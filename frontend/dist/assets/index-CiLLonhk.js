import{j as e,q as Gt,_ as es}from"./ui-BsaTBtI9.js";import{a as di,r as o,N as ui,b as Tl,O as Pl,m as Ne,u as lr,L as Zt,c as mi,d as hi,R as Ol,f as We,B as Rl}from"./vendor-BVDAFvKx.js";import{a as Il,A as Dl,c as Fl,u as Ct,b as je,d as le,Q as Ll,e as Ml}from"./data-CsO4I2n7.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(i){if(i.ep)return;i.ep=!0;const l=r(i);fetch(i.href,l)}})();var pi,Rn=di;pi=Rn.createRoot,Rn.hydrateRoot;const Z=Il.create({baseURL:"https://admin.fixzep.com/api",timeout:15e3});Z.interceptors.request.use(t=>{const s=localStorage.getItem("fixzep_token");if(s){const r=Dl.from(t.headers);r.set("Authorization",`Bearer ${s}`),t.headers=r}return t});const te=async t=>(await t).data.data,Bl={login:t=>te(Z.post("/auth/login",t))},Ee={list:(t={})=>te(Z.get("/admin/orders",{params:t})),create:t=>te(Z.post("/admin/orders",t)),assign:(t,s)=>te(Z.post(`/admin/orders/${t}/assign`,s)),candidates:t=>te(Z.get(`/admin/orders/${t}/technicians`)),jobCard:t=>te(Z.get(`/admin/orders/${t}/jobcard`)),reschedule:(t,s)=>te(Z.post(`/orders/${t}/reschedule`,s)),changeStatus:(t,s)=>te(Z.post(`/admin/orders/${t}/status`,s)),uploadMedia:(t,s)=>te(Z.post(`/admin/orders/${t}/media`,s)),deleteMedia:(t,s)=>te(Z.delete(`/admin/orders/${t}/media/${s}`)),updatePaymentStatus:(t,s)=>te(Z.post(`/admin/orders/${t}/payment-status`,s)),addHistoryNote:(t,s)=>te(Z.post(`/admin/orders/${t}/history`,s)),addSparePart:(t,s)=>te(Z.post(`/admin/orders/${t}/spare-parts`,s)),removeSparePart:(t,s)=>te(Z.delete(`/admin/orders/${t}/spare-parts/${s}`)),addAdditionalService:(t,s)=>te(Z.post(`/admin/orders/${t}/additional-services`,s)),removeAdditionalService:(t,s)=>te(Z.delete(`/admin/orders/${t}/additional-services/${s}`))},Ie={categories:()=>te(Z.get("/admin/categories")),serviceItems:t=>te(Z.get("/admin/service-items",{params:t?{categoryId:t}:void 0})),upsertCategory:t=>te(Z.post("/admin/categories",t)),updateCategory:(t,s)=>te(Z.put(`/admin/categories/${t}`,s)),deleteCategory:t=>te(Z.delete(`/admin/categories/${t}`)),upsertServiceItem:t=>te(Z.post("/admin/service-items",t)),updateServiceItem:(t,s)=>te(Z.put(`/admin/service-items/${t}`,s)),deleteServiceItem:t=>te(Z.delete(`/admin/service-items/${t}`))},ws={list:()=>te(Z.get("/admin/spare-parts")),upsert:t=>te(Z.post("/admin/spare-parts",t)),update:(t,s)=>te(Z.put(`/admin/spare-parts/${t}`,s)),delete:t=>te(Z.delete(`/admin/spare-parts/${t}`))},Br={list:()=>te(Z.get("/admin/technician-skills")),create:t=>te(Z.post("/admin/technician-skills",t))},$l={create:t=>te(Z.post("/admin/users",t))},Xt={list:()=>te(Z.get("/admin/technicians")),get:t=>te(Z.get(`/admin/technicians/${t}`)),update:(t,s)=>te(Z.put(`/admin/technicians/${t}`,s)),availability:t=>te(Z.get(`/admin/technicians/${t}/availability`)),schedule:(t,s)=>te(Z.get(`/admin/technicians/${t}/schedule`,{params:s})),attendance:t=>te(Z.get(`/admin/technicians/${t}/attendance`)),markAttendance:(t,s)=>te(Z.post(`/admin/technicians/${t}/attendance`,s))},Ns={list:()=>te(Z.get("/admin/time-slots")),create:t=>te(Z.post("/admin/time-slots",t)),update:(t,s)=>te(Z.put(`/admin/time-slots/${t}`,s)),remove:t=>te(Z.delete(`/admin/time-slots/${t}`))},wt={list:()=>te(Z.get("/admin/customers")),findByPhone:t=>te(Z.get(`/admin/customers/phone/${t}`)),create:t=>te(Z.post("/admin/customers",t)),update:(t,s)=>te(Z.put(`/admin/customers/${t}`,s)),updateAddress:(t,s)=>te(Z.put(`/admin/customers/${t}/address`,s)),deleteAddress:(t,s)=>te(Z.delete(`/admin/customers/${t}/address/${s}`))};let ql={data:""},Ul=t=>{if(typeof window=="object"){let s=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return s.nonce=window.__nonce__,s.parentNode||(t||document.head).appendChild(s),s.firstChild}return t||ql},Vl=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Wl=/\/\*[^]*?\*\/|  +/g,In=/\n+/g,Ot=(t,s)=>{let r="",a="",i="";for(let l in t){let c=t[l];l[0]=="@"?l[1]=="i"?r=l+" "+c+";":a+=l[1]=="f"?Ot(c,l):l+"{"+Ot(c,l[1]=="k"?"":s)+"}":typeof c=="object"?a+=Ot(c,s?s.replace(/([^,])+/g,u=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,b=>/&/.test(b)?b.replace(/&/g,u):u?u+" "+b:b)):l):c!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Ot.p?Ot.p(l,c):l+":"+c+";")}return r+(s&&i?s+"{"+i+"}":i)+a},vt={},xi=t=>{if(typeof t=="object"){let s="";for(let r in t)s+=r+xi(t[r]);return s}return t},Hl=(t,s,r,a,i)=>{let l=xi(t),c=vt[l]||(vt[l]=(b=>{let f=0,h=11;for(;f<b.length;)h=101*h+b.charCodeAt(f++)>>>0;return"go"+h})(l));if(!vt[c]){let b=l!==t?t:(f=>{let h,p,w=[{}];for(;h=Vl.exec(f.replace(Wl,""));)h[4]?w.shift():h[3]?(p=h[3].replace(In," ").trim(),w.unshift(w[0][p]=w[0][p]||{})):w[0][h[1]]=h[2].replace(In," ").trim();return w[0]})(t);vt[c]=Ot(i?{["@keyframes "+c]:b}:b,r?"":"."+c)}let u=r&&vt.g?vt.g:null;return r&&(vt.g=vt[c]),((b,f,h,p)=>{p?f.data=f.data.replace(p,b):f.data.indexOf(b)===-1&&(f.data=h?b+f.data:f.data+b)})(vt[c],s,a,u),c},Kl=(t,s,r)=>t.reduce((a,i,l)=>{let c=s[l];if(c&&c.call){let u=c(r),b=u&&u.props&&u.props.className||/^go/.test(u)&&u;c=b?"."+b:u&&typeof u=="object"?u.props?"":Ot(u,""):u===!1?"":u}return a+i+(c??"")},"");function or(t){let s=this||{},r=t.call?t(s.p):t;return Hl(r.unshift?r.raw?Kl(r,[].slice.call(arguments,1),s.p):r.reduce((a,i)=>Object.assign(a,i&&i.call?i(s.p):i),{}):r,Ul(s.target),s.g,s.o,s.k)}let fi,$r,qr;or.bind({g:1});let Nt=or.bind({k:1});function Ql(t,s,r,a){Ot.p=s,fi=t,$r=r,qr=a}function Ft(t,s){let r=this||{};return function(){let a=arguments;function i(l,c){let u=Object.assign({},l),b=u.className||i.className;r.p=Object.assign({theme:$r&&$r()},u),r.o=/ *go\d+/.test(b),u.className=or.apply(r,a)+(b?" "+b:"");let f=t;return t[0]&&(f=u.as||t,delete u.as),qr&&f[0]&&qr(u),fi(f,u)}return i}}var zl=t=>typeof t=="function",rr=(t,s)=>zl(t)?t(s):t,Zl=(()=>{let t=0;return()=>(++t).toString()})(),gi=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let s=matchMedia("(prefers-reduced-motion: reduce)");t=!s||s.matches}return t}})(),Yl=20,ea="default",bi=(t,s)=>{let{toastLimit:r}=t.settings;switch(s.type){case 0:return{...t,toasts:[s.toast,...t.toasts].slice(0,r)};case 1:return{...t,toasts:t.toasts.map(c=>c.id===s.toast.id?{...c,...s.toast}:c)};case 2:let{toast:a}=s;return bi(t,{type:t.toasts.find(c=>c.id===a.id)?1:0,toast:a});case 3:let{toastId:i}=s;return{...t,toasts:t.toasts.map(c=>c.id===i||i===void 0?{...c,dismissed:!0,visible:!1}:c)};case 4:return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(c=>c.id!==s.toastId)};case 5:return{...t,pausedAt:s.time};case 6:let l=s.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(c=>({...c,pauseDuration:c.pauseDuration+l}))}}},Xs=[],yi={toasts:[],pausedAt:void 0,settings:{toastLimit:Yl}},dt={},vi=(t,s=ea)=>{dt[s]=bi(dt[s]||yi,t),Xs.forEach(([r,a])=>{r===s&&a(dt[s])})},ji=t=>Object.keys(dt).forEach(s=>vi(t,s)),Jl=t=>Object.keys(dt).find(s=>dt[s].toasts.some(r=>r.id===t)),cr=(t=ea)=>s=>{vi(s,t)},Xl={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Gl=(t={},s=ea)=>{let[r,a]=o.useState(dt[s]||yi),i=o.useRef(dt[s]);o.useEffect(()=>(i.current!==dt[s]&&a(dt[s]),Xs.push([s,a]),()=>{let c=Xs.findIndex(([u])=>u===s);c>-1&&Xs.splice(c,1)}),[s]);let l=r.toasts.map(c=>{var u,b,f;return{...t,...t[c.type],...c,removeDelay:c.removeDelay||((u=t[c.type])==null?void 0:u.removeDelay)||(t==null?void 0:t.removeDelay),duration:c.duration||((b=t[c.type])==null?void 0:b.duration)||(t==null?void 0:t.duration)||Xl[c.type],style:{...t.style,...(f=t[c.type])==null?void 0:f.style,...c.style}}});return{...r,toasts:l}},eo=(t,s="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:s,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...r,id:(r==null?void 0:r.id)||Zl()}),As=t=>(s,r)=>{let a=eo(s,t,r);return cr(a.toasterId||Jl(a.id))({type:2,toast:a}),a.id},Pe=(t,s)=>As("blank")(t,s);Pe.error=As("error");Pe.success=As("success");Pe.loading=As("loading");Pe.custom=As("custom");Pe.dismiss=(t,s)=>{let r={type:3,toastId:t};s?cr(s)(r):ji(r)};Pe.dismissAll=t=>Pe.dismiss(void 0,t);Pe.remove=(t,s)=>{let r={type:4,toastId:t};s?cr(s)(r):ji(r)};Pe.removeAll=t=>Pe.remove(void 0,t);Pe.promise=(t,s,r)=>{let a=Pe.loading(s.loading,{...r,...r==null?void 0:r.loading});return typeof t=="function"&&(t=t()),t.then(i=>{let l=s.success?rr(s.success,i):void 0;return l?Pe.success(l,{id:a,...r,...r==null?void 0:r.success}):Pe.dismiss(a),i}).catch(i=>{let l=s.error?rr(s.error,i):void 0;l?Pe.error(l,{id:a,...r,...r==null?void 0:r.error}):Pe.dismiss(a)}),t};var to=1e3,so=(t,s="default")=>{let{toasts:r,pausedAt:a}=Gl(t,s),i=o.useRef(new Map).current,l=o.useCallback((p,w=to)=>{if(i.has(p))return;let Y=setTimeout(()=>{i.delete(p),c({type:4,toastId:p})},w);i.set(p,Y)},[]);o.useEffect(()=>{if(a)return;let p=Date.now(),w=r.map(Y=>{if(Y.duration===1/0)return;let X=(Y.duration||0)+Y.pauseDuration-(p-Y.createdAt);if(X<0){Y.visible&&Pe.dismiss(Y.id);return}return setTimeout(()=>Pe.dismiss(Y.id,s),X)});return()=>{w.forEach(Y=>Y&&clearTimeout(Y))}},[r,a,s]);let c=o.useCallback(cr(s),[s]),u=o.useCallback(()=>{c({type:5,time:Date.now()})},[c]),b=o.useCallback((p,w)=>{c({type:1,toast:{id:p,height:w}})},[c]),f=o.useCallback(()=>{a&&c({type:6,time:Date.now()})},[a,c]),h=o.useCallback((p,w)=>{let{reverseOrder:Y=!1,gutter:X=8,defaultPosition:J}=w||{},M=r.filter(C=>(C.position||J)===(p.position||J)&&C.height),G=M.findIndex(C=>C.id===p.id),B=M.filter((C,I)=>I<G&&C.visible).length;return M.filter(C=>C.visible).slice(...Y?[B+1]:[0,B]).reduce((C,I)=>C+(I.height||0)+X,0)},[r]);return o.useEffect(()=>{r.forEach(p=>{if(p.dismissed)l(p.id,p.removeDelay);else{let w=i.get(p.id);w&&(clearTimeout(w),i.delete(p.id))}})},[r,l]),{toasts:r,handlers:{updateHeight:b,startPause:u,endPause:f,calculateOffset:h}}},ro=Nt`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,ao=Nt`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,no=Nt`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,io=Ft("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ro} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${ao} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${no} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,lo=Nt`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,oo=Ft("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${lo} 1s linear infinite;
`,co=Nt`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,uo=Nt`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,mo=Ft("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${co} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${uo} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,ho=Ft("div")`
  position: absolute;
`,po=Ft("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,xo=Nt`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,fo=Ft("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${xo} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,go=({toast:t})=>{let{icon:s,type:r,iconTheme:a}=t;return s!==void 0?typeof s=="string"?o.createElement(fo,null,s):s:r==="blank"?null:o.createElement(po,null,o.createElement(oo,{...a}),r!=="loading"&&o.createElement(ho,null,r==="error"?o.createElement(io,{...a}):o.createElement(mo,{...a})))},bo=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,yo=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,vo="0%{opacity:0;} 100%{opacity:1;}",jo="0%{opacity:1;} 100%{opacity:0;}",wo=Ft("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,No=Ft("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,So=(t,s)=>{let r=t.includes("top")?1:-1,[a,i]=gi()?[vo,jo]:[bo(r),yo(r)];return{animation:s?`${Nt(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Nt(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Co=o.memo(({toast:t,position:s,style:r,children:a})=>{let i=t.height?So(t.position||s||"top-center",t.visible):{opacity:0},l=o.createElement(go,{toast:t}),c=o.createElement(No,{...t.ariaProps},rr(t.message,t));return o.createElement(wo,{className:t.className,style:{...i,...r,...t.style}},typeof a=="function"?a({icon:l,message:c}):o.createElement(o.Fragment,null,l,c))});Ql(o.createElement);var ko=({id:t,className:s,style:r,onHeightUpdate:a,children:i})=>{let l=o.useCallback(c=>{if(c){let u=()=>{let b=c.getBoundingClientRect().height;a(t,b)};u(),new MutationObserver(u).observe(c,{subtree:!0,childList:!0,characterData:!0})}},[t,a]);return o.createElement("div",{ref:l,className:s,style:r},i)},Eo=(t,s)=>{let r=t.includes("top"),a=r?{top:0}:{bottom:0},i=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:gi()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${s*(r?1:-1)}px)`,...a,...i}},_o=or`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Qs=16,Ao=({reverseOrder:t,position:s="top-center",toastOptions:r,gutter:a,children:i,toasterId:l,containerStyle:c,containerClassName:u})=>{let{toasts:b,handlers:f}=so(r,l);return o.createElement("div",{"data-rht-toaster":l||"",style:{position:"fixed",zIndex:9999,top:Qs,left:Qs,right:Qs,bottom:Qs,pointerEvents:"none",...c},className:u,onMouseEnter:f.startPause,onMouseLeave:f.endPause},b.map(h=>{let p=h.position||s,w=f.calculateOffset(h,{reverseOrder:t,gutter:a,defaultPosition:s}),Y=Eo(p,w);return o.createElement(ko,{id:h.id,key:h.id,onHeightUpdate:f.updateHeight,className:h.visible?_o:"",style:Y},h.type==="custom"?rr(h.message,h):i?i(h):o.createElement(Co,{toast:h,position:p}))}))},N=Pe;const wi=o.createContext(void 0),Or="fixzep_token",Rr="fixzep_user",To=({children:t})=>{const[s,r]=o.useState(()=>localStorage.getItem(Or)),[a,i]=o.useState(()=>{const b=localStorage.getItem(Rr);return b?JSON.parse(b):null});o.useEffect(()=>{s?localStorage.setItem(Or,s):localStorage.removeItem(Or)},[s]),o.useEffect(()=>{a?localStorage.setItem(Rr,JSON.stringify(a)):localStorage.removeItem(Rr)},[a]);const l=o.useCallback(async b=>{var f,h;try{const p=await Bl.login(b);r(p.token),i(p.user),N.success("Welcome back, "+p.user.name.split(" ")[0])}catch(p){throw N.error(((h=(f=p==null?void 0:p.response)==null?void 0:f.data)==null?void 0:h.message)||"Unable to login"),p}},[]),c=o.useCallback(()=>{r(null),i(null),N.success("Logged out")},[]),u=o.useMemo(()=>({user:a,token:s,isAuthenticated:!!(s&&a),login:l,logout:c}),[l,c,s,a]);return e.jsx(wi.Provider,{value:u,children:t})},Po=()=>{const t=o.useContext(wi);if(!t)throw new Error("useAuthContext must be used within AuthProvider");return t},ta=()=>Po(),Oo=({children:t})=>{const{isAuthenticated:s}=ta();return s?e.jsx(e.Fragment,{children:t}):e.jsx(ui,{to:"/login",replace:!0})};function Ro({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const Io=o.forwardRef(Ro);function Do({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const Fo=o.forwardRef(Do);function Lo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))}const Mo=o.forwardRef(Lo);function Bo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"}))}const Dn=o.forwardRef(Bo);function $o({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const qo=o.forwardRef($o);function Uo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const Ni=o.forwardRef(Uo);function Vo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}))}const Wo=o.forwardRef(Vo);function Ho({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Ko=o.forwardRef(Ho);function Qo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"}))}const zo=o.forwardRef(Qo);function Zo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Yo=o.forwardRef(Zo);function Jo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25"}))}const Xo=o.forwardRef(Jo);function Go({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const Ur=o.forwardRef(Go);function ec({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const Vr=o.forwardRef(ec);function tc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607ZM13.5 10.5h-6"}))}const sc=o.forwardRef(tc);function rc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607ZM10.5 7.5v6m3-3h-6"}))}const ac=o.forwardRef(rc);function nc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const Dt=o.forwardRef(nc);function ic({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const lc=o.forwardRef(ic);function oc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const Fn=o.forwardRef(oc);function cc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z"}))}const dc=o.forwardRef(cc);function uc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const mc=o.forwardRef(uc);function hc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const pc=o.forwardRef(hc);function xc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"}))}const fc=o.forwardRef(xc);function gc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const ts=o.forwardRef(gc);function bc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))}const yc=o.forwardRef(bc);function vc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"}))}const Ir=o.forwardRef(vc);function jc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))}const wc=o.forwardRef(jc);function Nc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75a4.5 4.5 0 0 1-4.884 4.484c-1.076-.091-2.264.071-2.95.904l-7.152 8.684a2.548 2.548 0 1 1-3.586-3.586l8.684-7.152c.833-.686.995-1.874.904-2.95a4.5 4.5 0 0 1 6.336-4.486l-3.276 3.276a3.004 3.004 0 0 0 2.25 2.25l3.276-3.276c.256.565.398 1.192.398 1.852Z"}),o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.867 19.125h.008v.008h-.008v-.008Z"}))}const Ln=o.forwardRef(Nc);function Sc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Cc=o.forwardRef(Sc);function kc({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Ss=o.forwardRef(kc);function Si(t){var s,r,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(s=0;s<i;s++)t[s]&&(r=Si(t[s]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function St(){for(var t,s,r=0,a="",i=arguments.length;r<i;r++)(t=arguments[r])&&(s=Si(t))&&(a&&(a+=" "),a+=s);return a}const Ec=[{to:"/",label:"Overview",icon:fc},{to:"/orders",label:"Orders",icon:zo},{to:"/customers",label:"Customers",icon:Ir},{to:"/catalog",label:"Catalog",icon:Ln},{to:"/technicians",label:"Technicians",icon:Ir},{to:"/spare-parts",label:"Spare Parts",icon:Ln},{to:"/time-slots",label:"Time Slots",icon:Yo},{to:"/banners",label:"Banners",icon:lc},{to:"/users/new",label:"Create User",icon:Ir}],Mn=()=>e.jsxs("aside",{className:"hidden lg:flex w-64 flex-col border-r border-slate-200 bg-white/90 backdrop-blur",children:[e.jsxs("div",{className:"px-6 py-5 border-b border-slate-200",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Fixzep Admin"}),e.jsx("p",{className:"mt-2 text-xl font-semibold text-slate-900",children:"Control Room"})]}),e.jsx("nav",{className:"flex-1 px-4 py-6 space-y-1",children:Ec.map(t=>e.jsxs(Tl,{to:t.to,className:({isActive:s})=>St("flex items-center gap-3 rounded-xl px-4 py-3 text-sm font-medium transition-all",s?"bg-slate-900 text-white shadow-card":"text-slate-500 hover:bg-slate-100"),children:[e.jsx(t.icon,{className:"h-5 w-5"}),t.label]},t.to))})]}),Ci=Fl(t=>({isOpen:!1,toggle:()=>t(s=>({isOpen:!s.isOpen})),close:()=>t({isOpen:!1})})),mt=Object.create(null);mt.open="0";mt.close="1";mt.ping="2";mt.pong="3";mt.message="4";mt.upgrade="5";mt.noop="6";const Gs=Object.create(null);Object.keys(mt).forEach(t=>{Gs[mt[t]]=t});const Wr={type:"error",data:"parser error"},ki=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ei=typeof ArrayBuffer=="function",_i=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,sa=({type:t,data:s},r,a)=>ki&&s instanceof Blob?r?a(s):Bn(s,a):Ei&&(s instanceof ArrayBuffer||_i(s))?r?a(s):Bn(new Blob([s]),a):a(mt[t]+(s||"")),Bn=(t,s)=>{const r=new FileReader;return r.onload=function(){const a=r.result.split(",")[1];s("b"+(a||""))},r.readAsDataURL(t)};function $n(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let Dr;function _c(t,s){if(ki&&t.data instanceof Blob)return t.data.arrayBuffer().then($n).then(s);if(Ei&&(t.data instanceof ArrayBuffer||_i(t.data)))return s($n(t.data));sa(t,!1,r=>{Dr||(Dr=new TextEncoder),s(Dr.encode(r))})}const qn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Cs=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<qn.length;t++)Cs[qn.charCodeAt(t)]=t;const Ac=t=>{let s=t.length*.75,r=t.length,a,i=0,l,c,u,b;t[t.length-1]==="="&&(s--,t[t.length-2]==="="&&s--);const f=new ArrayBuffer(s),h=new Uint8Array(f);for(a=0;a<r;a+=4)l=Cs[t.charCodeAt(a)],c=Cs[t.charCodeAt(a+1)],u=Cs[t.charCodeAt(a+2)],b=Cs[t.charCodeAt(a+3)],h[i++]=l<<2|c>>4,h[i++]=(c&15)<<4|u>>2,h[i++]=(u&3)<<6|b&63;return f},Tc=typeof ArrayBuffer=="function",ra=(t,s)=>{if(typeof t!="string")return{type:"message",data:Ai(t,s)};const r=t.charAt(0);return r==="b"?{type:"message",data:Pc(t.substring(1),s)}:Gs[r]?t.length>1?{type:Gs[r],data:t.substring(1)}:{type:Gs[r]}:Wr},Pc=(t,s)=>{if(Tc){const r=Ac(t);return Ai(r,s)}else return{base64:!0,data:t}},Ai=(t,s)=>{switch(s){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},Ti="",Oc=(t,s)=>{const r=t.length,a=new Array(r);let i=0;t.forEach((l,c)=>{sa(l,!1,u=>{a[c]=u,++i===r&&s(a.join(Ti))})})},Rc=(t,s)=>{const r=t.split(Ti),a=[];for(let i=0;i<r.length;i++){const l=ra(r[i],s);if(a.push(l),l.type==="error")break}return a};function Ic(){return new TransformStream({transform(t,s){_c(t,r=>{const a=r.length;let i;if(a<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,a);else if(a<65536){i=new Uint8Array(3);const l=new DataView(i.buffer);l.setUint8(0,126),l.setUint16(1,a)}else{i=new Uint8Array(9);const l=new DataView(i.buffer);l.setUint8(0,127),l.setBigUint64(1,BigInt(a))}t.data&&typeof t.data!="string"&&(i[0]|=128),s.enqueue(i),s.enqueue(r)})}})}let Fr;function zs(t){return t.reduce((s,r)=>s+r.length,0)}function Zs(t,s){if(t[0].length===s)return t.shift();const r=new Uint8Array(s);let a=0;for(let i=0;i<s;i++)r[i]=t[0][a++],a===t[0].length&&(t.shift(),a=0);return t.length&&a<t[0].length&&(t[0]=t[0].slice(a)),r}function Dc(t,s){Fr||(Fr=new TextDecoder);const r=[];let a=0,i=-1,l=!1;return new TransformStream({transform(c,u){for(r.push(c);;){if(a===0){if(zs(r)<1)break;const b=Zs(r,1);l=(b[0]&128)===128,i=b[0]&127,i<126?a=3:i===126?a=1:a=2}else if(a===1){if(zs(r)<2)break;const b=Zs(r,2);i=new DataView(b.buffer,b.byteOffset,b.length).getUint16(0),a=3}else if(a===2){if(zs(r)<8)break;const b=Zs(r,8),f=new DataView(b.buffer,b.byteOffset,b.length),h=f.getUint32(0);if(h>Math.pow(2,21)-1){u.enqueue(Wr);break}i=h*Math.pow(2,32)+f.getUint32(4),a=3}else{if(zs(r)<i)break;const b=Zs(r,i);u.enqueue(ra(l?b:Fr.decode(b),s)),a=0}if(i===0||i>t){u.enqueue(Wr);break}}}})}const Pi=4;function Ae(t){if(t)return Fc(t)}function Fc(t){for(var s in Ae.prototype)t[s]=Ae.prototype[s];return t}Ae.prototype.on=Ae.prototype.addEventListener=function(t,s){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(s),this};Ae.prototype.once=function(t,s){function r(){this.off(t,r),s.apply(this,arguments)}return r.fn=s,this.on(t,r),this};Ae.prototype.off=Ae.prototype.removeListener=Ae.prototype.removeAllListeners=Ae.prototype.removeEventListener=function(t,s){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var a,i=0;i<r.length;i++)if(a=r[i],a===s||a.fn===s){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};Ae.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var s=new Array(arguments.length-1),r=this._callbacks["$"+t],a=1;a<arguments.length;a++)s[a-1]=arguments[a];if(r){r=r.slice(0);for(var a=0,i=r.length;a<i;++a)r[a].apply(this,s)}return this};Ae.prototype.emitReserved=Ae.prototype.emit;Ae.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Ae.prototype.hasListeners=function(t){return!!this.listeners(t).length};const dr=typeof Promise=="function"&&typeof Promise.resolve=="function"?s=>Promise.resolve().then(s):(s,r)=>r(s,0),et=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Lc="arraybuffer";function Oi(t,...s){return s.reduce((r,a)=>(t.hasOwnProperty(a)&&(r[a]=t[a]),r),{})}const Mc=et.setTimeout,Bc=et.clearTimeout;function ur(t,s){s.useNativeTimers?(t.setTimeoutFn=Mc.bind(et),t.clearTimeoutFn=Bc.bind(et)):(t.setTimeoutFn=et.setTimeout.bind(et),t.clearTimeoutFn=et.clearTimeout.bind(et))}const $c=1.33;function qc(t){return typeof t=="string"?Uc(t):Math.ceil((t.byteLength||t.size)*$c)}function Uc(t){let s=0,r=0;for(let a=0,i=t.length;a<i;a++)s=t.charCodeAt(a),s<128?r+=1:s<2048?r+=2:s<55296||s>=57344?r+=3:(a++,r+=4);return r}function Ri(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Vc(t){let s="";for(let r in t)t.hasOwnProperty(r)&&(s.length&&(s+="&"),s+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return s}function Wc(t){let s={},r=t.split("&");for(let a=0,i=r.length;a<i;a++){let l=r[a].split("=");s[decodeURIComponent(l[0])]=decodeURIComponent(l[1])}return s}class Hc extends Error{constructor(s,r,a){super(s),this.description=r,this.context=a,this.type="TransportError"}}class aa extends Ae{constructor(s){super(),this.writable=!1,ur(this,s),this.opts=s,this.query=s.query,this.socket=s.socket,this.supportsBinary=!s.forceBase64}onError(s,r,a){return super.emitReserved("error",new Hc(s,r,a)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(s){this.readyState==="open"&&this.write(s)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(s){const r=ra(s,this.socket.binaryType);this.onPacket(r)}onPacket(s){super.emitReserved("packet",s)}onClose(s){this.readyState="closed",super.emitReserved("close",s)}pause(s){}createUri(s,r={}){return s+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const s=this.opts.hostname;return s.indexOf(":")===-1?s:"["+s+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(s){const r=Vc(s);return r.length?"?"+r:""}}class Kc extends aa{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(s){this.readyState="pausing";const r=()=>{this.readyState="paused",s()};if(this._polling||!this.writable){let a=0;this._polling&&(a++,this.once("pollComplete",function(){--a||r()})),this.writable||(a++,this.once("drain",function(){--a||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(s){const r=a=>{if(this.readyState==="opening"&&a.type==="open"&&this.onOpen(),a.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(a)};Rc(s,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const s=()=>{this.write([{type:"close"}])};this.readyState==="open"?s():this.once("open",s)}write(s){this.writable=!1,Oc(s,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const s=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=Ri()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(s,r)}}let Ii=!1;try{Ii=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Qc=Ii;function zc(){}class Zc extends Kc{constructor(s){if(super(s),typeof location<"u"){const r=location.protocol==="https:";let a=location.port;a||(a=r?"443":"80"),this.xd=typeof location<"u"&&s.hostname!==location.hostname||a!==s.port}}doWrite(s,r){const a=this.request({method:"POST",data:s});a.on("success",r),a.on("error",(i,l)=>{this.onError("xhr post error",i,l)})}doPoll(){const s=this.request();s.on("data",this.onData.bind(this)),s.on("error",(r,a)=>{this.onError("xhr poll error",r,a)}),this.pollXhr=s}}class ut extends Ae{constructor(s,r,a){super(),this.createRequest=s,ur(this,a),this._opts=a,this._method=a.method||"GET",this._uri=r,this._data=a.data!==void 0?a.data:null,this._create()}_create(){var s;const r=Oi(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const a=this._xhr=this.createRequest(r);try{a.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){a.setDisableHeaderCheck&&a.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&a.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{a.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{a.setRequestHeader("Accept","*/*")}catch{}(s=this._opts.cookieJar)===null||s===void 0||s.addCookies(a),"withCredentials"in a&&(a.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(a.timeout=this._opts.requestTimeout),a.onreadystatechange=()=>{var i;a.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(a.getResponseHeader("set-cookie"))),a.readyState===4&&(a.status===200||a.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof a.status=="number"?a.status:0)},0))},a.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=ut.requestsCount++,ut.requests[this._index]=this)}_onError(s){this.emitReserved("error",s,this._xhr),this._cleanup(!0)}_cleanup(s){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=zc,s)try{this._xhr.abort()}catch{}typeof document<"u"&&delete ut.requests[this._index],this._xhr=null}}_onLoad(){const s=this._xhr.responseText;s!==null&&(this.emitReserved("data",s),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}ut.requestsCount=0;ut.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Un);else if(typeof addEventListener=="function"){const t="onpagehide"in et?"pagehide":"unload";addEventListener(t,Un,!1)}}function Un(){for(let t in ut.requests)ut.requests.hasOwnProperty(t)&&ut.requests[t].abort()}const Yc=function(){const t=Di({xdomain:!1});return t&&t.responseType!==null}();class Jc extends Zc{constructor(s){super(s);const r=s&&s.forceBase64;this.supportsBinary=Yc&&!r}request(s={}){return Object.assign(s,{xd:this.xd},this.opts),new ut(Di,this.uri(),s)}}function Di(t){const s=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!s||Qc))return new XMLHttpRequest}catch{}if(!s)try{return new et[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Fi=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Xc extends aa{get name(){return"websocket"}doOpen(){const s=this.uri(),r=this.opts.protocols,a=Fi?{}:Oi(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(a.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(s,r,a)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=s=>this.onClose({description:"websocket connection closed",context:s}),this.ws.onmessage=s=>this.onData(s.data),this.ws.onerror=s=>this.onError("websocket error",s)}write(s){this.writable=!1;for(let r=0;r<s.length;r++){const a=s[r],i=r===s.length-1;sa(a,this.supportsBinary,l=>{try{this.doWrite(a,l)}catch{}i&&dr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const s=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=Ri()),this.supportsBinary||(r.b64=1),this.createUri(s,r)}}const Lr=et.WebSocket||et.MozWebSocket;class Gc extends Xc{createSocket(s,r,a){return Fi?new Lr(s,r,a):r?new Lr(s,r):new Lr(s)}doWrite(s,r){this.ws.send(r)}}class ed extends aa{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(s){return this.emitReserved("error",s)}this._transport.closed.then(()=>{this.onClose()}).catch(s=>{this.onError("webtransport error",s)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(s=>{const r=Dc(Number.MAX_SAFE_INTEGER,this.socket.binaryType),a=s.readable.pipeThrough(r).getReader(),i=Ic();i.readable.pipeTo(s.writable),this._writer=i.writable.getWriter();const l=()=>{a.read().then(({done:u,value:b})=>{u||(this.onPacket(b),l())}).catch(u=>{})};l();const c={type:"open"};this.query.sid&&(c.data=`{"sid":"${this.query.sid}"}`),this._writer.write(c).then(()=>this.onOpen())})})}write(s){this.writable=!1;for(let r=0;r<s.length;r++){const a=s[r],i=r===s.length-1;this._writer.write(a).then(()=>{i&&dr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var s;(s=this._transport)===null||s===void 0||s.close()}}const td={websocket:Gc,webtransport:ed,polling:Jc},sd=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,rd=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Hr(t){if(t.length>8e3)throw"URI too long";const s=t,r=t.indexOf("["),a=t.indexOf("]");r!=-1&&a!=-1&&(t=t.substring(0,r)+t.substring(r,a).replace(/:/g,";")+t.substring(a,t.length));let i=sd.exec(t||""),l={},c=14;for(;c--;)l[rd[c]]=i[c]||"";return r!=-1&&a!=-1&&(l.source=s,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=ad(l,l.path),l.queryKey=nd(l,l.query),l}function ad(t,s){const r=/\/{2,9}/g,a=s.replace(r,"/").split("/");return(s.slice(0,1)=="/"||s.length===0)&&a.splice(0,1),s.slice(-1)=="/"&&a.splice(a.length-1,1),a}function nd(t,s){const r={};return s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,i,l){i&&(r[i]=l)}),r}const Kr=typeof addEventListener=="function"&&typeof removeEventListener=="function",er=[];Kr&&addEventListener("offline",()=>{er.forEach(t=>t())},!1);class Rt extends Ae{constructor(s,r){if(super(),this.binaryType=Lc,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,s&&typeof s=="object"&&(r=s,s=null),s){const a=Hr(s);r.hostname=a.host,r.secure=a.protocol==="https"||a.protocol==="wss",r.port=a.port,a.query&&(r.query=a.query)}else r.host&&(r.hostname=Hr(r.host).host);ur(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(a=>{const i=a.prototype.name;this.transports.push(i),this._transportsByName[i]=a}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Wc(this.opts.query)),Kr&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},er.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(s){const r=Object.assign({},this.opts.query);r.EIO=Pi,r.transport=s,this.id&&(r.sid=this.id);const a=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[s]);return new this._transportsByName[s](a)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const s=this.opts.rememberUpgrade&&Rt.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(s);r.open(),this.setTransport(r)}setTransport(s){this.transport&&this.transport.removeAllListeners(),this.transport=s,s.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",Rt.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",s),this.emitReserved("heartbeat"),s.type){case"open":this.onHandshake(JSON.parse(s.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=s.data,this._onError(r);break;case"message":this.emitReserved("data",s.data),this.emitReserved("message",s.data);break}}onHandshake(s){this.emitReserved("handshake",s),this.id=s.sid,this.transport.query.sid=s.sid,this._pingInterval=s.pingInterval,this._pingTimeout=s.pingTimeout,this._maxPayload=s.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const s=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+s,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},s),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const s=this._getWritablePackets();this.transport.send(s),this._prevBufferLen=s.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let a=0;a<this.writeBuffer.length;a++){const i=this.writeBuffer[a].data;if(i&&(r+=qc(i)),a>0&&r>this._maxPayload)return this.writeBuffer.slice(0,a);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const s=Date.now()>this._pingTimeoutTime;return s&&(this._pingTimeoutTime=0,dr(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),s}write(s,r,a){return this._sendPacket("message",s,r,a),this}send(s,r,a){return this._sendPacket("message",s,r,a),this}_sendPacket(s,r,a,i){if(typeof r=="function"&&(i=r,r=void 0),typeof a=="function"&&(i=a,a=null),this.readyState==="closing"||this.readyState==="closed")return;a=a||{},a.compress=a.compress!==!1;const l={type:s,data:r,options:a};this.emitReserved("packetCreate",l),this.writeBuffer.push(l),i&&this.once("flush",i),this.flush()}close(){const s=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),s()},a=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?a():s()}):this.upgrading?a():s()),this}_onError(s){if(Rt.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",s),this._onClose("transport error",s)}_onClose(s,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Kr&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const a=er.indexOf(this._offlineEventListener);a!==-1&&er.splice(a,1)}this.readyState="closed",this.id=null,this.emitReserved("close",s,r),this.writeBuffer=[],this._prevBufferLen=0}}}Rt.protocol=Pi;class id extends Rt{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let s=0;s<this._upgrades.length;s++)this._probe(this._upgrades[s])}_probe(s){let r=this.createTransport(s),a=!1;Rt.priorWebsocketSuccess=!1;const i=()=>{a||(r.send([{type:"ping",data:"probe"}]),r.once("packet",p=>{if(!a)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;Rt.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{a||this.readyState!=="closed"&&(h(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const w=new Error("probe error");w.transport=r.name,this.emitReserved("upgradeError",w)}}))};function l(){a||(a=!0,h(),r.close(),r=null)}const c=p=>{const w=new Error("probe error: "+p);w.transport=r.name,l(),this.emitReserved("upgradeError",w)};function u(){c("transport closed")}function b(){c("socket closed")}function f(p){r&&p.name!==r.name&&l()}const h=()=>{r.removeListener("open",i),r.removeListener("error",c),r.removeListener("close",u),this.off("close",b),this.off("upgrading",f)};r.once("open",i),r.once("error",c),r.once("close",u),this.once("close",b),this.once("upgrading",f),this._upgrades.indexOf("webtransport")!==-1&&s!=="webtransport"?this.setTimeoutFn(()=>{a||r.open()},200):r.open()}onHandshake(s){this._upgrades=this._filterUpgrades(s.upgrades),super.onHandshake(s)}_filterUpgrades(s){const r=[];for(let a=0;a<s.length;a++)~this.transports.indexOf(s[a])&&r.push(s[a]);return r}}let ld=class extends id{constructor(s,r={}){const a=typeof s=="object"?s:r;(!a.transports||a.transports&&typeof a.transports[0]=="string")&&(a.transports=(a.transports||["polling","websocket","webtransport"]).map(i=>td[i]).filter(i=>!!i)),super(s,a)}};function od(t,s="",r){let a=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),a=Hr(t)),a.port||(/^(http|ws)$/.test(a.protocol)?a.port="80":/^(http|ws)s$/.test(a.protocol)&&(a.port="443")),a.path=a.path||"/";const l=a.host.indexOf(":")!==-1?"["+a.host+"]":a.host;return a.id=a.protocol+"://"+l+":"+a.port+s,a.href=a.protocol+"://"+l+(r&&r.port===a.port?"":":"+a.port),a}const cd=typeof ArrayBuffer=="function",dd=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,Li=Object.prototype.toString,ud=typeof Blob=="function"||typeof Blob<"u"&&Li.call(Blob)==="[object BlobConstructor]",md=typeof File=="function"||typeof File<"u"&&Li.call(File)==="[object FileConstructor]";function na(t){return cd&&(t instanceof ArrayBuffer||dd(t))||ud&&t instanceof Blob||md&&t instanceof File}function tr(t,s){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,a=t.length;r<a;r++)if(tr(t[r]))return!0;return!1}if(na(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return tr(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&tr(t[r]))return!0;return!1}function hd(t){const s=[],r=t.data,a=t;return a.data=Qr(r,s),a.attachments=s.length,{packet:a,buffers:s}}function Qr(t,s){if(!t)return t;if(na(t)){const r={_placeholder:!0,num:s.length};return s.push(t),r}else if(Array.isArray(t)){const r=new Array(t.length);for(let a=0;a<t.length;a++)r[a]=Qr(t[a],s);return r}else if(typeof t=="object"&&!(t instanceof Date)){const r={};for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=Qr(t[a],s));return r}return t}function pd(t,s){return t.data=zr(t.data,s),delete t.attachments,t}function zr(t,s){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<s.length)return s[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=zr(t[r],s);else if(typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=zr(t[r],s));return t}const Mi=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],xd=5;var ie;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(ie||(ie={}));class fd{constructor(s){this.replacer=s}encode(s){return(s.type===ie.EVENT||s.type===ie.ACK)&&tr(s)?this.encodeAsBinary({type:s.type===ie.EVENT?ie.BINARY_EVENT:ie.BINARY_ACK,nsp:s.nsp,data:s.data,id:s.id}):[this.encodeAsString(s)]}encodeAsString(s){let r=""+s.type;return(s.type===ie.BINARY_EVENT||s.type===ie.BINARY_ACK)&&(r+=s.attachments+"-"),s.nsp&&s.nsp!=="/"&&(r+=s.nsp+","),s.id!=null&&(r+=s.id),s.data!=null&&(r+=JSON.stringify(s.data,this.replacer)),r}encodeAsBinary(s){const r=hd(s),a=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(a),i}}class ia extends Ae{constructor(s){super(),this.reviver=s}add(s){let r;if(typeof s=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(s);const a=r.type===ie.BINARY_EVENT;a||r.type===ie.BINARY_ACK?(r.type=a?ie.EVENT:ie.ACK,this.reconstructor=new gd(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(na(s)||s.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(s),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+s)}decodeString(s){let r=0;const a={type:Number(s.charAt(0))};if(ie[a.type]===void 0)throw new Error("unknown packet type "+a.type);if(a.type===ie.BINARY_EVENT||a.type===ie.BINARY_ACK){const l=r+1;for(;s.charAt(++r)!=="-"&&r!=s.length;);const c=s.substring(l,r);if(c!=Number(c)||s.charAt(r)!=="-")throw new Error("Illegal attachments");a.attachments=Number(c)}if(s.charAt(r+1)==="/"){const l=r+1;for(;++r&&!(s.charAt(r)===","||r===s.length););a.nsp=s.substring(l,r)}else a.nsp="/";const i=s.charAt(r+1);if(i!==""&&Number(i)==i){const l=r+1;for(;++r;){const c=s.charAt(r);if(c==null||Number(c)!=c){--r;break}if(r===s.length)break}a.id=Number(s.substring(l,r+1))}if(s.charAt(++r)){const l=this.tryParse(s.substr(r));if(ia.isPayloadValid(a.type,l))a.data=l;else throw new Error("invalid payload")}return a}tryParse(s){try{return JSON.parse(s,this.reviver)}catch{return!1}}static isPayloadValid(s,r){switch(s){case ie.CONNECT:return ar(r);case ie.DISCONNECT:return r===void 0;case ie.CONNECT_ERROR:return typeof r=="string"||ar(r);case ie.EVENT:case ie.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&Mi.indexOf(r[0])===-1);case ie.ACK:case ie.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class gd{constructor(s){this.packet=s,this.buffers=[],this.reconPack=s}takeBinaryData(s){if(this.buffers.push(s),this.buffers.length===this.reconPack.attachments){const r=pd(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function bd(t){return typeof t=="string"}const yd=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};function vd(t){return t===void 0||yd(t)}function ar(t){return Object.prototype.toString.call(t)==="[object Object]"}function jd(t,s){switch(t){case ie.CONNECT:return s===void 0||ar(s);case ie.DISCONNECT:return s===void 0;case ie.EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&Mi.indexOf(s[0])===-1);case ie.ACK:return Array.isArray(s);case ie.CONNECT_ERROR:return typeof s=="string"||ar(s);default:return!1}}function wd(t){return bd(t.nsp)&&vd(t.id)&&jd(t.type,t.data)}const Nd=Object.freeze(Object.defineProperty({__proto__:null,Decoder:ia,Encoder:fd,get PacketType(){return ie},isPacketValid:wd,protocol:xd},Symbol.toStringTag,{value:"Module"}));function rt(t,s,r){return t.on(s,r),function(){t.off(s,r)}}const Sd=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Bi extends Ae{constructor(s,r,a){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=s,this.nsp=r,a&&a.auth&&(this.auth=a.auth),this._opts=Object.assign({},a),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const s=this.io;this.subs=[rt(s,"open",this.onopen.bind(this)),rt(s,"packet",this.onpacket.bind(this)),rt(s,"error",this.onerror.bind(this)),rt(s,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...s){return s.unshift("message"),this.emit.apply(this,s),this}emit(s,...r){var a,i,l;if(Sd.hasOwnProperty(s))throw new Error('"'+s.toString()+'" is a reserved event name');if(r.unshift(s),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const c={type:ie.EVENT,data:r};if(c.options={},c.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const h=this.ids++,p=r.pop();this._registerAckCallback(h,p),c.id=h}const u=(i=(a=this.io.engine)===null||a===void 0?void 0:a.transport)===null||i===void 0?void 0:i.writable,b=this.connected&&!(!((l=this.io.engine)===null||l===void 0)&&l._hasPingExpired());return this.flags.volatile&&!u||(b?(this.notifyOutgoingListeners(c),this.packet(c)):this.sendBuffer.push(c)),this.flags={},this}_registerAckCallback(s,r){var a;const i=(a=this.flags.timeout)!==null&&a!==void 0?a:this._opts.ackTimeout;if(i===void 0){this.acks[s]=r;return}const l=this.io.setTimeoutFn(()=>{delete this.acks[s];for(let u=0;u<this.sendBuffer.length;u++)this.sendBuffer[u].id===s&&this.sendBuffer.splice(u,1);r.call(this,new Error("operation has timed out"))},i),c=(...u)=>{this.io.clearTimeoutFn(l),r.apply(this,u)};c.withError=!0,this.acks[s]=c}emitWithAck(s,...r){return new Promise((a,i)=>{const l=(c,u)=>c?i(c):a(u);l.withError=!0,r.push(l),this.emit(s,...r)})}_addToQueue(s){let r;typeof s[s.length-1]=="function"&&(r=s.pop());const a={id:this._queueSeq++,tryCount:0,pending:!1,args:s,flags:Object.assign({fromQueue:!0},this.flags)};s.push((i,...l)=>(this._queue[0],i!==null?a.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...l)),a.pending=!1,this._drainQueue())),this._queue.push(a),this._drainQueue()}_drainQueue(s=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!s||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(s){s.nsp=this.nsp,this.io._packet(s)}onopen(){typeof this.auth=="function"?this.auth(s=>{this._sendConnectPacket(s)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(s){this.packet({type:ie.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},s):s})}onerror(s){this.connected||this.emitReserved("connect_error",s)}onclose(s,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",s,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(s=>{if(!this.sendBuffer.some(a=>String(a.id)===s)){const a=this.acks[s];delete this.acks[s],a.withError&&a.call(this,new Error("socket has been disconnected"))}})}onpacket(s){if(s.nsp===this.nsp)switch(s.type){case ie.CONNECT:s.data&&s.data.sid?this.onconnect(s.data.sid,s.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ie.EVENT:case ie.BINARY_EVENT:this.onevent(s);break;case ie.ACK:case ie.BINARY_ACK:this.onack(s);break;case ie.DISCONNECT:this.ondisconnect();break;case ie.CONNECT_ERROR:this.destroy();const a=new Error(s.data.message);a.data=s.data.data,this.emitReserved("connect_error",a);break}}onevent(s){const r=s.data||[];s.id!=null&&r.push(this.ack(s.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(s){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const a of r)a.apply(this,s)}super.emit.apply(this,s),this._pid&&s.length&&typeof s[s.length-1]=="string"&&(this._lastOffset=s[s.length-1])}ack(s){const r=this;let a=!1;return function(...i){a||(a=!0,r.packet({type:ie.ACK,id:s,data:i}))}}onack(s){const r=this.acks[s.id];typeof r=="function"&&(delete this.acks[s.id],r.withError&&s.data.unshift(null),r.apply(this,s.data))}onconnect(s,r){this.id=s,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(s=>this.emitEvent(s)),this.receiveBuffer=[],this.sendBuffer.forEach(s=>{this.notifyOutgoingListeners(s),this.packet(s)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(s=>s()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ie.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(s){return this.flags.compress=s,this}get volatile(){return this.flags.volatile=!0,this}timeout(s){return this.flags.timeout=s,this}onAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(s),this}prependAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(s),this}offAny(s){if(!this._anyListeners)return this;if(s){const r=this._anyListeners;for(let a=0;a<r.length;a++)if(s===r[a])return r.splice(a,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(s),this}prependAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(s),this}offAnyOutgoing(s){if(!this._anyOutgoingListeners)return this;if(s){const r=this._anyOutgoingListeners;for(let a=0;a<r.length;a++)if(s===r[a])return r.splice(a,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(s){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const a of r)a.apply(this,s.data)}}}function ss(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ss.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var s=Math.random(),r=Math.floor(s*this.jitter*t);t=Math.floor(s*10)&1?t+r:t-r}return Math.min(t,this.max)|0};ss.prototype.reset=function(){this.attempts=0};ss.prototype.setMin=function(t){this.ms=t};ss.prototype.setMax=function(t){this.max=t};ss.prototype.setJitter=function(t){this.jitter=t};class Zr extends Ae{constructor(s,r){var a;super(),this.nsps={},this.subs=[],s&&typeof s=="object"&&(r=s,s=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,ur(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((a=r.randomizationFactor)!==null&&a!==void 0?a:.5),this.backoff=new ss({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=s;const i=r.parser||Nd;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(s){return arguments.length?(this._reconnection=!!s,s||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(s){return s===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=s,this)}reconnectionDelay(s){var r;return s===void 0?this._reconnectionDelay:(this._reconnectionDelay=s,(r=this.backoff)===null||r===void 0||r.setMin(s),this)}randomizationFactor(s){var r;return s===void 0?this._randomizationFactor:(this._randomizationFactor=s,(r=this.backoff)===null||r===void 0||r.setJitter(s),this)}reconnectionDelayMax(s){var r;return s===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=s,(r=this.backoff)===null||r===void 0||r.setMax(s),this)}timeout(s){return arguments.length?(this._timeout=s,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(s){if(~this._readyState.indexOf("open"))return this;this.engine=new ld(this.uri,this.opts);const r=this.engine,a=this;this._readyState="opening",this.skipReconnect=!1;const i=rt(r,"open",function(){a.onopen(),s&&s()}),l=u=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",u),s?s(u):this.maybeReconnectOnOpen()},c=rt(r,"error",l);if(this._timeout!==!1){const u=this._timeout,b=this.setTimeoutFn(()=>{i(),l(new Error("timeout")),r.close()},u);this.opts.autoUnref&&b.unref(),this.subs.push(()=>{this.clearTimeoutFn(b)})}return this.subs.push(i),this.subs.push(c),this}connect(s){return this.open(s)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const s=this.engine;this.subs.push(rt(s,"ping",this.onping.bind(this)),rt(s,"data",this.ondata.bind(this)),rt(s,"error",this.onerror.bind(this)),rt(s,"close",this.onclose.bind(this)),rt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(s){try{this.decoder.add(s)}catch(r){this.onclose("parse error",r)}}ondecoded(s){dr(()=>{this.emitReserved("packet",s)},this.setTimeoutFn)}onerror(s){this.emitReserved("error",s)}socket(s,r){let a=this.nsps[s];return a?this._autoConnect&&!a.active&&a.connect():(a=new Bi(this,s,r),this.nsps[s]=a),a}_destroy(s){const r=Object.keys(this.nsps);for(const a of r)if(this.nsps[a].active)return;this._close()}_packet(s){const r=this.encoder.encode(s);for(let a=0;a<r.length;a++)this.engine.write(r[a],s.options)}cleanup(){this.subs.forEach(s=>s()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(s,r){var a;this.cleanup(),(a=this.engine)===null||a===void 0||a.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",s,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const s=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const a=this.setTimeoutFn(()=>{s.skipReconnect||(this.emitReserved("reconnect_attempt",s.backoff.attempts),!s.skipReconnect&&s.open(i=>{i?(s._reconnecting=!1,s.reconnect(),this.emitReserved("reconnect_error",i)):s.onreconnect()}))},r);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}}onreconnect(){const s=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",s)}}const ys={};function sr(t,s){typeof t=="object"&&(s=t,t=void 0),s=s||{};const r=od(t,s.path||"/socket.io"),a=r.source,i=r.id,l=r.path,c=ys[i]&&l in ys[i].nsps,u=s.forceNew||s["force new connection"]||s.multiplex===!1||c;let b;return u?b=new Zr(a,s):(ys[i]||(ys[i]=new Zr(a,s)),b=ys[i]),r.query&&!s.query&&(s.query=r.queryKey),b.socket(r.path,s)}Object.assign(sr,{Manager:Zr,Socket:Bi,io:sr,connect:sr});const Cd="/notification.wav";var ci;const kd=typeof window<"u"&&((ci=window.electronAPI)==null?void 0:ci.isElectron)===!0,ve={ORDER_CREATED:"ORDER_CREATED",ORDER_RESCHEDULED:"ORDER_RESCHEDULED",TECHNICIAN_ASSIGNED:"TECHNICIAN_ASSIGNED",JOB_UPDATED:"JOB_UPDATED",CUSTOMER_ORDER_PLACED:"CUSTOMER_ORDER_PLACED",PAYMENT_RECEIVED:"PAYMENT_RECEIVED",TECHNICIAN_CHECKED_IN:"TECHNICIAN_CHECKED_IN",CUSTOMER_APPROVAL_REQUIRED:"CUSTOMER_APPROVAL_REQUIRED",CUSTOMER_APPROVAL_UPDATED:"CUSTOMER_APPROVAL_UPDATED",TECHNICIAN_UNASSIGNED:"TECHNICIAN_UNASSIGNED",ORDER_CANCELLATION_REQUESTED:"ORDER_CANCELLATION_REQUESTED",ORDER_CANCELLED:"ORDER_CANCELLED",ORDER_ACTIVITY:"ORDER_ACTIVITY"},$i=o.createContext(null),Ed="https://admin.fixzep.com",_d=({children:t})=>{const[s,r]=o.useState(null),[a,i]=o.useState(!1),[l,c]=o.useState([]),[u,b]=o.useState(!0),f=Ct(),h=o.useRef(null),p=o.useRef(null);o.useEffect(()=>(h.current=new Audio(Cd),h.current.volume=.5,h.current.load(),()=>{h.current&&(h.current.pause(),h.current=null)}),[]),o.useEffect(()=>{const C=()=>{if(h.current&&!u){const E=h.current;E.volume=0,E.play().then(()=>{E.pause(),E.currentTime=0,E.volume=.5,b(!0),console.log("[Sound] Audio unlocked - notifications will play")}).catch(()=>{})}},I=["click","touchstart","keydown"];return I.forEach(E=>{document.addEventListener(E,C,{once:!1,passive:!0})}),()=>{I.forEach(E=>{document.removeEventListener(E,C)})}},[u]);const w=o.useCallback(()=>{h.current&&u?(h.current.currentTime=0,h.current.play().catch(C=>{console.log("[Sound] Could not play notification sound:",C.message)})):u||console.log("[Sound] Audio not yet unlocked - click anywhere to enable notification sounds")},[u]),Y=o.useCallback((C,I)=>{const E={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,event:C,payload:I,timestamp:new Date,read:!1};c(k=>[E,...k].slice(0,50))},[]),X=o.useCallback(()=>{c([])},[]),J=o.useCallback((C,I)=>{let E="",k=e.jsx(Ni,{className:"h-5 w-5 text-blue-500"});switch(C){case ve.ORDER_CREATED:case ve.CUSTOMER_ORDER_PLACED:E=`New order received${I.orderCode?`: #${I.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case ve.TECHNICIAN_ASSIGNED:E=`Technician assigned to order${I.orderCode?` #${I.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case ve.ORDER_RESCHEDULED:E=`Order rescheduled${I.orderCode?`: #${I.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case ve.PAYMENT_RECEIVED:E=`Payment received${I.amount?`: ${I.amount}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case ve.TECHNICIAN_CHECKED_IN:E="Technician checked in",k=e.jsx("span",{className:"text-xl",children:""});break;case ve.CUSTOMER_APPROVAL_REQUIRED:E="Customer approval required",k=e.jsx("span",{className:"text-xl",children:""});break;case ve.CUSTOMER_APPROVAL_UPDATED:E="Customer approval updated",k=e.jsx("span",{className:"text-xl",children:""});break;case ve.JOB_UPDATED:E="Job card updated",k=e.jsx("span",{className:"text-xl",children:""});break;case ve.TECHNICIAN_UNASSIGNED:E="Technician unassigned from order",k=e.jsx("span",{className:"text-xl",children:""});break;case ve.ORDER_CANCELLATION_REQUESTED:E=`Cancellation requested${I.orderCode?`: #${I.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case ve.ORDER_CANCELLED:E=`Order cancelled${I.orderCode?`: #${I.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;default:E="New notification received"}N(E,{icon:k,duration:5e3,position:"top-right",style:{borderRadius:"12px",background:"#1e293b",color:"#fff",padding:"12px 16px"}}),kd&&window.electronAPI&&window.electronAPI.showNotification("Fixzep Admin",E)},[]);o.useEffect(()=>{const C=localStorage.getItem("fixzep_token"),I=localStorage.getItem("fixzep_user");if(!C||!I)return;let E={};try{E=JSON.parse(I)}catch{return}const k=sr(Ed,{transports:["websocket","polling"],autoConnect:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3});return p.current=E,k.on("connect",()=>{console.log("[Socket] Connected:",k.id),i(!0),E.role==="admin"?k.emit("admin:join",{userId:E.id}):E.role==="technician"?k.emit("technician:join",{userId:E.id}):k.emit("customer:join",{userId:E.id})}),k.on("disconnect",()=>{console.log("[Socket] Disconnected"),i(!1)}),k.on("connect_error",K=>{console.error("[Socket] Connection error:",K),i(!1)}),Object.values(ve).forEach(K=>{k.on(K,L=>{console.log(`[Socket] Received ${K}:`,L),Y(K,L),J(K,L),(K===ve.ORDER_CREATED||K===ve.CUSTOMER_ORDER_PLACED||K===ve.ORDER_CANCELLATION_REQUESTED||K===ve.ORDER_CANCELLED)&&w(),K===ve.ORDER_CREATED||K===ve.CUSTOMER_ORDER_PLACED?(f.invalidateQueries({queryKey:["orders"]}),f.invalidateQueries({queryKey:["dashboard"]})):K===ve.TECHNICIAN_ASSIGNED||K===ve.TECHNICIAN_UNASSIGNED?(f.invalidateQueries({queryKey:["orders"]}),f.invalidateQueries({queryKey:["technicians"]}),L!=null&&L.orderId&&f.invalidateQueries({queryKey:["order-jobcard",L.orderId]})):K===ve.JOB_UPDATED||K===ve.ORDER_CANCELLATION_REQUESTED||K===ve.ORDER_CANCELLED?(f.invalidateQueries({queryKey:["orders"]}),L!=null&&L.orderId&&f.invalidateQueries({queryKey:["order-jobcard",L.orderId]})):K===ve.ORDER_RESCHEDULED?(f.invalidateQueries({queryKey:["orders"]}),L!=null&&L.orderId&&f.invalidateQueries({queryKey:["order-jobcard",L.orderId]})):K===ve.PAYMENT_RECEIVED?(f.invalidateQueries({queryKey:["orders"]}),L!=null&&L.orderId&&f.invalidateQueries({queryKey:["order-jobcard",L.orderId]})):K===ve.ORDER_ACTIVITY&&L!=null&&L.orderId&&(f.invalidateQueries({queryKey:["orders"]}),f.invalidateQueries({queryKey:["order-jobcard",L.orderId]}))})}),r(k),()=>{k.disconnect(),r(null),i(!1),p.current=null}},[Y,J,w,f]);const M=o.useCallback(C=>{var I;s!=null&&s.connected&&C&&((I=p.current)!=null&&I.id)&&s.emit("order:join",{orderId:C,userId:p.current.id,role:"admin"})},[s]),G=o.useCallback(C=>{s!=null&&s.connected&&C&&s.emit("order:leave",{orderId:C})},[s]),B=l.filter(C=>!C.read).length;return e.jsx($i.Provider,{value:{socket:s,isConnected:a,notifications:l,clearNotifications:X,unreadCount:B,soundEnabled:u,joinOrder:M,leaveOrder:G},children:t})},qi=()=>{const t=o.useContext($i);if(!t)throw new Error("useSocket must be used within a SocketProvider");return t},Ad=()=>{const t=o.useMemo(()=>{var c;return typeof window<"u"&&((c=window.electronAPI)==null?void 0:c.isElectron)===!0},[]),s=o.useMemo(()=>t&&window.electronAPI?window.electronAPI.platform:"web",[t]),r=o.useCallback((c,u)=>{t&&window.electronAPI?window.electronAPI.showNotification(c,u):"Notification"in window&&Notification.permission==="granted"?new Notification(c,{body:u}):"Notification"in window&&Notification.permission!=="denied"&&Notification.requestPermission().then(b=>{b==="granted"&&new Notification(c,{body:u})})},[t]),a=o.useCallback(()=>{t&&window.electronAPI&&window.electronAPI.minimizeWindow()},[t]),i=o.useCallback(()=>{t&&window.electronAPI&&window.electronAPI.maximizeWindow()},[t]),l=o.useCallback(()=>{t&&window.electronAPI&&window.electronAPI.closeWindow()},[t]);return{isElectron:t,platform:s,showNotification:r,minimizeWindow:a,maximizeWindow:i,closeWindow:l}},Td=()=>{const{user:t,logout:s}=ta(),r=Ci(u=>u.toggle),{isConnected:a,unreadCount:i,soundEnabled:l}=qi(),{isElectron:c}=Ad();return e.jsxs("header",{className:"flex items-center justify-between border-b border-slate-200 bg-white/80 px-6 py-4 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:r,className:"lg:hidden rounded-full border border-slate-200 p-2 text-slate-600",children:e.jsx(qo,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Admin"}),e.jsxs("h2",{className:"text-lg font-semibold text-slate-900",children:["Welcome, ",t==null?void 0:t.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[c&&e.jsxs("div",{className:"flex items-center gap-1.5 rounded-full bg-slate-100 px-2 py-1",title:"Running as Desktop App",children:[e.jsx(Xo,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Desktop"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",title:a?"Connected - Real-time updates active":"Disconnected - Reconnecting...",children:[e.jsx(wc,{className:`h-4 w-4 ${a?"text-emerald-500":"text-slate-300"}`}),e.jsx("span",{className:`h-2 w-2 rounded-full ${a?"bg-emerald-500 animate-pulse":"bg-slate-300"}`})]}),e.jsx("div",{className:"flex items-center",title:l?"Sound notifications enabled":"Click anywhere to enable sound notifications",children:l?e.jsx(mc,{className:"h-4 w-4 text-emerald-500"}):e.jsx(pc,{className:"h-4 w-4 text-amber-500 animate-pulse"})}),e.jsxs("div",{className:"relative",children:[e.jsx(Ni,{className:"h-5 w-5 text-slate-500"}),i>0&&e.jsx("span",{className:"absolute -right-1 -top-1 flex h-4 w-4 items-center justify-center rounded-full bg-rose-500 text-[10px] font-bold text-white",children:i>9?"9+":i})]}),e.jsx("button",{onClick:s,className:"rounded-full border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-600 hover:border-slate-900 hover:text-slate-900",children:"Logout"})]})]})},Pd=()=>{const{isOpen:t,close:s}=Ci();return e.jsxs("div",{className:"flex min-h-screen bg-slate-50 text-slate-900",children:[e.jsx(Mn,{}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx(Td,{}),e.jsx("main",{className:"flex-1 px-4 py-6 sm:px-6 lg:px-10",children:e.jsx("div",{className:"mx-auto max-w-6xl",children:e.jsx(Pl,{})})})]}),e.jsx("div",{className:St("fixed inset-0 z-40 bg-slate-900/60 backdrop-blur-sm transition-opacity lg:hidden",t?"opacity-100 pointer-events-auto":"pointer-events-none opacity-0"),onClick:s,children:e.jsx("div",{className:St("absolute inset-y-0 left-0 w-72 transform bg-white shadow-xl transition-transform",t?"translate-x-0":"-translate-x-full"),children:e.jsx(Mn,{})})})]})};var Ts=t=>t.type==="checkbox",Ut=t=>t instanceof Date,Xe=t=>t==null;const Ui=t=>typeof t=="object";var Te=t=>!Xe(t)&&!Array.isArray(t)&&Ui(t)&&!Ut(t),Od=t=>Te(t)&&t.target?Ts(t.target)?t.target.checked:t.target.value:t,Rd=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,Id=(t,s)=>t.has(Rd(s)),Dd=t=>{const s=t.constructor&&t.constructor.prototype;return Te(s)&&s.hasOwnProperty("isPrototypeOf")},la=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Re(t){let s;const r=Array.isArray(t),a=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)s=new Date(t);else if(!(la&&(t instanceof Blob||a))&&(r||Te(t)))if(s=r?[]:Object.create(Object.getPrototypeOf(t)),!r&&!Dd(t))s=t;else for(const i in t)t.hasOwnProperty(i)&&(s[i]=Re(t[i]));else return t;return s}var mr=t=>/^\w*$/.test(t),Ce=t=>t===void 0,oa=t=>Array.isArray(t)?t.filter(Boolean):[],ca=t=>oa(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Q=(t,s,r)=>{if(!s||!Te(t))return r;const a=(mr(s)?[s]:ca(s)).reduce((i,l)=>Xe(i)?i:i[l],t);return Ce(a)||a===t?Ce(t[s])?r:t[s]:a},ct=t=>typeof t=="boolean",we=(t,s,r)=>{let a=-1;const i=mr(s)?[s]:ca(s),l=i.length,c=l-1;for(;++a<l;){const u=i[a];let b=r;if(a!==c){const f=t[u];b=Te(f)||Array.isArray(f)?f:isNaN(+i[a+1])?{}:[]}if(u==="__proto__"||u==="constructor"||u==="prototype")return;t[u]=b,t=t[u]}};const Vn={BLUR:"blur",FOCUS_OUT:"focusout"},at={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},jt={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Vi=Ne.createContext(null);Vi.displayName="HookFormContext";const Fd=()=>Ne.useContext(Vi);var Ld=(t,s,r,a=!0)=>{const i={defaultValues:s._defaultValues};for(const l in t)Object.defineProperty(i,l,{get:()=>{const c=l;return s._proxyFormState[c]!==at.all&&(s._proxyFormState[c]=!a||at.all),t[c]}});return i};const Wi=typeof window<"u"?Ne.useLayoutEffect:Ne.useEffect;var Ge=t=>typeof t=="string",Yr=(t,s,r,a,i)=>Ge(t)?(a&&s.watch.add(t),Q(r,t,i)):Array.isArray(t)?t.map(l=>(a&&s.watch.add(l),Q(r,l))):(a&&(s.watchAll=!0),r),Jr=t=>Xe(t)||!Ui(t);function nt(t,s,r=new WeakSet){if(Jr(t)||Jr(s))return Object.is(t,s);if(Ut(t)&&Ut(s))return t.getTime()===s.getTime();const a=Object.keys(t),i=Object.keys(s);if(a.length!==i.length)return!1;if(r.has(t)||r.has(s))return!0;r.add(t),r.add(s);for(const l of a){const c=t[l];if(!i.includes(l))return!1;if(l!=="ref"){const u=s[l];if(Ut(c)&&Ut(u)||Te(c)&&Te(u)||Array.isArray(c)&&Array.isArray(u)?!nt(c,u,r):!Object.is(c,u))return!1}}return!0}function Md(t){const s=Fd(),{control:r=s.control,name:a,defaultValue:i,disabled:l,exact:c,compute:u}=t||{},b=Ne.useRef(i),f=Ne.useRef(u),h=Ne.useRef(void 0),p=Ne.useRef(r),w=Ne.useRef(a);f.current=u;const[Y,X]=Ne.useState(()=>{const I=r._getWatch(a,b.current);return f.current?f.current(I):I}),J=Ne.useCallback(I=>{const E=Yr(a,r._names,I||r._formValues,!1,b.current);return f.current?f.current(E):E},[r._formValues,r._names,a]),M=Ne.useCallback(I=>{if(!l){const E=Yr(a,r._names,I||r._formValues,!1,b.current);if(f.current){const k=f.current(E);nt(k,h.current)||(X(k),h.current=k)}else X(E)}},[r._formValues,r._names,l,a]);Wi(()=>((p.current!==r||!nt(w.current,a))&&(p.current=r,w.current=a,M()),r._subscribe({name:a,formState:{values:!0},exact:c,callback:I=>{M(I.values)}})),[r,c,a,M]),Ne.useEffect(()=>r._removeUnmounted());const G=p.current!==r,B=w.current,C=Ne.useMemo(()=>{if(l)return null;const I=!G&&!nt(B,a);return G||I?J():null},[l,G,a,B,J]);return C!==null?C:Y}var Bd=(t,s,r,a,i)=>s?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[a]:i||!0}}:{},Es=t=>Array.isArray(t)?t:[t],Wn=()=>{let t=[];return{get observers(){return t},next:i=>{for(const l of t)l.next&&l.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(l=>l!==i)}}),unsubscribe:()=>{t=[]}}};function Hi(t,s){const r={};for(const a in t)if(t.hasOwnProperty(a)){const i=t[a],l=s[a];if(i&&Te(i)&&l){const c=Hi(i,l);Te(c)&&(r[a]=c)}else t[a]&&(r[a]=l)}return r}var He=t=>Te(t)&&!Object.keys(t).length,da=t=>t.type==="file",it=t=>typeof t=="function",nr=t=>{if(!la)return!1;const s=t?t.ownerDocument:0;return t instanceof(s&&s.defaultView?s.defaultView.HTMLElement:HTMLElement)},Ki=t=>t.type==="select-multiple",ua=t=>t.type==="radio",$d=t=>ua(t)||Ts(t),Mr=t=>nr(t)&&t.isConnected;function qd(t,s){const r=s.slice(0,-1).length;let a=0;for(;a<r;)t=Ce(t)?a++:t[s[a++]];return t}function Ud(t){for(const s in t)if(t.hasOwnProperty(s)&&!Ce(t[s]))return!1;return!0}function _e(t,s){const r=Array.isArray(s)?s:mr(s)?[s]:ca(s),a=r.length===1?t:qd(t,r),i=r.length-1,l=r[i];return a&&delete a[l],i!==0&&(Te(a)&&He(a)||Array.isArray(a)&&Ud(a))&&_e(t,r.slice(0,-1)),t}var Vd=t=>{for(const s in t)if(it(t[s]))return!0;return!1};function Qi(t){return Array.isArray(t)||Te(t)&&!Vd(t)}function Xr(t,s={}){for(const r in t){const a=t[r];Qi(a)?(s[r]=Array.isArray(a)?[]:{},Xr(a,s[r])):Ce(a)||(s[r]=!0)}return s}function Jt(t,s,r){r||(r=Xr(s));for(const a in t){const i=t[a];if(Qi(i))Ce(s)||Jr(r[a])?r[a]=Xr(i,Array.isArray(i)?[]:{}):Jt(i,Xe(s)?{}:s[a],r[a]);else{const l=s[a];r[a]=!nt(i,l)}}return r}const Hn={value:!1,isValid:!1},Kn={value:!0,isValid:!0};var zi=t=>{if(Array.isArray(t)){if(t.length>1){const s=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:s,isValid:!!s.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Ce(t[0].attributes.value)?Ce(t[0].value)||t[0].value===""?Kn:{value:t[0].value,isValid:!0}:Kn:Hn}return Hn},Zi=(t,{valueAsNumber:s,valueAsDate:r,setValueAs:a})=>Ce(t)?t:s?t===""?NaN:t&&+t:r&&Ge(t)?new Date(t):a?a(t):t;const Qn={isValid:!1,value:null};var Yi=t=>Array.isArray(t)?t.reduce((s,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:s,Qn):Qn;function zn(t){const s=t.ref;return da(s)?s.files:ua(s)?Yi(t.refs).value:Ki(s)?[...s.selectedOptions].map(({value:r})=>r):Ts(s)?zi(t.refs).value:Zi(Ce(s.value)?t.ref.value:s.value,t)}var Wd=(t,s,r,a)=>{const i={};for(const l of t){const c=Q(s,l);c&&we(i,l,c._f)}return{criteriaMode:r,names:[...t],fields:i,shouldUseNativeValidation:a}},ir=t=>t instanceof RegExp,vs=t=>Ce(t)?t:ir(t)?t.source:Te(t)?ir(t.value)?t.value.source:t.value:t,Zn=t=>({isOnSubmit:!t||t===at.onSubmit,isOnBlur:t===at.onBlur,isOnChange:t===at.onChange,isOnAll:t===at.all,isOnTouch:t===at.onTouched});const Yn="AsyncFunction";var Hd=t=>!!t&&!!t.validate&&!!(it(t.validate)&&t.validate.constructor.name===Yn||Te(t.validate)&&Object.values(t.validate).find(s=>s.constructor.name===Yn)),Kd=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),Jn=(t,s,r)=>!r&&(s.watchAll||s.watch.has(t)||[...s.watch].some(a=>t.startsWith(a)&&/^\.\w+/.test(t.slice(a.length))));const _s=(t,s,r,a)=>{for(const i of r||Object.keys(t)){const l=Q(t,i);if(l){const{_f:c,...u}=l;if(c){if(c.refs&&c.refs[0]&&s(c.refs[0],i)&&!a)return!0;if(c.ref&&s(c.ref,c.name)&&!a)return!0;if(_s(u,s))break}else if(Te(u)&&_s(u,s))break}}};function Xn(t,s,r){const a=Q(t,r);if(a||mr(r))return{error:a,name:r};const i=r.split(".");for(;i.length;){const l=i.join("."),c=Q(s,l),u=Q(t,l);if(c&&!Array.isArray(c)&&r!==l)return{name:r};if(u&&u.type)return{name:l,error:u};if(u&&u.root&&u.root.type)return{name:`${l}.root`,error:u.root};i.pop()}return{name:r}}var Qd=(t,s,r,a)=>{r(t);const{name:i,...l}=t;return He(l)||Object.keys(l).length>=Object.keys(s).length||Object.keys(l).find(c=>s[c]===(!a||at.all))},zd=(t,s,r)=>!t||!s||t===s||Es(t).some(a=>a&&(r?a===s:a.startsWith(s)||s.startsWith(a))),Zd=(t,s,r,a,i)=>i.isOnAll?!1:!r&&i.isOnTouch?!(s||t):(r?a.isOnBlur:i.isOnBlur)?!t:(r?a.isOnChange:i.isOnChange)?t:!0,Yd=(t,s)=>!oa(Q(t,s)).length&&_e(t,s),Jd=(t,s,r)=>{const a=Es(Q(t,r));return we(a,"root",s[r]),we(t,r,a),t};function Gn(t,s,r="validate"){if(Ge(t)||Array.isArray(t)&&t.every(Ge)||ct(t)&&!t)return{type:r,message:Ge(t)?t:"",ref:s}}var Yt=t=>Te(t)&&!ir(t)?t:{value:t,message:""},ei=async(t,s,r,a,i,l)=>{const{ref:c,refs:u,required:b,maxLength:f,minLength:h,min:p,max:w,pattern:Y,validate:X,name:J,valueAsNumber:M,mount:G}=t._f,B=Q(r,J);if(!G||s.has(J))return{};const C=u?u[0]:c,I=$=>{i&&C.reportValidity&&(C.setCustomValidity(ct($)?"":$||""),C.reportValidity())},E={},k=ua(c),K=Ts(c),L=k||K,pe=(M||da(c))&&Ce(c.value)&&Ce(B)||nr(c)&&c.value===""||B===""||Array.isArray(B)&&!B.length,O=Bd.bind(null,J,a,E),z=($,re,V,be=jt.maxLength,ye=jt.minLength)=>{const Se=$?re:V;E[J]={type:$?be:ye,message:Se,ref:c,...O($?be:ye,Se)}};if(l?!Array.isArray(B)||!B.length:b&&(!L&&(pe||Xe(B))||ct(B)&&!B||K&&!zi(u).isValid||k&&!Yi(u).isValid)){const{value:$,message:re}=Ge(b)?{value:!!b,message:b}:Yt(b);if($&&(E[J]={type:jt.required,message:re,ref:C,...O(jt.required,re)},!a))return I(re),E}if(!pe&&(!Xe(p)||!Xe(w))){let $,re;const V=Yt(w),be=Yt(p);if(!Xe(B)&&!isNaN(B)){const ye=c.valueAsNumber||B&&+B;Xe(V.value)||($=ye>V.value),Xe(be.value)||(re=ye<be.value)}else{const ye=c.valueAsDate||new Date(B),Se=Fe=>new Date(new Date().toDateString()+" "+Fe),De=c.type=="time",ke=c.type=="week";Ge(V.value)&&B&&($=De?Se(B)>Se(V.value):ke?B>V.value:ye>new Date(V.value)),Ge(be.value)&&B&&(re=De?Se(B)<Se(be.value):ke?B<be.value:ye<new Date(be.value))}if(($||re)&&(z(!!$,V.message,be.message,jt.max,jt.min),!a))return I(E[J].message),E}if((f||h)&&!pe&&(Ge(B)||l&&Array.isArray(B))){const $=Yt(f),re=Yt(h),V=!Xe($.value)&&B.length>+$.value,be=!Xe(re.value)&&B.length<+re.value;if((V||be)&&(z(V,$.message,re.message),!a))return I(E[J].message),E}if(Y&&!pe&&Ge(B)){const{value:$,message:re}=Yt(Y);if(ir($)&&!B.match($)&&(E[J]={type:jt.pattern,message:re,ref:c,...O(jt.pattern,re)},!a))return I(re),E}if(X){if(it(X)){const $=await X(B,r),re=Gn($,C);if(re&&(E[J]={...re,...O(jt.validate,re.message)},!a))return I(re.message),E}else if(Te(X)){let $={};for(const re in X){if(!He($)&&!a)break;const V=Gn(await X[re](B,r),C,re);V&&($={...V,...O(re,V.message)},I(V.message),a&&(E[J]=$))}if(!He($)&&(E[J]={ref:C,...$},!a))return E}}return I(!0),E};const Xd={mode:at.onSubmit,reValidateMode:at.onChange,shouldFocusError:!0};function Gd(t={}){let s={...Xd,...t},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:it(s.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1},a={},i=Te(s.defaultValues)||Te(s.values)?Re(s.defaultValues||s.values)||{}:{},l=s.shouldUnregister?{}:Re(i),c={action:!1,mount:!1,watch:!1},u={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},b,f=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let p={...h};const w={array:Wn(),state:Wn()},Y=s.criteriaMode===at.all,X=m=>g=>{clearTimeout(f),f=setTimeout(m,g)},J=async m=>{if(!s.disabled&&(h.isValid||p.isValid||m)){const g=s.resolver?He((await K()).errors):await pe(a,!0);g!==r.isValid&&w.state.next({isValid:g})}},M=(m,g)=>{!s.disabled&&(h.isValidating||h.validatingFields||p.isValidating||p.validatingFields)&&((m||Array.from(u.mount)).forEach(j=>{j&&(g?we(r.validatingFields,j,g):_e(r.validatingFields,j))}),w.state.next({validatingFields:r.validatingFields,isValidating:!He(r.validatingFields)}))},G=(m,g=[],j,D,P=!0,A=!0)=>{if(D&&j&&!s.disabled){if(c.action=!0,A&&Array.isArray(Q(a,m))){const q=j(Q(a,m),D.argA,D.argB);P&&we(a,m,q)}if(A&&Array.isArray(Q(r.errors,m))){const q=j(Q(r.errors,m),D.argA,D.argB);P&&we(r.errors,m,q),Yd(r.errors,m)}if((h.touchedFields||p.touchedFields)&&A&&Array.isArray(Q(r.touchedFields,m))){const q=j(Q(r.touchedFields,m),D.argA,D.argB);P&&we(r.touchedFields,m,q)}(h.dirtyFields||p.dirtyFields)&&(r.dirtyFields=Jt(i,l)),w.state.next({name:m,isDirty:z(m,g),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else we(l,m,g)},B=(m,g)=>{we(r.errors,m,g),w.state.next({errors:r.errors})},C=m=>{r.errors=m,w.state.next({errors:r.errors,isValid:!1})},I=(m,g,j,D)=>{const P=Q(a,m);if(P){const A=Q(l,m,Ce(j)?Q(i,m):j);Ce(A)||D&&D.defaultChecked||g?we(l,m,g?A:zn(P._f)):V(m,A),c.mount&&!c.action&&J()}},E=(m,g,j,D,P)=>{let A=!1,q=!1;const oe={name:m};if(!s.disabled){if(!j||D){(h.isDirty||p.isDirty)&&(q=r.isDirty,r.isDirty=oe.isDirty=z(),A=q!==oe.isDirty);const ce=nt(Q(i,m),g);q=!!Q(r.dirtyFields,m),ce?_e(r.dirtyFields,m):we(r.dirtyFields,m,!0),oe.dirtyFields=r.dirtyFields,A=A||(h.dirtyFields||p.dirtyFields)&&q!==!ce}if(j){const ce=Q(r.touchedFields,m);ce||(we(r.touchedFields,m,j),oe.touchedFields=r.touchedFields,A=A||(h.touchedFields||p.touchedFields)&&ce!==j)}A&&P&&w.state.next(oe)}return A?oe:{}},k=(m,g,j,D)=>{const P=Q(r.errors,m),A=(h.isValid||p.isValid)&&ct(g)&&r.isValid!==g;if(s.delayError&&j?(b=X(()=>B(m,j)),b(s.delayError)):(clearTimeout(f),b=null,j?we(r.errors,m,j):_e(r.errors,m)),(j?!nt(P,j):P)||!He(D)||A){const q={...D,...A&&ct(g)?{isValid:g}:{},errors:r.errors,name:m};r={...r,...q},w.state.next(q)}},K=async m=>{M(m,!0);const g=await s.resolver(l,s.context,Wd(m||u.mount,a,s.criteriaMode,s.shouldUseNativeValidation));return M(m),g},L=async m=>{const{errors:g}=await K(m);if(m)for(const j of m){const D=Q(g,j);D?we(r.errors,j,D):_e(r.errors,j)}else r.errors=g;return g},pe=async(m,g,j={valid:!0})=>{for(const D in m){const P=m[D];if(P){const{_f:A,...q}=P;if(A){const oe=u.array.has(A.name),ce=P._f&&Hd(P._f);ce&&h.validatingFields&&M([A.name],!0);const Le=await ei(P,u.disabled,l,Y,s.shouldUseNativeValidation&&!g,oe);if(ce&&h.validatingFields&&M([A.name]),Le[A.name]&&(j.valid=!1,g))break;!g&&(Q(Le,A.name)?oe?Jd(r.errors,Le,A.name):we(r.errors,A.name,Le[A.name]):_e(r.errors,A.name))}!He(q)&&await pe(q,g,j)}}return j.valid},O=()=>{for(const m of u.unMount){const g=Q(a,m);g&&(g._f.refs?g._f.refs.every(j=>!Mr(j)):!Mr(g._f.ref))&&se(m)}u.unMount=new Set},z=(m,g)=>!s.disabled&&(m&&g&&we(l,m,g),!nt(Fe(),i)),$=(m,g,j)=>Yr(m,u,{...c.mount?l:Ce(g)?i:Ge(m)?{[m]:g}:g},j,g),re=m=>oa(Q(c.mount?l:i,m,s.shouldUnregister?Q(i,m,[]):[])),V=(m,g,j={})=>{const D=Q(a,m);let P=g;if(D){const A=D._f;A&&(!A.disabled&&we(l,m,Zi(g,A)),P=nr(A.ref)&&Xe(g)?"":g,Ki(A.ref)?[...A.ref.options].forEach(q=>q.selected=P.includes(q.value)):A.refs?Ts(A.ref)?A.refs.forEach(q=>{(!q.defaultChecked||!q.disabled)&&(Array.isArray(P)?q.checked=!!P.find(oe=>oe===q.value):q.checked=P===q.value||!!P)}):A.refs.forEach(q=>q.checked=q.value===P):da(A.ref)?A.ref.value="":(A.ref.value=P,A.ref.type||w.state.next({name:m,values:Re(l)})))}(j.shouldDirty||j.shouldTouch)&&E(m,P,j.shouldTouch,j.shouldDirty,!0),j.shouldValidate&&ke(m)},be=(m,g,j)=>{for(const D in g){if(!g.hasOwnProperty(D))return;const P=g[D],A=m+"."+D,q=Q(a,A);(u.array.has(m)||Te(P)||q&&!q._f)&&!Ut(P)?be(A,P,j):V(A,P,j)}},ye=(m,g,j={})=>{const D=Q(a,m),P=u.array.has(m),A=Re(g);we(l,m,A),P?(w.array.next({name:m,values:Re(l)}),(h.isDirty||h.dirtyFields||p.isDirty||p.dirtyFields)&&j.shouldDirty&&w.state.next({name:m,dirtyFields:Jt(i,l),isDirty:z(m,A)})):D&&!D._f&&!Xe(A)?be(m,A,j):V(m,A,j),Jn(m,u)&&w.state.next({...r,name:m}),w.state.next({name:c.mount?m:void 0,values:Re(l)})},Se=async m=>{c.mount=!0;const g=m.target;let j=g.name,D=!0;const P=Q(a,j),A=ce=>{D=Number.isNaN(ce)||Ut(ce)&&isNaN(ce.getTime())||nt(ce,Q(l,j,ce))},q=Zn(s.mode),oe=Zn(s.reValidateMode);if(P){let ce,Le;const v=g.type?zn(P._f):Od(m),he=m.type===Vn.BLUR||m.type===Vn.FOCUS_OUT,ge=!Kd(P._f)&&!s.resolver&&!Q(r.errors,j)&&!P._f.deps||Zd(he,Q(r.touchedFields,j),r.isSubmitted,oe,q),Bt=Jn(j,u,he);we(l,j,v),he?(!g||!g.readOnly)&&(P._f.onBlur&&P._f.onBlur(m),b&&b(0)):P._f.onChange&&P._f.onChange(m);const Et=E(j,v,he),rs=!He(Et)||Bt;if(!he&&w.state.next({name:j,type:m.type,values:Re(l)}),ge)return(h.isValid||p.isValid)&&(s.mode==="onBlur"?he&&J():he||J()),rs&&w.state.next({name:j,...Bt?{}:Et});if(!he&&Bt&&w.state.next({...r}),s.resolver){const{errors:$t}=await K([j]);if(A(v),D){const Wt=Xn(r.errors,a,j),_t=Xn($t,a,Wt.name||j);ce=_t.error,j=_t.name,Le=He($t)}}else M([j],!0),ce=(await ei(P,u.disabled,l,Y,s.shouldUseNativeValidation))[j],M([j]),A(v),D&&(ce?Le=!1:(h.isValid||p.isValid)&&(Le=await pe(a,!0)));D&&(P._f.deps&&(!Array.isArray(P._f.deps)||P._f.deps.length>0)&&ke(P._f.deps),k(j,Le,ce,Et))}},De=(m,g)=>{if(Q(r.errors,g)&&m.focus)return m.focus(),1},ke=async(m,g={})=>{let j,D;const P=Es(m);if(s.resolver){const A=await L(Ce(m)?m:P);j=He(A),D=m?!P.some(q=>Q(A,q)):j}else m?(D=(await Promise.all(P.map(async A=>{const q=Q(a,A);return await pe(q&&q._f?{[A]:q}:q)}))).every(Boolean),!(!D&&!r.isValid)&&J()):D=j=await pe(a);return w.state.next({...!Ge(m)||(h.isValid||p.isValid)&&j!==r.isValid?{}:{name:m},...s.resolver||!m?{isValid:j}:{},errors:r.errors}),g.shouldFocus&&!D&&_s(a,De,m?P:u.mount),D},Fe=(m,g)=>{let j={...c.mount?l:i};return g&&(j=Hi(g.dirtyFields?r.dirtyFields:r.touchedFields,j)),Ce(m)?j:Ge(m)?Q(j,m):m.map(D=>Q(j,D))},y=(m,g)=>({invalid:!!Q((g||r).errors,m),isDirty:!!Q((g||r).dirtyFields,m),error:Q((g||r).errors,m),isValidating:!!Q(r.validatingFields,m),isTouched:!!Q((g||r).touchedFields,m)}),ae=m=>{m&&Es(m).forEach(g=>_e(r.errors,g)),w.state.next({errors:m?r.errors:{}})},ue=(m,g,j)=>{const D=(Q(a,m,{_f:{}})._f||{}).ref,P=Q(r.errors,m)||{},{ref:A,message:q,type:oe,...ce}=P;we(r.errors,m,{...ce,...g,ref:D}),w.state.next({name:m,errors:r.errors,isValid:!1}),j&&j.shouldFocus&&D&&D.focus&&D.focus()},Qe=(m,g)=>it(m)?w.state.subscribe({next:j=>"values"in j&&m($(void 0,g),j)}):$(m,g,!0),_=m=>w.state.subscribe({next:g=>{zd(m.name,g.name,m.exact)&&Qd(g,m.formState||h,Lt,m.reRenderRoot)&&m.callback({values:{...l},...r,...g,defaultValues:i})}}).unsubscribe,ee=m=>(c.mount=!0,p={...p,...m.formState},_({...m,formState:p})),se=(m,g={})=>{for(const j of m?Es(m):u.mount)u.mount.delete(j),u.array.delete(j),g.keepValue||(_e(a,j),_e(l,j)),!g.keepError&&_e(r.errors,j),!g.keepDirty&&_e(r.dirtyFields,j),!g.keepTouched&&_e(r.touchedFields,j),!g.keepIsValidating&&_e(r.validatingFields,j),!s.shouldUnregister&&!g.keepDefaultValue&&_e(i,j);w.state.next({values:Re(l)}),w.state.next({...r,...g.keepDirty?{isDirty:z()}:{}}),!g.keepIsValid&&J()},xe=({disabled:m,name:g})=>{(ct(m)&&c.mount||m||u.disabled.has(g))&&(m?u.disabled.add(g):u.disabled.delete(g))},ze=(m,g={})=>{let j=Q(a,m);const D=ct(g.disabled)||ct(s.disabled);return we(a,m,{...j||{},_f:{...j&&j._f?j._f:{ref:{name:m}},name:m,mount:!0,...g}}),u.mount.add(m),j?xe({disabled:ct(g.disabled)?g.disabled:s.disabled,name:m}):I(m,!0,g.value),{...D?{disabled:g.disabled||s.disabled}:{},...s.progressive?{required:!!g.required,min:vs(g.min),max:vs(g.max),minLength:vs(g.minLength),maxLength:vs(g.maxLength),pattern:vs(g.pattern)}:{},name:m,onChange:Se,onBlur:Se,ref:P=>{if(P){ze(m,g),j=Q(a,m);const A=Ce(P.value)&&P.querySelectorAll&&P.querySelectorAll("input,select,textarea")[0]||P,q=$d(A),oe=j._f.refs||[];if(q?oe.find(ce=>ce===A):A===j._f.ref)return;we(a,m,{_f:{...j._f,...q?{refs:[...oe.filter(Mr),A,...Array.isArray(Q(i,m))?[{}]:[]],ref:{type:A.type,name:m}}:{ref:A}}}),I(m,!1,void 0,A)}else j=Q(a,m,{}),j._f&&(j._f.mount=!1),(s.shouldUnregister||g.shouldUnregister)&&!(Id(u.array,m)&&c.action)&&u.unMount.add(m)}}},Ze=()=>s.shouldFocusError&&_s(a,De,u.mount),tt=m=>{ct(m)&&(w.state.next({disabled:m}),_s(a,(g,j)=>{const D=Q(a,j);D&&(g.disabled=D._f.disabled||m,Array.isArray(D._f.refs)&&D._f.refs.forEach(P=>{P.disabled=D._f.disabled||m}))},0,!1))},st=(m,g)=>async j=>{let D;j&&(j.preventDefault&&j.preventDefault(),j.persist&&j.persist());let P=Re(l);if(w.state.next({isSubmitting:!0}),s.resolver){const{errors:A,values:q}=await K();r.errors=A,P=Re(q)}else await pe(a);if(u.disabled.size)for(const A of u.disabled)_e(P,A);if(_e(r.errors,"root"),He(r.errors)){w.state.next({errors:{}});try{await m(P,j)}catch(A){D=A}}else g&&await g({...r.errors},j),Ze(),setTimeout(Ze);if(w.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:He(r.errors)&&!D,submitCount:r.submitCount+1,errors:r.errors}),D)throw D},fe=(m,g={})=>{Q(a,m)&&(Ce(g.defaultValue)?ye(m,Re(Q(i,m))):(ye(m,g.defaultValue),we(i,m,Re(g.defaultValue))),g.keepTouched||_e(r.touchedFields,m),g.keepDirty||(_e(r.dirtyFields,m),r.isDirty=g.defaultValue?z(m,Re(Q(i,m))):z()),g.keepError||(_e(r.errors,m),h.isValid&&J()),w.state.next({...r}))},pt=(m,g={})=>{const j=m?Re(m):i,D=Re(j),P=He(m),A=P?i:D;if(g.keepDefaultValues||(i=j),!g.keepValues){if(g.keepDirtyValues){const q=new Set([...u.mount,...Object.keys(Jt(i,l))]);for(const oe of Array.from(q))Q(r.dirtyFields,oe)?we(A,oe,Q(l,oe)):ye(oe,Q(A,oe))}else{if(la&&Ce(m))for(const q of u.mount){const oe=Q(a,q);if(oe&&oe._f){const ce=Array.isArray(oe._f.refs)?oe._f.refs[0]:oe._f.ref;if(nr(ce)){const Le=ce.closest("form");if(Le){Le.reset();break}}}}if(g.keepFieldsRef)for(const q of u.mount)ye(q,Q(A,q));else a={}}l=s.shouldUnregister?g.keepDefaultValues?Re(i):{}:Re(A),w.array.next({values:{...A}}),w.state.next({values:{...A}})}u={mount:g.keepDirtyValues?u.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},c.mount=!h.isValid||!!g.keepIsValid||!!g.keepDirtyValues||!s.shouldUnregister&&!He(A),c.watch=!!s.shouldUnregister,w.state.next({submitCount:g.keepSubmitCount?r.submitCount:0,isDirty:P?!1:g.keepDirty?r.isDirty:!!(g.keepDefaultValues&&!nt(m,i)),isSubmitted:g.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:P?{}:g.keepDirtyValues?g.keepDefaultValues&&l?Jt(i,l):r.dirtyFields:g.keepDefaultValues&&m?Jt(i,m):g.keepDirty?r.dirtyFields:{},touchedFields:g.keepTouched?r.touchedFields:{},errors:g.keepErrors?r.errors:{},isSubmitSuccessful:g.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},lt=(m,g)=>pt(it(m)?m(l):m,g),xt=(m,g={})=>{const j=Q(a,m),D=j&&j._f;if(D){const P=D.refs?D.refs[0]:D.ref;P.focus&&(P.focus(),g.shouldSelect&&it(P.select)&&P.select())}},Lt=m=>{r={...r,...m}},kt={control:{register:ze,unregister:se,getFieldState:y,handleSubmit:st,setError:ue,_subscribe:_,_runSchema:K,_focusError:Ze,_getWatch:$,_getDirty:z,_setValid:J,_setFieldArray:G,_setDisabledField:xe,_setErrors:C,_getFieldArray:re,_reset:pt,_resetDefaultValues:()=>it(s.defaultValues)&&s.defaultValues().then(m=>{lt(m,s.resetOptions),w.state.next({isLoading:!1})}),_removeUnmounted:O,_disableForm:tt,_subjects:w,_proxyFormState:h,get _fields(){return a},get _formValues(){return l},get _state(){return c},set _state(m){c=m},get _defaultValues(){return i},get _names(){return u},set _names(m){u=m},get _formState(){return r},get _options(){return s},set _options(m){s={...s,...m}}},subscribe:ee,trigger:ke,register:ze,handleSubmit:st,watch:Qe,setValue:ye,getValues:Fe,reset:lt,resetField:fe,clearErrors:ae,unregister:se,setError:ue,setFocus:xt,getFieldState:y};return{...kt,formControl:kt}}function ht(t={}){const s=Ne.useRef(void 0),r=Ne.useRef(void 0),[a,i]=Ne.useState({isDirty:!1,isValidating:!1,isLoading:it(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:it(t.defaultValues)?void 0:t.defaultValues});if(!s.current)if(t.formControl)s.current={...t.formControl,formState:a},t.defaultValues&&!it(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:c,...u}=Gd(t);s.current={...u,formState:a}}const l=s.current.control;return l._options=t,Wi(()=>{const c=l._subscribe({formState:l._proxyFormState,callback:()=>i({...l._formState}),reRenderRoot:!0});return i(u=>({...u,isReady:!0})),l._formState.isReady=!0,c},[l]),Ne.useEffect(()=>l._disableForm(t.disabled),[l,t.disabled]),Ne.useEffect(()=>{t.mode&&(l._options.mode=t.mode),t.reValidateMode&&(l._options.reValidateMode=t.reValidateMode)},[l,t.mode,t.reValidateMode]),Ne.useEffect(()=>{t.errors&&(l._setErrors(t.errors),l._focusError())},[l,t.errors]),Ne.useEffect(()=>{t.shouldUnregister&&l._subjects.state.next({values:l._getWatch()})},[l,t.shouldUnregister]),Ne.useEffect(()=>{if(l._proxyFormState.isDirty){const c=l._getDirty();c!==a.isDirty&&l._subjects.state.next({isDirty:c})}},[l,a.isDirty]),Ne.useEffect(()=>{var c;t.values&&!nt(t.values,r.current)?(l._reset(t.values,{keepFieldsRef:!0,...l._options.resetOptions}),!((c=l._options.resetOptions)===null||c===void 0)&&c.keepIsValid||l._setValid(),r.current=t.values,i(u=>({...u}))):l._resetDefaultValues()},[l,t.values]),Ne.useEffect(()=>{l._state.mount||(l._setValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),s.current.formState=Ld(a,l),s.current}const W=({children:t,className:s,variant:r="primary",icon:a,loading:i,disabled:l,...c})=>{const u={primary:"bg-slate-900 text-white hover:bg-slate-800",secondary:"bg-white text-slate-900 border border-slate-200 hover:border-slate-900",ghost:"bg-transparent text-slate-600 hover:text-slate-900",danger:"bg-rose-600 text-white hover:bg-rose-700"};return e.jsxs("button",{className:St("inline-flex items-center justify-center gap-2 rounded-xl px-4 py-2 text-sm font-semibold transition-all focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-900 disabled:opacity-60",u[r],s),disabled:l||i,...c,children:[i&&e.jsx("span",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white/30 border-l-white","aria-hidden":!0}),a,t]})},U=o.forwardRef(({label:t,className:s,helpText:r,icon:a,...i},l)=>e.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:[t&&e.jsx("span",{className:"font-medium text-slate-900",children:t}),e.jsxs("div",{className:"relative",children:[a&&e.jsx("span",{className:"pointer-events-none absolute inset-y-0 left-3 flex items-center text-slate-400",children:a}),e.jsx("input",{ref:l,className:St("w-full rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-slate-900 placeholder:text-slate-400 focus:border-slate-900 focus:outline-none",a&&"pl-10",s),...i})]}),r&&e.jsx("span",{className:"text-xs text-slate-400",children:r})]}));U.displayName="Input";const eu={email:"",password:"",role:"admin"},tu=()=>{const{register:t,handleSubmit:s,formState:{isSubmitting:r}}=ht({defaultValues:eu}),{login:a,isAuthenticated:i}=ta(),l=lr(),c=async u=>{await a(u),l("/",{replace:!0})};return o.useEffect(()=>{i&&l("/",{replace:!0})},[i,l]),i?null:e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 px-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-3xl border border-white/5 bg-white/10 p-8 backdrop-blur",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-white/70",children:"Fixzep"}),e.jsx("h1",{className:"mt-4 text-3xl font-bold text-white",children:"Admin Control Login"}),e.jsx("p",{className:"mt-2 text-sm text-white/70",children:"Use your admin credentials to access mission control."}),e.jsxs("form",{onSubmit:s(c),className:"mt-8 space-y-5",children:[e.jsx(U,{type:"email",label:"Email",placeholder:"admin@fixzep.com",...t("email",{required:!0}),className:"bg-white/90"}),e.jsx(U,{type:"password",label:"Password",placeholder:"",...t("password",{required:!0}),className:"bg-white/90"}),e.jsx(W,{type:"submit",loading:r,className:"w-full justify-center text-base",children:"Enter Dashboard"})]})]})})},Ke=({children:t,className:s,title:r,actions:a})=>e.jsxs("section",{className:St("rounded-2xl border border-white/60 bg-white/90 p-6 shadow-card backdrop-blur",s),children:[(r||a)&&e.jsxs("header",{className:"mb-4 flex items-center justify-between gap-4",children:[r&&e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:r}),a]}),t]}),qe=t=>new Intl.DateTimeFormat("en-IN",{dateStyle:"medium",timeStyle:"short"}).format(new Date(t)),Be=(t,s="INR")=>{const r=typeof t=="number"?t:0;return new Intl.NumberFormat("en-IN",{style:"currency",currency:s,maximumFractionDigits:2}).format(r)},su=new Set(["completed","cancelled"]),ru=()=>{var h;const{data:t=[],isLoading:s}=je({queryKey:["orders","dashboard"],queryFn:()=>Ee.list()}),{data:r=[],isLoading:a}=je({queryKey:["technicians","dashboard"],queryFn:()=>Xt.list()}),i=o.useMemo(()=>{const p=s?null:t.filter(X=>!su.has(X.status)),w=p?p.filter(X=>X.status==="pending_assignment"):null,Y=a?null:r.filter(X=>{var J;return((J=X.todayAttendance)==null?void 0:J.status)==="present"});return[{label:"Open Orders",value:(p==null?void 0:p.length.toString())??"",delta:w?`${w.length} awaiting assignment`:"fetching",accent:p?"text-slate-900":"text-slate-400",link:"/orders"},{label:"Pending Assignments",value:(w==null?void 0:w.length.toString())??"",delta:p&&w?`${p.length-w.length} already scheduled`:"fetching",accent:w?w.length?"text-amber-600":"text-emerald-600":"text-slate-400",link:"/orders?status=pending_assignment"},{label:"Technicians Active",value:(Y==null?void 0:Y.length.toString())??"",delta:Y?`${r.length} on roster`:"fetching",accent:Y?Y.length?"text-emerald-600":"text-rose-600":"text-slate-400",link:"/technicians"}]},[t,r,s,a]),l=o.useMemo(()=>t.filter(p=>p.status==="pending_assignment"&&new Date(p.timeWindowStart).getTime()<Date.now()).sort((p,w)=>new Date(p.timeWindowStart).getTime()-new Date(w.timeWindowStart).getTime()),[t]),c=o.useMemo(()=>t.filter(p=>p.status==="rescheduled"||p.status==="awaiting_customer_approval"),[t]),u=o.useMemo(()=>r.filter(p=>!p.todayAttendance||p.todayAttendance.status!=="present"),[r]),b=[...l.slice(0,3).map(p=>({id:p._id,text:`${Gr(p)} missed ${qe(p.timeWindowStart)} without technician assigned.`,link:`/orders?selected=${p._id}`})),...c.slice(0,2).map(p=>({id:`${p._id}-reschedule`,text:`${Gr(p)} awaiting reschedule confirmation.`,link:`/orders?selected=${p._id}`}))],f=[l[0]?{text:au(l[0],"Assign technician"),link:`/orders?selected=${l[0]._id}`}:null,u.length?{text:`Mark attendance for ${u[0].name} to include them in assignments.`,link:`/technicians?selected=${u[0].id}`}:null,c.length?{text:`Confirm reschedule for ${c[0].customer.name} (${(h=c[0].serviceItem)==null?void 0:h.name}).`,link:`/orders?selected=${c[0]._id}`}:null].filter(Boolean);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Mission Control"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Realtime Ops Snapshot"})]}),e.jsxs(Zt,{to:"/orders",className:"inline-flex items-center gap-2 rounded-2xl bg-slate-900 px-5 py-3 text-sm font-semibold text-white shadow-card",children:["Review Orders",e.jsx(Mo,{className:"h-4 w-4"})]})]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-3",children:i.map(p=>e.jsx(Zt,{to:p.link,className:"group",children:e.jsxs(Ke,{className:"transition-all duration-200 group-hover:shadow-lg group-hover:border-slate-200 group-hover:-translate-y-0.5",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:p.label}),e.jsx(Fo,{className:"h-4 w-4 text-slate-300 transition-colors group-hover:text-slate-500"})]}),e.jsx("p",{className:`mt-3 text-3xl font-semibold ${p.accent}`,children:p.value}),e.jsx("p",{className:"mt-1 text-xs uppercase tracking-[0.3em] text-slate-400",children:p.delta})]})},p.label))}),e.jsx(Ke,{title:"Operations Heatmap",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-600",children:"Critical Alerts"}),b.length>0&&e.jsx(Zt,{to:"/orders",className:"text-xs text-slate-400 hover:text-slate-600 transition-colors",children:"View all "})]}),e.jsxs("ul",{className:"mt-4 space-y-3 text-sm",children:[b.length===0&&e.jsx("li",{className:"text-slate-400",children:"All clear. No SLA breaches detected."}),b.map(p=>e.jsx("li",{children:e.jsxs(Zt,{to:p.link,className:"text-slate-500 hover:text-slate-800 transition-colors cursor-pointer",children:[" ",p.text]})},p.id))]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-600",children:"Next Best Actions"}),f.length>0&&e.jsx(Zt,{to:"/orders",className:"text-xs text-slate-400 hover:text-slate-600 transition-colors",children:"View all "})]}),e.jsxs("ol",{className:"mt-4 space-y-3 text-sm",children:[f.length===0&&e.jsx("li",{className:"text-slate-400",children:"You're fully caught up for now."}),f.map((p,w)=>e.jsx("li",{children:e.jsxs(Zt,{to:p.link,className:"text-slate-500 hover:text-slate-800 transition-colors cursor-pointer",children:[w+1,". ",p.text]})},p.text))]})]})]})})]})},au=(t,s="Update order")=>t?`${s} for ${Gr(t)} scheduled ${qe(t.timeWindowStart)}.`:null,Gr=t=>{var a,i;const s=((a=t.customer)==null?void 0:a.name)??"Customer",r=((i=t.serviceItem)==null?void 0:i.name)??"Service";return`${s} (${r})`},ti={new:"bg-slate-100 text-slate-700",pending_assignment:"bg-amber-100 text-amber-800",assigned:"bg-blue-100 text-blue-800",in_progress:"bg-indigo-100 text-indigo-800",completed:"bg-emerald-100 text-emerald-700",cancelled:"bg-rose-100 text-rose-700",follow_up:"bg-orange-100 text-orange-800",unpaid:"bg-rose-100 text-rose-700",partially_paid:"bg-amber-100 text-amber-800",pending:"bg-slate-100 text-slate-700",partial:"bg-amber-100 text-amber-800",paid:"bg-emerald-100 text-emerald-700"},ks=({variant:t="new",children:s})=>e.jsx("span",{className:St("rounded-full px-3 py-1 text-xs font-semibold capitalize",ti[t]||ti.new),children:s}),Je=o.forwardRef(({label:t,className:s,children:r,...a},i)=>e.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:[t&&e.jsx("span",{className:"font-medium text-slate-900",children:t}),e.jsx("select",{ref:i,className:St("w-full rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-slate-900 focus:border-slate-900 focus:outline-none",s),...a,children:r})]}));Je.displayName="Select";const It=o.forwardRef(({label:t,className:s,...r},a)=>e.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:[t&&e.jsx("span",{className:"font-medium text-slate-900",children:t}),e.jsx("textarea",{ref:a,className:St("w-full rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-slate-900 placeholder:text-slate-400 focus:border-slate-900 focus:outline-none",s),rows:r.rows||3,...r})]}));It.displayName="TextArea";const nu={md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",xxl:"max-w-8xl"},Ue=({open:t,onClose:s,title:r,children:a,size:i="md",showCloseButton:l=!1})=>e.jsx(Gt,{appear:!0,show:t,as:o.Fragment,children:e.jsxs(es,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(Gt.Child,{as:o.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/50"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsx(Gt.Child,{as:o.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-150",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(es.Panel,{className:`w-full ${nu[i]} transform rounded-2xl bg-white p-6 text-left align-middle shadow-xl`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx(es.Title,{as:"h3",className:"text-lg font-semibold text-slate-900",children:r}),l&&e.jsx("button",{type:"button",onClick:s,className:"rounded-full p-1 text-slate-500 transition hover:bg-slate-100 hover:text-slate-900","aria-label":"Close modal",children:""})]}),e.jsx("div",{className:"mt-4 space-y-4",children:a})]})})})})]})}),Ji=({open:t,onClose:s,title:r,children:a,widthClassName:i="w-screen max-w-lg"})=>e.jsx(Gt,{show:t,as:o.Fragment,appear:!0,children:e.jsxs(es,{as:"div",className:"relative z-[60]",onClose:()=>{},static:!0,children:[e.jsx(Gt.Child,{as:o.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 cursor-pointer",onClick:s,"aria-hidden":"true"})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"fixed inset-y-0 right-0 flex max-w-full pl-8",children:e.jsx(Gt.Child,{as:o.Fragment,enter:"transform transition ease-out duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in duration-200",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsx(es.Panel,{className:`pointer-events-auto ${i} bg-white shadow-2xl`,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-slate-100 px-6 py-4",children:[e.jsx("div",{children:e.jsx(es.Title,{className:"text-base font-semibold text-slate-900",children:r})}),e.jsxs("button",{type:"button",className:"rounded-full p-1 text-slate-400 transition hover:text-slate-600",onClick:s,children:[e.jsx("span",{className:"sr-only",children:"Close panel"}),e.jsx(Ss,{className:"h-5 w-5"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:a})]})})})})})})]})}),js=t=>t._id??`${t.dayOfWeek}-${t.startTime}-${t.endTime}-${t.label??""}`,iu=t=>{const[s,r,a]=t.split("-"),i=Number(s),l=Number(r),c=Number(a);if(!Number.isFinite(i)||!Number.isFinite(l)||!Number.isFinite(c))return null;const u=new Date(i,l-1,c);return Number.isNaN(u.getTime())?null:u.getDay()},lu=[{value:"",label:"All statuses"},{value:"pending_assignment",label:"Pending assignment"},{value:"assigned",label:"Assigned"},{value:"in_progress",label:"In progress"},{value:"completed",label:"Completed"},{value:"cancellation_requested",label:"Cancellation requested"},{value:"follow_up",label:"Follow up"},{value:"unpaid",label:"Unpaid"},{value:"partially_paid",label:"Partially paid"}],Xi=[{value:"follow_up",label:"Follow up"},{value:"in_progress",label:"In progress"},{value:"completed",label:"Completed"}],ou=Xi.map(t=>t.value),Gi=[{value:"pending",label:"Pending"},{value:"partial",label:"Partially paid"},{value:"paid",label:"Paid"}],cu=Gi.map(t=>t.value),Ys=t=>{if(!t)return"";const s=t.replace(/_/g," ");return s.charAt(0).toUpperCase()+s.slice(1)},du=t=>t?typeof t=="string"?t:t.name||"System":"System",uu=t=>t?[t.addressLine1,t.addressLine2,t.city,t.state,t.postalCode].filter(Boolean).join(", "):"",si=(t,s=7)=>{const r=[];for(let a=0;a<s;a++){const i=new Date(t);i.setDate(t.getDate()+a),r.push(i)}return r},ri=t=>t.toLocaleDateString("en-IN",{weekday:"short",day:"numeric",month:"short"}),mu=(t,s,r,a)=>{const[i,l]=s.split(":").map(Number),[c,u]=r.split(":").map(Number),b=new Date(t);b.setHours(i,l,0,0);const f=new Date(t);f.setHours(c,u,0,0);for(const h of a){const p=new Date(h.start),w=new Date(h.end);if(p<f&&w>b)return h}return null},ot=(t,s)=>{const[r,a]=s.split(":").map(Number),i=new Date(t);return i.setHours(r,a,0,0),i},hu=()=>{var Ia,Da,Fa,La,Ma,Ba,$a,qa,Ua,Va,Wa,Ha,Ka,Qa,za,Za,Ya,Ja,Xa,Ga,en,tn,sn,rn,an,nn,ln,on,cn,dn,un,mn,hn,pn,xn,fn,gn,bn,yn,vn,jn,wn,Nn,Sn,Cn,kn,En;const[t,s]=mi(),[r,a]=o.useState(()=>t.get("status")||""),[i,l]=o.useState(!1),[c,u]=o.useState({order:null,open:!1}),[b,f]=o.useState({order:null,open:!1}),[h,p]=o.useState({order:null,open:!1}),[w,Y]=o.useState(()=>t.get("selected")),[X,J]=o.useState({open:!1,url:"",name:""}),[M,G]=o.useState(100),[B,C]=o.useState(null),[I,E]=o.useState([]),[k,K]=o.useState(!1),[L,pe]=o.useState(""),[O,z]=o.useState(null),[$,re]=o.useState(""),[V,be]=o.useState(null),[ye,Se]=o.useState(""),[De,ke]=o.useState(""),[Fe,y]=o.useState(""),[ae,ue]=o.useState(""),[Qe,_]=o.useState(""),[ee,se]=o.useState(""),[xe,ze]=o.useState(""),[Ze,tt]=o.useState(""),[st,fe]=o.useState(""),[pt,lt]=o.useState(""),[xt,Lt]=o.useState(""),[Mt,kt]=o.useState("09:00"),[m,g]=o.useState("11:00"),[j,D]=o.useState(""),[P,A]=o.useState(!1),[q,oe]=o.useState({open:!1,technicianId:null,name:""}),[ce,Le]=o.useState(()=>{const n=new Date;return n.setHours(0,0,0,0),n}),[v,he]=o.useState([]),[ge,Bt]=o.useState(""),[Et,rs]=o.useState(""),[$t,Wt]=o.useState(""),[_t,as]=o.useState([]),[At,Ps]=o.useState([]),[hr,pr]=o.useState(""),[ma,ha]=o.useState(null),[xr,pa]=o.useState(!1),[Ht,xa]=o.useState(""),[Os,fa]=o.useState(""),[Rs,ga]=o.useState(!1),[Kt,ba]=o.useState(""),[ya,fr]=o.useState(!1),[ns,is]=o.useState(""),[ls,os]=o.useState(!1),[gr,cs]=o.useState(""),[va,ds]=o.useState(""),[br,us]=o.useState(""),[yr,ms]=o.useState(""),[ja,hs]=o.useState(""),[Is,wa]=o.useState("1"),Oe=Ct(),{joinOrder:Na,leaveOrder:Sa,isConnected:Ca}=qi(),ps=h.open&&((Ia=h.order)!=null&&Ia._id)?h.order._id:null;o.useEffect(()=>(ps&&Ca&&Na(ps),()=>{ps&&Sa(ps)}),[ps,Ca,Na,Sa]);const Ds=()=>{u({order:null,open:!1}),oe({open:!1,technicianId:null,name:""}),he([]),E([]),K(!1)},el=n=>{he([]),oe({open:!0,technicianId:n.id,name:n.name||"Technician"})},ka=n=>{c.order&&bt.mutate({orderId:c.order._id,technicianId:n})},tl=()=>{if(!c.order)return;const n=(()=>{var F;const x=c.order;return((F=x==null?void 0:x.assignedTechnicians)!=null&&F.length?x.assignedTechnicians:x!=null&&x.assignedTechnician?[x.assignedTechnician]:[]).map(R=>typeof R=="object"?R==null?void 0:R._id:R).filter(Boolean)})(),d=k?[...new Set([...n,...I])]:I;d.length!==0&&bt.mutate({orderId:c.order._id,technicianIds:d})},sl=n=>{E(d=>d.includes(n)?d.filter(x=>x!==n):[...d,n])},rl=n=>{E(d=>d.includes(n)?[n,...d.filter(x=>x!==n)]:d)},al=n=>{var de,me;n==null||n.stopPropagation();const d=(T==null?void 0:T.order)||h.order,x=(d==null?void 0:d._id)||(d==null?void 0:d.id)||((de=h.order)==null?void 0:de._id);if(!x||!h.order)return;const S=T==null?void 0:T.order,F=(me=S==null?void 0:S.assignedTechnicians)!=null&&me.length?S.assignedTechnicians:null,R={...h.order,_id:x,assignedTechnician:(S==null?void 0:S.assignedTechnician)||(F==null?void 0:F[0])||h.order.assignedTechnician,assignedTechnicians:F??(h.order.assignedTechnician?[h.order.assignedTechnician]:[])};K(!0),u({order:R,open:!0}),E([])},{data:xs=[],isLoading:Fs}=je({queryKey:["orders",r],queryFn:()=>Ee.list({status:r||void 0})});o.useEffect(()=>{if(w&&xs.length>0&&!Fs){const n=xs.find(x=>x._id===w);n&&p({order:n,open:!0}),Y(null);const d=new URLSearchParams(t);d.delete("selected"),s(d,{replace:!0})}},[xs,w,Fs,t,s]);const nl=n=>{a(n);const d=new URLSearchParams(t);n?d.set("status",n):d.delete("status"),d.delete("selected"),s(d,{replace:!0})},{data:il=[]}=je({queryKey:["categories"],queryFn:Ie.categories,enabled:i}),{data:ll=[]}=je({queryKey:["service-items",st],queryFn:()=>Ie.serviceItems(st||void 0),enabled:i&&!!st}),{data:vr=[]}=je({queryKey:["spare-parts"],queryFn:ws.list,enabled:h.open}),{data:jr=[]}=je({queryKey:["all-service-items"],queryFn:()=>Ie.serviceItems(),enabled:h.open}),{data:wr=[],isFetching:Ea}=je({queryKey:["order-technicians",(Da=c.order)==null?void 0:Da._id],queryFn:()=>Ee.candidates(c.order._id),enabled:c.open&&!!((Fa=c.order)!=null&&Fa._id)}),{data:Ls=[],isFetching:Ms}=je({queryKey:["technician-schedule",q.technicianId,ce.toISOString()],queryFn:()=>{const n=new Date(ce);return n.setDate(n.getDate()+7),Xt.schedule(q.technicianId,{start:ce.toISOString(),end:n.toISOString()})},enabled:q.open&&!!q.technicianId}),{data:ft=[],isFetching:Tt}=je({queryKey:["time-slots"],queryFn:()=>Ns.list(),enabled:b.open||q.open}),{data:T,isFetching:ol,error:cl}=je({queryKey:["order-jobcard",(La=h.order)==null?void 0:La._id],queryFn:()=>Ee.jobCard(h.order._id),enabled:h.open&&!!((Ma=h.order)!=null&&Ma._id)}),H=(T==null?void 0:T.jobCard)??null,Ve=((Ba=T==null?void 0:T.order)==null?void 0:Ba.followUp)||null,Nr=(H==null?void 0:H.sparePartsUsed)??[],Bs=Nr.reduce((n,d)=>{var F;const x=(d==null?void 0:d.quantity)??0,S=(d==null?void 0:d.unitPrice)??(typeof(d==null?void 0:d.part)=="object"?((F=d.part)==null?void 0:F.unitPrice)??0:0);return n+x*S},0),$s=((H==null?void 0:H.extraWork)??[]).reduce((n,d)=>n+((d==null?void 0:d.amount)??0),0),qs=($a=T==null?void 0:T.order)==null?void 0:$a.serviceItem,dl=typeof qs=="string"?0:(qs==null?void 0:qs.basePrice)??0,Us=(H==null?void 0:H.estimateAmount)??((qa=T==null?void 0:T.order)==null?void 0:qa.estimatedCost)??dl;o.useEffect(()=>{var d;const n=(d=T==null?void 0:T.order)==null?void 0:d.status;n&&ou.includes(n)?Bt(n):Bt("")},[(Ua=T==null?void 0:T.order)==null?void 0:Ua.status]),o.useEffect(()=>{H!=null&&H.paymentStatus&&cu.includes(H.paymentStatus)?rs(H.paymentStatus):rs("")},[H==null?void 0:H.paymentStatus]),o.useEffect(()=>{if(!h.open){Wt(""),as([]),Ps([]),pr("");return}Ve?(Wt(Ve.reason||""),as(Ve.attachments||[])):ge!=="follow_up"&&(Wt(""),as([]))},[h.open,Ve==null?void 0:Ve.reason,(Va=Ve==null?void 0:Ve.attachments)==null?void 0:Va.length,ge]);const Vs=o.useMemo(()=>{var S;if(!T)return[];const n=[],{order:d}=T;((d==null?void 0:d.history)||[]).forEach((F,R)=>{if(!F)return;let de="bg-blue-100",me=Ys(F.action)||"Update";switch(F.action){case"technician_checked_in":de="bg-emerald-500",me="Technician Checked In";break;case"technician_checked_out":de="bg-rose-500",me="Technician Checked Out";break;case"technician_progress_update":de="bg-amber-500",me="Progress Update";break;case"technician_follow_up":de="bg-orange-500",me="Follow Up Required";break;case"technician_assigned":de="bg-indigo-500",me="Technician Assigned";break;case"order_rescheduled":de="bg-purple-500",me="Order Rescheduled";break;case"order_created":de="bg-slate-900",me="Order Created";break;default:de="bg-blue-100"}n.push({id:`history-${R}`,title:me,description:[F.message,F.performedBy?`By ${du(F.performedBy)}`:null].filter(Boolean).join("  "),timestamp:F.performedAt,accent:de})}),(S=d==null?void 0:d.followUp)!=null&&S.reason&&(n.push({id:"follow-up-start",title:"Follow Up Requested",description:d.followUp.reason,timestamp:d.followUp.createdAt,accent:"bg-orange-500",attachments:d.followUp.attachments||[]}),d.followUp.resolvedAt&&n.push({id:"follow-up-resolved",title:"Follow Up Resolved",description:"Case moved out of follow up",timestamp:d.followUp.resolvedAt,accent:"bg-emerald-500"}));const x=F=>{if(!F)return Number.MAX_SAFE_INTEGER;const R=new Date(F).getTime();return Number.isNaN(R)?Number.MAX_SAFE_INTEGER:R};return n.sort((F,R)=>x(F.timestamp)-x(R.timestamp))},[T]),Sr=((Wa=T==null?void 0:T.order)==null?void 0:Wa.media)??[],ul=Sr.length>0||At.length>0,gt=o.useMemo(()=>{if(!L)return[];const n=iu(L);return n===null?[]:ft.filter(d=>d.dayOfWeek===n)},[L,ft]),Pt=O&&gt.find(n=>js(n)===O)||null,qt=b.order,Ws=(Ha=qt==null?void 0:qt.preferredSlot)==null?void 0:Ha.label,fs=ge==="follow_up",ne=((Ka=T==null?void 0:T.order)==null?void 0:Ka.status)==="completed",ml=n=>{if(ne){N.error("Completed job cards are view-only"),n.target.value="";return}const d=Array.from(n.target.files??[]);d.length&&(d.forEach(x=>{const S=new FileReader;S.onload=()=>{const F=S.result;typeof F=="string"&&as(R=>[...R,{url:F,kind:x.type.startsWith("video")?"video":"image",name:x.name}])},S.readAsDataURL(x)}),n.target.value="")},hl=n=>{if(ne){N.error("Completed job cards are view-only"),n.target.value="";return}const d=Array.from(n.target.files??[]);d.length&&(d.forEach(x=>{const S=new FileReader;S.onload=()=>{const F=S.result;typeof F=="string"&&Ps(R=>[...R,{url:F,kind:x.type.startsWith("video")?"video":x.type.startsWith("image")?"image":"document",name:x.name}])},S.readAsDataURL(x)}),n.target.value="")},pl=n=>{if(ne){N.error("Completed job cards are view-only");return}Ps(d=>d.filter((x,S)=>S!==n))},xl=n=>{var d;if(ne){N.error("Completed job cards are view-only");return}if(!n){N.error("Unable to delete this file");return}if(!((d=h.order)!=null&&d._id)){N.error("Open an order before deleting documents");return}ha(n),kr.mutate({orderId:h.order._id,mediaId:n})},fl=()=>{var n;if(ne){N.error("Completed job cards are view-only");return}if(!((n=h.order)!=null&&n._id)){N.error("Open an order before uploading documents");return}if(!At.length){N.error("Select at least one file to upload");return}Cr.mutate({orderId:h.order._id,media:At})},gl=n=>{if(ne){N.error("Completed job cards are view-only");return}as(d=>d.filter((x,S)=>S!==n))},bl=()=>{var n;if(ne){N.error("Completed job cards are view-only");return}if(!(!((n=h.order)!=null&&n._id)||!ge)){if(fs){if(!$t.trim()){N.error("Provide a follow-up reason");return}if(!_t.length){N.error("Attach at least one image or video");return}}if(ge==="completed"&&(H==null?void 0:H.paymentStatus)!=="paid"){N.error("Set payment status to Paid before marking the job as completed");return}bs.mutate({orderId:h.order._id,status:ge,reason:fs?$t:void 0,attachments:fs?_t:void 0})}},yl=()=>{var n;if(ne){N.error("Completed job cards are view-only");return}if(!(!((n=h.order)!=null&&n._id)||!Et)){if(!H){N.error("Generate a job card before updating payment status");return}Er.mutate({orderId:h.order._id,status:Et})}},vl=()=>{var x;if(ne){N.error("Completed job cards are view-only");return}if(!((x=h.order)!=null&&x._id)){N.error("Open an order before adding spare parts");return}if(!Ht||!Os){N.error("Please select a spare part and enter quantity");return}const n=parseFloat(Os);if(isNaN(n)||n<=0){N.error("Quantity must be a positive number");return}const d=vr.find(S=>S._id===Ht);if(!d){N.error("Selected spare part not found");return}Aa.mutate({orderId:h.order._id,sparePart:{sparePartId:Ht,quantity:n,unitPrice:d.unitPrice}})},jl=()=>{var S;if(ne){N.error("Completed job cards are view-only");return}if(!((S=h.order)!=null&&S._id)){N.error("Open an order before adding services");return}if(!Kt||!Is){N.error("Please select a service and enter quantity");return}const n=parseFloat(Is);if(isNaN(n)||n<=0){N.error("Quantity must be a positive number");return}const d=jr.find(F=>F._id===Kt);if(!d){N.error("Selected service not found");return}const x=(d.basePrice||0)*n;Ta.mutate({orderId:h.order._id,service:{description:`${d.name} (x${n})`,amount:x,serviceItemId:Kt}})};o.useEffect(()=>{if(b.open&&b.order){const n=b.order.timeWindowStart?new Date(b.order.timeWindowStart).toISOString().split("T")[0]:"";pe(n)}else pe(""),z(null)},[b.open,b.order]),o.useEffect(()=>{var x,S;if(!b.open)return;if(!L){O!==null&&z(null);return}if(!gt.length){O!==null&&z(null);return}if(O&&gt.some(F=>js(F)===O))return;const n=(S=(x=b.order)==null?void 0:x.preferredSlot)==null?void 0:S.label;if(n){const F=gt.find(R=>R.label===n);if(F){const R=js(F);R!==O&&z(R);return}}const d=js(gt[0]);d!==O&&z(d)},[b.open,L,gt,O,b.order]);const bt=le({mutationFn:({orderId:n,technicianId:d,technicianIds:x,slots:S})=>Ee.assign(n,{...x!=null&&x.length?{technicianIds:x}:{technicianId:d},...S!=null&&S.length?{slots:S}:{}}),onMutate:({technicianId:n})=>C(n||null),onSuccess:(n,d)=>{var S;let x="Technician assigned";(((S=d.technicianIds)==null?void 0:S.length)||0)>1&&(x="Technicians assigned"),N.success(x),Oe.invalidateQueries({queryKey:["orders"]}),Oe.invalidateQueries({queryKey:["order-jobcard",d.orderId]}),Oe.invalidateQueries({queryKey:["technician-schedule"]}),Ds(),E([]),K(!1)},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Assignment failed")},onSettled:()=>C(null)}),gs=le({mutationFn:async({orderId:n,technicianId:d,newStart:x,newEnd:S})=>(await Ee.reschedule(n,{newStart:x,newEnd:S}),Ee.assign(n,{technicianId:d})),onSuccess:()=>{N.success("Order rescheduled and technician assigned!"),Oe.invalidateQueries({queryKey:["orders"]}),Oe.invalidateQueries({queryKey:["technician-schedule"]}),Ds()},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Failed to assign with new slot")}}),_a=le({mutationFn:({orderId:n,newStart:d,newEnd:x})=>Ee.reschedule(n,{newStart:d,newEnd:x}),onSuccess:()=>{N.success("Order rescheduled"),Oe.invalidateQueries({queryKey:["orders"]}),f({order:null,open:!1})},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Reschedule failed")}}),bs=le({mutationFn:({orderId:n,status:d,reason:x,attachments:S})=>Ee.changeStatus(n,{status:d,reason:x,attachments:S}),onSuccess:()=>{var n;N.success("Status updated"),(n=h.order)!=null&&n._id&&Oe.invalidateQueries({queryKey:["order-jobcard",h.order._id]}),Oe.invalidateQueries({queryKey:["orders"]})},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Unable to update status")}}),Cr=le({mutationFn:({orderId:n,media:d})=>Ee.uploadMedia(n,{media:d}),onSuccess:()=>{var n;N.success("Documents uploaded"),Ps([]),(n=h.order)!=null&&n._id&&Oe.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Unable to upload documents")}}),kr=le({mutationFn:({orderId:n,mediaId:d})=>Ee.deleteMedia(n,d),onSuccess:()=>{var n;N.success("Document removed"),(n=h.order)!=null&&n._id&&Oe.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Unable to delete document")},onSettled:()=>ha(null)}),Er=le({mutationFn:({orderId:n,status:d})=>Ee.updatePaymentStatus(n,{status:d}),onSuccess:()=>{var n;N.success("Payment status updated"),(n=h.order)!=null&&n._id&&Oe.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Unable to update payment status")}}),_r=le({mutationFn:({orderId:n,message:d})=>Ee.addHistoryNote(n,{message:d}),onSuccess:(n,d)=>{N.success("Activity note added"),pr(""),Oe.setQueryData(["order-jobcard",d.orderId],n)},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Unable to record note")}}),Aa=le({mutationFn:({orderId:n,sparePart:d})=>Ee.addSparePart(n,d),onSuccess:(n,d)=>{N.success("Spare part added"),xa(""),fa(""),pa(!1),Oe.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Unable to add spare part")}}),Ta=le({mutationFn:({orderId:n,service:d})=>Ee.addAdditionalService(n,d),onSuccess:(n,d)=>{N.success("Additional service added"),ba(""),wa("1"),ga(!1),Oe.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Unable to add service")}}),Pa=le({mutationFn:({orderId:n,index:d})=>Ee.removeSparePart(n,d),onSuccess:(n,d)=>{N.success("Spare part removed"),Oe.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Unable to remove spare part")}}),Oa=le({mutationFn:({orderId:n,index:d})=>Ee.removeAdditionalService(n,d),onSuccess:(n,d)=>{N.success("Additional service removed"),Oe.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Unable to remove service")}}),Hs=le({mutationFn:({customerId:n,addressId:d,address:x})=>wt.updateAddress(n,{...x,addressId:d}),onSuccess:(n,d)=>{var x;N.success(d.addressId?"Order address updated":"New address added successfully"),fr(!1),os(!1),is(""),(x=h.order)!=null&&x._id&&Oe.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Unable to update address")}}),wl=le({mutationFn:n=>wt.findByPhone(n),onSuccess:n=>{var d,x;if(n){be(n),ke(n.name||""),y(n.email||"");const S=((d=n.addresses)==null?void 0:d.find(F=>F.isDefault))||((x=n.addresses)==null?void 0:x[0]);S?(Se(S.id),ue(S.line1||""),_(S.line2||""),se(S.city||""),ze(S.state||""),tt(S.postalCode||"")):(ue(n.addressLine1||""),_(n.addressLine2||""),se(n.city||""),ze(""),tt(n.postalCode||"")),N.success("Customer found!")}else be(null),Se(""),ke(""),y(""),ue(""),_(""),se(""),ze(""),tt(""),N("Customer not found. Please enter details to create new customer.",{icon:""});A(!1)},onError:()=>{N.error("Failed to check customer"),A(!1)}}),Ra=le({mutationFn:async n=>{if(!V){const d=await wt.create({name:De,phone:$,email:Fe,address:{line1:ae,line2:Qe,city:ee,state:xe,postalCode:Ze}});return Ee.create({...n,customerId:d.id})}return Ee.create(n)},onSuccess:()=>{N.success("Order created successfully!"),l(!1),Ar(),Oe.invalidateQueries({queryKey:["orders"]})},onError:n=>{var d,x;return N.error(((x=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:x.message)||"Failed to create order")}}),Ar=()=>{re(""),be(null),Se(""),ke(""),y(""),ue(""),_(""),se(""),ze(""),tt(""),fe(""),lt(""),Lt(""),kt("09:00"),g("11:00"),D("")},Nl=n=>{var x;Se(n);const d=(x=V==null?void 0:V.addresses)==null?void 0:x.find(S=>S.id===n);d&&(ue(d.line1||""),_(d.line2||""),se(d.city||""),ze(d.state||""),tt(d.postalCode||""))},Sl=()=>{if(!$.trim()){N.error("Please enter phone number");return}A(!0),wl.mutate($)},Cl=()=>{if(!$||!De||!pt||!xt){N.error("Please fill all required fields");return}const n=ye,d=ae&&ee&&xe;if(!n&&!d){N.error("Please select an address or fill in address details");return}const x=new Date(`${xt}T${Mt}`),S=new Date(`${xt}T${m}`),F={customerId:V==null?void 0:V.id,serviceItem:pt,scheduledAt:x.toISOString(),timeWindowStart:x.toISOString(),timeWindowEnd:S.toISOString(),issueDescription:j,slotLabel:`${Mt} - ${m}`};ye?F.addressId=ye:d&&(F.address={line1:ae,line2:Qe,city:ee,state:xe,postalCode:Ze}),Ra.mutate(F)},kl=!((Qa=h.order)!=null&&Qa._id)||!ge||bs.isPending||fs&&(!$t.trim()||_t.length===0)||ge==="completed"&&(H==null?void 0:H.paymentStatus)!=="paid"||ne,El=!((za=h.order)!=null&&za._id)||!H||!Et||Er.isPending||ne,_l=!((Za=h.order)!=null&&Za._id)||!hr.trim()||_r.isPending||ne;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Live Orders"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Admin Assignment Console"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(W,{onClick:()=>l(!0),children:"+ Create Order"}),e.jsx(Je,{value:r,onChange:n=>nl(n.target.value),children:lu.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))})]})]}),e.jsx(Ke,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs uppercase tracking-wide text-slate-500",children:[e.jsx("th",{className:"px-4 py-3",children:"Customer"}),e.jsx("th",{className:"px-4 py-3",children:"Service"}),e.jsx("th",{className:"px-4 py-3",children:"Schedule"}),e.jsx("th",{className:"px-4 py-3",children:"Technician"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3",children:"Payment"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[Fs&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-slate-400",children:"Loading orders"})}),!Fs&&xs.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-slate-400",children:"No orders found for this filter."})}),xs.map(n=>{var d,x;return e.jsxs("tr",{className:"text-sm cursor-pointer transition-colors hover:bg-slate-50",onClick:()=>p({order:n,open:!0}),children:[e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("p",{className:"font-semibold text-slate-900",children:n.customer.name}),e.jsx("p",{className:"text-xs text-slate-500",children:n.customer.city})]}),e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("p",{className:"font-medium text-slate-900",children:(d=n.serviceItem)==null?void 0:d.name}),e.jsx("p",{className:"text-xs text-slate-500",children:(x=n.serviceCategory)==null?void 0:x.name})]}),e.jsxs("td",{className:"px-4 py-4 text-sm text-slate-600",children:[qe(n.timeWindowStart),e.jsxs("span",{className:"block text-xs text-slate-400",children:[" ",qe(n.timeWindowEnd)]})]}),e.jsx("td",{className:"px-4 py-4",children:n.assignedTechnician?e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-emerald-600",children:n.assignedTechnician.name}),e.jsx("p",{className:"text-xs text-slate-500",children:"Assigned technician"})]}):e.jsx("p",{className:"text-xs text-slate-400",children:"Not assigned"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx(ks,{variant:n.status,children:n.status.replace(/_/g," ")})}),e.jsx("td",{className:"px-4 py-4",children:n.paymentStatus?e.jsx(ks,{variant:n.paymentStatus==="paid"?"emerald":n.paymentStatus==="partial"?"amber":"slate",children:Ys(n.paymentStatus)}):e.jsx("span",{className:"text-xs text-slate-400",children:""})}),e.jsx("td",{className:"px-4 py-4 text-right",children:n.status==="completed"?e.jsx("span",{className:"text-xs text-slate-400",children:"Completed"}):n.status==="cancellation_requested"?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(W,{variant:"secondary",onClick:S=>{S.stopPropagation();const F=window.prompt("Optional: Add a note for approving cancellation")||void 0;bs.mutate({orderId:n._id,status:"cancelled",reason:(F==null?void 0:F.trim())||void 0})},className:"text-xs",children:"Approve Cancel"}),e.jsx(W,{variant:"secondary",onClick:S=>{S.stopPropagation();const F=window.prompt("Optional: Add a note for rejecting cancellation")||void 0,R=n.assignedTechnician?"assigned":"pending_assignment";bs.mutate({orderId:n._id,status:R,reason:(F==null?void 0:F.trim())||void 0})},className:"text-xs",children:"Reject Cancel"})]}):e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(W,{variant:"secondary",onClick:S=>{S.stopPropagation(),f({order:n,open:!0})},className:"text-xs",children:"Reschedule"}),e.jsx(W,{onClick:S=>{S.stopPropagation(),u({order:n,open:!0})},className:"text-xs",children:n.assignedTechnician?"Reassign":"Assign"})]})})]},n._id)})]})]})})}),e.jsxs(Ue,{open:c.open,onClose:()=>{q.open||Ds()},title:k?"Add assistant technician(s)":"Assign Technician(s)",children:[k&&e.jsxs("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 p-4 mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-emerald-800",children:"Add assistant technician(s) to work alongside the primary"}),e.jsx("p",{className:"text-xs text-emerald-700 mt-1",children:'Select one or more technicians below, then click "Add assistants". They will be added to the team.'})]}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Technicians shown are certified for"," ",e.jsx("span",{className:"font-semibold text-slate-900",children:(Ja=(Ya=c.order)==null?void 0:Ya.serviceItem)==null?void 0:Ja.name})," and reflect real-time slot availability."]}),((Ga=(Xa=c.order)==null?void 0:Xa.assignedTechnicians)==null?void 0:Ga.length)>0&&e.jsxs("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-800",children:["Currently assigned: ",e.jsx("span",{className:"font-semibold",children:c.order.assignedTechnicians.map(n=>typeof n=="object"?n==null?void 0:n.name:n).filter(Boolean).join(", ")}),((en=c.order.assignedTechnicians)==null?void 0:en.length)>1&&" (first = primary)",". Select technician(s) below to reassign. First selected = primary."]}),((tn=c.order)==null?void 0:tn.assignedTechnician)&&!((rn=(sn=c.order)==null?void 0:sn.assignedTechnicians)!=null&&rn.length)&&e.jsxs("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-800",children:["Currently assigned to ",e.jsx("span",{className:"font-semibold",children:c.order.assignedTechnician.name}),". Select technician(s) below to reassign. First selected = primary."]}),I.length>0&&e.jsxs("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 p-3 text-sm text-emerald-800",children:[e.jsx("p",{className:"font-semibold",children:k?`Adding assistants to ${((nn=(an=c.order)==null?void 0:an.assignedTechnician)==null?void 0:nn.name)||"primary"}.`:`${I.length} technician(s) selected  first = primary`}),e.jsx("div",{className:"mt-2 space-y-1",children:I.map((n,d)=>{const x=wr.find(S=>S.id===n);return e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{children:[d===0?" Primary: ":" Assisted by: ",e.jsx("span",{className:"font-medium",children:(x==null?void 0:x.name)||n})]}),d>0&&e.jsx("button",{type:"button",onClick:()=>rl(n),className:"text-emerald-700 hover:underline font-medium",children:"Set as primary"})]},n)})}),e.jsx(W,{type:"button",onClick:tl,disabled:bt.isPending,loading:bt.isPending,className:"mt-2 w-full",children:k?"Add assistants":"Assign selected"})]}),Ea&&e.jsx("p",{className:"text-sm text-slate-400",children:"Loading technician roster"}),!Ea&&wr.length===0&&e.jsx("p",{className:"text-sm text-slate-400",children:"No technicians match this service yet. Add a profile from the Technicians tab."}),e.jsx("div",{className:"space-y-3",children:wr.map(n=>{var F,R,de,me,$e,Ye;const x=(((F=c.order)==null?void 0:F.assignedTechnicians)||((R=c.order)!=null&&R.assignedTechnician?[c.order.assignedTechnician]:[])).some(Me=>(typeof Me=="object"?Me==null?void 0:Me._id:Me)===n.id),S=I.includes(n.id);return e.jsxs("div",{className:`flex flex-col gap-4 rounded-2xl border p-4 shadow-sm sm:flex-row sm:items-start sm:justify-between ${x?"border-amber-200 bg-amber-50/60":"border-slate-100"}`,children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("input",{type:"checkbox",checked:S,onChange:()=>sl(n.id),disabled:!n.isAvailable,className:"mt-1.5 h-4 w-4 rounded border-slate-300 text-primary-600 focus:ring-primary-500"}),e.jsxs("div",{className:"space-y-2 flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("p",{className:"font-semibold text-slate-900",children:n.name||"Unnamed technician"}),e.jsx("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-xs font-semibold ${n.isAvailable?"bg-emerald-50 text-emerald-700":"bg-rose-50 text-rose-600"}`,children:n.isAvailable?e.jsxs(e.Fragment,{children:[e.jsx(Ko,{className:"h-4 w-4"})," Available"]}):e.jsxs(e.Fragment,{children:[e.jsx(Cc,{className:"h-4 w-4"})," Busy in slot"]})}),x&&e.jsx("span",{className:"rounded-full bg-amber-100 px-2 py-0.5 text-xs font-semibold text-amber-700",children:"Assigned"}),S&&e.jsx("span",{className:"rounded-full bg-emerald-100 px-2 py-0.5 text-xs font-semibold text-emerald-700",children:"Selected"})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[(de=n.skills)!=null&&de.length?n.skills.slice(0,3).join(", "):"Generalist",typeof n.experienceYears=="number"&&`  ${n.experienceYears} yrs exp`,n.phone&&`  ${n.phone}`]}),((me=n.workingHours)==null?void 0:me.start)&&(($e=n.workingHours)==null?void 0:$e.end)&&e.jsxs("p",{className:"text-xs text-slate-400",children:["Preferred hours ",n.workingHours.start,"  ",n.workingHours.end]}),(Ye=n.serviceItems)!=null&&Ye.length?e.jsxs("p",{className:"text-xs text-slate-400",children:["Services: ",n.serviceItems.map(Me=>Me.name).join(", ")]}):null]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:items-end flex-shrink-0",children:[e.jsx(W,{type:"button",variant:"secondary",icon:e.jsx(Wo,{className:"h-4 w-4"}),onClick:()=>el(n),children:"Calendar"}),e.jsx(W,{type:"button",onClick:()=>ka(n.id),disabled:!n.isAvailable||bt.isPending,loading:bt.isPending&&B===n.id,children:"Assign as primary"})]})]},n.id)})})]}),e.jsx(Ue,{open:b.open,onClose:()=>f({order:null,open:!1}),title:"Reschedule Order",children:qt&&e.jsxs("form",{className:"space-y-5",onSubmit:n=>{if(n.preventDefault(),!L||!Pt){N.error("Select a date and a slot to reschedule");return}const d=(F,R)=>{const de=R.length===5?`${R}:00`:R;return new Date(`${F}T${de}`).toISOString()},x=d(L,Pt.startTime),S=d(L,Pt.endTime);_a.mutate({orderId:qt._id,newStart:x,newEnd:S})},children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Currently scheduled"}),e.jsxs("p",{className:"mt-2 text-sm font-semibold text-slate-900",children:[qe(qt.timeWindowStart),e.jsx("span",{className:"mx-1 text-slate-400",children:""}),qe(qt.timeWindowEnd)]}),Ws&&e.jsxs("p",{className:"text-xs text-slate-500",children:["Slot: ",Ws]}),e.jsx("p",{className:"mt-3 text-xs text-slate-500",children:"Rescheduling keeps the same service and technician assignment rules. Pick a new day & slot below so we can notify the customer and crew."})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(U,{type:"date",label:"Target date",value:L,min:new Date().toISOString().split("T")[0],onChange:n=>pe(n.target.value),required:!0}),e.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 p-4 text-sm text-slate-600",children:L&&Pt?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-semibold text-slate-900",children:"New slot preview"}),e.jsxs("p",{children:[Pt.label||"Custom slot"," on ",new Date(L).toLocaleDateString("en-IN",{dateStyle:"medium"})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[Pt.startTime,"  ",Pt.endTime]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-semibold text-slate-900",children:"Awaiting selection"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Pick a date and slot to generate a fresh appointment window."})]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Available time slots"}),Tt&&e.jsx("p",{className:"mt-2 text-xs text-slate-400",children:"Loading slot templates"}),!Tt&&ft.length===0&&e.jsx("p",{className:"mt-2 text-xs text-rose-500",children:"No time slots configured yet. Create slots in the admin settings."}),!Tt&&ft.length>0&&!L&&e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Pick a date first to preview relevant slot templates."}),!Tt&&ft.length>0&&L&&gt.length===0&&e.jsxs("p",{className:"mt-2 text-xs text-amber-600",children:["No slot templates cover ",new Date(L).toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"short"}),"."]}),!Tt&&ft.length>0&&L&&gt.length>0&&e.jsx("div",{className:"mt-3 grid gap-3 sm:grid-cols-2",children:gt.map(n=>{const d=js(n),x=d===O,S=Ws&&n.label===Ws;return e.jsxs("button",{type:"button",className:`rounded-2xl border px-4 py-3 text-left transition focus:outline-none ${x?"border-slate-900 bg-slate-900/5 shadow-sm":"border-slate-200 hover:border-slate-400"}`,onClick:()=>z(d),children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:n.label||`Slot ${n.dayOfWeek}`}),e.jsxs("p",{className:"text-xs text-slate-500",children:[n.startTime,"  ",n.endTime]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-[11px] uppercase tracking-wide",children:[x&&e.jsx("span",{className:"rounded-full bg-slate-900 px-2 py-0.5 text-white",children:"New choice"}),S&&e.jsx("span",{className:"rounded-full bg-emerald-100 px-2 py-0.5 text-emerald-700",children:"Current slot"}),typeof n.capacity=="number"&&e.jsxs("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-slate-600",children:[n.capacity," jobs"]})]})]},d)})})]}),e.jsx(W,{type:"submit",className:"w-full",disabled:!L||!Pt,loading:_a.isPending,children:"Confirm reschedule"})]})}),e.jsxs(Ue,{open:h.open,onClose:()=>p({order:null,open:!1}),title:`Job card  ${((on=(ln=h.order)==null?void 0:ln.serviceItem)==null?void 0:on.name)??""}`,size:"xxl",showCloseButton:!0,children:[ol&&e.jsx("p",{className:"text-sm text-slate-400",children:"Preparing printable job summary"}),cl&&e.jsx("p",{className:"text-sm text-rose-500",children:"Unable to load job card. Please try again."}),T&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Fixzep Job Sheet"}),e.jsx("h3",{className:"text-2xl font-semibold text-slate-900",children:T.order.code||(H==null?void 0:H.id)||"Job Summary"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Status: ",e.jsx("span",{className:"font-semibold text-slate-900",children:(H==null?void 0:H.status)??"Not generated yet"})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(W,{type:"button",variant:"secondary",icon:e.jsx(dc,{className:"h-4 w-4"}),onClick:()=>window.print(),disabled:!H,title:H?void 0:"Generate a job card before printing",children:"Print"})})]}),ne&&e.jsx("div",{className:"rounded-2xl border border-emerald-200 bg-emerald-50/80 p-4 text-sm text-emerald-800",children:"Job marked as completed. Chat, uploads, and status changes are locked for audit safety."}),!H&&e.jsx("div",{className:"rounded-2xl border border-dashed border-amber-200 bg-amber-50/60 p-4 text-sm text-amber-800",children:"No job card has been created for this order yet. Once the technician starts work, their updates will appear here."}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Customer & Property"}),!ne&&!ya&&e.jsx("button",{type:"button",onClick:()=>{fr(!0),os(!1),is(""),cs(""),ds(""),us(""),ms(""),hs("")},className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"Change Address"})]}),e.jsx("h4",{className:"mt-2 text-lg font-semibold text-slate-900",children:T.order.customer.name}),e.jsx("p",{className:"text-sm text-slate-600",children:T.order.customer.phone}),e.jsx("p",{className:"text-sm text-slate-600",children:T.order.customer.email||"Email not provided"}),ya?e.jsxs("div",{className:"mt-3 space-y-3",children:[V!=null&&V.addresses&&((cn=V==null?void 0:V.addresses)==null?void 0:cn.length)>0&&!ls?e.jsxs(e.Fragment,{children:[e.jsxs(Je,{label:"Select Address",value:ns,onChange:n=>{var S;const d=n.target.value;is(d);const x=(S=V.addresses)==null?void 0:S.find(F=>F.id===d);x&&(cs(x.line1||""),ds(x.line2||""),us(x.city||""),ms(x.state||""),hs(x.postalCode||""))},children:[e.jsx("option",{value:"",children:"Choose an existing address"}),V.addresses.map(n=>e.jsxs("option",{value:n.id,children:[n.label||"Address"," - ",n.line1,", ",n.city," ",n.isDefault?"(Default)":""]},n.id))]}),e.jsx("button",{type:"button",onClick:()=>{os(!0),is(""),cs(""),ds(""),us(""),ms(""),hs("")},className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"+ Add New Address"})]}):null,(ls||!((dn=V==null?void 0:V.addresses)!=null&&dn.length)||ns)&&e.jsxs(e.Fragment,{children:[ls&&(V==null?void 0:V.addresses)&&V.addresses.length>0&&e.jsx("button",{type:"button",onClick:()=>{os(!1),cs(""),ds(""),us(""),ms(""),hs("")},className:"text-xs text-slate-600 hover:text-slate-700",children:" Back to address list"}),e.jsx(U,{label:"Address Line 1 *",value:gr,onChange:n=>cs(n.target.value),placeholder:"Street address"}),e.jsx(U,{label:"Address Line 2",value:va,onChange:n=>ds(n.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(U,{label:"City *",value:br,onChange:n=>us(n.target.value),placeholder:"City"}),e.jsx(U,{label:"State *",value:yr,onChange:n=>ms(n.target.value),placeholder:"State"})]}),e.jsx(U,{label:"Postal Code",value:ja,onChange:n=>hs(n.target.value),placeholder:"PIN Code"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(W,{type:"button",onClick:()=>{var d;if(!ns&&!ls&&((d=V==null?void 0:V.addresses)!=null&&d.length)){N.error("Please select an address or add a new one");return}if(!gr.trim()||!br.trim()||!yr.trim()){N.error("Please fill required address fields");return}const n=typeof T.order.customer=="string"?T.order.customer:T.order.customer._id||T.order.customer._id;if(!n){N.error("Customer ID not found");return}Hs.mutate({customerId:n,addressId:ns||void 0,address:{line1:gr,line2:va,city:br,state:yr,postalCode:ja}})},loading:Hs.isPending,disabled:Hs.isPending,className:"flex-1",children:ls?"Add Address":ns?"Update Order Address":"Save"}),e.jsx(W,{type:"button",variant:"secondary",onClick:()=>{fr(!1),os(!1),is("")},disabled:Hs.isPending,className:"flex-1",children:"Cancel"})]})]}):e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:e.jsx("p",{children:uu(T.order.customer)||"Address not provided"})})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Documents & Photos"}),e.jsxs("label",{className:`mt-3 flex flex-col items-center justify-center rounded-2xl border-2 border-dashed px-4 py-6 text-center text-sm transition ${ne?"cursor-not-allowed border-slate-100 bg-slate-50 text-slate-400":"cursor-pointer border-slate-200 bg-slate-50/50 text-slate-500 hover:border-slate-400"}`,children:[e.jsx("input",{type:"file",className:"hidden",multiple:!0,onChange:hl,disabled:ne}),e.jsx("span",{className:"font-semibold text-slate-900",children:"Drag & drop files"}),e.jsx("span",{className:"text-xs text-slate-500",children:"or click to browse"})]}),ul?e.jsxs("div",{className:"mt-4 space-y-5 text-sm",children:[Sr.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Stored files"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-3",children:Sr.map((n,d)=>e.jsxs("div",{className:"relative rounded-xl border border-slate-100 bg-white/70 overflow-hidden group",children:[n.kind==="image"?e.jsx("div",{className:"aspect-square cursor-pointer",onClick:()=>J({open:!0,url:n.url,name:n.name||`Image ${d+1}`}),children:e.jsx("img",{src:n.url,alt:n.name||`Image ${d+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity"})}):n.kind==="video"?e.jsx("div",{className:"aspect-square bg-slate-900",children:e.jsx("video",{src:n.url,className:"w-full h-full object-cover",controls:!0})}):e.jsxs("div",{className:"aspect-square flex flex-col items-center justify-center bg-slate-50 p-3",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("p",{className:"mt-2 text-xs text-slate-600 text-center truncate w-full px-2",children:n.name||"Document"})]}),!ne&&e.jsx("button",{type:"button",className:"absolute top-2 right-2 p-1 rounded-full bg-rose-600 hover:bg-rose-700 text-white shadow-lg transition-all opacity-0 group-hover:opacity-100",onClick:x=>{x.stopPropagation(),xl(n._id)},disabled:!n._id||kr.isPending&&ma!==n._id,title:"Delete",children:kr.isPending&&ma===n._id?e.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx(Ss,{className:"h-4 w-4"})})]},n._id??`${n.url}-${d}`))})]}),At.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Pending upload"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-3",children:At.map((n,d)=>e.jsxs("div",{className:"relative rounded-xl border border-dashed border-slate-200 bg-slate-50 overflow-hidden group",children:[n.kind==="image"?e.jsx("div",{className:"aspect-square cursor-pointer",onClick:()=>J({open:!0,url:n.url,name:n.name||`Image ${d+1}`}),children:e.jsx("img",{src:n.url,alt:n.name||`Image ${d+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity"})}):n.kind==="video"?e.jsx("div",{className:"aspect-square bg-slate-900",children:e.jsx("video",{src:n.url,className:"w-full h-full object-cover",controls:!0})}):e.jsxs("div",{className:"aspect-square flex flex-col items-center justify-center bg-slate-50 p-3",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("p",{className:"mt-2 text-xs text-slate-600 text-center truncate w-full px-2",children:n.name||"Document"})]}),!ne&&e.jsx("button",{type:"button",className:"absolute top-2 right-2 p-1 rounded-full bg-slate-700 hover:bg-slate-800 text-white shadow-lg transition-all opacity-0 group-hover:opacity-100",onClick:x=>{x.stopPropagation(),pl(d)},disabled:ne,title:"Remove",children:e.jsx(Ss,{className:"h-4 w-4"})})]},`${n.url}-${d}`))}),e.jsx(W,{type:"button",onClick:fl,className:"mt-4 w-full",disabled:ne||!At.length||Cr.isPending,loading:!ne&&Cr.isPending,children:`Upload ${At.length} Document${At.length>1?"s":""}`})]})]}):e.jsx("p",{className:"mt-3 text-xs text-slate-500",children:"No documents uploaded yet."})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Service Details"}),e.jsx("h4",{className:"mt-2 text-lg font-semibold text-slate-900",children:typeof T.order.serviceItem=="string"?T.order.serviceItem:(un=T.order.serviceItem)==null?void 0:un.name}),e.jsx("p",{className:"text-sm text-slate-600",children:typeof T.order.serviceCategory=="string"?T.order.serviceCategory:((mn=T.order.serviceCategory)==null?void 0:mn.name)||"Category not tagged"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:T.order.serviceItem&&typeof T.order.serviceItem!="string"?T.order.serviceItem.description||T.order.issueDescription||"No description provided.":T.order.issueDescription||"No description provided."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Additional Services"}),!ne&&e.jsx(W,{variant:"secondary",onClick:()=>ga(!Rs),className:"text-xs",children:Rs?"Cancel":"+ Add Service"})]}),Rs&&e.jsxs("div",{className:"mt-3 space-y-3 rounded-lg border border-slate-200 bg-slate-50 p-3",children:[e.jsxs(Je,{label:"Select Service *",value:Kt,onChange:n=>ba(n.target.value),children:[e.jsx("option",{value:"",children:"Choose a service..."}),jr.map(n=>e.jsxs("option",{value:n._id,children:[n.name," - ",Be(n.basePrice||0)]},n._id))]}),e.jsx(U,{label:"Quantity",type:"number",placeholder:"1",value:Is,onChange:n=>wa(n.target.value),min:"1",step:"1"}),Kt&&e.jsxs("div",{className:"rounded-lg bg-slate-100 p-2 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:"Total: "}),Be((((hn=jr.find(n=>n._id===Kt))==null?void 0:hn.basePrice)||0)*parseFloat(Is||"1"))]}),e.jsx(W,{onClick:jl,loading:Ta.isPending,className:"w-full",children:"Add Service"})]}),H!=null&&H.extraWork&&H.extraWork.length>0?e.jsx("ul",{className:"mt-3 space-y-2 text-sm",children:H.extraWork.map((n,d)=>e.jsxs("li",{className:"flex items-center justify-between rounded-xl bg-slate-50 px-3 py-2",children:[e.jsx("span",{className:"text-slate-600",children:n.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:Be(n.amount)}),!ne&&e.jsx("button",{type:"button",onClick:x=>{var S;x.stopPropagation(),(S=h.order)!=null&&S._id&&Oa.mutate({orderId:h.order._id,index:d})},className:"text-rose-500 hover:text-rose-700 transition-colors",disabled:Oa.isPending,title:"Remove service",children:e.jsx(ts,{className:"h-4 w-4"})})]})]},`${n.description}-${d}`))}):Rs?null:e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"No additional services captured yet."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Activity Tracking"}),Vs.length>0&&e.jsxs("span",{className:"text-xs text-slate-400",children:[Vs.length," entries"]})]}),Vs.length===0?e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"No activity recorded yet for this job."}):e.jsx("ol",{className:"mt-4 space-y-4 border-l border-slate-100 pl-4 max-h-64 overflow-y-auto pr-2",children:Vs.map(n=>e.jsxs("li",{className:"relative pl-4",children:[e.jsx("span",{className:`absolute -left-2 top-2 block h-3 w-3 rounded-full ${n.accent||"bg-slate-300"}`}),e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:n.title}),n.description&&e.jsx("p",{className:"text-xs text-slate-500",children:n.description}),n.attachments&&n.attachments.length>0&&e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2",children:n.attachments.map((d,x)=>e.jsx("div",{className:"rounded-lg overflow-hidden border border-slate-100 bg-white",children:d.kind==="video"?e.jsx("video",{src:d.url,className:"w-full h-24 object-cover",controls:!0}):e.jsx("img",{src:d.url,alt:d.name||"Attachment",className:"w-full h-24 object-cover"})},`${d.url}-${x}`))}),n.timestamp&&e.jsx("p",{className:"text-[11px] text-slate-400",children:qe(n.timestamp)})]},n.id))}),e.jsxs("form",{className:"mt-4 space-y-3 rounded-2xl bg-slate-50/80 p-3",onSubmit:n=>{var x;if(n.preventDefault(),ne){N.error("Completed job cards are view-only");return}if(!((x=h.order)!=null&&x._id)){N.error("Open an order before logging activity");return}const d=hr.trim();d&&_r.mutate({orderId:h.order._id,message:d})},children:[e.jsx(It,{label:"Add a quick note",placeholder:"Share updates for finance, dispatch, or technicians",value:hr,onChange:n=>pr(n.target.value),rows:3,disabled:ne}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("p",{className:"text-[11px] text-slate-500",children:ne?"Job completed  notes locked.":"Notes sync to the order history instantly."}),e.jsx(W,{type:"submit",className:"w-full sm:w-auto",disabled:_l,loading:!ne&&_r.isPending,children:"Send update"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Job & Payment Status"}),e.jsxs("div",{className:"mt-3 space-y-5",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-400",children:"Job progress"}),e.jsxs(Je,{value:ge,onChange:n=>Bt(n.target.value),disabled:ne,children:[e.jsx("option",{value:"",children:"Select status"}),Xi.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]}),e.jsx(W,{type:"button",onClick:bl,disabled:kl,loading:!ne&&bs.isPending,children:"Update job status"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[e.jsx(ks,{variant:T.order.status,children:Ys(T.order.status)||"Status"}),e.jsx("span",{children:"Last change synced to technicians and finance."})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-400",children:"Payment status"}),H?e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs(Je,{value:Et,onChange:n=>rs(n.target.value),disabled:ne,children:[e.jsx("option",{value:"",children:"Select payment status"}),Gi.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]}),e.jsx(W,{type:"button",onClick:yl,disabled:El,loading:!ne&&Er.isPending,children:"Update payment status"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[e.jsx(ks,{variant:H.paymentStatus??"pending",children:Ys(H.paymentStatus)||"Pending"}),e.jsx("span",{children:"Tracks what finance should collect."})]}),T.paymentBalance&&e.jsxs("div",{className:"mt-4 space-y-2 rounded-xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-400 font-semibold",children:"Payment Balance"}),e.jsxs("div",{className:"space-y-1.5 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Total Due"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Be(T.paymentBalance.totalDue)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Total Paid"}),e.jsx("span",{className:"font-semibold text-emerald-600",children:Be(T.paymentBalance.totalPaid)})]}),T.paymentBalance.remainingBalance>0&&e.jsxs("div",{className:"flex items-center justify-between border-t border-slate-200 pt-1.5",children:[e.jsx("span",{className:"text-slate-600",children:"Remaining Balance"}),e.jsx("span",{className:"font-bold text-red-600",children:Be(T.paymentBalance.remainingBalance)})]}),T.paymentBalance.paymentCount>0&&e.jsxs("div",{className:"text-xs text-slate-500 pt-1",children:[T.paymentBalance.paymentCount," payment",T.paymentBalance.paymentCount>1?"s":""," received"]})]})]})]}):e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Payment tracking unlocks once a job card is created."})]})]}),fs&&e.jsxs("div",{className:"mt-4 space-y-3 rounded-2xl border border-dashed border-rose-200 p-4",children:[e.jsx(It,{label:"Follow up reason",placeholder:"Explain why further follow up is required",value:$t,onChange:n=>Wt(n.target.value),disabled:ne}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Attach evidence (images/videos)"}),e.jsx("input",{type:"file",accept:"image/*,video/*",multiple:!0,onChange:ml,disabled:ne,className:"hidden",id:"followup-file-input"}),e.jsxs("label",{htmlFor:"followup-file-input",className:`flex flex-col items-center justify-center rounded-2xl border-2 border-dashed px-4 py-6 text-center text-sm transition cursor-pointer ${ne?"border-slate-100 bg-slate-50 text-slate-400 cursor-not-allowed":"border-slate-200 bg-slate-50/50 text-slate-500 hover:border-slate-400"}`,children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"Drag & drop files"}),e.jsx("span",{className:"text-xs text-slate-500",children:"or click to browse"})]})]}),_t.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-3",children:_t.map((n,d)=>e.jsxs("div",{className:"relative rounded-xl border border-slate-100 bg-white/70 overflow-hidden group",children:[n.kind==="video"?e.jsx("div",{className:"aspect-square bg-slate-900",children:e.jsx("video",{src:n.url,className:"w-full h-full object-cover",controls:!0})}):e.jsx("div",{className:"aspect-square cursor-pointer",onClick:()=>J({open:!0,url:n.url,name:n.name||`Evidence ${d+1}`}),children:e.jsx("img",{src:n.url,alt:n.name||"Attachment",className:"w-full h-full object-cover hover:opacity-90 transition-opacity"})}),!ne&&e.jsx("button",{type:"button",className:"absolute top-2 right-2 p-1 rounded-full bg-rose-600 hover:bg-rose-700 text-white shadow-lg transition-all opacity-0 group-hover:opacity-100",onClick:x=>{x.stopPropagation(),gl(d)},disabled:ne,title:"Remove",children:e.jsx(Ss,{className:"h-4 w-4"})})]},`${n.name||"attachment"}-${d}`))}),e.jsx("p",{className:"text-[11px] text-rose-600",children:"Technician assignment will be cleared when a job enters follow up."})]}),ge!=="follow_up"&&(Ve==null?void 0:Ve.reason)&&e.jsxs("div",{className:"mt-4 rounded-xl border border-dashed border-rose-100 bg-rose-50/60 p-3 text-xs text-rose-800",children:[e.jsx("p",{className:"font-semibold text-rose-900",children:"Follow up in progress"}),e.jsx("p",{className:"mt-1 text-rose-800",children:Ve.reason}),(pn=Ve.attachments)!=null&&pn.length?e.jsx("div",{className:"mt-3 grid gap-3 sm:grid-cols-2",children:Ve.attachments.map((n,d)=>e.jsxs("div",{className:"rounded-xl border border-rose-100 p-2",children:[n.kind==="video"?e.jsx("video",{controls:!0,className:"h-28 w-full rounded-lg object-cover",src:n.url}):e.jsx("img",{src:n.url,alt:n.name||"Follow up evidence",className:"h-28 w-full rounded-lg object-cover"}),e.jsx("p",{className:"mt-1 text-[11px] text-rose-700 truncate",children:n.name||`Attachment ${d+1}`})]},`existing-${d}`))}):null]}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Syncs both job card and order status for finance follow-ups."})]}),((H==null?void 0:H.technician)||((fn=(xn=T==null?void 0:T.order)==null?void 0:xn.assignedTechnicians)==null?void 0:fn.length))&&e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Technician team"}),((gn=T==null?void 0:T.order)==null?void 0:gn.status)&&!["completed","cancelled"].includes(T.order.status)&&e.jsx(W,{variant:"secondary",onClick:al,icon:e.jsx(yc,{className:"h-4 w-4"}),className:"text-xs",children:"Add assistant"})]}),e.jsx("div",{className:"mt-3 space-y-2",children:((yn=(bn=T==null?void 0:T.order)==null?void 0:bn.assignedTechnicians)==null?void 0:yn.length)>0?(T==null?void 0:T.order).assignedTechnicians.map((n,d)=>{const x=typeof n=="object"?n==null?void 0:n.name:n,S=typeof n=="object"?n==null?void 0:n.mobile:"",F=d===0;return e.jsx("div",{className:"flex items-center justify-between rounded-lg bg-slate-50 px-3 py-2",children:e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-slate-900",children:[x,F&&e.jsx("span",{className:"ml-2 text-xs font-normal text-emerald-600",children:"Primary"})]}),S&&e.jsx("p",{className:"text-xs text-slate-500",children:S})]})},d)}):(H==null?void 0:H.technician)&&e.jsx("div",{className:"flex items-center justify-between rounded-lg bg-slate-50 px-3 py-2",children:e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-slate-900",children:[typeof H.technician=="string"?H.technician:H.technician.name,e.jsx("span",{className:"ml-2 text-xs font-normal text-emerald-600",children:"Primary"})]}),typeof H.technician!="string"&&H.technician.mobile&&e.jsx("p",{className:"text-xs text-slate-500",children:H.technician.mobile})]})})})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-900/10 bg-gradient-to-br from-slate-900 to-slate-800 p-5 text-white",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-white/70",children:"Schedule"}),e.jsx("p",{className:"mt-2 text-lg font-semibold",children:((vn=T.order.preferredSlot)==null?void 0:vn.label)||"Scheduled slot"}),e.jsxs("p",{className:"mt-1 text-sm text-white/80",children:[T.order.timeWindowStart?qe(T.order.timeWindowStart):"",e.jsx("span",{className:"mx-1 text-white/50",children:""}),T.order.timeWindowEnd?qe(T.order.timeWindowEnd):""]}),((wn=(jn=T==null?void 0:T.order)==null?void 0:jn.assignedTechnicians)==null?void 0:wn.length)>0&&e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("p",{className:"text-xs text-white/70 font-semibold",children:"Technicians:"}),(T==null?void 0:T.order).assignedTechnicians.map((n,d)=>{const x=typeof n=="object"?n==null?void 0:n.name:n,S=typeof n=="object"?n==null?void 0:n.mobile:"",F=d===0;return e.jsxs("p",{className:"text-xs text-white/70 ml-2",children:[x,S?`  ${S}`:"",F&&" (primary)"]},d)})]}),(H==null?void 0:H.technician)&&!((Sn=(Nn=T==null?void 0:T.order)==null?void 0:Nn.assignedTechnicians)!=null&&Sn.length)&&e.jsxs("p",{className:"mt-2 text-xs text-white/70",children:["Technician:"," ",typeof H.technician=="string"?H.technician:H.technician.name,typeof H.technician!="string"&&H.technician.mobile?`  ${H.technician.mobile}`:"",e.jsx("span",{className:"text-white/50",children:" (primary)"})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Spare Parts / Cost Summary"}),!ne&&e.jsx(W,{variant:"secondary",onClick:()=>pa(!xr),className:"text-xs",children:xr?"Cancel":"+ Add Spare"})]}),xr&&e.jsxs("div",{className:"mt-3 space-y-3 rounded-lg border border-slate-200 bg-slate-50 p-3",children:[e.jsxs(Je,{label:"Select Spare Part *",value:Ht,onChange:n=>xa(n.target.value),children:[e.jsx("option",{value:"",children:"Choose a spare part..."}),vr.map(n=>e.jsxs("option",{value:n._id,children:[n.name," (",n.sku,") - ",Be(n.unitPrice)]},n._id))]}),e.jsx(U,{label:"Quantity",type:"number",placeholder:"1",value:Os,onChange:n=>fa(n.target.value),min:"1",step:"1"}),Ht&&e.jsxs("div",{className:"rounded-lg bg-slate-100 p-2 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:"Total: "}),Be((((Cn=vr.find(n=>n._id===Ht))==null?void 0:Cn.unitPrice)||0)*parseFloat(Os||"1"))]}),e.jsx(W,{onClick:vl,loading:Aa.isPending,className:"w-full",children:"Add Spare Part"})]}),Nr.length>0&&e.jsx("div",{className:"mt-3 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"text-xs uppercase tracking-wide text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2",children:"Item"}),e.jsx("th",{className:"px-3 py-2",children:"Qty"}),e.jsx("th",{className:"px-3 py-2",children:"Unit price"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Total"}),!ne&&e.jsx("th",{className:"px-3 py-2"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:Nr.map((n,d)=>{var R,de,me;const x=typeof n.part=="string"?n.part:((R=n.part)==null?void 0:R.name)||((de=n.part)==null?void 0:de.sku)||"Part",S=(n==null?void 0:n.unitPrice)??(typeof(n==null?void 0:n.part)=="object"?((me=n.part)==null?void 0:me.unitPrice)??0:0),F=(n.quantity??0)*S;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 text-slate-700",children:x}),e.jsx("td",{className:"px-3 py-2 text-slate-500",children:n.quantity??0}),e.jsx("td",{className:"px-3 py-2 text-slate-500",children:Be(S)}),e.jsx("td",{className:"px-3 py-2 text-right font-semibold text-slate-900",children:Be(F)}),!ne&&e.jsx("td",{className:"px-3 py-2",children:e.jsx("button",{type:"button",onClick:$e=>{var Ye;$e.stopPropagation(),(Ye=h.order)!=null&&Ye._id&&Pa.mutate({orderId:h.order._id,index:d})},className:"text-rose-500 hover:text-rose-700 transition-colors",disabled:Pa.isPending,title:"Remove spare part",children:e.jsx(ts,{className:"h-4 w-4"})})})]},`${x}-${d}`)})})]})}),e.jsxs("div",{className:"mt-4 space-y-2 rounded-2xl bg-slate-50 p-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Service Price"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Be(Us)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Spare Parts Subtotal"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Be(Bs)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Additional Services"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Be($s)})]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-slate-200 pt-2 text-slate-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Be(Us+Bs+$s)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Tax (18%)"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Be((Us+Bs+$s)*.18)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{className:"font-semibold text-emerald-600",children:["-",Be(0)]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t-2 border-slate-300 pt-2 text-base font-bold text-slate-900",children:[e.jsx("span",{children:"Grand Total"}),e.jsx("span",{className:"text-lg",children:Be((Us+Bs+$s)*1.18)})]})]})]})]})]})]})]}),e.jsxs(Ji,{open:q.open,onClose:()=>{Ds()},title:`Calendar  ${q.name||""}`,widthClassName:"w-screen max-w-2xl",children:[c.order&&e.jsxs("div",{className:"mb-4 space-y-3",children:[e.jsxs("div",{className:"rounded-xl border border-blue-200 bg-blue-50 p-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-blue-600 font-semibold",children:"Assigning to order"}),e.jsxs("p",{className:"text-sm text-blue-900 mt-1",children:[(kn=c.order.serviceItem)==null?void 0:kn.name,"  ",(En=c.order.customer)==null?void 0:En.name]}),e.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:["Current slot: ",qe(c.order.timeWindowStart),"  ",qe(c.order.timeWindowEnd)]})]}),e.jsx("div",{className:`rounded-xl border-2 p-4 ${v.length>0?"border-emerald-400 bg-emerald-50":"border-slate-200 bg-slate-50"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:v.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-xs uppercase tracking-wide text-emerald-600 font-semibold",children:["Selected time slots (",v.length,")"]}),(()=>{const n=v[0],d=v.every(R=>R.date.toDateString()===n.date.toDateString()),x=[...v].sort((R,de)=>{const me=ot(R.date,R.startTime).getTime(),$e=ot(de.date,de.startTime).getTime();return me-$e}),S=ot(x[0].date,x[0].startTime),F=ot(x[x.length-1].date,x[x.length-1].endTime);return e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm font-semibold text-emerald-900 mt-1",children:d?x[0].date.toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"short",year:"numeric"}):"Multiple days selected"}),e.jsxs("p",{className:"text-xs text-emerald-700 mt-0.5",children:["Effective window: ",S.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}),"  ",F.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})]}),e.jsx("ul",{className:"mt-2 space-y-1",children:x.map(R=>e.jsx("li",{className:"text-xs text-emerald-600",children:R.label||`${R.startTime} - ${R.endTime}`},`${R.date.toISOString()}-${R.startTime}-${R.endTime}`))}),(()=>{var $e,Ye;const R=($e=c.order)!=null&&$e.timeWindowStart?new Date(c.order.timeWindowStart):null,de=(Ye=c.order)!=null&&Ye.timeWindowEnd?new Date(c.order.timeWindowEnd):null;return R&&de&&S.getTime()===R.getTime()&&F.getTime()===de.getTime()?e.jsx("p",{className:"text-xs text-emerald-800 mt-2 font-medium",children:" Same as current order window"}):e.jsx("p",{className:"text-xs text-amber-600 mt-2 font-medium",children:" Order will be rescheduled to this window"})})()]})})()]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500 font-semibold",children:"No slot selected"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:" Select an available time slot from the calendar below"})]})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(W,{onClick:()=>{if(!q.technicianId||!c.order||v.length===0)return;const n=v[0];if(!v.every($e=>$e.date.toDateString()===n.date.toDateString())){N.error("Please select slots from a single day");return}const x=[...v].sort(($e,Ye)=>{const Me=ot($e.date,$e.startTime).getTime(),Ks=ot(Ye.date,Ye.startTime).getTime();return Me-Ks}),S=ot(x[0].date,x[0].startTime),F=ot(x[x.length-1].date,x[x.length-1].endTime),R=c.order.timeWindowStart?new Date(c.order.timeWindowStart):null,de=c.order.timeWindowEnd?new Date(c.order.timeWindowEnd):null;R&&de&&S.getTime()===R.getTime()&&F.getTime()===de.getTime()?ka(q.technicianId):gs.mutate({orderId:c.order._id,technicianId:q.technicianId,newStart:S.toISOString(),newEnd:F.toISOString()})},loading:gs.isPending||bt.isPending,disabled:v.length===0||gs.isPending||bt.isPending,className:"whitespace-nowrap",children:gs.isPending||bt.isPending?"Assigning...":"Assign Technician"}),v.length>0&&e.jsx("button",{type:"button",onClick:()=>he([]),className:"text-xs text-slate-500 hover:text-slate-700 transition-colors",children:"Clear selection"})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),n.preventDefault();const d=new Date(ce);d.setDate(d.getDate()-7),Le(d)},className:"px-3 py-1.5 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:" Previous"}),e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:[ri(ce)," - ",ri(si(ce,7)[6])]}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),n.preventDefault();const d=new Date(ce);d.setDate(d.getDate()+7),Le(d)},className:"px-3 py-1.5 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:"Next "})]}),(Ms||Tt)&&e.jsx("p",{className:"text-sm text-slate-400 text-center py-8",children:"Loading calendar"}),!Ms&&!Tt&&ft.length===0&&e.jsx("p",{className:"text-sm text-amber-600 text-center py-8",children:"No time slots configured. Add slots in admin settings."}),!Ms&&!Tt&&ft.length>0&&e.jsx("div",{className:"space-y-1",onClick:n=>n.stopPropagation(),children:si(ce,7).map(n=>{const d=n.getDay(),x=ft.filter(R=>R.dayOfWeek===d),S=n.toDateString()===new Date().toDateString(),F=n<new Date(new Date().setHours(0,0,0,0));return e.jsxs("div",{className:`rounded-xl border p-3 ${S?"border-blue-200 bg-blue-50/50":"border-slate-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("p",{className:`text-sm font-semibold ${S?"text-blue-900":"text-slate-900"}`,children:n.toLocaleDateString("en-IN",{weekday:"short",day:"numeric",month:"short"})}),S&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-blue-500 text-white px-2 py-0.5 rounded-full",children:"Today"}),F&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-slate-300 text-slate-600 px-2 py-0.5 rounded-full",children:"Past"})]}),x.length===0?e.jsx("p",{className:"text-xs text-slate-400 italic",children:"No slots configured for this day"}):e.jsx("div",{className:"grid grid-cols-2 gap-2",children:x.map(R=>{var An,Tn,Pn,On;const de=mu(n,R.startTime,R.endTime,Ls),me=de!==null,$e=ot(n,R.startTime),Ye=ot(n,R.endTime),Me=Ye<new Date,Ks=(An=c.order)!=null&&An.timeWindowStart?new Date(c.order.timeWindowStart):null,_n=(Tn=c.order)!=null&&Tn.timeWindowEnd?new Date(c.order.timeWindowEnd):null,Tr=Ks&&_n&&$e.getTime()===Ks.getTime()&&Ye.getTime()===_n.getTime(),Al=!me&&!Me&&c.order&&q.technicianId,yt=v.some(Qt=>Qt.date.toDateString()===n.toDateString()&&Qt.startTime===R.startTime&&Qt.endTime===R.endTime);return e.jsxs("button",{type:"button",disabled:me||Me||!c.order,onClick:Qt=>{Qt.stopPropagation(),Qt.preventDefault(),Al&&he(yt?zt=>zt.filter(Pr=>!(Pr.date.toDateString()===n.toDateString()&&Pr.startTime===R.startTime&&Pr.endTime===R.endTime)):zt=>zt.length>0&&zt[0].date.toDateString()!==n.toDateString()?(N.error("Please select slots from a single day"),zt):[...zt,{date:n,startTime:R.startTime,endTime:R.endTime,label:R.label||`${R.startTime} - ${R.endTime}`}])},className:`
                              relative p-2 rounded-lg text-left text-xs transition-all
                              ${me?"bg-rose-50 border border-rose-200 cursor-not-allowed":Me?"bg-slate-50 border border-slate-200 cursor-not-allowed opacity-50":yt?"bg-blue-100 border-2 border-blue-500 ring-2 ring-blue-200 cursor-pointer":Tr?"bg-emerald-50 border-2 border-emerald-400 hover:bg-emerald-100 cursor-pointer":"bg-emerald-50/50 border border-emerald-200 hover:bg-emerald-100 hover:border-emerald-400 cursor-pointer"}
                            `,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`font-semibold ${me?"text-rose-700":Me?"text-slate-400":yt?"text-blue-700":"text-emerald-700"}`,children:R.label||`${R.startTime} - ${R.endTime}`}),me&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-rose-100 text-rose-600 px-1.5 py-0.5 rounded",children:"Blocked"}),yt&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-blue-500 text-white px-1.5 py-0.5 rounded",children:"Selected"}),!me&&!Me&&!yt&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-emerald-100 text-emerald-600 px-1.5 py-0.5 rounded",children:"Available"})]}),e.jsxs("p",{className:`mt-1 ${me?"text-rose-600":Me?"text-slate-400":yt?"text-blue-600":"text-emerald-600"}`,children:[R.startTime,"  ",R.endTime]}),me&&de&&e.jsx("div",{className:"mt-2 pt-2 border-t border-rose-200",children:((On=(Pn=de.order)==null?void 0:Pn.customer)==null?void 0:On.name)&&e.jsx("p",{className:"text-rose-600 truncate",children:de.order.customer.name})}),!me&&!Me&&c.order&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-emerald-200",children:[e.jsx("p",{className:`font-medium ${yt?"text-blue-700":"text-emerald-700"}`,children:yt?' Click "Assign Technician" above':Tr?" Current order slot":"Click to select"}),!Tr&&!yt&&e.jsx("p",{className:"text-emerald-600 text-[10px]",children:"Will reschedule order"})]})]},`${n.toISOString()}-${R.startTime}-${R.endTime}`)})})]},n.toISOString())})}),gs.isPending&&e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl flex items-center gap-3",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"text-slate-700 font-medium",children:"Rescheduling and assigning"})]})}),!Ms&&Ls.length>0&&e.jsxs("div",{className:"mt-6 pt-4 border-t border-slate-200",children:[e.jsxs("p",{className:"text-xs uppercase tracking-wide text-slate-500 font-semibold mb-3",children:["Blocked entries (",Ls.length,")"]}),e.jsx("ol",{className:"space-y-2 max-h-48 overflow-y-auto",children:Ls.map(n=>{var x,S,F,R,de,me;const d=typeof((x=n.order)==null?void 0:x.serviceItem)=="string"?(S=n.order)==null?void 0:S.serviceItem:(R=(F=n.order)==null?void 0:F.serviceItem)==null?void 0:R.name;return e.jsxs("li",{className:"rounded-lg border border-slate-100 p-2 text-xs",children:[e.jsxs("p",{className:"font-semibold text-slate-900",children:[qe(n.start)," ",e.jsx("span",{className:"text-slate-400",children:""})," ",qe(n.end)]}),e.jsxs("p",{className:"text-slate-500",children:[d||"Blocked slot",(me=(de=n.order)==null?void 0:de.customer)!=null&&me.name?`  ${n.order.customer.name}`:""]})]},n.id)})})]})]}),e.jsx(Ue,{open:i,onClose:()=>{l(!1),Ar()},title:"Create New Order",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Customer Information"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{label:"Customer Phone Number",value:$,onChange:n=>re(n.target.value),placeholder:"Enter phone number",disabled:P}),e.jsx(W,{onClick:Sl,loading:P,variant:"secondary",className:"mt-6",children:"Check"})]}),V&&e.jsxs("div",{className:"rounded-lg bg-emerald-50 p-3 text-sm text-emerald-800",children:[" Customer found: ",V.name]}),e.jsx(U,{label:"Customer Name *",value:De,onChange:n=>ke(n.target.value),placeholder:"Enter customer name",disabled:!!(V&&De)}),e.jsx(U,{label:"Email",type:"email",value:Fe,onChange:n=>y(n.target.value),placeholder:"customer@email.com",disabled:!!(V&&Fe)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Service Address"}),V&&V.addresses&&V.addresses.length>0&&e.jsxs(Je,{label:"Select Address *",value:ye,onChange:n=>Nl(n.target.value),children:[e.jsx("option",{value:"",children:"Choose an address"}),V.addresses.map(n=>e.jsxs("option",{value:n.id,children:[n.label||"Address"," - ",n.line1,", ",n.city," ",n.isDefault?"(Default)":""]},n.id))]}),e.jsx(U,{label:"Address Line 1 *",value:ae,onChange:n=>ue(n.target.value),placeholder:"Street address",disabled:!!(V&&ae)}),e.jsx(U,{label:"Address Line 2",value:Qe,onChange:n=>_(n.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(U,{label:"City *",value:ee,onChange:n=>se(n.target.value),placeholder:"City",disabled:!!(V&&ee)}),e.jsx(U,{label:"State *",value:xe,onChange:n=>ze(n.target.value),placeholder:"State",disabled:!!(V&&xe)})]}),e.jsx(U,{label:"Postal Code",value:Ze,onChange:n=>tt(n.target.value),placeholder:"PIN Code",disabled:!!(V&&Ze)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Service Details"}),e.jsxs(Je,{label:"Service Category *",value:st,onChange:n=>{fe(n.target.value),lt("")},children:[e.jsx("option",{value:"",children:"Select category"}),il.map(n=>e.jsx("option",{value:n._id,children:n.name},n._id))]}),e.jsxs(Je,{label:"Service Item *",value:pt,onChange:n=>lt(n.target.value),disabled:!st,children:[e.jsx("option",{value:"",children:"Select service"}),ll.map(n=>e.jsx("option",{value:n._id,children:n.name},n._id))]}),e.jsx(It,{label:"Issue Description",value:j,onChange:n=>D(n.target.value),placeholder:"Describe the issue...",rows:3})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Schedule"}),e.jsx(U,{label:"Order Date *",type:"date",value:xt,onChange:n=>Lt(n.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(U,{label:"Start Time *",type:"time",value:Mt,onChange:n=>kt(n.target.value)}),e.jsx(U,{label:"End Time *",type:"time",value:m,onChange:n=>g(n.target.value)})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(W,{onClick:Cl,loading:Ra.isPending,children:"Create Order"}),e.jsx(W,{variant:"secondary",onClick:()=>{l(!1),Ar()},children:"Cancel"})]})]})}),X.open&&di.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[9999] flex flex-col bg-black/95 backdrop-blur-md animate-in fade-in duration-200",onClick:n=>{n.stopPropagation(),n.target===n.currentTarget&&(J({open:!1,url:"",name:""}),G(100))},onKeyDown:n=>{n.key==="Escape"&&(n.stopPropagation(),J({open:!1,url:"",name:""}),G(100))},tabIndex:-1,style:{isolation:"isolate"},children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-gradient-to-b from-black/60 to-transparent",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-semibold text-lg truncate",children:X.name}),e.jsx("p",{className:"text-white/60 text-sm mt-0.5",children:"Click and drag to pan  Scroll to zoom"})]}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),J({open:!1,url:"",name:""}),G(100)},className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-all ml-4","aria-label":"Close image viewer",children:e.jsx(Ss,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center overflow-auto p-8",onClick:n=>n.stopPropagation(),children:e.jsx("div",{className:"relative transition-transform duration-200 ease-out",style:{transform:`scale(${M/100})`,cursor:M>100?"move":"default"},children:e.jsx("img",{src:X.url,alt:X.name,className:"max-w-none shadow-2xl rounded-lg",style:{maxHeight:"80vh",maxWidth:M===100?"90vw":"none"},onClick:n=>n.stopPropagation(),onWheel:n=>{n.preventDefault();const d=n.deltaY>0?-10:10;G(x=>Math.min(Math.max(50,x+d),300))},draggable:!1})})}),e.jsxs("div",{className:"flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-t from-black/60 to-transparent",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm rounded-lg px-4 py-2",children:[e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),G(d=>Math.max(50,d-10))},disabled:M<=50,className:"p-2 rounded-lg hover:bg-white/10 text-white transition-all disabled:opacity-40 disabled:cursor-not-allowed",title:"Zoom out",children:e.jsx(sc,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center gap-2 px-3",children:[e.jsx("input",{type:"range",min:"50",max:"300",step:"10",value:M,onChange:n=>G(Number(n.target.value)),className:"w-32 h-1 bg-white/20 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, rgb(59 130 246) 0%, rgb(59 130 246) ${(M-50)/250*100}%, rgba(255,255,255,0.2) ${(M-50)/250*100}%, rgba(255,255,255,0.2) 100%)`},onClick:n=>n.stopPropagation()}),e.jsxs("span",{className:"text-white font-medium text-sm min-w-[3.5rem] text-center",children:[M,"%"]})]}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),G(d=>Math.min(300,d+10))},disabled:M>=300,className:"p-2 rounded-lg hover:bg-white/10 text-white transition-all disabled:opacity-40 disabled:cursor-not-allowed",title:"Zoom in",children:e.jsx(ac,{className:"h-5 w-5"})})]}),e.jsxs("button",{type:"button",onClick:n=>{n.stopPropagation(),G(100)},className:"px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white text-sm font-medium transition-all flex items-center gap-2",title:"Reset zoom",children:[e.jsx(Dn,{className:"h-4 w-4"}),"Reset"]}),e.jsxs("button",{type:"button",onClick:n=>{n.stopPropagation(),window.open(X.url,"_blank")},className:"px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium transition-all flex items-center gap-2",title:"Open in new tab",children:[e.jsx(Dn,{className:"h-4 w-4"}),"Full Screen"]})]})]}),document.body)]})},pu=()=>{const t=lr(),s=Ct(),[r,a]=o.useState(!1),[i,l]=o.useState(null),[c,u]=o.useState(!1),[b,f]=o.useState(null),h=ht({defaultValues:{name:"",description:"",imageUrl:""}}),p=h.watch("imageUrl"),w=O=>{var re;const z=(re=O.target.files)==null?void 0:re[0];if(!z)return;const $=new FileReader;$.onload=()=>{typeof $.result=="string"&&h.setValue("imageUrl",$.result,{shouldDirty:!0,shouldValidate:!0})},$.readAsDataURL(z),O.target.value=""},{data:Y=[],isLoading:X}=je({queryKey:["categories"],queryFn:Ie.categories}),J=le({mutationFn:O=>Ie.upsertCategory(O),onSuccess:()=>{N.success("Category saved"),s.invalidateQueries({queryKey:["categories"]}),h.reset(),a(!1)},onError:O=>{var z,$;return N.error((($=(z=O==null?void 0:O.response)==null?void 0:z.data)==null?void 0:$.message)||"Failed to save category")}}),M=le({mutationFn:O=>Ie.updateCategory(i._id,O),onSuccess:()=>{N.success("Category updated successfully"),s.invalidateQueries({queryKey:["categories"]}),h.reset(),l(null),a(!1)},onError:O=>{var z,$;return N.error((($=(z=O==null?void 0:O.response)==null?void 0:z.data)==null?void 0:$.message)||"Failed to update category")}}),G=le({mutationFn:O=>Ie.deleteCategory(O),onSuccess:()=>{N.success("Category deleted successfully"),s.invalidateQueries({queryKey:["categories"]}),u(!1),f(null)},onError:O=>{var z,$;return N.error((($=(z=O==null?void 0:O.response)==null?void 0:z.data)==null?void 0:$.message)||"Failed to delete category")}}),B=le({mutationFn:({categoryId:O,isActive:z})=>Ie.updateCategory(O,{isActive:z}),onSuccess:(O,z)=>{N.success(z.isActive?"Category activated":"Category deactivated"),s.invalidateQueries({queryKey:["categories"]})},onError:O=>{var z,$;return N.error((($=(z=O==null?void 0:O.response)==null?void 0:z.data)==null?void 0:$.message)||"Failed to update status")}}),C=(O,z)=>{z.stopPropagation(),O._id&&B.mutate({categoryId:O._id,isActive:!(O.isActive??!0)})},I=()=>{l(null),h.reset({name:"",description:"",imageUrl:""}),a(!0)},E=(O,z)=>{z.stopPropagation(),l(O),h.reset({name:O.name,description:O.description||"",imageUrl:O.imageUrl||""}),a(!0)},k=(O,z)=>{z.stopPropagation(),f(O),u(!0)},K=O=>{i?M.mutate(O):J.mutate(O)},L=()=>{b!=null&&b._id&&G.mutate(b._id)},pe=()=>{a(!1),l(null),h.reset()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Catalog"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Service Categories & Workflows"})]}),e.jsx(W,{onClick:I,children:"Add Category"})]}),e.jsxs(Ke,{title:"Categories",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Click a category to manage its sub categories."}),X&&e.jsx("p",{className:"mt-4 text-sm text-slate-400",children:"Loading categories"}),!X&&Y.length===0&&e.jsx("p",{className:"mt-4 text-sm text-slate-400",children:"No categories yet. Create one using the form above."}),!X&&Y.length>0&&e.jsx("div",{className:"mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:Y.map(O=>{const z=O.isActive??!0;return e.jsxs("div",{className:`group relative flex flex-col items-center gap-3 rounded-2xl border bg-white p-6 text-center shadow-sm transition hover:-translate-y-1 hover:shadow-lg cursor-pointer ${z?"border-slate-100 hover:border-slate-200":"border-slate-200 bg-slate-50 opacity-60"}`,onClick:()=>t(`/catalog/${O._id}`),children:[!z&&e.jsx("div",{className:"absolute left-2 top-2",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 text-xs font-medium",children:"Inactive"})}),e.jsxs("div",{className:"absolute right-2 top-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{type:"button",onClick:$=>C(O,$),className:`p-1.5 rounded-lg bg-white/90 transition-colors shadow-sm ${z?"text-amber-500 hover:text-amber-700 hover:bg-amber-50":"text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50"}`,title:z?"Deactivate category":"Activate category",disabled:B.isPending,children:z?e.jsx(Ur,{className:"h-4 w-4"}):e.jsx(Vr,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:$=>E(O,$),className:"p-1.5 rounded-lg bg-white/90 text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors shadow-sm",title:"Edit category",children:e.jsx(Dt,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:$=>k(O,$),className:"p-1.5 rounded-lg bg-white/90 text-rose-500 hover:text-rose-700 hover:bg-rose-50 transition-colors shadow-sm",title:"Delete category",children:e.jsx(ts,{className:"h-4 w-4"})})]}),O.imageUrl?e.jsx("img",{src:O.imageUrl,alt:O.name,className:`h-24 w-24 rounded-2xl object-cover ${z?"":"grayscale"}`}):e.jsx("div",{className:"flex h-24 w-24 items-center justify-center rounded-2xl bg-slate-50 text-xs text-slate-400",children:"No image"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-900 group-hover:text-slate-700",children:O.name}),O.description&&e.jsx("p",{className:"mt-1 text-xs text-slate-500 line-clamp-2",children:O.description})]})]},O._id)})})]})]}),e.jsx(Ue,{open:r,onClose:pe,title:i?"Edit Category":"Add Category",children:e.jsxs("form",{className:"space-y-4",onSubmit:h.handleSubmit(K),children:[e.jsx(U,{label:"Name *",placeholder:"Electrical",...h.register("name",{required:!0})}),e.jsx(It,{label:"Description",placeholder:"Household electrical repairs",...h.register("description")}),e.jsx(U,{type:"file",accept:"image/*",label:"Upload image",onChange:w}),p&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:p,alt:"Category preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(W,{type:"button",variant:"ghost",onClick:pe,children:"Cancel"}),e.jsx(W,{type:"submit",loading:J.isPending||M.isPending,children:i?"Update Category":"Save Category"})]})]})}),e.jsx(Ue,{open:c,onClose:()=>{u(!1),f(null)},title:"Delete Category",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-slate-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:b==null?void 0:b.name}),"? This action cannot be undone."]}),e.jsx("p",{className:"text-xs text-amber-600 bg-amber-50 p-3 rounded-lg",children:"Note: Categories with existing service items or orders cannot be deleted."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(W,{variant:"ghost",onClick:()=>{u(!1),f(null)},children:"Cancel"}),e.jsx(W,{variant:"primary",className:"!bg-rose-600 hover:!bg-rose-700",onClick:L,loading:G.isPending,children:"Delete Category"})]})]})})]})},xu=()=>{const{categoryId:t}=hi(),s=lr(),r=Ct(),a=t??"",[i,l]=o.useState(!1),[c,u]=o.useState(null),[b,f]=o.useState(!1),[h,p]=o.useState(null),[w,Y]=o.useState(!1),{data:X=[],isLoading:J}=je({queryKey:["categories"],queryFn:Ie.categories}),M=X.find(_=>_._id===t),{data:G=[],isLoading:B}=je({queryKey:["serviceItems",a],queryFn:()=>Ie.serviceItems(a),enabled:!!a}),C=ht({defaultValues:{category:a,name:"",description:"",basePrice:0,imageUrl:""}}),I=C.watch("imageUrl"),E=ht({defaultValues:{name:"",description:"",imageUrl:""}}),k=E.watch("imageUrl"),K=_=>{var xe;const ee=(xe=_.target.files)==null?void 0:xe[0];if(!ee)return;const se=new FileReader;se.onload=()=>{typeof se.result=="string"&&C.setValue("imageUrl",se.result,{shouldDirty:!0,shouldValidate:!0})},se.readAsDataURL(ee),_.target.value=""},L=_=>{var xe;const ee=(xe=_.target.files)==null?void 0:xe[0];if(!ee)return;const se=new FileReader;se.onload=()=>{typeof se.result=="string"&&E.setValue("imageUrl",se.result,{shouldDirty:!0,shouldValidate:!0})},se.readAsDataURL(ee),_.target.value=""};o.useEffect(()=>{a&&C.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""})},[a,C]);const pe=le({mutationFn:_=>Ie.upsertServiceItem(_),onSuccess:()=>{N.success("Sub category created"),r.invalidateQueries({queryKey:["serviceItems",a]}),C.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""}),l(!1)},onError:_=>{var ee,se;return N.error(((se=(ee=_==null?void 0:_.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to create sub category")}}),O=le({mutationFn:_=>Ie.updateServiceItem(c._id,_),onSuccess:()=>{N.success("Sub category updated"),r.invalidateQueries({queryKey:["serviceItems",a]}),C.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""}),u(null),l(!1)},onError:_=>{var ee,se;return N.error(((se=(ee=_==null?void 0:_.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to update sub category")}}),z=le({mutationFn:_=>Ie.deleteServiceItem(_),onSuccess:()=>{N.success("Sub category deleted"),r.invalidateQueries({queryKey:["serviceItems",a]}),f(!1),p(null)},onError:_=>{var ee,se;return N.error(((se=(ee=_==null?void 0:_.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to delete sub category")}}),$=le({mutationFn:_=>Ie.updateCategory(a,_),onSuccess:()=>{N.success("Category updated"),r.invalidateQueries({queryKey:["categories"]}),E.reset(),Y(!1)},onError:_=>{var ee,se;return N.error(((se=(ee=_==null?void 0:_.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to update category")}}),re=le({mutationFn:({itemId:_,isActive:ee})=>Ie.updateServiceItem(_,{isActive:ee}),onSuccess:(_,ee)=>{N.success(ee.isActive?"Sub category activated":"Sub category deactivated"),r.invalidateQueries({queryKey:["serviceItems",a]})},onError:_=>{var ee,se;return N.error(((se=(ee=_==null?void 0:_.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to update status")}}),V=le({mutationFn:({isActive:_})=>Ie.updateCategory(a,{isActive:_}),onSuccess:(_,ee)=>{N.success(ee.isActive?"Category activated":"Category deactivated"),r.invalidateQueries({queryKey:["categories"]})},onError:_=>{var ee,se;return N.error(((se=(ee=_==null?void 0:_.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to update status")}}),be=_=>{_._id&&re.mutate({itemId:_._id,isActive:!(_.isActive??!0)})},ye=()=>{M&&V.mutate({isActive:!(M.isActive??!0)})},Se=()=>{u(null),C.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""}),l(!0)},De=_=>{u(_),C.reset({category:a,name:_.name,description:_.description||"",basePrice:_.basePrice||0,imageUrl:_.imageUrl||""}),l(!0)},ke=_=>{p(_),f(!0)},Fe=()=>{M&&(E.reset({name:M.name,description:M.description||"",imageUrl:M.imageUrl||""}),Y(!0))},y=_=>{c?O.mutate(_):pe.mutate({..._,category:a})},ae=()=>{h!=null&&h._id&&z.mutate(h._id)},ue=()=>{l(!1),u(null),C.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""})},Qe=_=>{$.mutate(_)};return a?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(W,{variant:"ghost",icon:e.jsx(Io,{className:"h-4 w-4"}),onClick:()=>s("/catalog"),children:"Back to catalog"}),e.jsxs("div",{className:"flex items-center gap-3",children:[(M==null?void 0:M.imageUrl)&&e.jsx("img",{src:M.imageUrl,alt:M.name,className:`h-12 w-12 rounded-xl object-cover ${M.isActive??!0?"":"grayscale opacity-60"}`}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Catalog"}),M&&!(M.isActive??!0)&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 text-xs font-medium",children:"Inactive"})]}),e.jsx("h1",{className:"mt-1 text-2xl font-bold text-slate-900",children:J?"Loading":(M==null?void 0:M.name)||"Category not found"}),(M==null?void 0:M.description)&&e.jsx("p",{className:"text-sm text-slate-500",children:M.description})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[M&&e.jsxs(e.Fragment,{children:[e.jsx(W,{variant:"secondary",onClick:ye,loading:V.isPending,icon:M.isActive??!0?e.jsx(Ur,{className:"h-4 w-4"}):e.jsx(Vr,{className:"h-4 w-4"}),className:M.isActive??!0?"":"!bg-emerald-50 !text-emerald-700 !border-emerald-200",children:M.isActive??!0?"Deactivate":"Activate"}),e.jsx(W,{variant:"secondary",onClick:Fe,icon:e.jsx(Dt,{className:"h-4 w-4"}),children:"Edit Category"})]}),e.jsx(W,{onClick:Se,disabled:!M,children:"Add Sub Category"})]})]}),!J&&!M&&e.jsx(Ke,{children:e.jsx("p",{className:"text-sm text-rose-500",children:"We couldn't find that category. It may have been deleted."})}),M&&e.jsxs(Ke,{title:`Sub Categories (${G.length})`,children:[B&&e.jsx("p",{className:"text-sm text-slate-400",children:"Loading sub categories"}),!B&&G.length===0&&e.jsx("p",{className:"text-sm text-slate-400",children:"No sub categories yet. Create one using the button above."}),!B&&G.length>0&&e.jsx("div",{className:"mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:G.map(_=>{const ee=_.isActive??!0;return e.jsxs("div",{className:`group relative flex flex-col items-center gap-3 rounded-2xl border bg-white p-6 text-center shadow-sm ${ee?"border-slate-100":"border-slate-200 bg-slate-50 opacity-60"}`,children:[!ee&&e.jsx("div",{className:"absolute left-2 top-2",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 text-xs font-medium",children:"Inactive"})}),e.jsxs("div",{className:"absolute right-2 top-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{type:"button",onClick:()=>be(_),className:`p-1.5 rounded-lg bg-white/90 transition-colors shadow-sm ${ee?"text-amber-500 hover:text-amber-700 hover:bg-amber-50":"text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50"}`,title:ee?"Deactivate sub category":"Activate sub category",disabled:re.isPending,children:ee?e.jsx(Ur,{className:"h-4 w-4"}):e.jsx(Vr,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>De(_),className:"p-1.5 rounded-lg bg-white/90 text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors shadow-sm",title:"Edit sub category",children:e.jsx(Dt,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>ke(_),className:"p-1.5 rounded-lg bg-white/90 text-rose-500 hover:text-rose-700 hover:bg-rose-50 transition-colors shadow-sm",title:"Delete sub category",children:e.jsx(ts,{className:"h-4 w-4"})})]}),_.imageUrl?e.jsx("img",{src:_.imageUrl,alt:_.name,className:`h-20 w-20 rounded-2xl object-cover ${ee?"":"grayscale"}`}):e.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-2xl bg-slate-50 text-xs text-slate-400",children:"No image"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-900",children:_.name}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2",children:_.description||""}),typeof _.basePrice=="number"&&e.jsxs("p",{className:"mt-1 text-sm font-medium text-slate-700",children:["Base ",_.basePrice.toFixed(2)]})]})]},_._id)})})]}),e.jsx(Ue,{open:i,onClose:ue,title:c?"Edit Sub Category":"Add Sub Category",children:e.jsxs("form",{className:"space-y-4",onSubmit:C.handleSubmit(y),children:[e.jsx(U,{label:"Sub category name *",placeholder:"Fan installation",...C.register("name",{required:!0})}),e.jsx(It,{label:"Description",...C.register("description")}),e.jsx(U,{type:"file",accept:"image/*",label:"Upload image",onChange:K}),I&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:I,alt:"Sub category preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsx(U,{label:"Base price ()",type:"number",step:"0.01",...C.register("basePrice",{valueAsNumber:!0})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(W,{type:"button",variant:"ghost",onClick:ue,children:"Cancel"}),e.jsx(W,{type:"submit",loading:pe.isPending||O.isPending,children:c?"Update Sub Category":"Save Sub Category"})]})]})}),e.jsx(Ue,{open:b,onClose:()=>{f(!1),p(null)},title:"Delete Sub Category",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-slate-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:h==null?void 0:h.name}),"? This action cannot be undone."]}),e.jsx("p",{className:"text-xs text-amber-600 bg-amber-50 p-3 rounded-lg",children:"Note: Sub categories with existing orders cannot be deleted."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(W,{variant:"ghost",onClick:()=>{f(!1),p(null)},children:"Cancel"}),e.jsx(W,{variant:"primary",className:"!bg-rose-600 hover:!bg-rose-700",onClick:ae,loading:z.isPending,children:"Delete Sub Category"})]})]})}),e.jsx(Ue,{open:w,onClose:()=>{Y(!1),E.reset()},title:"Edit Category",children:e.jsxs("form",{className:"space-y-4",onSubmit:E.handleSubmit(Qe),children:[e.jsx(U,{label:"Name *",placeholder:"Electrical",...E.register("name",{required:!0})}),e.jsx(It,{label:"Description",placeholder:"Household electrical repairs",...E.register("description")}),e.jsx(U,{type:"file",accept:"image/*",label:"Upload image",onChange:L}),k&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:k,alt:"Category preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(W,{type:"button",variant:"ghost",onClick:()=>{Y(!1),E.reset()},children:"Cancel"}),e.jsx(W,{type:"submit",loading:$.isPending,children:"Update Category"})]})]})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(W,{variant:"ghost",onClick:()=>s("/catalog"),children:"Back to catalog"}),e.jsx("p",{className:"text-sm text-rose-500",children:"No category selected."})]})},fu=()=>{const t=Ct(),[s,r]=o.useState(!1),[a,i]=o.useState(null),[l,c]=o.useState(!1),[u,b]=o.useState(null),f=ht({defaultValues:{name:"",sku:"",unitPrice:0,imageUrl:""}}),h=f.watch("imageUrl"),{data:p=[]}=je({queryKey:["spareParts"],queryFn:ws.list}),w=k=>{var pe;const K=(pe=k.target.files)==null?void 0:pe[0];if(!K)return;const L=new FileReader;L.onload=()=>{typeof L.result=="string"&&f.setValue("imageUrl",L.result,{shouldDirty:!0,shouldValidate:!0})},L.readAsDataURL(K),k.target.value=""},Y=le({mutationFn:ws.upsert,onSuccess:()=>{N.success("Spare part saved"),t.invalidateQueries({queryKey:["spareParts"]}),f.reset(),r(!1)},onError:k=>{var K,L;return N.error(((L=(K=k==null?void 0:k.response)==null?void 0:K.data)==null?void 0:L.message)||"Failed to save spare part")}}),X=le({mutationFn:k=>ws.update(a._id,k),onSuccess:()=>{N.success("Spare part updated successfully"),t.invalidateQueries({queryKey:["spareParts"]}),f.reset(),i(null),r(!1)},onError:k=>{var K,L;return N.error(((L=(K=k==null?void 0:k.response)==null?void 0:K.data)==null?void 0:L.message)||"Failed to update spare part")}}),J=le({mutationFn:k=>ws.delete(k),onSuccess:()=>{N.success("Spare part deleted successfully"),t.invalidateQueries({queryKey:["spareParts"]}),c(!1),b(null)},onError:k=>{var K,L;return N.error(((L=(K=k==null?void 0:k.response)==null?void 0:K.data)==null?void 0:L.message)||"Failed to delete spare part")}}),M=()=>{i(null),f.reset({name:"",sku:"",unitPrice:0,imageUrl:""}),r(!0)},G=(k,K)=>{K.stopPropagation(),i(k),f.reset({name:k.name,sku:k.sku,unitPrice:k.unitPrice||0,imageUrl:k.imageUrl||""}),r(!0)},B=(k,K)=>{K.stopPropagation(),b(k),c(!0)},C=k=>{a?X.mutate(k):Y.mutate(k)},I=()=>{u!=null&&u._id&&J.mutate(u._id)},E=()=>{r(!1),i(null),f.reset()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Inventory"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Spare Parts Management"})]}),e.jsx(W,{onClick:M,children:"Add Spare Part"})]}),e.jsx(Ke,{title:"Spare Parts Catalog",children:e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:p.length===0?e.jsx("p",{className:"col-span-full text-center text-sm text-slate-500",children:"No spare parts added yet"}):p.map(k=>{var K;return e.jsxs("div",{className:"group relative flex items-center gap-4 rounded-2xl border border-slate-100 p-4 transition hover:border-slate-200 hover:shadow-sm",children:[k.imageUrl?e.jsx("img",{src:k.imageUrl,alt:k.name,className:"h-16 w-16 rounded-lg object-cover"}):e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-lg bg-slate-50 text-xs text-slate-400",children:"No image"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900 truncate",children:k.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:["SKU: ",k.sku]}),e.jsxs("p",{className:"mt-1 text-sm font-medium text-slate-600",children:["",(K=k.unitPrice)==null?void 0:K.toFixed(2)]})]}),e.jsxs("div",{className:"absolute right-2 top-2 flex gap-1 opacity-0 transition-opacity group-hover:opacity-100",children:[e.jsx("button",{type:"button",onClick:L=>G(k,L),className:"rounded-lg bg-white p-1.5 text-slate-600 shadow-sm transition hover:bg-slate-50 hover:text-blue-600",title:"Edit",children:e.jsx(Dt,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:L=>B(k,L),className:"rounded-lg bg-white p-1.5 text-slate-600 shadow-sm transition hover:bg-rose-50 hover:text-rose-600",title:"Delete",children:e.jsx(ts,{className:"h-4 w-4"})})]})]},k._id)})})})]}),e.jsx(Ue,{open:s,onClose:E,title:a?"Edit Spare Part":"Add Spare Part",children:e.jsxs("form",{className:"space-y-4",onSubmit:f.handleSubmit(C),children:[e.jsx(U,{label:"Name",...f.register("name",{required:!0})}),e.jsx(U,{label:"SKU",...f.register("sku",{required:!0}),disabled:!!a}),e.jsx(U,{type:"number",step:"0.01",label:"Unit price",...f.register("unitPrice",{valueAsNumber:!0,required:!0})}),e.jsx(U,{type:"file",accept:"image/*",label:"Upload image",onChange:w}),h&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:h,alt:"Spare part preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(W,{type:"button",variant:"secondary",onClick:E,children:"Cancel"}),e.jsx(W,{type:"submit",loading:Y.isPending||X.isPending,children:a?"Update":"Save"})]})]})}),e.jsx(Ue,{open:l,onClose:()=>c(!1),title:"Delete Spare Part",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-slate-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:u==null?void 0:u.name}),"? This action cannot be undone."]}),e.jsx("p",{className:"text-xs text-amber-600",children:" This spare part may be referenced in existing job cards. Deleting it will not affect historical records but it will no longer be available for new orders."}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(W,{type:"button",variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx(W,{type:"button",variant:"danger",onClick:I,loading:J.isPending,children:"Delete"})]})]})})]})},ai={name:"",email:"",phone:"",password:"",role:"technician",serviceItems:[],skills:[]},gu=()=>{const t=Ct(),s=ht({defaultValues:ai}),r=Md({control:s.control,name:"role"}),{data:a=[]}=je({queryKey:["technician-skills"],queryFn:Br.list}),i=le({mutationFn:$l.create,onSuccess:()=>{N.success("User created"),s.reset(ai)},onError:u=>{var b,f;return N.error(((f=(b=u==null?void 0:u.response)==null?void 0:b.data)==null?void 0:f.message)||"Failed to create user")}});o.useEffect(()=>{r==="admin"&&(s.setValue("serviceItems",[]),s.setValue("skills",[]))},[r,s]);const l=ht({defaultValues:{name:"",description:""}}),c=le({mutationFn:Br.create,onSuccess:()=>{N.success("Skill saved"),l.reset(),t.invalidateQueries({queryKey:["technician-skills"]})},onError:u=>{var b,f;return N.error(((f=(b=u==null?void 0:u.response)==null?void 0:b.data)==null?void 0:f.message)||"Failed to save skill")}});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Team"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Create Admin / Technician"})]}),e.jsx(Ke,{children:e.jsxs("form",{className:"grid gap-4 md:grid-cols-2",onSubmit:s.handleSubmit(u=>i.mutate(u)),children:[e.jsx(U,{label:"Full name",...s.register("name",{required:!0})}),e.jsx(U,{label:"Email",type:"email",...s.register("email",{required:!0})}),e.jsx(U,{label:"Phone",...s.register("phone",{required:!0})}),e.jsx(U,{label:"Password",type:"password",...s.register("password",{required:!0})}),e.jsxs(Je,{label:"Role",...s.register("role",{required:!0}),children:[e.jsx("option",{value:"technician",children:"Technician"}),e.jsx("option",{value:"admin",children:"Admin"})]}),r==="technician"&&e.jsx("div",{className:"col-span-2 grid gap-6",children:e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{className:"font-medium text-slate-900",children:"Technician skills"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Pick applicable trade skills (electrician, plumber, pest control, etc.)."}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[a.map(u=>e.jsxs("label",{className:"flex items-center gap-2 rounded-xl border border-slate-200 p-3",children:[e.jsx("input",{type:"checkbox",value:u._id,...s.register("skills"),className:"accent-slate-900"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:u.name})]},u._id)),!a.length&&e.jsx("span",{className:"text-xs text-slate-400",children:"Add skill types below to start tagging technicians."})]})]})}),e.jsx(W,{type:"submit",loading:i.isPending,className:"col-span-2",children:"Create User"})]})}),e.jsxs(Ke,{title:"Manage Technician Skills",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Add or update the skill taxonomy used when creating technicians."}),e.jsxs("form",{className:"mt-4 grid gap-4 md:grid-cols-2",onSubmit:l.handleSubmit(u=>c.mutate(u)),children:[e.jsx(U,{label:"Skill name",placeholder:"Electrician",...l.register("name",{required:!0})}),e.jsx(U,{label:"Description",placeholder:"Optional",...l.register("description")}),e.jsx(W,{type:"submit",loading:c.isPending,className:"md:col-span-2",children:"Save Skill"})]})]})]})},Js={label:"",dayOfWeek:0,startTime:"09:00",endTime:"10:00",intervalMinutes:60,capacity:1,isActive:!0},ni=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map((t,s)=>({label:t,value:s})),bu=()=>{const t=Ct(),[s,r]=o.useState(null),a=ht({defaultValues:Js}),{data:i=[],isLoading:l}=je({queryKey:["time-slots"],queryFn:Ns.list}),c=le({mutationFn:({slotId:h,data:p})=>h?Ns.update(h,p):Ns.create(p),onSuccess:()=>{N.success(`Time slot ${s?"updated":"created"}`),t.invalidateQueries({queryKey:["time-slots"]}),r(null),a.reset(Js)},onError:h=>{var p,w;return N.error(((w=(p=h==null?void 0:h.response)==null?void 0:p.data)==null?void 0:w.message)||"Unable to save time slot")}}),u=le({mutationFn:h=>Ns.remove(h),onSuccess:()=>{N.success("Time slot removed"),t.invalidateQueries({queryKey:["time-slots"]}),s&&s._id&&(r(null),a.reset(Js))},onError:h=>{var p,w;return N.error(((w=(p=h==null?void 0:h.response)==null?void 0:p.data)==null?void 0:w.message)||"Unable to delete slot")}});o.useEffect(()=>{s?a.reset({label:`${s.startTime}-${s.endTime}`,dayOfWeek:s.dayOfWeek,startTime:s.startTime,endTime:s.endTime,intervalMinutes:s.intervalMinutes??60,capacity:s.capacity??1,isActive:s.isActive??!0,_id:s._id}):a.reset(Js)},[s,a]);const b=h=>{const p={...h,intervalMinutes:h.intervalMinutes||60,capacity:h.capacity||1};c.mutate({slotId:s==null?void 0:s._id,data:p})},f=o.useMemo(()=>ni.map(h=>({day:h,entries:i.filter(p=>p.dayOfWeek===h.value)})),[i]);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Scheduling"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Time Slot Templates"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Control reusable availability windows used by admin scheduling tooling."})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[360px,1fr]",children:[e.jsx(Ke,{title:s?"Edit Time Slot":"Create Time Slot",children:e.jsxs("form",{className:"space-y-4",onSubmit:a.handleSubmit(b),children:[e.jsx(U,{label:"Label",placeholder:"Morning Prime",...a.register("label")}),e.jsx(Je,{label:"Day of week",...a.register("dayOfWeek",{setValueAs:h=>Number(h)}),children:ni.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(U,{type:"time",label:"Start",...a.register("startTime",{required:!0})}),e.jsx(U,{type:"time",label:"End",...a.register("endTime",{required:!0})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(U,{type:"number",label:"Interval (minutes)",min:15,step:15,...a.register("intervalMinutes",{valueAsNumber:!0,min:15})}),e.jsx(U,{type:"number",label:"Capacity",min:1,step:1,...a.register("capacity",{valueAsNumber:!0,min:1})})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 accent-slate-900",...a.register("isActive")}),"Active"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(W,{type:"submit",loading:c.isPending,className:"flex-1",children:s?"Update Slot":"Create Slot"}),s&&e.jsx(W,{type:"button",variant:"secondary",onClick:()=>r(null),children:"Cancel"})]})]})}),e.jsx(Ke,{title:"Configured Slots",children:l?e.jsx("p",{className:"text-sm text-slate-500",children:"Loading time slots"}):e.jsx("div",{className:"space-y-5",children:f.map(({day:h,entries:p})=>e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:h.label}),e.jsxs("div",{className:"mt-2 space-y-3",children:[p.length===0&&e.jsx("p",{className:"text-sm text-slate-300",children:"No slots configured."}),p.map(w=>e.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl border border-slate-100 bg-white p-4 shadow-sm sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:w.label||`${w.startTime}  ${w.endTime}`}),e.jsxs("p",{className:"text-xs text-slate-500",children:[w.startTime,"  ",w.endTime,"  every ",w.intervalMinutes,"m  capacity ",w.capacity]}),!w.isActive&&e.jsx("p",{className:"text-xs text-rose-500",children:"Inactive"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(W,{variant:"secondary",onClick:()=>r(w),children:"Edit"}),e.jsx(W,{variant:"secondary",className:"text-rose-600",onClick:()=>w._id&&u.mutate(w._id),loading:u.isPending&&u.variables===w._id,children:"Delete"})]})]},w._id))]})]},h.value))})})]})]})},yu=[{value:"present",label:"Present"},{value:"absent",label:"Absent"},{value:"on_leave",label:"On leave"}],vu=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"suspended",label:"Suspended"}],ii=()=>new Date().toISOString().split("T")[0],li=(t,s)=>{if(!t||!s)return;const r=s.length===5?`${s}:00`:s;return new Date(`${t}T${r}`).toISOString()},ju=()=>{var be,ye,Se,De,ke,Fe;const t=Ct(),[s,r]=mi(),[a,i]=o.useState(null),[l,c]=o.useState(()=>s.get("selected")),[u,b]=o.useState(!1),[f,h]=o.useState(null),{data:p=[],isLoading:w}=je({queryKey:["technicians"],queryFn:Xt.list}),{data:Y=[]}=je({queryKey:["categories"],queryFn:Ie.categories,enabled:u}),{data:X=[]}=je({queryKey:["all-service-items"],queryFn:()=>Ie.serviceItems(),enabled:u}),{data:J=[]}=je({queryKey:["technician-skills"],queryFn:Br.list,enabled:u});o.useEffect(()=>{if(l&&p.length>0&&!w){const y=p.find(ue=>ue.id===l);y&&i(y),c(null);const ae=new URLSearchParams(s);ae.delete("selected"),r(ae,{replace:!0})}},[p,l,w,s,r]);const{data:M=[],isFetching:G}=je({queryKey:["technician-attendance",a==null?void 0:a.id],queryFn:()=>Xt.attendance(a.id),enabled:!!(a!=null&&a.id)}),B=ht({defaultValues:{date:ii(),status:"present",checkInTime:"09:00",checkOutTime:"18:00"}}),C=ht({defaultValues:{name:"",email:"",phone:"",status:"active",experienceYears:0,workingHoursStart:"08:00",workingHoursEnd:"20:00",selectedSkills:[],selectedServiceItems:[],selectedServiceCategories:[]}});o.useEffect(()=>{B.reset({date:ii(),status:"present",checkInTime:"09:00",checkOutTime:"18:00",note:""})},[B,a]);const I=le({mutationFn:y=>{if(!a)throw new Error("Select a technician");return Xt.markAttendance(a.id,{date:y.date,status:y.status,checkInAt:li(y.date,y.checkInTime),checkOutAt:li(y.date,y.checkOutTime),note:y.note})},onSuccess:()=>{N.success("Attendance updated"),a&&t.invalidateQueries({queryKey:["technician-attendance",a.id]}),t.invalidateQueries({queryKey:["technicians"]})},onError:y=>{var ae,ue;return N.error(((ue=(ae=y==null?void 0:y.response)==null?void 0:ae.data)==null?void 0:ue.message)||"Unable to save attendance")}}),E=le({mutationFn:y=>{if(!f)throw new Error("No technician selected");return Xt.update(f.id,{name:y.name,email:y.email,phone:y.phone,status:y.status,experienceYears:y.experienceYears,workingHours:{start:y.workingHoursStart,end:y.workingHoursEnd},skills:y.selectedSkills,serviceItems:y.selectedServiceItems,serviceCategories:y.selectedServiceCategories})},onSuccess:y=>{N.success("Technician updated successfully"),t.invalidateQueries({queryKey:["technicians"]}),b(!1),h(null),(a==null?void 0:a.id)===y.id&&i(y)},onError:y=>{var ae,ue;return N.error(((ue=(ae=y==null?void 0:y.response)==null?void 0:ae.data)==null?void 0:ue.message)||"Failed to update technician")}}),k=o.useMemo(()=>M.slice(0,10),[M]),K=(y,ae)=>{var ue,Qe,_,ee,se;ae==null||ae.stopPropagation(),h(y),C.reset({name:y.name||"",email:y.email||"",phone:y.phone||"",status:y.status||"active",experienceYears:y.experienceYears||0,workingHoursStart:((ue=y.workingHours)==null?void 0:ue.start)||"08:00",workingHoursEnd:((Qe=y.workingHours)==null?void 0:Qe.end)||"20:00",selectedSkills:((_=y.skills)==null?void 0:_.map(xe=>typeof xe=="string"?xe:xe.id||xe._id||"").filter(Boolean))||[],selectedServiceItems:((ee=y.serviceItems)==null?void 0:ee.map(xe=>xe.id||xe._id||"").filter(Boolean))||[],selectedServiceCategories:((se=y.serviceCategories)==null?void 0:se.map(xe=>xe.id||xe._id||"").filter(Boolean))||[]}),b(!0)},L=()=>{b(!1),h(null),C.reset()},pe=y=>{const ae=C.getValues("selectedSkills");ae.includes(y)?C.setValue("selectedSkills",ae.filter(ue=>ue!==y)):C.setValue("selectedSkills",[...ae,y])},O=y=>{const ae=C.getValues("selectedServiceItems");ae.includes(y)?C.setValue("selectedServiceItems",ae.filter(ue=>ue!==y)):C.setValue("selectedServiceItems",[...ae,y])},z=y=>{const ae=C.getValues("selectedServiceCategories");ae.includes(y)?C.setValue("selectedServiceCategories",ae.filter(ue=>ue!==y)):C.setValue("selectedServiceCategories",[...ae,y])},$=C.watch("selectedSkills"),re=C.watch("selectedServiceItems"),V=C.watch("selectedServiceCategories");return e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"flex flex-wrap items-end justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Operations"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Technician Roster"})]})}),e.jsx(Ke,{title:"Technicians",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs uppercase tracking-wide text-slate-500",children:[e.jsx("th",{className:"px-4 py-3",children:"Name"}),e.jsx("th",{className:"px-4 py-3",children:"Contact"}),e.jsx("th",{className:"px-4 py-3",children:"Skills"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3",children:"Today"}),e.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[w&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-6 text-center text-slate-400",children:"Loading technicians"})}),!w&&p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-6 text-center text-slate-400",children:"No technicians found. Create technician users to populate this list."})}),p.map(y=>{var ae;return e.jsxs("tr",{className:"cursor-pointer transition hover:bg-slate-50",onClick:()=>i(y),children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:y.name}),e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-500",children:[y.phone||"",e.jsx("span",{className:"block text-xs text-slate-400",children:y.email||""})]}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-500",children:(ae=y.skills)!=null&&ae.length?y.skills.slice(0,3).join(", "):"Generalist"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`text-xs uppercase tracking-wide px-2 py-1 rounded-full ${y.status==="active"?"bg-emerald-50 text-emerald-700":y.status==="inactive"?"bg-slate-100 text-slate-600":"bg-rose-50 text-rose-700"}`,children:y.status||"active"})}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-500",children:y.todayAttendance?y.todayAttendance.status:"Not marked"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{type:"button",onClick:ue=>K(y,ue),className:"p-1.5 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors",title:"Edit technician",children:e.jsx(Dt,{className:"h-4 w-4"})})})]},y.id)})]})]})})}),e.jsx(Ji,{open:!!a,onClose:()=>i(null),title:(a==null?void 0:a.name)||"Technician",children:a&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-2xl border border-slate-200 p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Contact"}),e.jsx("p",{className:"text-base font-semibold text-slate-900",children:a.phone||""}),e.jsx("p",{className:"text-sm text-slate-500",children:a.email||""}),a.workingHours&&e.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["Hours ",a.workingHours.start||"--","  ",a.workingHours.end||"--"]})]}),e.jsx(W,{variant:"secondary",onClick:()=>K(a),icon:e.jsx(Dt,{className:"h-4 w-4"}),children:"Edit"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Skills"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:[(be=a.skills)==null?void 0:be.map(y=>e.jsx("span",{className:"rounded-full bg-emerald-50 px-3 py-1 text-emerald-700",children:y},y)),!((ye=a.skills)!=null&&ye.length)&&e.jsx("span",{className:"text-slate-400",children:"No skills tagged."})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Service items"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:[(Se=a.serviceItems)==null?void 0:Se.map(y=>e.jsx("span",{className:"rounded-full bg-slate-100 px-3 py-1",children:y.name},y.id||y.name)),!((De=a.serviceItems)!=null&&De.length)&&e.jsx("span",{className:"text-slate-400",children:"No service items mapped."})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Service categories"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:[(ke=a.serviceCategories)==null?void 0:ke.map(y=>e.jsx("span",{className:"rounded-full bg-blue-50 px-3 py-1 text-blue-700",children:y.name},y.id||y.name)),!((Fe=a.serviceCategories)!=null&&Fe.length)&&e.jsx("span",{className:"text-slate-400",children:"No categories mapped."})]})]})]}),e.jsx(Ke,{title:"Mark attendance",children:e.jsxs("form",{className:"space-y-4",onSubmit:B.handleSubmit(y=>I.mutate(y)),children:[e.jsx(U,{type:"date",label:"Date",...B.register("date",{required:!0})}),e.jsx(Je,{label:"Status",...B.register("status",{required:!0}),children:yu.map(y=>e.jsx("option",{value:y.value,children:y.label},y.value))}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(U,{type:"time",label:"Check-in",...B.register("checkInTime")}),e.jsx(U,{type:"time",label:"Check-out",...B.register("checkOutTime")})]}),e.jsx(It,{label:"Notes",rows:3,...B.register("note")}),e.jsx(W,{type:"submit",loading:I.isPending,children:"Save attendance"})]})}),e.jsxs(Ke,{title:"Attendance history",children:[G&&e.jsx("p",{className:"text-sm text-slate-400",children:"Loading attendance"}),!G&&k.length===0&&e.jsx("p",{className:"text-sm text-slate-400",children:"No attendance records found."}),!G&&k.length>0&&e.jsx("ul",{className:"space-y-3",children:k.map(y=>e.jsxs("li",{className:"rounded-xl border border-slate-100 p-3",children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:[new Date(y.date).toLocaleDateString("en-IN",{weekday:"short",day:"numeric",month:"short"}),e.jsx("span",{className:"ml-2 text-xs uppercase tracking-wide text-slate-500",children:y.status})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[y.checkInAt?`In: ${qe(y.checkInAt)}`:"No check-in"," "," ",y.checkOutAt?`Out: ${qe(y.checkOutAt)}`:"No check-out"]}),y.note&&e.jsx("p",{className:"text-xs text-slate-500",children:y.note})]},y._id||y.date))})]})]})}),e.jsx(Ue,{open:u,onClose:L,title:`Edit ${(f==null?void 0:f.name)||"Technician"}`,size:"xl",children:e.jsxs("form",{className:"space-y-6",onSubmit:C.handleSubmit(y=>E.mutate(y)),children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(U,{label:"Name *",...C.register("name",{required:!0})}),e.jsx(U,{label:"Email",type:"email",...C.register("email")}),e.jsx(U,{label:"Phone",...C.register("phone")}),e.jsx(Je,{label:"Status",...C.register("status"),children:vu.map(y=>e.jsx("option",{value:y.value,children:y.label},y.value))})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Work Details"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsx(U,{label:"Experience (years)",type:"number",step:"0.5",min:"0",...C.register("experienceYears",{valueAsNumber:!0})}),e.jsx(U,{label:"Working hours start",type:"time",...C.register("workingHoursStart")}),e.jsx(U,{label:"Working hours end",type:"time",...C.register("workingHoursEnd")})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Skills"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[J.map(y=>e.jsx("button",{type:"button",onClick:()=>pe(y._id),className:`rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${$.includes(y._id)?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:y.name},y._id)),J.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No skills available. Create skills in settings."})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Service Categories"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Y.map(y=>e.jsx("button",{type:"button",onClick:()=>z(y._id),className:`rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${V.includes(y._id)?"bg-blue-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:y.name},y._id)),Y.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No categories available."})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Service Items (Sub-categories)"}),e.jsx("div",{className:"max-h-48 overflow-y-auto border border-slate-200 rounded-xl p-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[X.map(y=>e.jsx("button",{type:"button",onClick:()=>O(y._id),className:`rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${re.includes(y._id)?"bg-slate-900 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:y.name},y._id)),X.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No service items available."})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(W,{type:"button",variant:"ghost",onClick:L,children:"Cancel"}),e.jsx(W,{type:"submit",loading:E.isPending,children:"Save Changes"})]})]})})]})},wu=()=>{const[t,s]=o.useState(null),[r,a]=o.useState(!1),[i,l]=o.useState(!1),[c,u]=o.useState(!1),[b,f]=o.useState(null),[h,p]=o.useState(!1),[w,Y]=o.useState(""),[X,J]=o.useState(""),[M,G]=o.useState(""),[B,C]=o.useState(""),[I,E]=o.useState(""),[k,K]=o.useState(""),[L,pe]=o.useState(""),[O,z]=o.useState(""),[$,re]=o.useState(""),[V,be]=o.useState(""),[ye,Se]=o.useState(""),[De,ke]=o.useState(""),[Fe,y]=o.useState(""),[ae,ue]=o.useState(""),[Qe,_]=o.useState(""),[ee,se]=o.useState(""),[xe,ze]=o.useState(""),Ze=Ct(),{data:tt=[],isLoading:st}=je({queryKey:["customers"],queryFn:wt.list}),{data:fe,refetch:pt}=je({queryKey:["customer-details",t==null?void 0:t.phone],queryFn:()=>t!=null&&t.phone?wt.findByPhone(t.phone):null,enabled:!!(t&&r)}),{data:lt=[]}=je({queryKey:["customer-orders",t==null?void 0:t.id],queryFn:()=>Ee.list({customerId:t.id}),enabled:!!(t&&r)}),xt=le({mutationFn:v=>wt.update(t.id,v),onSuccess:v=>{N.success("Customer updated successfully"),Ze.invalidateQueries({queryKey:["customers"]}),Ze.invalidateQueries({queryKey:["customer-details"]}),l(!1),v&&s(v)},onError:v=>{var he,ge;return N.error(((ge=(he=v==null?void 0:v.response)==null?void 0:he.data)==null?void 0:ge.message)||"Failed to update customer")}}),Lt=le({mutationFn:v=>wt.updateAddress(t.id,v),onSuccess:()=>{N.success(b?"Address updated successfully":"Address added successfully"),Ze.invalidateQueries({queryKey:["customer-details"]}),u(!1),oe(),pt()},onError:v=>{var he,ge;return N.error(((ge=(he=v==null?void 0:v.response)==null?void 0:he.data)==null?void 0:ge.message)||"Failed to update address")}}),Mt=le({mutationFn:v=>wt.deleteAddress(t.id,v),onSuccess:()=>{N.success("Address deleted successfully"),Ze.invalidateQueries({queryKey:["customer-details"]}),pt()},onError:v=>{var he,ge;return N.error(((ge=(he=v==null?void 0:v.response)==null?void 0:he.data)==null?void 0:ge.message)||"Failed to delete address")}}),kt=le({mutationFn:v=>wt.create(v),onSuccess:()=>{N.success("Customer created successfully"),Ze.invalidateQueries({queryKey:["customers"]}),p(!1),m()},onError:v=>{var he,ge;return N.error(((ge=(he=v==null?void 0:v.response)==null?void 0:he.data)==null?void 0:ge.message)||"Failed to create customer")}}),m=()=>{C(""),E(""),K(""),pe(""),z(""),re(""),be(""),Se("")},g=()=>{if(!B.trim()){N.error("Name is required");return}if(!k.trim()){N.error("Phone number is required");return}const v={name:B.trim(),phone:k.trim(),email:I.trim()||void 0};L.trim()&&$.trim()&&V.trim()&&(v.address={line1:L.trim(),line2:O.trim()||void 0,city:$.trim(),state:V.trim(),postalCode:ye.trim()||void 0}),kt.mutate(v)},j=v=>{s(v),a(!0)},D=()=>{a(!1),setTimeout(()=>s(null),200)},P=()=>{t&&(Y((fe==null?void 0:fe.name)||t.name||""),J((fe==null?void 0:fe.email)||t.email||""),G((fe==null?void 0:fe.phone)||t.phone||""),l(!0))},A=()=>{if(!w.trim()){N.error("Name is required");return}xt.mutate({name:w.trim(),email:X.trim()||void 0,phone:M.trim()||void 0})},q=v=>{v?(f(v),ke(v.label||""),y(v.line1||""),ue(v.line2||""),_(v.city||""),se(v.state||""),ze(v.postalCode||"")):(f(null),oe()),u(!0)},oe=()=>{f(null),ke(""),y(""),ue(""),_(""),se(""),ze("")},ce=()=>{if(!Fe.trim()||!Qe.trim()||!ee.trim()){N.error("Address line 1, city, and state are required");return}Lt.mutate({line1:Fe.trim(),line2:ae.trim()||void 0,city:Qe.trim(),state:ee.trim(),postalCode:xe.trim()||void 0,addressId:b==null?void 0:b.id})},Le=v=>{window.confirm("Are you sure you want to delete this address?")&&Mt.mutate(v)};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Customers"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Customer Directory"})]}),e.jsx(W,{onClick:()=>p(!0),icon:e.jsx(Fn,{className:"h-4 w-4"}),children:"Add Customer"})]}),e.jsx(Ke,{title:"Customers",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs uppercase tracking-wide text-slate-500",children:[e.jsx("th",{className:"px-4 py-3",children:"Name"}),e.jsx("th",{className:"px-4 py-3",children:"Contact"}),e.jsx("th",{className:"px-4 py-3",children:"City"}),e.jsx("th",{className:"px-4 py-3",children:"Address"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[st&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-slate-400",children:"Loading customers"})}),!st&&tt.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-slate-400",children:"No customers found."})}),tt.map(v=>e.jsxs("tr",{className:"cursor-pointer hover:bg-slate-50 transition-colors",onClick:()=>j(v),children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:v.name}),e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-500",children:[v.phone||"",e.jsx("span",{className:"block text-xs text-slate-400",children:v.email||""})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-500",children:v.city||""}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-500",children:[v.addressLine1,v.addressLine2,v.postalCode].filter(Boolean).join(", ")||""})]},v.id))]})]})})}),e.jsx(Ue,{open:r,onClose:D,title:(t==null?void 0:t.name)||"Customer Details",size:"xl",showCloseButton:!0,children:t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Contact Information"}),e.jsx(W,{variant:"secondary",onClick:P,icon:e.jsx(Dt,{className:"h-4 w-4"}),children:"Edit"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Name"}),e.jsx("p",{className:"font-medium text-slate-900",children:(fe==null?void 0:fe.name)||t.name||""})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Phone"}),e.jsx("p",{className:"font-medium text-slate-900",children:(fe==null?void 0:fe.phone)||t.phone||""})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email"}),e.jsx("p",{className:"font-medium text-slate-900",children:(fe==null?void 0:fe.email)||t.email||""})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Addresses"}),e.jsx(W,{variant:"secondary",onClick:()=>q(),icon:e.jsx(Fn,{className:"h-4 w-4"}),children:"Add Address"})]}),fe!=null&&fe.addresses&&fe.addresses.length>0?e.jsx("div",{className:"space-y-3",children:fe.addresses.map((v,he)=>e.jsx("div",{className:"rounded-lg border border-slate-200 p-3 bg-slate-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[v.label&&e.jsx("p",{className:"text-xs font-semibold text-slate-700 mb-1",children:v.label}),e.jsx("p",{className:"text-sm text-slate-900",children:v.line1}),v.line2&&e.jsx("p",{className:"text-sm text-slate-600",children:v.line2}),e.jsx("p",{className:"text-sm text-slate-600",children:[v.city,v.state,v.postalCode].filter(Boolean).join(", ")}),v.phone&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Phone: ",v.phone]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[v.isDefault&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-xs font-medium",children:"Default"}),e.jsx("button",{type:"button",onClick:ge=>{ge.stopPropagation(),q(v)},className:"p-1.5 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors",title:"Edit address",children:e.jsx(Dt,{className:"h-4 w-4"})}),!v.isDefault&&e.jsx("button",{type:"button",onClick:ge=>{ge.stopPropagation(),Le(v.id)},disabled:Mt.isPending,className:"p-1.5 rounded-lg text-rose-500 hover:text-rose-700 hover:bg-rose-50 transition-colors disabled:opacity-50",title:"Delete address",children:e.jsx(ts,{className:"h-4 w-4"})})]})]})},v.id||he))}):e.jsx("p",{className:"text-sm text-slate-500",children:"No addresses on file"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:["Order History (",lt.length,")"]}),lt.length>0?e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:lt.map(v=>{var he;return e.jsx("div",{className:"rounded-lg border border-slate-200 p-3 hover:bg-slate-50 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:["#",v._id.slice(-8)]}),e.jsx(ks,{variant:v.status,children:v.status})]}),e.jsx("p",{className:"text-xs text-slate-600",children:typeof v.serviceItem=="string"?v.serviceItem:((he=v.serviceItem)==null?void 0:he.name)||"Service"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Scheduled: ",qe(v.timeWindowStart)]})]})})},v._id)})}):e.jsx("p",{className:"text-sm text-slate-500",children:"No orders found"})]})]})}),e.jsx(Ue,{open:i,onClose:()=>l(!1),title:"Edit Customer",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(U,{label:"Name *",value:w,onChange:v=>Y(v.target.value),placeholder:"Customer name"}),e.jsx(U,{label:"Email",type:"email",value:X,onChange:v=>J(v.target.value),placeholder:"customer@email.com"}),e.jsx(U,{label:"Phone",value:M,onChange:v=>G(v.target.value),placeholder:"Phone number"}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(W,{onClick:A,loading:xt.isPending,children:"Save Changes"}),e.jsx(W,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"})]})]})}),e.jsx(Ue,{open:c,onClose:()=>{u(!1),oe()},title:b?"Edit Address":"Add Address",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(U,{label:"Label (optional)",value:De,onChange:v=>ke(v.target.value),placeholder:"e.g. Home, Office"}),e.jsx(U,{label:"Address Line 1 *",value:Fe,onChange:v=>y(v.target.value),placeholder:"Street address"}),e.jsx(U,{label:"Address Line 2",value:ae,onChange:v=>ue(v.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(U,{label:"City *",value:Qe,onChange:v=>_(v.target.value),placeholder:"City"}),e.jsx(U,{label:"State *",value:ee,onChange:v=>se(v.target.value),placeholder:"State"})]}),e.jsx(U,{label:"Postal Code",value:xe,onChange:v=>ze(v.target.value),placeholder:"PIN Code"}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(W,{onClick:ce,loading:Lt.isPending,children:b?"Update Address":"Add Address"}),e.jsx(W,{variant:"secondary",onClick:()=>{u(!1),oe()},children:"Cancel"})]})]})}),e.jsx(Ue,{open:h,onClose:()=>{p(!1),m()},title:"Add New Customer",size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Contact Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(U,{label:"Name *",value:B,onChange:v=>C(v.target.value),placeholder:"Customer name"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(U,{label:"Phone *",value:k,onChange:v=>K(v.target.value),placeholder:"Phone number"}),e.jsx(U,{label:"Email",type:"email",value:I,onChange:v=>E(v.target.value),placeholder:"customer@email.com"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Address (Optional)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(U,{label:"Address Line 1",value:L,onChange:v=>pe(v.target.value),placeholder:"Street address"}),e.jsx(U,{label:"Address Line 2",value:O,onChange:v=>z(v.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(U,{label:"City",value:$,onChange:v=>re(v.target.value),placeholder:"City"}),e.jsx(U,{label:"State",value:V,onChange:v=>be(v.target.value),placeholder:"State"}),e.jsx(U,{label:"Postal Code",value:ye,onChange:v=>Se(v.target.value),placeholder:"PIN Code"})]})]}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"If you provide an address, line 1, city, and state are required."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(W,{onClick:g,loading:kt.isPending,children:"Create Customer"}),e.jsx(W,{variant:"secondary",onClick:()=>{p(!1),m()},children:"Cancel"})]})]})})]})},Vt={async listBanners(t){const s=t!==void 0?{isActive:t}:{},{data:r}=await Z.get("/banners",{params:s});return r.data},async getBanner(t){const{data:s}=await Z.get(`/banners/${t}`);return s.data},async createBanner(t){const{data:s}=await Z.post("/banners",t);return s.data},async updateBanner(t,s){const{data:r}=await Z.put(`/banners/${t}`,s);return r.data},async deleteBanner(t){const{data:s}=await Z.delete(`/banners/${t}`);return s.data},async toggleBannerStatus(t){const{data:s}=await Z.patch(`/banners/${t}/toggle`);return s.data},async reorderBanners(t){const{data:s}=await Z.post("/banners/reorder",{banners:t});return s.data},async uploadImage(t){const s=new FormData;s.append("image",t);const{data:r}=await Z.post("/banners/upload/image",s,{headers:{"Content-Type":"multipart/form-data"}}),a="https://admin.fixzep.com/api",i=r.data.imageUrl;return i.startsWith("http")?i:`${a.replace("/api","")}${i}`}},Nu=()=>{const[t,s]=o.useState([]),[r,a]=o.useState(!0),[i,l]=o.useState("");o.useEffect(()=>{c()},[]);const c=async()=>{try{a(!0);const f=await Vt.listBanners();s(f),l("")}catch(f){l("Failed to load banners"),console.error(f)}finally{a(!1)}},u=async f=>{if(window.confirm("Are you sure you want to delete this banner?"))try{await Vt.deleteBanner(f),s(t.filter(h=>h._id!==f))}catch(h){l("Failed to delete banner"),console.error(h)}},b=async f=>{try{const h=await Vt.toggleBannerStatus(f);s(t.map(p=>p._id===f?h:p))}catch(h){l("Failed to toggle banner status"),console.error(h)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Banners"}),e.jsx("a",{href:"/banners/new",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700",children:"+ Create Banner"})]}),i&&e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-sm text-red-700",children:i}),r?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"Loading banners..."})}):t.length===0?e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-12 text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"No banners yet"}),e.jsx("a",{href:"/banners/new",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700",children:"Create your first banner"})]}):e.jsx("div",{className:"grid gap-6",children:t.map(f=>e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"grid grid-cols-4 gap-6",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("img",{src:f.imageUrl,alt:f.title,className:"rounded-lg w-full h-32 object-cover"})}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:f.title}),f.subtitle&&e.jsx("p",{className:"text-sm text-gray-600",children:f.subtitle}),f.link&&e.jsx("p",{className:"text-sm text-blue-600 truncate",children:e.jsx("a",{href:f.link,target:"_blank",rel:"noopener noreferrer",children:f.link})}),f.startDate&&f.endDate&&e.jsxs("p",{className:"text-xs text-gray-500",children:[new Date(f.startDate).toLocaleDateString()," -"," ",new Date(f.endDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"col-span-1 flex flex-col gap-2 justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-xs font-semibold ${f.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:f.isActive?"Active":"Inactive"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>b(f._id),className:"flex-1 rounded-lg text-xs font-medium px-3 py-2 border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:f.isActive?"Deactivate":"Activate"}),e.jsx("a",{href:`/banners/${f._id}`,className:"flex-1 rounded-lg text-xs font-medium px-3 py-2 bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors text-center",children:"Edit"}),e.jsx("button",{onClick:()=>u(f._id),className:"flex-1 rounded-lg text-xs font-medium px-3 py-2 border border-red-200 text-red-700 hover:bg-red-50 transition-colors",children:"Delete"})]})]})]})},f._id))})]})},oi=()=>{const t=lr(),{bannerId:s}=hi(),r=o.useRef(null),[a,i]=o.useState(!!s),[l,c]=o.useState(!1),[u,b]=o.useState(!1),[f,h]=o.useState(""),[p,w]=o.useState({title:"",subtitle:"",imageUrl:"",link:"",isActive:!0,startDate:"",endDate:""});o.useEffect(()=>{s&&Y()},[s]);const Y=async()=>{if(s)try{i(!0);const G=await Vt.getBanner(s);w(G),h("")}catch(G){h("Failed to load banner"),console.error(G)}finally{i(!1)}},X=G=>{const{name:B,value:C,type:I}=G.target;w(E=>({...E,[B]:I==="checkbox"?G.target.checked:C}))},J=async G=>{var C;const B=(C=G.target.files)==null?void 0:C[0];if(B){b(!0),h("");try{const I=await Vt.uploadImage(B);w(E=>({...E,imageUrl:I}))}catch(I){h("Failed to upload image"),console.error(I)}finally{b(!1),r.current&&(r.current.value="")}}},M=async G=>{G.preventDefault(),c(!0),h("");try{s?await Vt.updateBanner(s,p):await Vt.createBanner(p),t("/banners")}catch(B){h(`Failed to ${s?"update":"create"} banner`),console.error(B)}finally{c(!1)}};return a?e.jsx("div",{className:"text-center py-12",children:"Loading..."}):e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s?"Edit Banner":"Create Banner"})}),f&&e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-sm text-red-700",children:f}),e.jsxs("form",{onSubmit:M,className:"space-y-6 bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),e.jsx("input",{type:"text",name:"title",required:!0,value:p.title||"",onChange:X,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"Banner title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subtitle"}),e.jsx("input",{type:"text",name:"subtitle",value:p.subtitle||"",onChange:X,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"Banner subtitle"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL *"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"url",name:"imageUrl",required:!0,value:p.imageUrl||"",onChange:X,className:"flex-1 rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"https://example.com/image.jpg"}),e.jsx("button",{type:"button",onClick:()=>{var G;return(G=r.current)==null?void 0:G.click()},disabled:u,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg border border-gray-300 text-sm font-medium disabled:opacity-60",children:u?"Uploading...":"Upload"})]}),e.jsx("input",{ref:r,type:"file",accept:"image/*",onChange:J,className:"hidden"})]}),p.imageUrl&&e.jsx("img",{src:p.imageUrl,alt:"Preview",className:"mt-3 rounded-lg max-h-48 object-cover"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link"}),e.jsx("input",{type:"url",name:"link",value:p.link||"",onChange:X,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"https://example.com"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"datetime-local",name:"startDate",value:p.startDate||"",onChange:X,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"datetime-local",name:"endDate",value:p.endDate||"",onChange:X,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"isActive",name:"isActive",checked:p.isActive||!1,onChange:X,className:"h-4 w-4 rounded border-gray-300"}),e.jsx("label",{className:"text-sm font-medium text-gray-700",htmlFor:"isActive",children:"Active"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:l,className:"flex-1 rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 disabled:opacity-60",children:l?"Saving...":"Save Banner"}),e.jsx("button",{type:"button",onClick:()=>t("/banners"),className:"flex-1 rounded-lg border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50",children:"Cancel"})]})]})]})},Su=()=>e.jsxs(Ol,{children:[e.jsx(We,{path:"/login",element:e.jsx(tu,{})}),e.jsxs(We,{element:e.jsx(Oo,{children:e.jsx(Pd,{})}),children:[e.jsx(We,{path:"/",element:e.jsx(ru,{})}),e.jsx(We,{path:"/orders",element:e.jsx(hu,{})}),e.jsx(We,{path:"/customers",element:e.jsx(wu,{})}),e.jsx(We,{path:"/catalog",element:e.jsx(pu,{})}),e.jsx(We,{path:"/catalog/:categoryId",element:e.jsx(xu,{})}),e.jsx(We,{path:"/technicians",element:e.jsx(ju,{})}),e.jsx(We,{path:"/spare-parts",element:e.jsx(fu,{})}),e.jsx(We,{path:"/time-slots",element:e.jsx(bu,{})}),e.jsx(We,{path:"/users/new",element:e.jsx(gu,{})}),e.jsx(We,{path:"/banners",element:e.jsx(Nu,{})}),e.jsx(We,{path:"/banners/new",element:e.jsx(oi,{})}),e.jsx(We,{path:"/banners/:bannerId",element:e.jsx(oi,{})})]}),e.jsx(We,{path:"*",element:e.jsx(ui,{to:"/",replace:!0})})]}),Cu=new Ll({defaultOptions:{queries:{staleTime:6e4,refetchOnWindowFocus:!1,retry:1}}});pi(document.getElementById("root")).render(e.jsx(o.StrictMode,{children:e.jsx(Ml,{client:Cu,children:e.jsx(To,{children:e.jsx(_d,{children:e.jsxs(Rl,{children:[e.jsx(Su,{}),e.jsx(Ao,{position:"top-right"})]})})})})}));
