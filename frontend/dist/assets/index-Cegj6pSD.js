import{j as e,q as Gt,_ as es}from"./ui-BsaTBtI9.js";import{a as Bn,r as o,N as $n,b as el,O as tl,m as je,u as tr,L as Zt,c as qn,d as Un,R as sl,f as Ve,B as rl}from"./vendor-BVDAFvKx.js";import{a as al,A as nl,c as il,u as St,b as ge,d as ne,Q as ll,e as ol}from"./data-CsO4I2n7.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(i){if(i.ep)return;i.ep=!0;const l=r(i);fetch(i.href,l)}})();var Vn,on=Bn;Vn=on.createRoot,on.hydrateRoot;const H=al.create({baseURL:"https://admin.eopsys.xyz/api",timeout:15e3});H.interceptors.request.use(t=>{const s=localStorage.getItem("fixzep_token");if(s){const r=nl.from(t.headers);r.set("Authorization",`Bearer ${s}`),t.headers=r}return t});const J=async t=>(await t).data.data,cl={login:t=>J(H.post("/auth/login",t))},Ee={list:(t={})=>J(H.get("/admin/orders",{params:t})),create:t=>J(H.post("/admin/orders",t)),assign:(t,s)=>J(H.post(`/admin/orders/${t}/assign`,{technicianId:s})),candidates:t=>J(H.get(`/admin/orders/${t}/technicians`)),jobCard:t=>J(H.get(`/admin/orders/${t}/jobcard`)),reschedule:(t,s)=>J(H.post(`/orders/${t}/reschedule`,s)),changeStatus:(t,s)=>J(H.post(`/admin/orders/${t}/status`,s)),uploadMedia:(t,s)=>J(H.post(`/admin/orders/${t}/media`,s)),deleteMedia:(t,s)=>J(H.delete(`/admin/orders/${t}/media/${s}`)),updatePaymentStatus:(t,s)=>J(H.post(`/admin/orders/${t}/payment-status`,s)),addHistoryNote:(t,s)=>J(H.post(`/admin/orders/${t}/history`,s)),addSparePart:(t,s)=>J(H.post(`/admin/orders/${t}/spare-parts`,s)),removeSparePart:(t,s)=>J(H.delete(`/admin/orders/${t}/spare-parts/${s}`)),addAdditionalService:(t,s)=>J(H.post(`/admin/orders/${t}/additional-services`,s)),removeAdditionalService:(t,s)=>J(H.delete(`/admin/orders/${t}/additional-services/${s}`))},Pe={categories:()=>J(H.get("/admin/categories")),serviceItems:t=>J(H.get("/admin/service-items",{params:t?{categoryId:t}:void 0})),upsertCategory:t=>J(H.post("/admin/categories",t)),updateCategory:(t,s)=>J(H.put(`/admin/categories/${t}`,s)),deleteCategory:t=>J(H.delete(`/admin/categories/${t}`)),upsertServiceItem:t=>J(H.post("/admin/service-items",t)),updateServiceItem:(t,s)=>J(H.put(`/admin/service-items/${t}`,s)),deleteServiceItem:t=>J(H.delete(`/admin/service-items/${t}`))},Or={list:()=>J(H.get("/admin/spare-parts")),upsert:t=>J(H.post("/admin/spare-parts",t))},Dr={list:()=>J(H.get("/admin/technician-skills")),create:t=>J(H.post("/admin/technician-skills",t))},dl={create:t=>J(H.post("/admin/users",t))},Xt={list:()=>J(H.get("/admin/technicians")),get:t=>J(H.get(`/admin/technicians/${t}`)),update:(t,s)=>J(H.put(`/admin/technicians/${t}`,s)),availability:t=>J(H.get(`/admin/technicians/${t}/availability`)),schedule:(t,s)=>J(H.get(`/admin/technicians/${t}/schedule`,{params:s})),attendance:t=>J(H.get(`/admin/technicians/${t}/attendance`)),markAttendance:(t,s)=>J(H.post(`/admin/technicians/${t}/attendance`,s))},bs={list:()=>J(H.get("/admin/time-slots")),create:t=>J(H.post("/admin/time-slots",t)),update:(t,s)=>J(H.put(`/admin/time-slots/${t}`,s)),remove:t=>J(H.delete(`/admin/time-slots/${t}`))},jt={list:()=>J(H.get("/admin/customers")),findByPhone:t=>J(H.get(`/admin/customers/phone/${t}`)),create:t=>J(H.post("/admin/customers",t)),update:(t,s)=>J(H.put(`/admin/customers/${t}`,s)),updateAddress:(t,s)=>J(H.put(`/admin/customers/${t}/address`,s)),deleteAddress:(t,s)=>J(H.delete(`/admin/customers/${t}/address/${s}`))};let ul={data:""},ml=t=>{if(typeof window=="object"){let s=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return s.nonce=window.__nonce__,s.parentNode||(t||document.head).appendChild(s),s.firstChild}return t||ul},hl=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,pl=/\/\*[^]*?\*\/|  +/g,cn=/\n+/g,Pt=(t,s)=>{let r="",a="",i="";for(let l in t){let c=t[l];l[0]=="@"?l[1]=="i"?r=l+" "+c+";":a+=l[1]=="f"?Pt(c,l):l+"{"+Pt(c,l[1]=="k"?"":s)+"}":typeof c=="object"?a+=Pt(c,s?s.replace(/([^,])+/g,m=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,x=>/&/.test(x)?x.replace(/&/g,m):m?m+" "+x:x)):l):c!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Pt.p?Pt.p(l,c):l+":"+c+";")}return r+(s&&i?s+"{"+i+"}":i)+a},yt={},Wn=t=>{if(typeof t=="object"){let s="";for(let r in t)s+=r+Wn(t[r]);return s}return t},xl=(t,s,r,a,i)=>{let l=Wn(t),c=yt[l]||(yt[l]=(x=>{let b=0,h=11;for(;b<x.length;)h=101*h+x.charCodeAt(b++)>>>0;return"go"+h})(l));if(!yt[c]){let x=l!==t?t:(b=>{let h,p,j=[{}];for(;h=hl.exec(b.replace(pl,""));)h[4]?j.shift():h[3]?(p=h[3].replace(cn," ").trim(),j.unshift(j[0][p]=j[0][p]||{})):j[0][h[1]]=h[2].replace(cn," ").trim();return j[0]})(t);yt[c]=Pt(i?{["@keyframes "+c]:x}:x,r?"":"."+c)}let m=r&&yt.g?yt.g:null;return r&&(yt.g=yt[c]),((x,b,h,p)=>{p?b.data=b.data.replace(p,x):b.data.indexOf(x)===-1&&(b.data=h?x+b.data:b.data+x)})(yt[c],s,a,m),c},fl=(t,s,r)=>t.reduce((a,i,l)=>{let c=s[l];if(c&&c.call){let m=c(r),x=m&&m.props&&m.props.className||/^go/.test(m)&&m;c=x?"."+x:m&&typeof m=="object"?m.props?"":Pt(m,""):m===!1?"":m}return a+i+(c??"")},"");function sr(t){let s=this||{},r=t.call?t(s.p):t;return xl(r.unshift?r.raw?fl(r,[].slice.call(arguments,1),s.p):r.reduce((a,i)=>Object.assign(a,i&&i.call?i(s.p):i),{}):r,ml(s.target),s.g,s.o,s.k)}let Hn,Ir,Rr;sr.bind({g:1});let wt=sr.bind({k:1});function gl(t,s,r,a){Pt.p=s,Hn=t,Ir=r,Rr=a}function It(t,s){let r=this||{};return function(){let a=arguments;function i(l,c){let m=Object.assign({},l),x=m.className||i.className;r.p=Object.assign({theme:Ir&&Ir()},m),r.o=/ *go\d+/.test(x),m.className=sr.apply(r,a)+(x?" "+x:"");let b=t;return t[0]&&(b=m.as||t,delete m.as),Rr&&b[0]&&Rr(m),Hn(b,m)}return i}}var bl=t=>typeof t=="function",Js=(t,s)=>bl(t)?t(s):t,yl=(()=>{let t=0;return()=>(++t).toString()})(),Kn=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let s=matchMedia("(prefers-reduced-motion: reduce)");t=!s||s.matches}return t}})(),vl=20,zr="default",Qn=(t,s)=>{let{toastLimit:r}=t.settings;switch(s.type){case 0:return{...t,toasts:[s.toast,...t.toasts].slice(0,r)};case 1:return{...t,toasts:t.toasts.map(c=>c.id===s.toast.id?{...c,...s.toast}:c)};case 2:let{toast:a}=s;return Qn(t,{type:t.toasts.find(c=>c.id===a.id)?1:0,toast:a});case 3:let{toastId:i}=s;return{...t,toasts:t.toasts.map(c=>c.id===i||i===void 0?{...c,dismissed:!0,visible:!1}:c)};case 4:return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(c=>c.id!==s.toastId)};case 5:return{...t,pausedAt:s.time};case 6:let l=s.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(c=>({...c,pauseDuration:c.pauseDuration+l}))}}},Hs=[],zn={toasts:[],pausedAt:void 0,settings:{toastLimit:vl}},ct={},Zn=(t,s=zr)=>{ct[s]=Qn(ct[s]||zn,t),Hs.forEach(([r,a])=>{r===s&&a(ct[s])})},Yn=t=>Object.keys(ct).forEach(s=>Zn(t,s)),jl=t=>Object.keys(ct).find(s=>ct[s].toasts.some(r=>r.id===t)),rr=(t=zr)=>s=>{Zn(s,t)},wl={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Nl=(t={},s=zr)=>{let[r,a]=o.useState(ct[s]||zn),i=o.useRef(ct[s]);o.useEffect(()=>(i.current!==ct[s]&&a(ct[s]),Hs.push([s,a]),()=>{let c=Hs.findIndex(([m])=>m===s);c>-1&&Hs.splice(c,1)}),[s]);let l=r.toasts.map(c=>{var m,x,b;return{...t,...t[c.type],...c,removeDelay:c.removeDelay||((m=t[c.type])==null?void 0:m.removeDelay)||(t==null?void 0:t.removeDelay),duration:c.duration||((x=t[c.type])==null?void 0:x.duration)||(t==null?void 0:t.duration)||wl[c.type],style:{...t.style,...(b=t[c.type])==null?void 0:b.style,...c.style}}});return{...r,toasts:l}},Sl=(t,s="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:s,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...r,id:(r==null?void 0:r.id)||yl()}),Ss=t=>(s,r)=>{let a=Sl(s,t,r);return rr(a.toasterId||jl(a.id))({type:2,toast:a}),a.id},Oe=(t,s)=>Ss("blank")(t,s);Oe.error=Ss("error");Oe.success=Ss("success");Oe.loading=Ss("loading");Oe.custom=Ss("custom");Oe.dismiss=(t,s)=>{let r={type:3,toastId:t};s?rr(s)(r):Yn(r)};Oe.dismissAll=t=>Oe.dismiss(void 0,t);Oe.remove=(t,s)=>{let r={type:4,toastId:t};s?rr(s)(r):Yn(r)};Oe.removeAll=t=>Oe.remove(void 0,t);Oe.promise=(t,s,r)=>{let a=Oe.loading(s.loading,{...r,...r==null?void 0:r.loading});return typeof t=="function"&&(t=t()),t.then(i=>{let l=s.success?Js(s.success,i):void 0;return l?Oe.success(l,{id:a,...r,...r==null?void 0:r.success}):Oe.dismiss(a),i}).catch(i=>{let l=s.error?Js(s.error,i):void 0;l?Oe.error(l,{id:a,...r,...r==null?void 0:r.error}):Oe.dismiss(a)}),t};var Cl=1e3,kl=(t,s="default")=>{let{toasts:r,pausedAt:a}=Nl(t,s),i=o.useRef(new Map).current,l=o.useCallback((p,j=Cl)=>{if(i.has(p))return;let Q=setTimeout(()=>{i.delete(p),c({type:4,toastId:p})},j);i.set(p,Q)},[]);o.useEffect(()=>{if(a)return;let p=Date.now(),j=r.map(Q=>{if(Q.duration===1/0)return;let z=(Q.duration||0)+Q.pauseDuration-(p-Q.createdAt);if(z<0){Q.visible&&Oe.dismiss(Q.id);return}return setTimeout(()=>Oe.dismiss(Q.id,s),z)});return()=>{j.forEach(Q=>Q&&clearTimeout(Q))}},[r,a,s]);let c=o.useCallback(rr(s),[s]),m=o.useCallback(()=>{c({type:5,time:Date.now()})},[c]),x=o.useCallback((p,j)=>{c({type:1,toast:{id:p,height:j}})},[c]),b=o.useCallback(()=>{a&&c({type:6,time:Date.now()})},[a,c]),h=o.useCallback((p,j)=>{let{reverseOrder:Q=!1,gutter:z=8,defaultPosition:Z}=j||{},T=r.filter(k=>(k.position||Z)===(p.position||Z)&&k.height),B=T.findIndex(k=>k.id===p.id),C=T.filter((k,P)=>P<B&&k.visible).length;return T.filter(k=>k.visible).slice(...Q?[C+1]:[0,C]).reduce((k,P)=>k+(P.height||0)+z,0)},[r]);return o.useEffect(()=>{r.forEach(p=>{if(p.dismissed)l(p.id,p.removeDelay);else{let j=i.get(p.id);j&&(clearTimeout(j),i.delete(p.id))}})},[r,l]),{toasts:r,handlers:{updateHeight:x,startPause:m,endPause:b,calculateOffset:h}}},El=wt`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,_l=wt`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Al=wt`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Tl=It("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${El} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${_l} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Al} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Pl=wt`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Ol=It("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${Pl} 1s linear infinite;
`,Dl=wt`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Il=wt`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Rl=It("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Dl} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Il} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Fl=It("div")`
  position: absolute;
`,Ll=It("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Ml=wt`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Bl=It("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Ml} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,$l=({toast:t})=>{let{icon:s,type:r,iconTheme:a}=t;return s!==void 0?typeof s=="string"?o.createElement(Bl,null,s):s:r==="blank"?null:o.createElement(Ll,null,o.createElement(Ol,{...a}),r!=="loading"&&o.createElement(Fl,null,r==="error"?o.createElement(Tl,{...a}):o.createElement(Rl,{...a})))},ql=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Ul=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,Vl="0%{opacity:0;} 100%{opacity:1;}",Wl="0%{opacity:1;} 100%{opacity:0;}",Hl=It("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Kl=It("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Ql=(t,s)=>{let r=t.includes("top")?1:-1,[a,i]=Kn()?[Vl,Wl]:[ql(r),Ul(r)];return{animation:s?`${wt(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${wt(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},zl=o.memo(({toast:t,position:s,style:r,children:a})=>{let i=t.height?Ql(t.position||s||"top-center",t.visible):{opacity:0},l=o.createElement($l,{toast:t}),c=o.createElement(Kl,{...t.ariaProps},Js(t.message,t));return o.createElement(Hl,{className:t.className,style:{...i,...r,...t.style}},typeof a=="function"?a({icon:l,message:c}):o.createElement(o.Fragment,null,l,c))});gl(o.createElement);var Zl=({id:t,className:s,style:r,onHeightUpdate:a,children:i})=>{let l=o.useCallback(c=>{if(c){let m=()=>{let x=c.getBoundingClientRect().height;a(t,x)};m(),new MutationObserver(m).observe(c,{subtree:!0,childList:!0,characterData:!0})}},[t,a]);return o.createElement("div",{ref:l,className:s,style:r},i)},Yl=(t,s)=>{let r=t.includes("top"),a=r?{top:0}:{bottom:0},i=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Kn()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${s*(r?1:-1)}px)`,...a,...i}},Jl=sr`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,qs=16,Xl=({reverseOrder:t,position:s="top-center",toastOptions:r,gutter:a,children:i,toasterId:l,containerStyle:c,containerClassName:m})=>{let{toasts:x,handlers:b}=kl(r,l);return o.createElement("div",{"data-rht-toaster":l||"",style:{position:"fixed",zIndex:9999,top:qs,left:qs,right:qs,bottom:qs,pointerEvents:"none",...c},className:m,onMouseEnter:b.startPause,onMouseLeave:b.endPause},x.map(h=>{let p=h.position||s,j=b.calculateOffset(h,{reverseOrder:t,gutter:a,defaultPosition:s}),Q=Yl(p,j);return o.createElement(Zl,{id:h.id,key:h.id,onHeightUpdate:b.updateHeight,className:h.visible?Jl:"",style:Q},h.type==="custom"?Js(h.message,h):i?i(h):o.createElement(zl,{toast:h,position:p}))}))},N=Oe;const Jn=o.createContext(void 0),Sr="fixzep_token",Cr="fixzep_user",Gl=({children:t})=>{const[s,r]=o.useState(()=>localStorage.getItem(Sr)),[a,i]=o.useState(()=>{const x=localStorage.getItem(Cr);return x?JSON.parse(x):null});o.useEffect(()=>{s?localStorage.setItem(Sr,s):localStorage.removeItem(Sr)},[s]),o.useEffect(()=>{a?localStorage.setItem(Cr,JSON.stringify(a)):localStorage.removeItem(Cr)},[a]);const l=o.useCallback(async x=>{var b,h;try{const p=await cl.login(x);r(p.token),i(p.user),N.success("Welcome back, "+p.user.name.split(" ")[0])}catch(p){throw N.error(((h=(b=p==null?void 0:p.response)==null?void 0:b.data)==null?void 0:h.message)||"Unable to login"),p}},[]),c=o.useCallback(()=>{r(null),i(null),N.success("Logged out")},[]),m=o.useMemo(()=>({user:a,token:s,isAuthenticated:!!(s&&a),login:l,logout:c}),[l,c,s,a]);return e.jsx(Jn.Provider,{value:m,children:t})},eo=()=>{const t=o.useContext(Jn);if(!t)throw new Error("useAuthContext must be used within AuthProvider");return t},Zr=()=>eo(),to=({children:t})=>{const{isAuthenticated:s}=Zr();return s?e.jsx(e.Fragment,{children:t}):e.jsx($n,{to:"/login",replace:!0})};function so({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const ro=o.forwardRef(so);function ao({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const no=o.forwardRef(ao);function io({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))}const lo=o.forwardRef(io);function oo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"}))}const dn=o.forwardRef(oo);function co({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const uo=o.forwardRef(co);function mo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const Xn=o.forwardRef(mo);function ho({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}))}const po=o.forwardRef(ho);function xo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const fo=o.forwardRef(xo);function go({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"}))}const bo=o.forwardRef(go);function yo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const vo=o.forwardRef(yo);function jo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25"}))}const wo=o.forwardRef(jo);function No({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const Fr=o.forwardRef(No);function So({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const Lr=o.forwardRef(So);function Co({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607ZM13.5 10.5h-6"}))}const ko=o.forwardRef(Co);function Eo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607ZM10.5 7.5v6m3-3h-6"}))}const _o=o.forwardRef(Eo);function Ao({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const $t=o.forwardRef(Ao);function To({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const Po=o.forwardRef(To);function Oo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const un=o.forwardRef(Oo);function Do({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z"}))}const Io=o.forwardRef(Do);function Ro({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const Fo=o.forwardRef(Ro);function Lo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const Mo=o.forwardRef(Lo);function Bo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"}))}const $o=o.forwardRef(Bo);function qo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const Ns=o.forwardRef(qo);function Uo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"}))}const kr=o.forwardRef(Uo);function Vo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))}const Wo=o.forwardRef(Vo);function Ho({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75a4.5 4.5 0 0 1-4.884 4.484c-1.076-.091-2.264.071-2.95.904l-7.152 8.684a2.548 2.548 0 1 1-3.586-3.586l8.684-7.152c.833-.686.995-1.874.904-2.95a4.5 4.5 0 0 1 6.336-4.486l-3.276 3.276a3.004 3.004 0 0 0 2.25 2.25l3.276-3.276c.256.565.398 1.192.398 1.852Z"}),o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.867 19.125h.008v.008h-.008v-.008Z"}))}const mn=o.forwardRef(Ho);function Ko({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Qo=o.forwardRef(Ko);function zo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const ys=o.forwardRef(zo);function Gn(t){var s,r,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(s=0;s<i;s++)t[s]&&(r=Gn(t[s]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function Nt(){for(var t,s,r=0,a="",i=arguments.length;r<i;r++)(t=arguments[r])&&(s=Gn(t))&&(a&&(a+=" "),a+=s);return a}const Zo=[{to:"/",label:"Overview",icon:$o},{to:"/orders",label:"Orders",icon:bo},{to:"/customers",label:"Customers",icon:kr},{to:"/catalog",label:"Catalog",icon:mn},{to:"/technicians",label:"Technicians",icon:kr},{to:"/spare-parts",label:"Spare Parts",icon:mn},{to:"/time-slots",label:"Time Slots",icon:vo},{to:"/banners",label:"Banners",icon:Po},{to:"/users/new",label:"Create User",icon:kr}],hn=()=>e.jsxs("aside",{className:"hidden lg:flex w-64 flex-col border-r border-slate-200 bg-white/90 backdrop-blur",children:[e.jsxs("div",{className:"px-6 py-5 border-b border-slate-200",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Fixzep Admin"}),e.jsx("p",{className:"mt-2 text-xl font-semibold text-slate-900",children:"Control Room"})]}),e.jsx("nav",{className:"flex-1 px-4 py-6 space-y-1",children:Zo.map(t=>e.jsxs(el,{to:t.to,className:({isActive:s})=>Nt("flex items-center gap-3 rounded-xl px-4 py-3 text-sm font-medium transition-all",s?"bg-slate-900 text-white shadow-card":"text-slate-500 hover:bg-slate-100"),children:[e.jsx(t.icon,{className:"h-5 w-5"}),t.label]},t.to))})]}),ei=il(t=>({isOpen:!1,toggle:()=>t(s=>({isOpen:!s.isOpen})),close:()=>t({isOpen:!1})})),ut=Object.create(null);ut.open="0";ut.close="1";ut.ping="2";ut.pong="3";ut.message="4";ut.upgrade="5";ut.noop="6";const Ks=Object.create(null);Object.keys(ut).forEach(t=>{Ks[ut[t]]=t});const Mr={type:"error",data:"parser error"},ti=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",si=typeof ArrayBuffer=="function",ri=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,Yr=({type:t,data:s},r,a)=>ti&&s instanceof Blob?r?a(s):pn(s,a):si&&(s instanceof ArrayBuffer||ri(s))?r?a(s):pn(new Blob([s]),a):a(ut[t]+(s||"")),pn=(t,s)=>{const r=new FileReader;return r.onload=function(){const a=r.result.split(",")[1];s("b"+(a||""))},r.readAsDataURL(t)};function xn(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let Er;function Yo(t,s){if(ti&&t.data instanceof Blob)return t.data.arrayBuffer().then(xn).then(s);if(si&&(t.data instanceof ArrayBuffer||ri(t.data)))return s(xn(t.data));Yr(t,!1,r=>{Er||(Er=new TextEncoder),s(Er.encode(r))})}const fn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",vs=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<fn.length;t++)vs[fn.charCodeAt(t)]=t;const Jo=t=>{let s=t.length*.75,r=t.length,a,i=0,l,c,m,x;t[t.length-1]==="="&&(s--,t[t.length-2]==="="&&s--);const b=new ArrayBuffer(s),h=new Uint8Array(b);for(a=0;a<r;a+=4)l=vs[t.charCodeAt(a)],c=vs[t.charCodeAt(a+1)],m=vs[t.charCodeAt(a+2)],x=vs[t.charCodeAt(a+3)],h[i++]=l<<2|c>>4,h[i++]=(c&15)<<4|m>>2,h[i++]=(m&3)<<6|x&63;return b},Xo=typeof ArrayBuffer=="function",Jr=(t,s)=>{if(typeof t!="string")return{type:"message",data:ai(t,s)};const r=t.charAt(0);return r==="b"?{type:"message",data:Go(t.substring(1),s)}:Ks[r]?t.length>1?{type:Ks[r],data:t.substring(1)}:{type:Ks[r]}:Mr},Go=(t,s)=>{if(Xo){const r=Jo(t);return ai(r,s)}else return{base64:!0,data:t}},ai=(t,s)=>{switch(s){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},ni="",ec=(t,s)=>{const r=t.length,a=new Array(r);let i=0;t.forEach((l,c)=>{Yr(l,!1,m=>{a[c]=m,++i===r&&s(a.join(ni))})})},tc=(t,s)=>{const r=t.split(ni),a=[];for(let i=0;i<r.length;i++){const l=Jr(r[i],s);if(a.push(l),l.type==="error")break}return a};function sc(){return new TransformStream({transform(t,s){Yo(t,r=>{const a=r.length;let i;if(a<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,a);else if(a<65536){i=new Uint8Array(3);const l=new DataView(i.buffer);l.setUint8(0,126),l.setUint16(1,a)}else{i=new Uint8Array(9);const l=new DataView(i.buffer);l.setUint8(0,127),l.setBigUint64(1,BigInt(a))}t.data&&typeof t.data!="string"&&(i[0]|=128),s.enqueue(i),s.enqueue(r)})}})}let _r;function Us(t){return t.reduce((s,r)=>s+r.length,0)}function Vs(t,s){if(t[0].length===s)return t.shift();const r=new Uint8Array(s);let a=0;for(let i=0;i<s;i++)r[i]=t[0][a++],a===t[0].length&&(t.shift(),a=0);return t.length&&a<t[0].length&&(t[0]=t[0].slice(a)),r}function rc(t,s){_r||(_r=new TextDecoder);const r=[];let a=0,i=-1,l=!1;return new TransformStream({transform(c,m){for(r.push(c);;){if(a===0){if(Us(r)<1)break;const x=Vs(r,1);l=(x[0]&128)===128,i=x[0]&127,i<126?a=3:i===126?a=1:a=2}else if(a===1){if(Us(r)<2)break;const x=Vs(r,2);i=new DataView(x.buffer,x.byteOffset,x.length).getUint16(0),a=3}else if(a===2){if(Us(r)<8)break;const x=Vs(r,8),b=new DataView(x.buffer,x.byteOffset,x.length),h=b.getUint32(0);if(h>Math.pow(2,21)-1){m.enqueue(Mr);break}i=h*Math.pow(2,32)+b.getUint32(4),a=3}else{if(Us(r)<i)break;const x=Vs(r,i);m.enqueue(Jr(l?x:_r.decode(x),s)),a=0}if(i===0||i>t){m.enqueue(Mr);break}}}})}const ii=4;function Ae(t){if(t)return ac(t)}function ac(t){for(var s in Ae.prototype)t[s]=Ae.prototype[s];return t}Ae.prototype.on=Ae.prototype.addEventListener=function(t,s){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(s),this};Ae.prototype.once=function(t,s){function r(){this.off(t,r),s.apply(this,arguments)}return r.fn=s,this.on(t,r),this};Ae.prototype.off=Ae.prototype.removeListener=Ae.prototype.removeAllListeners=Ae.prototype.removeEventListener=function(t,s){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var a,i=0;i<r.length;i++)if(a=r[i],a===s||a.fn===s){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};Ae.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var s=new Array(arguments.length-1),r=this._callbacks["$"+t],a=1;a<arguments.length;a++)s[a-1]=arguments[a];if(r){r=r.slice(0);for(var a=0,i=r.length;a<i;++a)r[a].apply(this,s)}return this};Ae.prototype.emitReserved=Ae.prototype.emit;Ae.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Ae.prototype.hasListeners=function(t){return!!this.listeners(t).length};const ar=typeof Promise=="function"&&typeof Promise.resolve=="function"?s=>Promise.resolve().then(s):(s,r)=>r(s,0),Xe=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),nc="arraybuffer";function li(t,...s){return s.reduce((r,a)=>(t.hasOwnProperty(a)&&(r[a]=t[a]),r),{})}const ic=Xe.setTimeout,lc=Xe.clearTimeout;function nr(t,s){s.useNativeTimers?(t.setTimeoutFn=ic.bind(Xe),t.clearTimeoutFn=lc.bind(Xe)):(t.setTimeoutFn=Xe.setTimeout.bind(Xe),t.clearTimeoutFn=Xe.clearTimeout.bind(Xe))}const oc=1.33;function cc(t){return typeof t=="string"?dc(t):Math.ceil((t.byteLength||t.size)*oc)}function dc(t){let s=0,r=0;for(let a=0,i=t.length;a<i;a++)s=t.charCodeAt(a),s<128?r+=1:s<2048?r+=2:s<55296||s>=57344?r+=3:(a++,r+=4);return r}function oi(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function uc(t){let s="";for(let r in t)t.hasOwnProperty(r)&&(s.length&&(s+="&"),s+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return s}function mc(t){let s={},r=t.split("&");for(let a=0,i=r.length;a<i;a++){let l=r[a].split("=");s[decodeURIComponent(l[0])]=decodeURIComponent(l[1])}return s}class hc extends Error{constructor(s,r,a){super(s),this.description=r,this.context=a,this.type="TransportError"}}class Xr extends Ae{constructor(s){super(),this.writable=!1,nr(this,s),this.opts=s,this.query=s.query,this.socket=s.socket,this.supportsBinary=!s.forceBase64}onError(s,r,a){return super.emitReserved("error",new hc(s,r,a)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(s){this.readyState==="open"&&this.write(s)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(s){const r=Jr(s,this.socket.binaryType);this.onPacket(r)}onPacket(s){super.emitReserved("packet",s)}onClose(s){this.readyState="closed",super.emitReserved("close",s)}pause(s){}createUri(s,r={}){return s+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const s=this.opts.hostname;return s.indexOf(":")===-1?s:"["+s+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(s){const r=uc(s);return r.length?"?"+r:""}}class pc extends Xr{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(s){this.readyState="pausing";const r=()=>{this.readyState="paused",s()};if(this._polling||!this.writable){let a=0;this._polling&&(a++,this.once("pollComplete",function(){--a||r()})),this.writable||(a++,this.once("drain",function(){--a||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(s){const r=a=>{if(this.readyState==="opening"&&a.type==="open"&&this.onOpen(),a.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(a)};tc(s,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const s=()=>{this.write([{type:"close"}])};this.readyState==="open"?s():this.once("open",s)}write(s){this.writable=!1,ec(s,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const s=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=oi()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(s,r)}}let ci=!1;try{ci=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const xc=ci;function fc(){}class gc extends pc{constructor(s){if(super(s),typeof location<"u"){const r=location.protocol==="https:";let a=location.port;a||(a=r?"443":"80"),this.xd=typeof location<"u"&&s.hostname!==location.hostname||a!==s.port}}doWrite(s,r){const a=this.request({method:"POST",data:s});a.on("success",r),a.on("error",(i,l)=>{this.onError("xhr post error",i,l)})}doPoll(){const s=this.request();s.on("data",this.onData.bind(this)),s.on("error",(r,a)=>{this.onError("xhr poll error",r,a)}),this.pollXhr=s}}class dt extends Ae{constructor(s,r,a){super(),this.createRequest=s,nr(this,a),this._opts=a,this._method=a.method||"GET",this._uri=r,this._data=a.data!==void 0?a.data:null,this._create()}_create(){var s;const r=li(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const a=this._xhr=this.createRequest(r);try{a.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){a.setDisableHeaderCheck&&a.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&a.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{a.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{a.setRequestHeader("Accept","*/*")}catch{}(s=this._opts.cookieJar)===null||s===void 0||s.addCookies(a),"withCredentials"in a&&(a.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(a.timeout=this._opts.requestTimeout),a.onreadystatechange=()=>{var i;a.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(a.getResponseHeader("set-cookie"))),a.readyState===4&&(a.status===200||a.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof a.status=="number"?a.status:0)},0))},a.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=dt.requestsCount++,dt.requests[this._index]=this)}_onError(s){this.emitReserved("error",s,this._xhr),this._cleanup(!0)}_cleanup(s){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=fc,s)try{this._xhr.abort()}catch{}typeof document<"u"&&delete dt.requests[this._index],this._xhr=null}}_onLoad(){const s=this._xhr.responseText;s!==null&&(this.emitReserved("data",s),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}dt.requestsCount=0;dt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",gn);else if(typeof addEventListener=="function"){const t="onpagehide"in Xe?"pagehide":"unload";addEventListener(t,gn,!1)}}function gn(){for(let t in dt.requests)dt.requests.hasOwnProperty(t)&&dt.requests[t].abort()}const bc=function(){const t=di({xdomain:!1});return t&&t.responseType!==null}();class yc extends gc{constructor(s){super(s);const r=s&&s.forceBase64;this.supportsBinary=bc&&!r}request(s={}){return Object.assign(s,{xd:this.xd},this.opts),new dt(di,this.uri(),s)}}function di(t){const s=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!s||xc))return new XMLHttpRequest}catch{}if(!s)try{return new Xe[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const ui=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class vc extends Xr{get name(){return"websocket"}doOpen(){const s=this.uri(),r=this.opts.protocols,a=ui?{}:li(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(a.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(s,r,a)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=s=>this.onClose({description:"websocket connection closed",context:s}),this.ws.onmessage=s=>this.onData(s.data),this.ws.onerror=s=>this.onError("websocket error",s)}write(s){this.writable=!1;for(let r=0;r<s.length;r++){const a=s[r],i=r===s.length-1;Yr(a,this.supportsBinary,l=>{try{this.doWrite(a,l)}catch{}i&&ar(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const s=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=oi()),this.supportsBinary||(r.b64=1),this.createUri(s,r)}}const Ar=Xe.WebSocket||Xe.MozWebSocket;class jc extends vc{createSocket(s,r,a){return ui?new Ar(s,r,a):r?new Ar(s,r):new Ar(s)}doWrite(s,r){this.ws.send(r)}}class wc extends Xr{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(s){return this.emitReserved("error",s)}this._transport.closed.then(()=>{this.onClose()}).catch(s=>{this.onError("webtransport error",s)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(s=>{const r=rc(Number.MAX_SAFE_INTEGER,this.socket.binaryType),a=s.readable.pipeThrough(r).getReader(),i=sc();i.readable.pipeTo(s.writable),this._writer=i.writable.getWriter();const l=()=>{a.read().then(({done:m,value:x})=>{m||(this.onPacket(x),l())}).catch(m=>{})};l();const c={type:"open"};this.query.sid&&(c.data=`{"sid":"${this.query.sid}"}`),this._writer.write(c).then(()=>this.onOpen())})})}write(s){this.writable=!1;for(let r=0;r<s.length;r++){const a=s[r],i=r===s.length-1;this._writer.write(a).then(()=>{i&&ar(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var s;(s=this._transport)===null||s===void 0||s.close()}}const Nc={websocket:jc,webtransport:wc,polling:yc},Sc=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Cc=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Br(t){if(t.length>8e3)throw"URI too long";const s=t,r=t.indexOf("["),a=t.indexOf("]");r!=-1&&a!=-1&&(t=t.substring(0,r)+t.substring(r,a).replace(/:/g,";")+t.substring(a,t.length));let i=Sc.exec(t||""),l={},c=14;for(;c--;)l[Cc[c]]=i[c]||"";return r!=-1&&a!=-1&&(l.source=s,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=kc(l,l.path),l.queryKey=Ec(l,l.query),l}function kc(t,s){const r=/\/{2,9}/g,a=s.replace(r,"/").split("/");return(s.slice(0,1)=="/"||s.length===0)&&a.splice(0,1),s.slice(-1)=="/"&&a.splice(a.length-1,1),a}function Ec(t,s){const r={};return s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,i,l){i&&(r[i]=l)}),r}const $r=typeof addEventListener=="function"&&typeof removeEventListener=="function",Qs=[];$r&&addEventListener("offline",()=>{Qs.forEach(t=>t())},!1);class Ot extends Ae{constructor(s,r){if(super(),this.binaryType=nc,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,s&&typeof s=="object"&&(r=s,s=null),s){const a=Br(s);r.hostname=a.host,r.secure=a.protocol==="https"||a.protocol==="wss",r.port=a.port,a.query&&(r.query=a.query)}else r.host&&(r.hostname=Br(r.host).host);nr(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(a=>{const i=a.prototype.name;this.transports.push(i),this._transportsByName[i]=a}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=mc(this.opts.query)),$r&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Qs.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(s){const r=Object.assign({},this.opts.query);r.EIO=ii,r.transport=s,this.id&&(r.sid=this.id);const a=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[s]);return new this._transportsByName[s](a)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const s=this.opts.rememberUpgrade&&Ot.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(s);r.open(),this.setTransport(r)}setTransport(s){this.transport&&this.transport.removeAllListeners(),this.transport=s,s.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",Ot.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",s),this.emitReserved("heartbeat"),s.type){case"open":this.onHandshake(JSON.parse(s.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=s.data,this._onError(r);break;case"message":this.emitReserved("data",s.data),this.emitReserved("message",s.data);break}}onHandshake(s){this.emitReserved("handshake",s),this.id=s.sid,this.transport.query.sid=s.sid,this._pingInterval=s.pingInterval,this._pingTimeout=s.pingTimeout,this._maxPayload=s.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const s=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+s,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},s),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const s=this._getWritablePackets();this.transport.send(s),this._prevBufferLen=s.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let a=0;a<this.writeBuffer.length;a++){const i=this.writeBuffer[a].data;if(i&&(r+=cc(i)),a>0&&r>this._maxPayload)return this.writeBuffer.slice(0,a);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const s=Date.now()>this._pingTimeoutTime;return s&&(this._pingTimeoutTime=0,ar(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),s}write(s,r,a){return this._sendPacket("message",s,r,a),this}send(s,r,a){return this._sendPacket("message",s,r,a),this}_sendPacket(s,r,a,i){if(typeof r=="function"&&(i=r,r=void 0),typeof a=="function"&&(i=a,a=null),this.readyState==="closing"||this.readyState==="closed")return;a=a||{},a.compress=a.compress!==!1;const l={type:s,data:r,options:a};this.emitReserved("packetCreate",l),this.writeBuffer.push(l),i&&this.once("flush",i),this.flush()}close(){const s=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),s()},a=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?a():s()}):this.upgrading?a():s()),this}_onError(s){if(Ot.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",s),this._onClose("transport error",s)}_onClose(s,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),$r&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const a=Qs.indexOf(this._offlineEventListener);a!==-1&&Qs.splice(a,1)}this.readyState="closed",this.id=null,this.emitReserved("close",s,r),this.writeBuffer=[],this._prevBufferLen=0}}}Ot.protocol=ii;class _c extends Ot{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let s=0;s<this._upgrades.length;s++)this._probe(this._upgrades[s])}_probe(s){let r=this.createTransport(s),a=!1;Ot.priorWebsocketSuccess=!1;const i=()=>{a||(r.send([{type:"ping",data:"probe"}]),r.once("packet",p=>{if(!a)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;Ot.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{a||this.readyState!=="closed"&&(h(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const j=new Error("probe error");j.transport=r.name,this.emitReserved("upgradeError",j)}}))};function l(){a||(a=!0,h(),r.close(),r=null)}const c=p=>{const j=new Error("probe error: "+p);j.transport=r.name,l(),this.emitReserved("upgradeError",j)};function m(){c("transport closed")}function x(){c("socket closed")}function b(p){r&&p.name!==r.name&&l()}const h=()=>{r.removeListener("open",i),r.removeListener("error",c),r.removeListener("close",m),this.off("close",x),this.off("upgrading",b)};r.once("open",i),r.once("error",c),r.once("close",m),this.once("close",x),this.once("upgrading",b),this._upgrades.indexOf("webtransport")!==-1&&s!=="webtransport"?this.setTimeoutFn(()=>{a||r.open()},200):r.open()}onHandshake(s){this._upgrades=this._filterUpgrades(s.upgrades),super.onHandshake(s)}_filterUpgrades(s){const r=[];for(let a=0;a<s.length;a++)~this.transports.indexOf(s[a])&&r.push(s[a]);return r}}let Ac=class extends _c{constructor(s,r={}){const a=typeof s=="object"?s:r;(!a.transports||a.transports&&typeof a.transports[0]=="string")&&(a.transports=(a.transports||["polling","websocket","webtransport"]).map(i=>Nc[i]).filter(i=>!!i)),super(s,a)}};function Tc(t,s="",r){let a=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),a=Br(t)),a.port||(/^(http|ws)$/.test(a.protocol)?a.port="80":/^(http|ws)s$/.test(a.protocol)&&(a.port="443")),a.path=a.path||"/";const l=a.host.indexOf(":")!==-1?"["+a.host+"]":a.host;return a.id=a.protocol+"://"+l+":"+a.port+s,a.href=a.protocol+"://"+l+(r&&r.port===a.port?"":":"+a.port),a}const Pc=typeof ArrayBuffer=="function",Oc=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,mi=Object.prototype.toString,Dc=typeof Blob=="function"||typeof Blob<"u"&&mi.call(Blob)==="[object BlobConstructor]",Ic=typeof File=="function"||typeof File<"u"&&mi.call(File)==="[object FileConstructor]";function Gr(t){return Pc&&(t instanceof ArrayBuffer||Oc(t))||Dc&&t instanceof Blob||Ic&&t instanceof File}function zs(t,s){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,a=t.length;r<a;r++)if(zs(t[r]))return!0;return!1}if(Gr(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return zs(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&zs(t[r]))return!0;return!1}function Rc(t){const s=[],r=t.data,a=t;return a.data=qr(r,s),a.attachments=s.length,{packet:a,buffers:s}}function qr(t,s){if(!t)return t;if(Gr(t)){const r={_placeholder:!0,num:s.length};return s.push(t),r}else if(Array.isArray(t)){const r=new Array(t.length);for(let a=0;a<t.length;a++)r[a]=qr(t[a],s);return r}else if(typeof t=="object"&&!(t instanceof Date)){const r={};for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=qr(t[a],s));return r}return t}function Fc(t,s){return t.data=Ur(t.data,s),delete t.attachments,t}function Ur(t,s){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<s.length)return s[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=Ur(t[r],s);else if(typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=Ur(t[r],s));return t}const hi=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Lc=5;var re;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(re||(re={}));class Mc{constructor(s){this.replacer=s}encode(s){return(s.type===re.EVENT||s.type===re.ACK)&&zs(s)?this.encodeAsBinary({type:s.type===re.EVENT?re.BINARY_EVENT:re.BINARY_ACK,nsp:s.nsp,data:s.data,id:s.id}):[this.encodeAsString(s)]}encodeAsString(s){let r=""+s.type;return(s.type===re.BINARY_EVENT||s.type===re.BINARY_ACK)&&(r+=s.attachments+"-"),s.nsp&&s.nsp!=="/"&&(r+=s.nsp+","),s.id!=null&&(r+=s.id),s.data!=null&&(r+=JSON.stringify(s.data,this.replacer)),r}encodeAsBinary(s){const r=Rc(s),a=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(a),i}}class ea extends Ae{constructor(s){super(),this.reviver=s}add(s){let r;if(typeof s=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(s);const a=r.type===re.BINARY_EVENT;a||r.type===re.BINARY_ACK?(r.type=a?re.EVENT:re.ACK,this.reconstructor=new Bc(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Gr(s)||s.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(s),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+s)}decodeString(s){let r=0;const a={type:Number(s.charAt(0))};if(re[a.type]===void 0)throw new Error("unknown packet type "+a.type);if(a.type===re.BINARY_EVENT||a.type===re.BINARY_ACK){const l=r+1;for(;s.charAt(++r)!=="-"&&r!=s.length;);const c=s.substring(l,r);if(c!=Number(c)||s.charAt(r)!=="-")throw new Error("Illegal attachments");a.attachments=Number(c)}if(s.charAt(r+1)==="/"){const l=r+1;for(;++r&&!(s.charAt(r)===","||r===s.length););a.nsp=s.substring(l,r)}else a.nsp="/";const i=s.charAt(r+1);if(i!==""&&Number(i)==i){const l=r+1;for(;++r;){const c=s.charAt(r);if(c==null||Number(c)!=c){--r;break}if(r===s.length)break}a.id=Number(s.substring(l,r+1))}if(s.charAt(++r)){const l=this.tryParse(s.substr(r));if(ea.isPayloadValid(a.type,l))a.data=l;else throw new Error("invalid payload")}return a}tryParse(s){try{return JSON.parse(s,this.reviver)}catch{return!1}}static isPayloadValid(s,r){switch(s){case re.CONNECT:return Xs(r);case re.DISCONNECT:return r===void 0;case re.CONNECT_ERROR:return typeof r=="string"||Xs(r);case re.EVENT:case re.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&hi.indexOf(r[0])===-1);case re.ACK:case re.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Bc{constructor(s){this.packet=s,this.buffers=[],this.reconPack=s}takeBinaryData(s){if(this.buffers.push(s),this.buffers.length===this.reconPack.attachments){const r=Fc(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function $c(t){return typeof t=="string"}const qc=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};function Uc(t){return t===void 0||qc(t)}function Xs(t){return Object.prototype.toString.call(t)==="[object Object]"}function Vc(t,s){switch(t){case re.CONNECT:return s===void 0||Xs(s);case re.DISCONNECT:return s===void 0;case re.EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&hi.indexOf(s[0])===-1);case re.ACK:return Array.isArray(s);case re.CONNECT_ERROR:return typeof s=="string"||Xs(s);default:return!1}}function Wc(t){return $c(t.nsp)&&Uc(t.id)&&Vc(t.type,t.data)}const Hc=Object.freeze(Object.defineProperty({__proto__:null,Decoder:ea,Encoder:Mc,get PacketType(){return re},isPacketValid:Wc,protocol:Lc},Symbol.toStringTag,{value:"Module"}));function tt(t,s,r){return t.on(s,r),function(){t.off(s,r)}}const Kc=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class pi extends Ae{constructor(s,r,a){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=s,this.nsp=r,a&&a.auth&&(this.auth=a.auth),this._opts=Object.assign({},a),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const s=this.io;this.subs=[tt(s,"open",this.onopen.bind(this)),tt(s,"packet",this.onpacket.bind(this)),tt(s,"error",this.onerror.bind(this)),tt(s,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...s){return s.unshift("message"),this.emit.apply(this,s),this}emit(s,...r){var a,i,l;if(Kc.hasOwnProperty(s))throw new Error('"'+s.toString()+'" is a reserved event name');if(r.unshift(s),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const c={type:re.EVENT,data:r};if(c.options={},c.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const h=this.ids++,p=r.pop();this._registerAckCallback(h,p),c.id=h}const m=(i=(a=this.io.engine)===null||a===void 0?void 0:a.transport)===null||i===void 0?void 0:i.writable,x=this.connected&&!(!((l=this.io.engine)===null||l===void 0)&&l._hasPingExpired());return this.flags.volatile&&!m||(x?(this.notifyOutgoingListeners(c),this.packet(c)):this.sendBuffer.push(c)),this.flags={},this}_registerAckCallback(s,r){var a;const i=(a=this.flags.timeout)!==null&&a!==void 0?a:this._opts.ackTimeout;if(i===void 0){this.acks[s]=r;return}const l=this.io.setTimeoutFn(()=>{delete this.acks[s];for(let m=0;m<this.sendBuffer.length;m++)this.sendBuffer[m].id===s&&this.sendBuffer.splice(m,1);r.call(this,new Error("operation has timed out"))},i),c=(...m)=>{this.io.clearTimeoutFn(l),r.apply(this,m)};c.withError=!0,this.acks[s]=c}emitWithAck(s,...r){return new Promise((a,i)=>{const l=(c,m)=>c?i(c):a(m);l.withError=!0,r.push(l),this.emit(s,...r)})}_addToQueue(s){let r;typeof s[s.length-1]=="function"&&(r=s.pop());const a={id:this._queueSeq++,tryCount:0,pending:!1,args:s,flags:Object.assign({fromQueue:!0},this.flags)};s.push((i,...l)=>(this._queue[0],i!==null?a.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...l)),a.pending=!1,this._drainQueue())),this._queue.push(a),this._drainQueue()}_drainQueue(s=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!s||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(s){s.nsp=this.nsp,this.io._packet(s)}onopen(){typeof this.auth=="function"?this.auth(s=>{this._sendConnectPacket(s)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(s){this.packet({type:re.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},s):s})}onerror(s){this.connected||this.emitReserved("connect_error",s)}onclose(s,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",s,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(s=>{if(!this.sendBuffer.some(a=>String(a.id)===s)){const a=this.acks[s];delete this.acks[s],a.withError&&a.call(this,new Error("socket has been disconnected"))}})}onpacket(s){if(s.nsp===this.nsp)switch(s.type){case re.CONNECT:s.data&&s.data.sid?this.onconnect(s.data.sid,s.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case re.EVENT:case re.BINARY_EVENT:this.onevent(s);break;case re.ACK:case re.BINARY_ACK:this.onack(s);break;case re.DISCONNECT:this.ondisconnect();break;case re.CONNECT_ERROR:this.destroy();const a=new Error(s.data.message);a.data=s.data.data,this.emitReserved("connect_error",a);break}}onevent(s){const r=s.data||[];s.id!=null&&r.push(this.ack(s.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(s){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const a of r)a.apply(this,s)}super.emit.apply(this,s),this._pid&&s.length&&typeof s[s.length-1]=="string"&&(this._lastOffset=s[s.length-1])}ack(s){const r=this;let a=!1;return function(...i){a||(a=!0,r.packet({type:re.ACK,id:s,data:i}))}}onack(s){const r=this.acks[s.id];typeof r=="function"&&(delete this.acks[s.id],r.withError&&s.data.unshift(null),r.apply(this,s.data))}onconnect(s,r){this.id=s,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(s=>this.emitEvent(s)),this.receiveBuffer=[],this.sendBuffer.forEach(s=>{this.notifyOutgoingListeners(s),this.packet(s)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(s=>s()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:re.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(s){return this.flags.compress=s,this}get volatile(){return this.flags.volatile=!0,this}timeout(s){return this.flags.timeout=s,this}onAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(s),this}prependAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(s),this}offAny(s){if(!this._anyListeners)return this;if(s){const r=this._anyListeners;for(let a=0;a<r.length;a++)if(s===r[a])return r.splice(a,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(s),this}prependAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(s),this}offAnyOutgoing(s){if(!this._anyOutgoingListeners)return this;if(s){const r=this._anyOutgoingListeners;for(let a=0;a<r.length;a++)if(s===r[a])return r.splice(a,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(s){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const a of r)a.apply(this,s.data)}}}function ts(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ts.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var s=Math.random(),r=Math.floor(s*this.jitter*t);t=Math.floor(s*10)&1?t+r:t-r}return Math.min(t,this.max)|0};ts.prototype.reset=function(){this.attempts=0};ts.prototype.setMin=function(t){this.ms=t};ts.prototype.setMax=function(t){this.max=t};ts.prototype.setJitter=function(t){this.jitter=t};class Vr extends Ae{constructor(s,r){var a;super(),this.nsps={},this.subs=[],s&&typeof s=="object"&&(r=s,s=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,nr(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((a=r.randomizationFactor)!==null&&a!==void 0?a:.5),this.backoff=new ts({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=s;const i=r.parser||Hc;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(s){return arguments.length?(this._reconnection=!!s,s||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(s){return s===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=s,this)}reconnectionDelay(s){var r;return s===void 0?this._reconnectionDelay:(this._reconnectionDelay=s,(r=this.backoff)===null||r===void 0||r.setMin(s),this)}randomizationFactor(s){var r;return s===void 0?this._randomizationFactor:(this._randomizationFactor=s,(r=this.backoff)===null||r===void 0||r.setJitter(s),this)}reconnectionDelayMax(s){var r;return s===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=s,(r=this.backoff)===null||r===void 0||r.setMax(s),this)}timeout(s){return arguments.length?(this._timeout=s,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(s){if(~this._readyState.indexOf("open"))return this;this.engine=new Ac(this.uri,this.opts);const r=this.engine,a=this;this._readyState="opening",this.skipReconnect=!1;const i=tt(r,"open",function(){a.onopen(),s&&s()}),l=m=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",m),s?s(m):this.maybeReconnectOnOpen()},c=tt(r,"error",l);if(this._timeout!==!1){const m=this._timeout,x=this.setTimeoutFn(()=>{i(),l(new Error("timeout")),r.close()},m);this.opts.autoUnref&&x.unref(),this.subs.push(()=>{this.clearTimeoutFn(x)})}return this.subs.push(i),this.subs.push(c),this}connect(s){return this.open(s)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const s=this.engine;this.subs.push(tt(s,"ping",this.onping.bind(this)),tt(s,"data",this.ondata.bind(this)),tt(s,"error",this.onerror.bind(this)),tt(s,"close",this.onclose.bind(this)),tt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(s){try{this.decoder.add(s)}catch(r){this.onclose("parse error",r)}}ondecoded(s){ar(()=>{this.emitReserved("packet",s)},this.setTimeoutFn)}onerror(s){this.emitReserved("error",s)}socket(s,r){let a=this.nsps[s];return a?this._autoConnect&&!a.active&&a.connect():(a=new pi(this,s,r),this.nsps[s]=a),a}_destroy(s){const r=Object.keys(this.nsps);for(const a of r)if(this.nsps[a].active)return;this._close()}_packet(s){const r=this.encoder.encode(s);for(let a=0;a<r.length;a++)this.engine.write(r[a],s.options)}cleanup(){this.subs.forEach(s=>s()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(s,r){var a;this.cleanup(),(a=this.engine)===null||a===void 0||a.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",s,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const s=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const a=this.setTimeoutFn(()=>{s.skipReconnect||(this.emitReserved("reconnect_attempt",s.backoff.attempts),!s.skipReconnect&&s.open(i=>{i?(s._reconnecting=!1,s.reconnect(),this.emitReserved("reconnect_error",i)):s.onreconnect()}))},r);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}}onreconnect(){const s=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",s)}}const xs={};function Zs(t,s){typeof t=="object"&&(s=t,t=void 0),s=s||{};const r=Tc(t,s.path||"/socket.io"),a=r.source,i=r.id,l=r.path,c=xs[i]&&l in xs[i].nsps,m=s.forceNew||s["force new connection"]||s.multiplex===!1||c;let x;return m?x=new Vr(a,s):(xs[i]||(xs[i]=new Vr(a,s)),x=xs[i]),r.query&&!s.query&&(s.query=r.queryKey),x.socket(r.path,s)}Object.assign(Zs,{Manager:Vr,Socket:pi,io:Zs,connect:Zs});const Qc="/notification.wav";var Mn;const zc=typeof window<"u"&&((Mn=window.electronAPI)==null?void 0:Mn.isElectron)===!0,fe={ORDER_CREATED:"ORDER_CREATED",ORDER_RESCHEDULED:"ORDER_RESCHEDULED",TECHNICIAN_ASSIGNED:"TECHNICIAN_ASSIGNED",JOB_UPDATED:"JOB_UPDATED",CUSTOMER_ORDER_PLACED:"CUSTOMER_ORDER_PLACED",PAYMENT_RECEIVED:"PAYMENT_RECEIVED",TECHNICIAN_CHECKED_IN:"TECHNICIAN_CHECKED_IN",CUSTOMER_APPROVAL_REQUIRED:"CUSTOMER_APPROVAL_REQUIRED",CUSTOMER_APPROVAL_UPDATED:"CUSTOMER_APPROVAL_UPDATED",TECHNICIAN_UNASSIGNED:"TECHNICIAN_UNASSIGNED",ORDER_CANCELLATION_REQUESTED:"ORDER_CANCELLATION_REQUESTED",ORDER_CANCELLED:"ORDER_CANCELLED"},xi=o.createContext(null),Zc="https://admin.eopsys.xyz",Yc=({children:t})=>{const[s,r]=o.useState(null),[a,i]=o.useState(!1),[l,c]=o.useState([]),[m,x]=o.useState(!0),b=St(),h=o.useRef(null);o.useEffect(()=>(h.current=new Audio(Qc),h.current.volume=.5,h.current.load(),()=>{h.current&&(h.current.pause(),h.current=null)}),[]),o.useEffect(()=>{const T=()=>{if(h.current&&!m){const C=h.current;C.volume=0,C.play().then(()=>{C.pause(),C.currentTime=0,C.volume=.5,x(!0),console.log("[Sound] Audio unlocked - notifications will play")}).catch(()=>{})}},B=["click","touchstart","keydown"];return B.forEach(C=>{document.addEventListener(C,T,{once:!1,passive:!0})}),()=>{B.forEach(C=>{document.removeEventListener(C,T)})}},[m]);const p=o.useCallback(()=>{h.current&&m?(h.current.currentTime=0,h.current.play().catch(T=>{console.log("[Sound] Could not play notification sound:",T.message)})):m||console.log("[Sound] Audio not yet unlocked - click anywhere to enable notification sounds")},[m]),j=o.useCallback((T,B)=>{const C={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,event:T,payload:B,timestamp:new Date,read:!1};c(k=>[C,...k].slice(0,50))},[]),Q=o.useCallback(()=>{c([])},[]),z=o.useCallback((T,B)=>{let C="",k=e.jsx(Xn,{className:"h-5 w-5 text-blue-500"});switch(T){case fe.ORDER_CREATED:case fe.CUSTOMER_ORDER_PLACED:C=`New order received${B.orderCode?`: #${B.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case fe.TECHNICIAN_ASSIGNED:C=`Technician assigned to order${B.orderCode?` #${B.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case fe.ORDER_RESCHEDULED:C=`Order rescheduled${B.orderCode?`: #${B.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case fe.PAYMENT_RECEIVED:C=`Payment received${B.amount?`: ${B.amount}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case fe.TECHNICIAN_CHECKED_IN:C="Technician checked in",k=e.jsx("span",{className:"text-xl",children:""});break;case fe.CUSTOMER_APPROVAL_REQUIRED:C="Customer approval required",k=e.jsx("span",{className:"text-xl",children:""});break;case fe.CUSTOMER_APPROVAL_UPDATED:C="Customer approval updated",k=e.jsx("span",{className:"text-xl",children:""});break;case fe.JOB_UPDATED:C="Job card updated",k=e.jsx("span",{className:"text-xl",children:""});break;case fe.TECHNICIAN_UNASSIGNED:C="Technician unassigned from order",k=e.jsx("span",{className:"text-xl",children:""});break;case fe.ORDER_CANCELLATION_REQUESTED:C=`Cancellation requested${B.orderCode?`: #${B.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case fe.ORDER_CANCELLED:C=`Order cancelled${B.orderCode?`: #${B.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;default:C="New notification received"}N(C,{icon:k,duration:5e3,position:"top-right",style:{borderRadius:"12px",background:"#1e293b",color:"#fff",padding:"12px 16px"}}),zc&&window.electronAPI&&window.electronAPI.showNotification("Fixzep Admin",C)},[]);o.useEffect(()=>{const T=localStorage.getItem("fixzep_token"),B=localStorage.getItem("fixzep_user");if(!T||!B)return;let C={};try{C=JSON.parse(B)}catch{return}const k=Zs(Zc,{transports:["websocket","polling"],autoConnect:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3});return k.on("connect",()=>{console.log("[Socket] Connected:",k.id),i(!0),C.role==="admin"?k.emit("admin:join",{userId:C.id}):C.role==="technician"?k.emit("technician:join",{userId:C.id}):k.emit("customer:join",{userId:C.id})}),k.on("disconnect",()=>{console.log("[Socket] Disconnected"),i(!1)}),k.on("connect_error",P=>{console.error("[Socket] Connection error:",P),i(!1)}),Object.values(fe).forEach(P=>{k.on(P,I=>{console.log(`[Socket] Received ${P}:`,I),j(P,I),z(P,I),(P===fe.ORDER_CREATED||P===fe.CUSTOMER_ORDER_PLACED||P===fe.ORDER_CANCELLATION_REQUESTED||P===fe.ORDER_CANCELLED)&&p(),P===fe.ORDER_CREATED||P===fe.CUSTOMER_ORDER_PLACED?(b.invalidateQueries({queryKey:["orders"]}),b.invalidateQueries({queryKey:["dashboard"]})):P===fe.TECHNICIAN_ASSIGNED||P===fe.TECHNICIAN_UNASSIGNED?(b.invalidateQueries({queryKey:["orders"]}),b.invalidateQueries({queryKey:["technicians"]}),I!=null&&I.orderId&&b.invalidateQueries({queryKey:["order-jobcard",I.orderId]})):P===fe.JOB_UPDATED||P===fe.ORDER_CANCELLATION_REQUESTED||P===fe.ORDER_CANCELLED?(b.invalidateQueries({queryKey:["orders"]}),I!=null&&I.orderId&&b.invalidateQueries({queryKey:["order-jobcard",I.orderId]})):P===fe.ORDER_RESCHEDULED?(b.invalidateQueries({queryKey:["orders"]}),I!=null&&I.orderId&&b.invalidateQueries({queryKey:["order-jobcard",I.orderId]})):P===fe.PAYMENT_RECEIVED&&(b.invalidateQueries({queryKey:["orders"]}),I!=null&&I.orderId&&b.invalidateQueries({queryKey:["order-jobcard",I.orderId]}))})}),r(k),()=>{k.disconnect(),r(null),i(!1)}},[j,z,p,b]);const Z=l.filter(T=>!T.read).length;return e.jsx(xi.Provider,{value:{socket:s,isConnected:a,notifications:l,clearNotifications:Q,unreadCount:Z,soundEnabled:m},children:t})},Jc=()=>{const t=o.useContext(xi);if(!t)throw new Error("useSocket must be used within a SocketProvider");return t},Xc=()=>{const t=o.useMemo(()=>{var c;return typeof window<"u"&&((c=window.electronAPI)==null?void 0:c.isElectron)===!0},[]),s=o.useMemo(()=>t&&window.electronAPI?window.electronAPI.platform:"web",[t]),r=o.useCallback((c,m)=>{t&&window.electronAPI?window.electronAPI.showNotification(c,m):"Notification"in window&&Notification.permission==="granted"?new Notification(c,{body:m}):"Notification"in window&&Notification.permission!=="denied"&&Notification.requestPermission().then(x=>{x==="granted"&&new Notification(c,{body:m})})},[t]),a=o.useCallback(()=>{t&&window.electronAPI&&window.electronAPI.minimizeWindow()},[t]),i=o.useCallback(()=>{t&&window.electronAPI&&window.electronAPI.maximizeWindow()},[t]),l=o.useCallback(()=>{t&&window.electronAPI&&window.electronAPI.closeWindow()},[t]);return{isElectron:t,platform:s,showNotification:r,minimizeWindow:a,maximizeWindow:i,closeWindow:l}},Gc=()=>{const{user:t,logout:s}=Zr(),r=ei(m=>m.toggle),{isConnected:a,unreadCount:i,soundEnabled:l}=Jc(),{isElectron:c}=Xc();return e.jsxs("header",{className:"flex items-center justify-between border-b border-slate-200 bg-white/80 px-6 py-4 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:r,className:"lg:hidden rounded-full border border-slate-200 p-2 text-slate-600",children:e.jsx(uo,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Admin"}),e.jsxs("h2",{className:"text-lg font-semibold text-slate-900",children:["Welcome, ",t==null?void 0:t.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[c&&e.jsxs("div",{className:"flex items-center gap-1.5 rounded-full bg-slate-100 px-2 py-1",title:"Running as Desktop App",children:[e.jsx(wo,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Desktop"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",title:a?"Connected - Real-time updates active":"Disconnected - Reconnecting...",children:[e.jsx(Wo,{className:`h-4 w-4 ${a?"text-emerald-500":"text-slate-300"}`}),e.jsx("span",{className:`h-2 w-2 rounded-full ${a?"bg-emerald-500 animate-pulse":"bg-slate-300"}`})]}),e.jsx("div",{className:"flex items-center",title:l?"Sound notifications enabled":"Click anywhere to enable sound notifications",children:l?e.jsx(Fo,{className:"h-4 w-4 text-emerald-500"}):e.jsx(Mo,{className:"h-4 w-4 text-amber-500 animate-pulse"})}),e.jsxs("div",{className:"relative",children:[e.jsx(Xn,{className:"h-5 w-5 text-slate-500"}),i>0&&e.jsx("span",{className:"absolute -right-1 -top-1 flex h-4 w-4 items-center justify-center rounded-full bg-rose-500 text-[10px] font-bold text-white",children:i>9?"9+":i})]}),e.jsx("button",{onClick:s,className:"rounded-full border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-600 hover:border-slate-900 hover:text-slate-900",children:"Logout"})]})]})},ed=()=>{const{isOpen:t,close:s}=ei();return e.jsxs("div",{className:"flex min-h-screen bg-slate-50 text-slate-900",children:[e.jsx(hn,{}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx(Gc,{}),e.jsx("main",{className:"flex-1 px-4 py-6 sm:px-6 lg:px-10",children:e.jsx("div",{className:"mx-auto max-w-6xl",children:e.jsx(tl,{})})})]}),e.jsx("div",{className:Nt("fixed inset-0 z-40 bg-slate-900/60 backdrop-blur-sm transition-opacity lg:hidden",t?"opacity-100 pointer-events-auto":"pointer-events-none opacity-0"),onClick:s,children:e.jsx("div",{className:Nt("absolute inset-y-0 left-0 w-72 transform bg-white shadow-xl transition-transform",t?"translate-x-0":"-translate-x-full"),children:e.jsx(hn,{})})})]})};var Cs=t=>t.type==="checkbox",Mt=t=>t instanceof Date,ze=t=>t==null;const fi=t=>typeof t=="object";var Te=t=>!ze(t)&&!Array.isArray(t)&&fi(t)&&!Mt(t),td=t=>Te(t)&&t.target?Cs(t.target)?t.target.checked:t.target.value:t,sd=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,rd=(t,s)=>t.has(sd(s)),ad=t=>{const s=t.constructor&&t.constructor.prototype;return Te(s)&&s.hasOwnProperty("isPrototypeOf")},ta=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Re(t){let s;const r=Array.isArray(t),a=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)s=new Date(t);else if(!(ta&&(t instanceof Blob||a))&&(r||Te(t)))if(s=r?[]:Object.create(Object.getPrototypeOf(t)),!r&&!ad(t))s=t;else for(const i in t)t.hasOwnProperty(i)&&(s[i]=Re(t[i]));else return t;return s}var ir=t=>/^\w*$/.test(t),Ce=t=>t===void 0,sa=t=>Array.isArray(t)?t.filter(Boolean):[],ra=t=>sa(t.replace(/["|']|\]/g,"").split(/\.|\[/)),q=(t,s,r)=>{if(!s||!Te(t))return r;const a=(ir(s)?[s]:ra(s)).reduce((i,l)=>ze(i)?i:i[l],t);return Ce(a)||a===t?Ce(t[s])?r:t[s]:a},ot=t=>typeof t=="boolean",ve=(t,s,r)=>{let a=-1;const i=ir(s)?[s]:ra(s),l=i.length,c=l-1;for(;++a<l;){const m=i[a];let x=r;if(a!==c){const b=t[m];x=Te(b)||Array.isArray(b)?b:isNaN(+i[a+1])?{}:[]}if(m==="__proto__"||m==="constructor"||m==="prototype")return;t[m]=x,t=t[m]}};const bn={BLUR:"blur",FOCUS_OUT:"focusout"},st={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},vt={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},gi=je.createContext(null);gi.displayName="HookFormContext";const nd=()=>je.useContext(gi);var id=(t,s,r,a=!0)=>{const i={defaultValues:s._defaultValues};for(const l in t)Object.defineProperty(i,l,{get:()=>{const c=l;return s._proxyFormState[c]!==st.all&&(s._proxyFormState[c]=!a||st.all),t[c]}});return i};const bi=typeof window<"u"?je.useLayoutEffect:je.useEffect;var Je=t=>typeof t=="string",Wr=(t,s,r,a,i)=>Je(t)?(a&&s.watch.add(t),q(r,t,i)):Array.isArray(t)?t.map(l=>(a&&s.watch.add(l),q(r,l))):(a&&(s.watchAll=!0),r),Hr=t=>ze(t)||!fi(t);function rt(t,s,r=new WeakSet){if(Hr(t)||Hr(s))return Object.is(t,s);if(Mt(t)&&Mt(s))return t.getTime()===s.getTime();const a=Object.keys(t),i=Object.keys(s);if(a.length!==i.length)return!1;if(r.has(t)||r.has(s))return!0;r.add(t),r.add(s);for(const l of a){const c=t[l];if(!i.includes(l))return!1;if(l!=="ref"){const m=s[l];if(Mt(c)&&Mt(m)||Te(c)&&Te(m)||Array.isArray(c)&&Array.isArray(m)?!rt(c,m,r):!Object.is(c,m))return!1}}return!0}function ld(t){const s=nd(),{control:r=s.control,name:a,defaultValue:i,disabled:l,exact:c,compute:m}=t||{},x=je.useRef(i),b=je.useRef(m),h=je.useRef(void 0),p=je.useRef(r),j=je.useRef(a);b.current=m;const[Q,z]=je.useState(()=>{const P=r._getWatch(a,x.current);return b.current?b.current(P):P}),Z=je.useCallback(P=>{const I=Wr(a,r._names,P||r._formValues,!1,x.current);return b.current?b.current(I):I},[r._formValues,r._names,a]),T=je.useCallback(P=>{if(!l){const I=Wr(a,r._names,P||r._formValues,!1,x.current);if(b.current){const ce=b.current(I);rt(ce,h.current)||(z(ce),h.current=ce)}else z(I)}},[r._formValues,r._names,l,a]);bi(()=>((p.current!==r||!rt(j.current,a))&&(p.current=r,j.current=a,T()),r._subscribe({name:a,formState:{values:!0},exact:c,callback:P=>{T(P.values)}})),[r,c,a,T]),je.useEffect(()=>r._removeUnmounted());const B=p.current!==r,C=j.current,k=je.useMemo(()=>{if(l)return null;const P=!B&&!rt(C,a);return B||P?Z():null},[l,B,a,C,Z]);return k!==null?k:Q}var od=(t,s,r,a,i)=>s?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[a]:i||!0}}:{},js=t=>Array.isArray(t)?t:[t],yn=()=>{let t=[];return{get observers(){return t},next:i=>{for(const l of t)l.next&&l.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(l=>l!==i)}}),unsubscribe:()=>{t=[]}}};function yi(t,s){const r={};for(const a in t)if(t.hasOwnProperty(a)){const i=t[a],l=s[a];if(i&&Te(i)&&l){const c=yi(i,l);Te(c)&&(r[a]=c)}else t[a]&&(r[a]=l)}return r}var He=t=>Te(t)&&!Object.keys(t).length,aa=t=>t.type==="file",at=t=>typeof t=="function",Gs=t=>{if(!ta)return!1;const s=t?t.ownerDocument:0;return t instanceof(s&&s.defaultView?s.defaultView.HTMLElement:HTMLElement)},vi=t=>t.type==="select-multiple",na=t=>t.type==="radio",cd=t=>na(t)||Cs(t),Tr=t=>Gs(t)&&t.isConnected;function dd(t,s){const r=s.slice(0,-1).length;let a=0;for(;a<r;)t=Ce(t)?a++:t[s[a++]];return t}function ud(t){for(const s in t)if(t.hasOwnProperty(s)&&!Ce(t[s]))return!1;return!0}function _e(t,s){const r=Array.isArray(s)?s:ir(s)?[s]:ra(s),a=r.length===1?t:dd(t,r),i=r.length-1,l=r[i];return a&&delete a[l],i!==0&&(Te(a)&&He(a)||Array.isArray(a)&&ud(a))&&_e(t,r.slice(0,-1)),t}var md=t=>{for(const s in t)if(at(t[s]))return!0;return!1};function ji(t){return Array.isArray(t)||Te(t)&&!md(t)}function Kr(t,s={}){for(const r in t){const a=t[r];ji(a)?(s[r]=Array.isArray(a)?[]:{},Kr(a,s[r])):Ce(a)||(s[r]=!0)}return s}function Jt(t,s,r){r||(r=Kr(s));for(const a in t){const i=t[a];if(ji(i))Ce(s)||Hr(r[a])?r[a]=Kr(i,Array.isArray(i)?[]:{}):Jt(i,ze(s)?{}:s[a],r[a]);else{const l=s[a];r[a]=!rt(i,l)}}return r}const vn={value:!1,isValid:!1},jn={value:!0,isValid:!0};var wi=t=>{if(Array.isArray(t)){if(t.length>1){const s=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:s,isValid:!!s.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Ce(t[0].attributes.value)?Ce(t[0].value)||t[0].value===""?jn:{value:t[0].value,isValid:!0}:jn:vn}return vn},Ni=(t,{valueAsNumber:s,valueAsDate:r,setValueAs:a})=>Ce(t)?t:s?t===""?NaN:t&&+t:r&&Je(t)?new Date(t):a?a(t):t;const wn={isValid:!1,value:null};var Si=t=>Array.isArray(t)?t.reduce((s,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:s,wn):wn;function Nn(t){const s=t.ref;return aa(s)?s.files:na(s)?Si(t.refs).value:vi(s)?[...s.selectedOptions].map(({value:r})=>r):Cs(s)?wi(t.refs).value:Ni(Ce(s.value)?t.ref.value:s.value,t)}var hd=(t,s,r,a)=>{const i={};for(const l of t){const c=q(s,l);c&&ve(i,l,c._f)}return{criteriaMode:r,names:[...t],fields:i,shouldUseNativeValidation:a}},er=t=>t instanceof RegExp,fs=t=>Ce(t)?t:er(t)?t.source:Te(t)?er(t.value)?t.value.source:t.value:t,Sn=t=>({isOnSubmit:!t||t===st.onSubmit,isOnBlur:t===st.onBlur,isOnChange:t===st.onChange,isOnAll:t===st.all,isOnTouch:t===st.onTouched});const Cn="AsyncFunction";var pd=t=>!!t&&!!t.validate&&!!(at(t.validate)&&t.validate.constructor.name===Cn||Te(t.validate)&&Object.values(t.validate).find(s=>s.constructor.name===Cn)),xd=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),kn=(t,s,r)=>!r&&(s.watchAll||s.watch.has(t)||[...s.watch].some(a=>t.startsWith(a)&&/^\.\w+/.test(t.slice(a.length))));const ws=(t,s,r,a)=>{for(const i of r||Object.keys(t)){const l=q(t,i);if(l){const{_f:c,...m}=l;if(c){if(c.refs&&c.refs[0]&&s(c.refs[0],i)&&!a)return!0;if(c.ref&&s(c.ref,c.name)&&!a)return!0;if(ws(m,s))break}else if(Te(m)&&ws(m,s))break}}};function En(t,s,r){const a=q(t,r);if(a||ir(r))return{error:a,name:r};const i=r.split(".");for(;i.length;){const l=i.join("."),c=q(s,l),m=q(t,l);if(c&&!Array.isArray(c)&&r!==l)return{name:r};if(m&&m.type)return{name:l,error:m};if(m&&m.root&&m.root.type)return{name:`${l}.root`,error:m.root};i.pop()}return{name:r}}var fd=(t,s,r,a)=>{r(t);const{name:i,...l}=t;return He(l)||Object.keys(l).length>=Object.keys(s).length||Object.keys(l).find(c=>s[c]===(!a||st.all))},gd=(t,s,r)=>!t||!s||t===s||js(t).some(a=>a&&(r?a===s:a.startsWith(s)||s.startsWith(a))),bd=(t,s,r,a,i)=>i.isOnAll?!1:!r&&i.isOnTouch?!(s||t):(r?a.isOnBlur:i.isOnBlur)?!t:(r?a.isOnChange:i.isOnChange)?t:!0,yd=(t,s)=>!sa(q(t,s)).length&&_e(t,s),vd=(t,s,r)=>{const a=js(q(t,r));return ve(a,"root",s[r]),ve(t,r,a),t};function _n(t,s,r="validate"){if(Je(t)||Array.isArray(t)&&t.every(Je)||ot(t)&&!t)return{type:r,message:Je(t)?t:"",ref:s}}var Yt=t=>Te(t)&&!er(t)?t:{value:t,message:""},An=async(t,s,r,a,i,l)=>{const{ref:c,refs:m,required:x,maxLength:b,minLength:h,min:p,max:j,pattern:Q,validate:z,name:Z,valueAsNumber:T,mount:B}=t._f,C=q(r,Z);if(!B||s.has(Z))return{};const k=m?m[0]:c,P=M=>{i&&k.reportValidity&&(k.setCustomValidity(ot(M)?"":M||""),k.reportValidity())},I={},ce=na(c),be=Cs(c),ke=ce||be,ye=(T||aa(c))&&Ce(c.value)&&Ce(C)||Gs(c)&&c.value===""||C===""||Array.isArray(C)&&!C.length,S=od.bind(null,Z,a,I),K=(M,G,ie,me=vt.maxLength,xe=vt.minLength)=>{const we=M?G:ie;I[Z]={type:M?me:xe,message:we,ref:c,...S(M?me:xe,we)}};if(l?!Array.isArray(C)||!C.length:x&&(!ke&&(ye||ze(C))||ot(C)&&!C||be&&!wi(m).isValid||ce&&!Si(m).isValid)){const{value:M,message:G}=Je(x)?{value:!!x,message:x}:Yt(x);if(M&&(I[Z]={type:vt.required,message:G,ref:k,...S(vt.required,G)},!a))return P(G),I}if(!ye&&(!ze(p)||!ze(j))){let M,G;const ie=Yt(j),me=Yt(p);if(!ze(C)&&!isNaN(C)){const xe=c.valueAsNumber||C&&+C;ze(ie.value)||(M=xe>ie.value),ze(me.value)||(G=xe<me.value)}else{const xe=c.valueAsDate||new Date(C),we=Fe=>new Date(new Date().toDateString()+" "+Fe),De=c.type=="time",Ne=c.type=="week";Je(ie.value)&&C&&(M=De?we(C)>we(ie.value):Ne?C>ie.value:xe>new Date(ie.value)),Je(me.value)&&C&&(G=De?we(C)<we(me.value):Ne?C<me.value:xe<new Date(me.value))}if((M||G)&&(K(!!M,ie.message,me.message,vt.max,vt.min),!a))return P(I[Z].message),I}if((b||h)&&!ye&&(Je(C)||l&&Array.isArray(C))){const M=Yt(b),G=Yt(h),ie=!ze(M.value)&&C.length>+M.value,me=!ze(G.value)&&C.length<+G.value;if((ie||me)&&(K(ie,M.message,G.message),!a))return P(I[Z].message),I}if(Q&&!ye&&Je(C)){const{value:M,message:G}=Yt(Q);if(er(M)&&!C.match(M)&&(I[Z]={type:vt.pattern,message:G,ref:c,...S(vt.pattern,G)},!a))return P(G),I}if(z){if(at(z)){const M=await z(C,r),G=_n(M,k);if(G&&(I[Z]={...G,...S(vt.validate,G.message)},!a))return P(G.message),I}else if(Te(z)){let M={};for(const G in z){if(!He(M)&&!a)break;const ie=_n(await z[G](C,r),k,G);ie&&(M={...ie,...S(G,ie.message)},P(ie.message),a&&(I[Z]=M))}if(!He(M)&&(I[Z]={ref:k,...M},!a))return I}}return P(!0),I};const jd={mode:st.onSubmit,reValidateMode:st.onChange,shouldFocusError:!0};function wd(t={}){let s={...jd,...t},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:at(s.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1},a={},i=Te(s.defaultValues)||Te(s.values)?Re(s.defaultValues||s.values)||{}:{},l=s.shouldUnregister?{}:Re(i),c={action:!1,mount:!1,watch:!1},m={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},x,b=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let p={...h};const j={array:yn(),state:yn()},Q=s.criteriaMode===st.all,z=u=>f=>{clearTimeout(b),b=setTimeout(u,f)},Z=async u=>{if(!s.disabled&&(h.isValid||p.isValid||u)){const f=s.resolver?He((await be()).errors):await ye(a,!0);f!==r.isValid&&j.state.next({isValid:f})}},T=(u,f)=>{!s.disabled&&(h.isValidating||h.validatingFields||p.isValidating||p.validatingFields)&&((u||Array.from(m.mount)).forEach(y=>{y&&(f?ve(r.validatingFields,y,f):_e(r.validatingFields,y))}),j.state.next({validatingFields:r.validatingFields,isValidating:!He(r.validatingFields)}))},B=(u,f=[],y,D,A=!0,_=!0)=>{if(D&&y&&!s.disabled){if(c.action=!0,_&&Array.isArray(q(a,u))){const R=y(q(a,u),D.argA,D.argB);A&&ve(a,u,R)}if(_&&Array.isArray(q(r.errors,u))){const R=y(q(r.errors,u),D.argA,D.argB);A&&ve(r.errors,u,R),yd(r.errors,u)}if((h.touchedFields||p.touchedFields)&&_&&Array.isArray(q(r.touchedFields,u))){const R=y(q(r.touchedFields,u),D.argA,D.argB);A&&ve(r.touchedFields,u,R)}(h.dirtyFields||p.dirtyFields)&&(r.dirtyFields=Jt(i,l)),j.state.next({name:u,isDirty:K(u,f),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else ve(l,u,f)},C=(u,f)=>{ve(r.errors,u,f),j.state.next({errors:r.errors})},k=u=>{r.errors=u,j.state.next({errors:r.errors,isValid:!1})},P=(u,f,y,D)=>{const A=q(a,u);if(A){const _=q(l,u,Ce(y)?q(i,u):y);Ce(_)||D&&D.defaultChecked||f?ve(l,u,f?_:Nn(A._f)):ie(u,_),c.mount&&!c.action&&Z()}},I=(u,f,y,D,A)=>{let _=!1,R=!1;const te={name:u};if(!s.disabled){if(!y||D){(h.isDirty||p.isDirty)&&(R=r.isDirty,r.isDirty=te.isDirty=K(),_=R!==te.isDirty);const ae=rt(q(i,u),f);R=!!q(r.dirtyFields,u),ae?_e(r.dirtyFields,u):ve(r.dirtyFields,u,!0),te.dirtyFields=r.dirtyFields,_=_||(h.dirtyFields||p.dirtyFields)&&R!==!ae}if(y){const ae=q(r.touchedFields,u);ae||(ve(r.touchedFields,u,y),te.touchedFields=r.touchedFields,_=_||(h.touchedFields||p.touchedFields)&&ae!==y)}_&&A&&j.state.next(te)}return _?te:{}},ce=(u,f,y,D)=>{const A=q(r.errors,u),_=(h.isValid||p.isValid)&&ot(f)&&r.isValid!==f;if(s.delayError&&y?(x=z(()=>C(u,y)),x(s.delayError)):(clearTimeout(b),x=null,y?ve(r.errors,u,y):_e(r.errors,u)),(y?!rt(A,y):A)||!He(D)||_){const R={...D,..._&&ot(f)?{isValid:f}:{},errors:r.errors,name:u};r={...r,...R},j.state.next(R)}},be=async u=>{T(u,!0);const f=await s.resolver(l,s.context,hd(u||m.mount,a,s.criteriaMode,s.shouldUseNativeValidation));return T(u),f},ke=async u=>{const{errors:f}=await be(u);if(u)for(const y of u){const D=q(f,y);D?ve(r.errors,y,D):_e(r.errors,y)}else r.errors=f;return f},ye=async(u,f,y={valid:!0})=>{for(const D in u){const A=u[D];if(A){const{_f:_,...R}=A;if(_){const te=m.array.has(_.name),ae=A._f&&pd(A._f);ae&&h.validatingFields&&T([_.name],!0);const Ie=await An(A,m.disabled,l,Q,s.shouldUseNativeValidation&&!f,te);if(ae&&h.validatingFields&&T([_.name]),Ie[_.name]&&(y.valid=!1,f))break;!f&&(q(Ie,_.name)?te?vd(r.errors,Ie,_.name):ve(r.errors,_.name,Ie[_.name]):_e(r.errors,_.name))}!He(R)&&await ye(R,f,y)}}return y.valid},S=()=>{for(const u of m.unMount){const f=q(a,u);f&&(f._f.refs?f._f.refs.every(y=>!Tr(y)):!Tr(f._f.ref))&&X(u)}m.unMount=new Set},K=(u,f)=>!s.disabled&&(u&&f&&ve(l,u,f),!rt(Fe(),i)),M=(u,f,y)=>Wr(u,m,{...c.mount?l:Ce(f)?i:Je(u)?{[u]:f}:f},y,f),G=u=>sa(q(c.mount?l:i,u,s.shouldUnregister?q(i,u,[]):[])),ie=(u,f,y={})=>{const D=q(a,u);let A=f;if(D){const _=D._f;_&&(!_.disabled&&ve(l,u,Ni(f,_)),A=Gs(_.ref)&&ze(f)?"":f,vi(_.ref)?[..._.ref.options].forEach(R=>R.selected=A.includes(R.value)):_.refs?Cs(_.ref)?_.refs.forEach(R=>{(!R.defaultChecked||!R.disabled)&&(Array.isArray(A)?R.checked=!!A.find(te=>te===R.value):R.checked=A===R.value||!!A)}):_.refs.forEach(R=>R.checked=R.value===A):aa(_.ref)?_.ref.value="":(_.ref.value=A,_.ref.type||j.state.next({name:u,values:Re(l)})))}(y.shouldDirty||y.shouldTouch)&&I(u,A,y.shouldTouch,y.shouldDirty,!0),y.shouldValidate&&Ne(u)},me=(u,f,y)=>{for(const D in f){if(!f.hasOwnProperty(D))return;const A=f[D],_=u+"."+D,R=q(a,_);(m.array.has(u)||Te(A)||R&&!R._f)&&!Mt(A)?me(_,A,y):ie(_,A,y)}},xe=(u,f,y={})=>{const D=q(a,u),A=m.array.has(u),_=Re(f);ve(l,u,_),A?(j.array.next({name:u,values:Re(l)}),(h.isDirty||h.dirtyFields||p.isDirty||p.dirtyFields)&&y.shouldDirty&&j.state.next({name:u,dirtyFields:Jt(i,l),isDirty:K(u,_)})):D&&!D._f&&!ze(_)?me(u,_,y):ie(u,_,y),kn(u,m)&&j.state.next({...r,name:u}),j.state.next({name:c.mount?u:void 0,values:Re(l)})},we=async u=>{c.mount=!0;const f=u.target;let y=f.name,D=!0;const A=q(a,y),_=ae=>{D=Number.isNaN(ae)||Mt(ae)&&isNaN(ae.getTime())||rt(ae,q(l,y,ae))},R=Sn(s.mode),te=Sn(s.reValidateMode);if(A){let ae,Ie;const w=f.type?Nn(A._f):td(u),ue=u.type===bn.BLUR||u.type===bn.FOCUS_OUT,Se=!xd(A._f)&&!s.resolver&&!q(r.errors,y)&&!A._f.deps||bd(ue,q(r.touchedFields,y),r.isSubmitted,te,R),_t=kn(y,m,ue);ve(l,y,w),ue?(!f||!f.readOnly)&&(A._f.onBlur&&A._f.onBlur(u),x&&x(0)):A._f.onChange&&A._f.onChange(u);const xt=I(y,w,ue),Ft=!He(xt)||_t;if(!ue&&j.state.next({name:y,type:u.type,values:Re(l)}),Se)return(h.isValid||p.isValid)&&(s.mode==="onBlur"?ue&&Z():ue||Z()),Ft&&j.state.next({name:y,..._t?{}:xt});if(!ue&&_t&&j.state.next({...r}),s.resolver){const{errors:Ge}=await be([y]);if(_(w),D){const Ut=En(r.errors,a,y),Vt=En(Ge,a,Ut.name||y);ae=Vt.error,y=Vt.name,Ie=He(Ge)}}else T([y],!0),ae=(await An(A,m.disabled,l,Q,s.shouldUseNativeValidation))[y],T([y]),_(w),D&&(ae?Ie=!1:(h.isValid||p.isValid)&&(Ie=await ye(a,!0)));D&&(A._f.deps&&(!Array.isArray(A._f.deps)||A._f.deps.length>0)&&Ne(A._f.deps),ce(y,Ie,ae,xt))}},De=(u,f)=>{if(q(r.errors,f)&&u.focus)return u.focus(),1},Ne=async(u,f={})=>{let y,D;const A=js(u);if(s.resolver){const _=await ke(Ce(u)?u:A);y=He(_),D=u?!A.some(R=>q(_,R)):y}else u?(D=(await Promise.all(A.map(async _=>{const R=q(a,_);return await ye(R&&R._f?{[_]:R}:R)}))).every(Boolean),!(!D&&!r.isValid)&&Z()):D=y=await ye(a);return j.state.next({...!Je(u)||(h.isValid||p.isValid)&&y!==r.isValid?{}:{name:u},...s.resolver||!u?{isValid:y}:{},errors:r.errors}),f.shouldFocus&&!D&&ws(a,De,u?A:m.mount),D},Fe=(u,f)=>{let y={...c.mount?l:i};return f&&(y=yi(f.dirtyFields?r.dirtyFields:r.touchedFields,y)),Ce(u)?y:Je(u)?q(y,u):u.map(D=>q(y,D))},v=(u,f)=>({invalid:!!q((f||r).errors,u),isDirty:!!q((f||r).dirtyFields,u),error:q((f||r).errors,u),isValidating:!!q(r.validatingFields,u),isTouched:!!q((f||r).touchedFields,u)}),ee=u=>{u&&js(u).forEach(f=>_e(r.errors,f)),j.state.next({errors:u?r.errors:{}})},le=(u,f,y)=>{const D=(q(a,u,{_f:{}})._f||{}).ref,A=q(r.errors,u)||{},{ref:_,message:R,type:te,...ae}=A;ve(r.errors,u,{...ae,...f,ref:D}),j.state.next({name:u,errors:r.errors,isValid:!1}),y&&y.shouldFocus&&D&&D.focus&&D.focus()},Le=(u,f)=>at(u)?j.state.subscribe({next:y=>"values"in y&&u(M(void 0,f),y)}):M(u,f,!0),E=u=>j.state.subscribe({next:f=>{gd(u.name,f.name,u.exact)&&fd(f,u.formState||h,Rt,u.reRenderRoot)&&u.callback({values:{...l},...r,...f,defaultValues:i})}}).unsubscribe,Y=u=>(c.mount=!0,p={...p,...u.formState},E({...u,formState:p})),X=(u,f={})=>{for(const y of u?js(u):m.mount)m.mount.delete(y),m.array.delete(y),f.keepValue||(_e(a,y),_e(l,y)),!f.keepError&&_e(r.errors,y),!f.keepDirty&&_e(r.dirtyFields,y),!f.keepTouched&&_e(r.touchedFields,y),!f.keepIsValidating&&_e(r.validatingFields,y),!s.shouldUnregister&&!f.keepDefaultValue&&_e(i,y);j.state.next({values:Re(l)}),j.state.next({...r,...f.keepDirty?{isDirty:K()}:{}}),!f.keepIsValid&&Z()},he=({disabled:u,name:f})=>{(ot(u)&&c.mount||u||m.disabled.has(f))&&(u?m.disabled.add(f):m.disabled.delete(f))},nt=(u,f={})=>{let y=q(a,u);const D=ot(f.disabled)||ot(s.disabled);return ve(a,u,{...y||{},_f:{...y&&y._f?y._f:{ref:{name:u}},name:u,mount:!0,...f}}),m.mount.add(u),y?he({disabled:ot(f.disabled)?f.disabled:s.disabled,name:u}):P(u,!0,f.value),{...D?{disabled:f.disabled||s.disabled}:{},...s.progressive?{required:!!f.required,min:fs(f.min),max:fs(f.max),minLength:fs(f.minLength),maxLength:fs(f.maxLength),pattern:fs(f.pattern)}:{},name:u,onChange:we,onBlur:we,ref:A=>{if(A){nt(u,f),y=q(a,u);const _=Ce(A.value)&&A.querySelectorAll&&A.querySelectorAll("input,select,textarea")[0]||A,R=cd(_),te=y._f.refs||[];if(R?te.find(ae=>ae===_):_===y._f.ref)return;ve(a,u,{_f:{...y._f,...R?{refs:[...te.filter(Tr),_,...Array.isArray(q(i,u))?[{}]:[]],ref:{type:_.type,name:u}}:{ref:_}}}),P(u,!1,void 0,_)}else y=q(a,u,{}),y._f&&(y._f.mount=!1),(s.shouldUnregister||f.shouldUnregister)&&!(rd(m.array,u)&&c.action)&&m.unMount.add(u)}}},Ye=()=>s.shouldFocusError&&ws(a,De,m.mount),Ct=u=>{ot(u)&&(j.state.next({disabled:u}),ws(a,(f,y)=>{const D=q(a,y);D&&(f.disabled=D._f.disabled||u,Array.isArray(D._f.refs)&&D._f.refs.forEach(A=>{A.disabled=D._f.disabled||u}))},0,!1))},it=(u,f)=>async y=>{let D;y&&(y.preventDefault&&y.preventDefault(),y.persist&&y.persist());let A=Re(l);if(j.state.next({isSubmitting:!0}),s.resolver){const{errors:_,values:R}=await be();r.errors=_,A=Re(R)}else await ye(a);if(m.disabled.size)for(const _ of m.disabled)_e(A,_);if(_e(r.errors,"root"),He(r.errors)){j.state.next({errors:{}});try{await u(A,y)}catch(_){D=_}}else f&&await f({...r.errors},y),Ye(),setTimeout(Ye);if(j.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:He(r.errors)&&!D,submitCount:r.submitCount+1,errors:r.errors}),D)throw D},pe=(u,f={})=>{q(a,u)&&(Ce(f.defaultValue)?xe(u,Re(q(i,u))):(xe(u,f.defaultValue),ve(i,u,Re(f.defaultValue))),f.keepTouched||_e(r.touchedFields,u),f.keepDirty||(_e(r.dirtyFields,u),r.isDirty=f.defaultValue?K(u,Re(q(i,u))):K()),f.keepError||(_e(r.errors,u),h.isValid&&Z()),j.state.next({...r}))},ht=(u,f={})=>{const y=u?Re(u):i,D=Re(y),A=He(u),_=A?i:D;if(f.keepDefaultValues||(i=y),!f.keepValues){if(f.keepDirtyValues){const R=new Set([...m.mount,...Object.keys(Jt(i,l))]);for(const te of Array.from(R))q(r.dirtyFields,te)?ve(_,te,q(l,te)):xe(te,q(_,te))}else{if(ta&&Ce(u))for(const R of m.mount){const te=q(a,R);if(te&&te._f){const ae=Array.isArray(te._f.refs)?te._f.refs[0]:te._f.ref;if(Gs(ae)){const Ie=ae.closest("form");if(Ie){Ie.reset();break}}}}if(f.keepFieldsRef)for(const R of m.mount)xe(R,q(_,R));else a={}}l=s.shouldUnregister?f.keepDefaultValues?Re(i):{}:Re(_),j.array.next({values:{..._}}),j.state.next({values:{..._}})}m={mount:f.keepDirtyValues?m.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},c.mount=!h.isValid||!!f.keepIsValid||!!f.keepDirtyValues||!s.shouldUnregister&&!He(_),c.watch=!!s.shouldUnregister,j.state.next({submitCount:f.keepSubmitCount?r.submitCount:0,isDirty:A?!1:f.keepDirty?r.isDirty:!!(f.keepDefaultValues&&!rt(u,i)),isSubmitted:f.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:A?{}:f.keepDirtyValues?f.keepDefaultValues&&l?Jt(i,l):r.dirtyFields:f.keepDefaultValues&&u?Jt(i,u):f.keepDirty?r.dirtyFields:{},touchedFields:f.keepTouched?r.touchedFields:{},errors:f.keepErrors?r.errors:{},isSubmitSuccessful:f.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},pt=(u,f)=>ht(at(u)?u(l):u,f),kt=(u,f={})=>{const y=q(a,u),D=y&&y._f;if(D){const A=D.refs?D.refs[0]:D.ref;A.focus&&(A.focus(),f.shouldSelect&&at(A.select)&&A.select())}},Rt=u=>{r={...r,...u}},Et={control:{register:nt,unregister:X,getFieldState:v,handleSubmit:it,setError:le,_subscribe:E,_runSchema:be,_focusError:Ye,_getWatch:M,_getDirty:K,_setValid:Z,_setFieldArray:B,_setDisabledField:he,_setErrors:k,_getFieldArray:G,_reset:ht,_resetDefaultValues:()=>at(s.defaultValues)&&s.defaultValues().then(u=>{pt(u,s.resetOptions),j.state.next({isLoading:!1})}),_removeUnmounted:S,_disableForm:Ct,_subjects:j,_proxyFormState:h,get _fields(){return a},get _formValues(){return l},get _state(){return c},set _state(u){c=u},get _defaultValues(){return i},get _names(){return m},set _names(u){m=u},get _formState(){return r},get _options(){return s},set _options(u){s={...s,...u}}},subscribe:Y,trigger:Ne,register:nt,handleSubmit:it,watch:Le,setValue:xe,getValues:Fe,reset:pt,resetField:pe,clearErrors:ee,unregister:X,setError:le,setFocus:kt,getFieldState:v};return{...Et,formControl:Et}}function mt(t={}){const s=je.useRef(void 0),r=je.useRef(void 0),[a,i]=je.useState({isDirty:!1,isValidating:!1,isLoading:at(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:at(t.defaultValues)?void 0:t.defaultValues});if(!s.current)if(t.formControl)s.current={...t.formControl,formState:a},t.defaultValues&&!at(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:c,...m}=wd(t);s.current={...m,formState:a}}const l=s.current.control;return l._options=t,bi(()=>{const c=l._subscribe({formState:l._proxyFormState,callback:()=>i({...l._formState}),reRenderRoot:!0});return i(m=>({...m,isReady:!0})),l._formState.isReady=!0,c},[l]),je.useEffect(()=>l._disableForm(t.disabled),[l,t.disabled]),je.useEffect(()=>{t.mode&&(l._options.mode=t.mode),t.reValidateMode&&(l._options.reValidateMode=t.reValidateMode)},[l,t.mode,t.reValidateMode]),je.useEffect(()=>{t.errors&&(l._setErrors(t.errors),l._focusError())},[l,t.errors]),je.useEffect(()=>{t.shouldUnregister&&l._subjects.state.next({values:l._getWatch()})},[l,t.shouldUnregister]),je.useEffect(()=>{if(l._proxyFormState.isDirty){const c=l._getDirty();c!==a.isDirty&&l._subjects.state.next({isDirty:c})}},[l,a.isDirty]),je.useEffect(()=>{var c;t.values&&!rt(t.values,r.current)?(l._reset(t.values,{keepFieldsRef:!0,...l._options.resetOptions}),!((c=l._options.resetOptions)===null||c===void 0)&&c.keepIsValid||l._setValid(),r.current=t.values,i(m=>({...m}))):l._resetDefaultValues()},[l,t.values]),je.useEffect(()=>{l._state.mount||(l._setValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),s.current.formState=id(a,l),s.current}const U=({children:t,className:s,variant:r="primary",icon:a,loading:i,disabled:l,...c})=>{const m={primary:"bg-slate-900 text-white hover:bg-slate-800",secondary:"bg-white text-slate-900 border border-slate-200 hover:border-slate-900",ghost:"bg-transparent text-slate-600 hover:text-slate-900"};return e.jsxs("button",{className:Nt("inline-flex items-center justify-center gap-2 rounded-xl px-4 py-2 text-sm font-semibold transition-all focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-900 disabled:opacity-60",m[r],s),disabled:l||i,...c,children:[i&&e.jsx("span",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white/30 border-l-white","aria-hidden":!0}),a,t]})},L=o.forwardRef(({label:t,className:s,helpText:r,icon:a,...i},l)=>e.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:[t&&e.jsx("span",{className:"font-medium text-slate-900",children:t}),e.jsxs("div",{className:"relative",children:[a&&e.jsx("span",{className:"pointer-events-none absolute inset-y-0 left-3 flex items-center text-slate-400",children:a}),e.jsx("input",{ref:l,className:Nt("w-full rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-slate-900 placeholder:text-slate-400 focus:border-slate-900 focus:outline-none",a&&"pl-10",s),...i})]}),r&&e.jsx("span",{className:"text-xs text-slate-400",children:r})]}));L.displayName="Input";const Nd={email:"",password:"",role:"admin"},Sd=()=>{const{register:t,handleSubmit:s,formState:{isSubmitting:r}}=mt({defaultValues:Nd}),{login:a,isAuthenticated:i}=Zr(),l=tr(),c=async m=>{await a(m),l("/",{replace:!0})};return o.useEffect(()=>{i&&l("/",{replace:!0})},[i,l]),i?null:e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 px-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-3xl border border-white/5 bg-white/10 p-8 backdrop-blur",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-white/70",children:"Fixzep"}),e.jsx("h1",{className:"mt-4 text-3xl font-bold text-white",children:"Admin Control Login"}),e.jsx("p",{className:"mt-2 text-sm text-white/70",children:"Use your admin credentials to access mission control."}),e.jsxs("form",{onSubmit:s(c),className:"mt-8 space-y-5",children:[e.jsx(L,{type:"email",label:"Email",placeholder:"admin@fixzep.com",...t("email",{required:!0}),className:"bg-white/90"}),e.jsx(L,{type:"password",label:"Password",placeholder:"",...t("password",{required:!0}),className:"bg-white/90"}),e.jsx(U,{type:"submit",loading:r,className:"w-full justify-center text-base",children:"Enter Dashboard"})]})]})})},qe=({children:t,className:s,title:r,actions:a})=>e.jsxs("section",{className:Nt("rounded-2xl border border-white/60 bg-white/90 p-6 shadow-card backdrop-blur",s),children:[(r||a)&&e.jsxs("header",{className:"mb-4 flex items-center justify-between gap-4",children:[r&&e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:r}),a]}),t]}),$e=t=>new Intl.DateTimeFormat("en-IN",{dateStyle:"medium",timeStyle:"short"}).format(new Date(t)),We=(t,s="INR")=>{const r=typeof t=="number"?t:0;return new Intl.NumberFormat("en-IN",{style:"currency",currency:s,maximumFractionDigits:0}).format(r)},Cd=new Set(["completed","cancelled"]),kd=()=>{var h;const{data:t=[],isLoading:s}=ge({queryKey:["orders","dashboard"],queryFn:()=>Ee.list()}),{data:r=[],isLoading:a}=ge({queryKey:["technicians","dashboard"],queryFn:()=>Xt.list()}),i=o.useMemo(()=>{const p=s?null:t.filter(z=>!Cd.has(z.status)),j=p?p.filter(z=>z.status==="pending_assignment"):null,Q=a?null:r.filter(z=>{var Z;return((Z=z.todayAttendance)==null?void 0:Z.status)==="present"});return[{label:"Open Orders",value:(p==null?void 0:p.length.toString())??"",delta:j?`${j.length} awaiting assignment`:"fetching",accent:p?"text-slate-900":"text-slate-400",link:"/orders"},{label:"Pending Assignments",value:(j==null?void 0:j.length.toString())??"",delta:p&&j?`${p.length-j.length} already scheduled`:"fetching",accent:j?j.length?"text-amber-600":"text-emerald-600":"text-slate-400",link:"/orders?status=pending_assignment"},{label:"Technicians Active",value:(Q==null?void 0:Q.length.toString())??"",delta:Q?`${r.length} on roster`:"fetching",accent:Q?Q.length?"text-emerald-600":"text-rose-600":"text-slate-400",link:"/technicians"}]},[t,r,s,a]),l=o.useMemo(()=>t.filter(p=>p.status==="pending_assignment"&&new Date(p.timeWindowStart).getTime()<Date.now()).sort((p,j)=>new Date(p.timeWindowStart).getTime()-new Date(j.timeWindowStart).getTime()),[t]),c=o.useMemo(()=>t.filter(p=>p.status==="rescheduled"||p.status==="awaiting_customer_approval"),[t]),m=o.useMemo(()=>r.filter(p=>!p.todayAttendance||p.todayAttendance.status!=="present"),[r]),x=[...l.slice(0,3).map(p=>({id:p._id,text:`${Qr(p)} missed ${$e(p.timeWindowStart)} without technician assigned.`,link:`/orders?selected=${p._id}`})),...c.slice(0,2).map(p=>({id:`${p._id}-reschedule`,text:`${Qr(p)} awaiting reschedule confirmation.`,link:`/orders?selected=${p._id}`}))],b=[l[0]?{text:Ed(l[0],"Assign technician"),link:`/orders?selected=${l[0]._id}`}:null,m.length?{text:`Mark attendance for ${m[0].name} to include them in assignments.`,link:`/technicians?selected=${m[0].id}`}:null,c.length?{text:`Confirm reschedule for ${c[0].customer.name} (${(h=c[0].serviceItem)==null?void 0:h.name}).`,link:`/orders?selected=${c[0]._id}`}:null].filter(Boolean);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Mission Control"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Realtime Ops Snapshot"})]}),e.jsxs(Zt,{to:"/orders",className:"inline-flex items-center gap-2 rounded-2xl bg-slate-900 px-5 py-3 text-sm font-semibold text-white shadow-card",children:["Review Orders",e.jsx(lo,{className:"h-4 w-4"})]})]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-3",children:i.map(p=>e.jsx(Zt,{to:p.link,className:"group",children:e.jsxs(qe,{className:"transition-all duration-200 group-hover:shadow-lg group-hover:border-slate-200 group-hover:-translate-y-0.5",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:p.label}),e.jsx(no,{className:"h-4 w-4 text-slate-300 transition-colors group-hover:text-slate-500"})]}),e.jsx("p",{className:`mt-3 text-3xl font-semibold ${p.accent}`,children:p.value}),e.jsx("p",{className:"mt-1 text-xs uppercase tracking-[0.3em] text-slate-400",children:p.delta})]})},p.label))}),e.jsx(qe,{title:"Operations Heatmap",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-600",children:"Critical Alerts"}),x.length>0&&e.jsx(Zt,{to:"/orders",className:"text-xs text-slate-400 hover:text-slate-600 transition-colors",children:"View all "})]}),e.jsxs("ul",{className:"mt-4 space-y-3 text-sm",children:[x.length===0&&e.jsx("li",{className:"text-slate-400",children:"All clear. No SLA breaches detected."}),x.map(p=>e.jsx("li",{children:e.jsxs(Zt,{to:p.link,className:"text-slate-500 hover:text-slate-800 transition-colors cursor-pointer",children:[" ",p.text]})},p.id))]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-600",children:"Next Best Actions"}),b.length>0&&e.jsx(Zt,{to:"/orders",className:"text-xs text-slate-400 hover:text-slate-600 transition-colors",children:"View all "})]}),e.jsxs("ol",{className:"mt-4 space-y-3 text-sm",children:[b.length===0&&e.jsx("li",{className:"text-slate-400",children:"You're fully caught up for now."}),b.map((p,j)=>e.jsx("li",{children:e.jsxs(Zt,{to:p.link,className:"text-slate-500 hover:text-slate-800 transition-colors cursor-pointer",children:[j+1,". ",p.text]})},p.text))]})]})]})})]})},Ed=(t,s="Update order")=>t?`${s} for ${Qr(t)} scheduled ${$e(t.timeWindowStart)}.`:null,Qr=t=>{var a,i;const s=((a=t.customer)==null?void 0:a.name)??"Customer",r=((i=t.serviceItem)==null?void 0:i.name)??"Service";return`${s} (${r})`},Tn={new:"bg-slate-100 text-slate-700",pending_assignment:"bg-amber-100 text-amber-800",assigned:"bg-blue-100 text-blue-800",in_progress:"bg-indigo-100 text-indigo-800",completed:"bg-emerald-100 text-emerald-700",cancelled:"bg-rose-100 text-rose-700",follow_up:"bg-orange-100 text-orange-800",unpaid:"bg-rose-100 text-rose-700",partially_paid:"bg-amber-100 text-amber-800",pending:"bg-slate-100 text-slate-700",partial:"bg-amber-100 text-amber-800",paid:"bg-emerald-100 text-emerald-700"},Ys=({variant:t="new",children:s})=>e.jsx("span",{className:Nt("rounded-full px-3 py-1 text-xs font-semibold capitalize",Tn[t]||Tn.new),children:s}),Qe=o.forwardRef(({label:t,className:s,children:r,...a},i)=>e.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:[t&&e.jsx("span",{className:"font-medium text-slate-900",children:t}),e.jsx("select",{ref:i,className:Nt("w-full rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-slate-900 focus:border-slate-900 focus:outline-none",s),...a,children:r})]}));Qe.displayName="Select";const Dt=o.forwardRef(({label:t,className:s,...r},a)=>e.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:[t&&e.jsx("span",{className:"font-medium text-slate-900",children:t}),e.jsx("textarea",{ref:a,className:Nt("w-full rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-slate-900 placeholder:text-slate-400 focus:border-slate-900 focus:outline-none",s),rows:r.rows||3,...r})]}));Dt.displayName="TextArea";const _d={md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",xxl:"max-w-8xl"},Ze=({open:t,onClose:s,title:r,children:a,size:i="md",showCloseButton:l=!1})=>e.jsx(Gt,{appear:!0,show:t,as:o.Fragment,children:e.jsxs(es,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(Gt.Child,{as:o.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/50"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsx(Gt.Child,{as:o.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-150",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(es.Panel,{className:`w-full ${_d[i]} transform rounded-2xl bg-white p-6 text-left align-middle shadow-xl`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx(es.Title,{as:"h3",className:"text-lg font-semibold text-slate-900",children:r}),l&&e.jsx("button",{type:"button",onClick:s,className:"rounded-full p-1 text-slate-500 transition hover:bg-slate-100 hover:text-slate-900","aria-label":"Close modal",children:""})]}),e.jsx("div",{className:"mt-4 space-y-4",children:a})]})})})})]})}),Ci=({open:t,onClose:s,title:r,children:a,widthClassName:i="w-screen max-w-lg"})=>e.jsx(Gt,{show:t,as:o.Fragment,appear:!0,children:e.jsxs(es,{as:"div",className:"relative z-[60]",onClose:()=>{},static:!0,children:[e.jsx(Gt.Child,{as:o.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 cursor-pointer",onClick:s,"aria-hidden":"true"})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"fixed inset-y-0 right-0 flex max-w-full pl-8",children:e.jsx(Gt.Child,{as:o.Fragment,enter:"transform transition ease-out duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in duration-200",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsx(es.Panel,{className:`pointer-events-auto ${i} bg-white shadow-2xl`,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-slate-100 px-6 py-4",children:[e.jsx("div",{children:e.jsx(es.Title,{className:"text-base font-semibold text-slate-900",children:r})}),e.jsxs("button",{type:"button",className:"rounded-full p-1 text-slate-400 transition hover:text-slate-600",onClick:s,children:[e.jsx("span",{className:"sr-only",children:"Close panel"}),e.jsx(ys,{className:"h-5 w-5"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:a})]})})})})})})]})}),gs=t=>t._id??`${t.dayOfWeek}-${t.startTime}-${t.endTime}-${t.label??""}`,Ad=t=>{const[s,r,a]=t.split("-"),i=Number(s),l=Number(r),c=Number(a);if(!Number.isFinite(i)||!Number.isFinite(l)||!Number.isFinite(c))return null;const m=new Date(i,l-1,c);return Number.isNaN(m.getTime())?null:m.getDay()},Td=[{value:"",label:"All statuses"},{value:"pending_assignment",label:"Pending assignment"},{value:"assigned",label:"Assigned"},{value:"in_progress",label:"In progress"},{value:"completed",label:"Completed"},{value:"cancellation_requested",label:"Cancellation requested"},{value:"follow_up",label:"Follow up"},{value:"unpaid",label:"Unpaid"},{value:"partially_paid",label:"Partially paid"}],ki=[{value:"follow_up",label:"Follow up"},{value:"in_progress",label:"In progress"},{value:"completed",label:"Completed"}],Pd=ki.map(t=>t.value),Ei=[{value:"pending",label:"Pending"},{value:"partial",label:"Partially paid"},{value:"paid",label:"Paid"}],Od=Ei.map(t=>t.value),Pr=t=>{if(!t)return"";const s=t.replace(/_/g," ");return s.charAt(0).toUpperCase()+s.slice(1)},Dd=t=>t?typeof t=="string"?t:t.name||"System":"System",Id=t=>t?[t.addressLine1,t.addressLine2,t.city,t.state,t.postalCode].filter(Boolean).join(", "):"",Pn=(t,s=7)=>{const r=[];for(let a=0;a<s;a++){const i=new Date(t);i.setDate(t.getDate()+a),r.push(i)}return r},On=t=>t.toLocaleDateString("en-IN",{weekday:"short",day:"numeric",month:"short"}),Rd=(t,s,r,a)=>{const[i,l]=s.split(":").map(Number),[c,m]=r.split(":").map(Number),x=new Date(t);x.setHours(i,l,0,0);const b=new Date(t);b.setHours(c,m,0,0);for(const h of a){const p=new Date(h.start),j=new Date(h.end);if(p<b&&j>x)return h}return null},lt=(t,s)=>{const[r,a]=s.split(":").map(Number),i=new Date(t);return i.setHours(r,a,0,0),i},Fd=()=>{var ka,Ea,_a,Aa,Ta,Pa,Oa,Da,Ia,Ra,Fa,La,Ma,Ba,$a,qa,Ua,Va,Wa,Ha,Ka,Qa,za,Za,Ya,Ja,Xa,Ga,en,tn;const[t,s]=qn(),[r,a]=o.useState(()=>t.get("status")||""),[i,l]=o.useState(!1),[c,m]=o.useState({order:null,open:!1}),[x,b]=o.useState({order:null,open:!1}),[h,p]=o.useState({order:null,open:!1}),[j,Q]=o.useState(()=>t.get("selected")),[z,Z]=o.useState({open:!1,url:"",name:""}),[T,B]=o.useState(100),[C,k]=o.useState(null),[P,I]=o.useState(""),[ce,be]=o.useState(null),[ke,ye]=o.useState(""),[S,K]=o.useState(null),[M,G]=o.useState(""),[ie,me]=o.useState(""),[xe,we]=o.useState(""),[De,Ne]=o.useState(""),[Fe,v]=o.useState(""),[ee,le]=o.useState(""),[Le,E]=o.useState(""),[Y,X]=o.useState(""),[he,nt]=o.useState(""),[Ye,Ct]=o.useState(""),[it,pe]=o.useState(""),[ht,pt]=o.useState("09:00"),[kt,Rt]=o.useState("11:00"),[qt,Et]=o.useState(""),[u,f]=o.useState(!1),[y,D]=o.useState({open:!1,technicianId:null,name:""}),[A,_]=o.useState(()=>{const n=new Date;return n.setHours(0,0,0,0),n}),[R,te]=o.useState([]),[ae,Ie]=o.useState(""),[w,ue]=o.useState(""),[Se,_t]=o.useState(""),[xt,Ft]=o.useState([]),[Ge,Ut]=o.useState([]),[Vt,lr]=o.useState(""),[ia,la]=o.useState(null),[or,oa]=o.useState(!1),[Wt,ca]=o.useState(""),[ks,da]=o.useState(""),[Es,ua]=o.useState(!1),[Ht,ma]=o.useState(""),[ha,cr]=o.useState(!1),[ss,rs]=o.useState(""),[as,ns]=o.useState(!1),[dr,is]=o.useState(""),[pa,ls]=o.useState(""),[ur,os]=o.useState(""),[mr,cs]=o.useState(""),[xa,ds]=o.useState(""),[_s,fa]=o.useState("1"),Me=St(),As=()=>{m({order:null,open:!1}),D({open:!1,technicianId:null,name:""}),te([])},_i=n=>{te([]),D({open:!0,technicianId:n.id,name:n.name||"Technician"})},ga=n=>{c.order&&Kt.mutate({orderId:c.order._id,technicianId:n})},{data:us=[],isLoading:Ts}=ge({queryKey:["orders",r],queryFn:()=>Ee.list({status:r||void 0})});o.useEffect(()=>{if(j&&us.length>0&&!Ts){const n=us.find(g=>g._id===j);n&&p({order:n,open:!0}),Q(null);const d=new URLSearchParams(t);d.delete("selected"),s(d,{replace:!0})}},[us,j,Ts,t,s]);const Ai=n=>{a(n);const d=new URLSearchParams(t);n?d.set("status",n):d.delete("status"),d.delete("selected"),s(d,{replace:!0})},{data:Ti=[]}=ge({queryKey:["categories"],queryFn:Pe.categories,enabled:i}),{data:Pi=[]}=ge({queryKey:["service-items",he],queryFn:()=>Pe.serviceItems(he||void 0),enabled:i&&!!he}),{data:hr=[]}=ge({queryKey:["spare-parts"],queryFn:Or.list,enabled:h.open}),{data:pr=[]}=ge({queryKey:["all-service-items"],queryFn:()=>Pe.serviceItems(),enabled:h.open}),{data:ba=[],isFetching:ya}=ge({queryKey:["order-technicians",(ka=c.order)==null?void 0:ka._id],queryFn:()=>Ee.candidates(c.order._id),enabled:c.open&&!!((Ea=c.order)!=null&&Ea._id)}),{data:Ps=[],isFetching:Os}=ge({queryKey:["technician-schedule",y.technicianId,A.toISOString()],queryFn:()=>{const n=new Date(A);return n.setDate(n.getDate()+7),Xt.schedule(y.technicianId,{start:A.toISOString(),end:n.toISOString()})},enabled:y.open&&!!y.technicianId}),{data:ft=[],isFetching:At}=ge({queryKey:["time-slots"],queryFn:()=>bs.list(),enabled:x.open||y.open}),{data:W,isFetching:Oi,error:Di}=ge({queryKey:["order-jobcard",(_a=h.order)==null?void 0:_a._id],queryFn:()=>Ee.jobCard(h.order._id),enabled:h.open&&!!((Aa=h.order)!=null&&Aa._id)}),V=(W==null?void 0:W.jobCard)??null,Ue=((Ta=W==null?void 0:W.order)==null?void 0:Ta.followUp)||null,xr=(V==null?void 0:V.sparePartsUsed)??[],Ds=xr.reduce((n,d)=>{var $;const g=(d==null?void 0:d.quantity)??0,O=(d==null?void 0:d.unitPrice)??(typeof(d==null?void 0:d.part)=="object"?(($=d.part)==null?void 0:$.unitPrice)??0:0);return n+g*O},0),Is=(Pa=W==null?void 0:W.order)==null?void 0:Pa.serviceItem,Ii=typeof Is=="string"?0:(Is==null?void 0:Is.basePrice)??0,Rs=(V==null?void 0:V.estimateAmount)??((Oa=W==null?void 0:W.order)==null?void 0:Oa.estimatedCost)??Ii,Fs=((V==null?void 0:V.extraWork)??[]).reduce((n,d)=>n+((d==null?void 0:d.amount)??0),0);o.useEffect(()=>{var d;console.log("Job Card Detail:",W),console.log("Job Card:",V);const n=(d=W==null?void 0:W.order)==null?void 0:d.status;n&&Pd.includes(n)?Ie(n):Ie("")},[(Da=W==null?void 0:W.order)==null?void 0:Da.status]),o.useEffect(()=>{V!=null&&V.paymentStatus&&Od.includes(V.paymentStatus)?ue(V.paymentStatus):ue("")},[V==null?void 0:V.paymentStatus]),o.useEffect(()=>{if(!h.open){_t(""),Ft([]),Ut([]),lr("");return}Ue?(_t(Ue.reason||""),Ft(Ue.attachments||[])):ae!=="follow_up"&&(_t(""),Ft([]))},[h.open,Ue==null?void 0:Ue.reason,(Ia=Ue==null?void 0:Ue.attachments)==null?void 0:Ia.length,ae]);const Ls=o.useMemo(()=>{var O;if(!W)return[];const n=[],{order:d}=W;((d==null?void 0:d.history)||[]).forEach(($,F)=>{if(!$)return;let oe="bg-blue-100",de=Pr($.action)||"Update";switch($.action){case"technician_checked_in":oe="bg-emerald-500",de="Technician Checked In";break;case"technician_checked_out":oe="bg-rose-500",de="Technician Checked Out";break;case"technician_progress_update":oe="bg-amber-500",de="Progress Update";break;case"technician_follow_up":oe="bg-orange-500",de="Follow Up Required";break;case"technician_assigned":oe="bg-indigo-500",de="Technician Assigned";break;case"order_rescheduled":oe="bg-purple-500",de="Order Rescheduled";break;case"order_created":oe="bg-slate-900",de="Order Created";break;default:oe="bg-blue-100"}n.push({id:`history-${F}`,title:de,description:[$.message,$.performedBy?`By ${Dd($.performedBy)}`:null].filter(Boolean).join("  "),timestamp:$.performedAt,accent:oe})}),(O=d==null?void 0:d.followUp)!=null&&O.reason&&(n.push({id:"follow-up-start",title:"Follow Up Requested",description:d.followUp.reason,timestamp:d.followUp.createdAt,accent:"bg-orange-500",attachments:d.followUp.attachments||[]}),d.followUp.resolvedAt&&n.push({id:"follow-up-resolved",title:"Follow Up Resolved",description:"Case moved out of follow up",timestamp:d.followUp.resolvedAt,accent:"bg-emerald-500"}));const g=$=>{if(!$)return Number.MAX_SAFE_INTEGER;const F=new Date($).getTime();return Number.isNaN(F)?Number.MAX_SAFE_INTEGER:F};return n.sort(($,F)=>g($.timestamp)-g(F.timestamp))},[W]),fr=((Ra=W==null?void 0:W.order)==null?void 0:Ra.media)??[],Ri=fr.length>0||Ge.length>0,gt=o.useMemo(()=>{if(!P)return[];const n=Ad(P);return n===null?[]:ft.filter(d=>d.dayOfWeek===n)},[P,ft]),Tt=ce&&gt.find(n=>gs(n)===ce)||null,Lt=x.order,Ms=(Fa=Lt==null?void 0:Lt.preferredSlot)==null?void 0:Fa.label,ms=ae==="follow_up",se=((La=W==null?void 0:W.order)==null?void 0:La.status)==="completed",Fi=n=>{if(se){N.error("Completed job cards are view-only"),n.target.value="";return}const d=Array.from(n.target.files??[]);d.length&&(d.forEach(g=>{const O=new FileReader;O.onload=()=>{const $=O.result;typeof $=="string"&&Ft(F=>[...F,{url:$,kind:g.type.startsWith("video")?"video":"image",name:g.name}])},O.readAsDataURL(g)}),n.target.value="")},Li=n=>{if(se){N.error("Completed job cards are view-only"),n.target.value="";return}const d=Array.from(n.target.files??[]);d.length&&(d.forEach(g=>{const O=new FileReader;O.onload=()=>{const $=O.result;typeof $=="string"&&Ut(F=>[...F,{url:$,kind:g.type.startsWith("video")?"video":g.type.startsWith("image")?"image":"document",name:g.name}])},O.readAsDataURL(g)}),n.target.value="")},Mi=n=>{if(se){N.error("Completed job cards are view-only");return}Ut(d=>d.filter((g,O)=>O!==n))},Bi=n=>{var d;if(se){N.error("Completed job cards are view-only");return}if(!n){N.error("Unable to delete this file");return}if(!((d=h.order)!=null&&d._id)){N.error("Open an order before deleting documents");return}la(n),br.mutate({orderId:h.order._id,mediaId:n})},$i=()=>{var n;if(se){N.error("Completed job cards are view-only");return}if(!((n=h.order)!=null&&n._id)){N.error("Open an order before uploading documents");return}if(!Ge.length){N.error("Select at least one file to upload");return}gr.mutate({orderId:h.order._id,media:Ge})},qi=n=>{if(se){N.error("Completed job cards are view-only");return}Ft(d=>d.filter((g,O)=>O!==n))},Ui=()=>{var n;if(se){N.error("Completed job cards are view-only");return}if(!(!((n=h.order)!=null&&n._id)||!ae)){if(ms){if(!Se.trim()){N.error("Provide a follow-up reason");return}if(!xt.length){N.error("Attach at least one image or video");return}}ps.mutate({orderId:h.order._id,status:ae,reason:ms?Se:void 0,attachments:ms?xt:void 0})}},Vi=()=>{var n;if(se){N.error("Completed job cards are view-only");return}if(!(!((n=h.order)!=null&&n._id)||!w)){if(!V){N.error("Generate a job card before updating payment status");return}yr.mutate({orderId:h.order._id,status:w})}},Wi=()=>{var g;if(se){N.error("Completed job cards are view-only");return}if(!((g=h.order)!=null&&g._id)){N.error("Open an order before adding spare parts");return}if(!Wt||!ks){N.error("Please select a spare part and enter quantity");return}const n=parseFloat(ks);if(isNaN(n)||n<=0){N.error("Quantity must be a positive number");return}const d=hr.find(O=>O._id===Wt);if(!d){N.error("Selected spare part not found");return}ja.mutate({orderId:h.order._id,sparePart:{sparePartId:Wt,quantity:n,unitPrice:d.unitPrice}})},Hi=()=>{var O;if(se){N.error("Completed job cards are view-only");return}if(!((O=h.order)!=null&&O._id)){N.error("Open an order before adding services");return}if(!Ht||!_s){N.error("Please select a service and enter quantity");return}const n=parseFloat(_s);if(isNaN(n)||n<=0){N.error("Quantity must be a positive number");return}const d=pr.find($=>$._id===Ht);if(!d){N.error("Selected service not found");return}const g=(d.basePrice||0)*n;wa.mutate({orderId:h.order._id,service:{description:`${d.name} (x${n})`,amount:g,serviceItemId:Ht}})};o.useEffect(()=>{if(x.open&&x.order){const n=x.order.timeWindowStart?new Date(x.order.timeWindowStart).toISOString().split("T")[0]:"";I(n)}else I(""),be(null)},[x.open,x.order]),o.useEffect(()=>{var g,O;if(!x.open)return;if(!P){ce!==null&&be(null);return}if(!gt.length){ce!==null&&be(null);return}if(ce&&gt.some($=>gs($)===ce))return;const n=(O=(g=x.order)==null?void 0:g.preferredSlot)==null?void 0:O.label;if(n){const $=gt.find(F=>F.label===n);if($){const F=gs($);F!==ce&&be(F);return}}const d=gs(gt[0]);d!==ce&&be(d)},[x.open,P,gt,ce,x.order]);const Kt=ne({mutationFn:({orderId:n,technicianId:d})=>Ee.assign(n,d),onMutate:({technicianId:n})=>k(n),onSuccess:()=>{N.success("Technician assigned"),Me.invalidateQueries({queryKey:["orders"]}),As()},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Assignment failed")},onSettled:()=>k(null)}),hs=ne({mutationFn:async({orderId:n,technicianId:d,newStart:g,newEnd:O})=>(await Ee.reschedule(n,{newStart:g,newEnd:O}),Ee.assign(n,d)),onSuccess:()=>{N.success("Order rescheduled and technician assigned!"),Me.invalidateQueries({queryKey:["orders"]}),Me.invalidateQueries({queryKey:["technician-schedule"]}),As()},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Failed to assign with new slot")}}),va=ne({mutationFn:({orderId:n,newStart:d,newEnd:g})=>Ee.reschedule(n,{newStart:d,newEnd:g}),onSuccess:()=>{N.success("Order rescheduled"),Me.invalidateQueries({queryKey:["orders"]}),b({order:null,open:!1})},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Reschedule failed")}}),ps=ne({mutationFn:({orderId:n,status:d,reason:g,attachments:O})=>Ee.changeStatus(n,{status:d,reason:g,attachments:O}),onSuccess:()=>{var n;N.success("Status updated"),(n=h.order)!=null&&n._id&&Me.invalidateQueries({queryKey:["order-jobcard",h.order._id]}),Me.invalidateQueries({queryKey:["orders"]})},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Unable to update status")}}),gr=ne({mutationFn:({orderId:n,media:d})=>Ee.uploadMedia(n,{media:d}),onSuccess:()=>{var n;N.success("Documents uploaded"),Ut([]),(n=h.order)!=null&&n._id&&Me.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Unable to upload documents")}}),br=ne({mutationFn:({orderId:n,mediaId:d})=>Ee.deleteMedia(n,d),onSuccess:()=>{var n;N.success("Document removed"),(n=h.order)!=null&&n._id&&Me.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Unable to delete document")},onSettled:()=>la(null)}),yr=ne({mutationFn:({orderId:n,status:d})=>Ee.updatePaymentStatus(n,{status:d}),onSuccess:()=>{var n;N.success("Payment status updated"),(n=h.order)!=null&&n._id&&Me.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Unable to update payment status")}}),vr=ne({mutationFn:({orderId:n,message:d})=>Ee.addHistoryNote(n,{message:d}),onSuccess:(n,d)=>{N.success("Activity note added"),lr(""),Me.setQueryData(["order-jobcard",d.orderId],n)},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Unable to record note")}}),ja=ne({mutationFn:({orderId:n,sparePart:d})=>Ee.addSparePart(n,d),onSuccess:(n,d)=>{N.success("Spare part added"),ca(""),da(""),oa(!1),Me.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Unable to add spare part")}}),wa=ne({mutationFn:({orderId:n,service:d})=>Ee.addAdditionalService(n,d),onSuccess:(n,d)=>{N.success("Additional service added"),ma(""),fa("1"),ua(!1),Me.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Unable to add service")}}),Na=ne({mutationFn:({orderId:n,index:d})=>Ee.removeSparePart(n,d),onSuccess:(n,d)=>{N.success("Spare part removed"),Me.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Unable to remove spare part")}}),Sa=ne({mutationFn:({orderId:n,index:d})=>Ee.removeAdditionalService(n,d),onSuccess:(n,d)=>{N.success("Additional service removed"),Me.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Unable to remove service")}}),Bs=ne({mutationFn:({customerId:n,addressId:d,address:g})=>jt.updateAddress(n,{...g,addressId:d}),onSuccess:(n,d)=>{var g;N.success(d.addressId?"Order address updated":"New address added successfully"),cr(!1),ns(!1),rs(""),(g=h.order)!=null&&g._id&&Me.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Unable to update address")}}),Ki=ne({mutationFn:n=>jt.findByPhone(n),onSuccess:n=>{var d,g;if(n){K(n),me(n.name||""),we(n.email||"");const O=((d=n.addresses)==null?void 0:d.find($=>$.isDefault))||((g=n.addresses)==null?void 0:g[0]);O?(G(O.id),Ne(O.line1||""),v(O.line2||""),le(O.city||""),E(O.state||""),X(O.postalCode||"")):(Ne(n.addressLine1||""),v(n.addressLine2||""),le(n.city||""),E(""),X(n.postalCode||"")),N.success("Customer found!")}else K(null),G(""),me(""),we(""),Ne(""),v(""),le(""),E(""),X(""),N("Customer not found. Please enter details to create new customer.",{icon:""});f(!1)},onError:()=>{N.error("Failed to check customer"),f(!1)}}),Ca=ne({mutationFn:async n=>{if(!S){const d=await jt.create({name:ie,phone:ke,email:xe,address:{line1:De,line2:Fe,city:ee,state:Le,postalCode:Y}});return Ee.create({...n,customerId:d.id})}return Ee.create(n)},onSuccess:()=>{N.success("Order created successfully!"),l(!1),jr(),Me.invalidateQueries({queryKey:["orders"]})},onError:n=>{var d,g;return N.error(((g=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:g.message)||"Failed to create order")}}),jr=()=>{ye(""),K(null),G(""),me(""),we(""),Ne(""),v(""),le(""),E(""),X(""),nt(""),Ct(""),pe(""),pt("09:00"),Rt("11:00"),Et("")},Qi=n=>{var g;G(n);const d=(g=S==null?void 0:S.addresses)==null?void 0:g.find(O=>O.id===n);d&&(Ne(d.line1||""),v(d.line2||""),le(d.city||""),E(d.state||""),X(d.postalCode||""))},zi=()=>{if(!ke.trim()){N.error("Please enter phone number");return}f(!0),Ki.mutate(ke)},Zi=()=>{if(!ke||!ie||!Ye||!it){N.error("Please fill all required fields");return}const n=M,d=De&&ee&&Le;if(!n&&!d){N.error("Please select an address or fill in address details");return}const g=new Date(`${it}T${ht}`),O=new Date(`${it}T${kt}`),$={customerId:S==null?void 0:S.id,serviceItem:Ye,scheduledAt:g.toISOString(),timeWindowStart:g.toISOString(),timeWindowEnd:O.toISOString(),issueDescription:qt,slotLabel:`${ht} - ${kt}`};M?$.addressId=M:d&&($.address={line1:De,line2:Fe,city:ee,state:Le,postalCode:Y}),Ca.mutate($)},Yi=!((Ma=h.order)!=null&&Ma._id)||!ae||ps.isPending||ms&&(!Se.trim()||xt.length===0)||se,Ji=!((Ba=h.order)!=null&&Ba._id)||!V||!w||yr.isPending||se,Xi=!(($a=h.order)!=null&&$a._id)||!Vt.trim()||vr.isPending||se;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Live Orders"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Admin Assignment Console"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(U,{onClick:()=>l(!0),children:"+ Create Order"}),e.jsx(Qe,{value:r,onChange:n=>Ai(n.target.value),children:Td.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))})]})]}),e.jsx(qe,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs uppercase tracking-wide text-slate-500",children:[e.jsx("th",{className:"px-4 py-3",children:"Customer"}),e.jsx("th",{className:"px-4 py-3",children:"Service"}),e.jsx("th",{className:"px-4 py-3",children:"Schedule"}),e.jsx("th",{className:"px-4 py-3",children:"Technician"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[Ts&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-slate-400",children:"Loading orders"})}),!Ts&&us.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-slate-400",children:"No orders found for this filter."})}),us.map(n=>{var d,g;return e.jsxs("tr",{className:"text-sm cursor-pointer transition-colors hover:bg-slate-50",onClick:()=>p({order:n,open:!0}),children:[e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("p",{className:"font-semibold text-slate-900",children:n.customer.name}),e.jsx("p",{className:"text-xs text-slate-500",children:n.customer.city})]}),e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("p",{className:"font-medium text-slate-900",children:(d=n.serviceItem)==null?void 0:d.name}),e.jsx("p",{className:"text-xs text-slate-500",children:(g=n.serviceCategory)==null?void 0:g.name})]}),e.jsxs("td",{className:"px-4 py-4 text-sm text-slate-600",children:[$e(n.timeWindowStart),e.jsxs("span",{className:"block text-xs text-slate-400",children:[" ",$e(n.timeWindowEnd)]})]}),e.jsx("td",{className:"px-4 py-4",children:n.assignedTechnician?e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-emerald-600",children:n.assignedTechnician.name}),e.jsx("p",{className:"text-xs text-slate-500",children:"Assigned technician"})]}):e.jsx("p",{className:"text-xs text-slate-400",children:"Not assigned"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx(Ys,{variant:n.status,children:n.status.replace(/_/g," ")})}),e.jsx("td",{className:"px-4 py-4 text-right",children:n.status==="completed"?e.jsx("span",{className:"text-xs text-slate-400",children:"Completed"}):n.status==="cancellation_requested"?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(U,{variant:"secondary",onClick:O=>{O.stopPropagation();const $=window.prompt("Optional: Add a note for approving cancellation")||void 0;ps.mutate({orderId:n._id,status:"cancelled",reason:($==null?void 0:$.trim())||void 0})},className:"text-xs",children:"Approve Cancel"}),e.jsx(U,{variant:"secondary",onClick:O=>{O.stopPropagation();const $=window.prompt("Optional: Add a note for rejecting cancellation")||void 0,F=n.assignedTechnician?"assigned":"pending_assignment";ps.mutate({orderId:n._id,status:F,reason:($==null?void 0:$.trim())||void 0})},className:"text-xs",children:"Reject Cancel"})]}):e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(U,{variant:"secondary",onClick:O=>{O.stopPropagation(),b({order:n,open:!0})},className:"text-xs",children:"Reschedule"}),e.jsx(U,{onClick:O=>{O.stopPropagation(),m({order:n,open:!0})},className:"text-xs",children:n.assignedTechnician?"Reassign":"Assign"})]})})]},n._id)})]})]})})}),e.jsxs(Ze,{open:c.open,onClose:()=>{y.open||As()},title:"Assign Technician",children:[e.jsxs("p",{className:"text-sm text-slate-500",children:["Technicians shown are certified for"," ",e.jsx("span",{className:"font-semibold text-slate-900",children:(Ua=(qa=c.order)==null?void 0:qa.serviceItem)==null?void 0:Ua.name})," and reflect real-time slot availability."]}),((Va=c.order)==null?void 0:Va.assignedTechnician)&&e.jsxs("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-800",children:["Currently assigned to ",e.jsx("span",{className:"font-semibold",children:c.order.assignedTechnician.name}),". Select another technician below to reassign."]}),ya&&e.jsx("p",{className:"text-sm text-slate-400",children:"Loading technician roster"}),!ya&&ba.length===0&&e.jsx("p",{className:"text-sm text-slate-400",children:"No technicians match this service yet. Add a profile from the Technicians tab."}),e.jsx("div",{className:"space-y-3",children:ba.map(n=>{var O,$,F,oe,de,Be,Ke;const d=($=(O=c.order)==null?void 0:O.assignedTechnician)==null?void 0:$._id,g=d?d===n.id:!1;return e.jsxs("div",{className:`flex flex-col gap-4 rounded-2xl border p-4 shadow-sm sm:flex-row sm:items-start sm:justify-between ${g?"border-amber-200 bg-amber-50/60":"border-slate-100"}`,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("p",{className:"font-semibold text-slate-900",children:n.name||"Unnamed technician"}),e.jsx("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-xs font-semibold ${n.isAvailable?"bg-emerald-50 text-emerald-700":"bg-rose-50 text-rose-600"}`,children:n.isAvailable?e.jsxs(e.Fragment,{children:[e.jsx(fo,{className:"h-4 w-4"})," Available"]}):e.jsxs(e.Fragment,{children:[e.jsx(Qo,{className:"h-4 w-4"})," Busy in slot"]})}),g&&e.jsx("span",{className:"rounded-full bg-amber-100 px-2 py-0.5 text-xs font-semibold text-amber-700",children:"Current"})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[(F=n.skills)!=null&&F.length?n.skills.slice(0,3).join(", "):"Generalist",typeof n.experienceYears=="number"&&`  ${n.experienceYears} yrs exp`,n.phone&&`  ${n.phone}`]}),((oe=n.workingHours)==null?void 0:oe.start)&&((de=n.workingHours)==null?void 0:de.end)&&e.jsxs("p",{className:"text-xs text-slate-400",children:["Preferred hours ",n.workingHours.start,"  ",n.workingHours.end]}),(Be=n.serviceItems)!=null&&Be.length?e.jsxs("p",{className:"text-xs text-slate-400",children:["Services: ",n.serviceItems.map(et=>et.name).join(", ")]}):null]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:items-end",children:[e.jsx(U,{type:"button",variant:"secondary",icon:e.jsx(po,{className:"h-4 w-4"}),onClick:()=>_i(n),children:"Calendar"}),e.jsx(U,{type:"button",onClick:()=>ga(n.id),disabled:!n.isAvailable||g||Kt.isPending,loading:Kt.isPending&&C===n.id,children:(Ke=c.order)!=null&&Ke.assignedTechnician?"Reassign":"Assign"})]})]},n.id)})})]}),e.jsx(Ze,{open:x.open,onClose:()=>b({order:null,open:!1}),title:"Reschedule Order",children:Lt&&e.jsxs("form",{className:"space-y-5",onSubmit:n=>{if(n.preventDefault(),!P||!Tt){N.error("Select a date and a slot to reschedule");return}const d=($,F)=>{const oe=F.length===5?`${F}:00`:F;return new Date(`${$}T${oe}`).toISOString()},g=d(P,Tt.startTime),O=d(P,Tt.endTime);va.mutate({orderId:Lt._id,newStart:g,newEnd:O})},children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Currently scheduled"}),e.jsxs("p",{className:"mt-2 text-sm font-semibold text-slate-900",children:[$e(Lt.timeWindowStart),e.jsx("span",{className:"mx-1 text-slate-400",children:""}),$e(Lt.timeWindowEnd)]}),Ms&&e.jsxs("p",{className:"text-xs text-slate-500",children:["Slot: ",Ms]}),e.jsx("p",{className:"mt-3 text-xs text-slate-500",children:"Rescheduling keeps the same service and technician assignment rules. Pick a new day & slot below so we can notify the customer and crew."})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(L,{type:"date",label:"Target date",value:P,min:new Date().toISOString().split("T")[0],onChange:n=>I(n.target.value),required:!0}),e.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 p-4 text-sm text-slate-600",children:P&&Tt?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-semibold text-slate-900",children:"New slot preview"}),e.jsxs("p",{children:[Tt.label||"Custom slot"," on ",new Date(P).toLocaleDateString("en-IN",{dateStyle:"medium"})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[Tt.startTime,"  ",Tt.endTime]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-semibold text-slate-900",children:"Awaiting selection"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Pick a date and slot to generate a fresh appointment window."})]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Available time slots"}),At&&e.jsx("p",{className:"mt-2 text-xs text-slate-400",children:"Loading slot templates"}),!At&&ft.length===0&&e.jsx("p",{className:"mt-2 text-xs text-rose-500",children:"No time slots configured yet. Create slots in the admin settings."}),!At&&ft.length>0&&!P&&e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Pick a date first to preview relevant slot templates."}),!At&&ft.length>0&&P&&gt.length===0&&e.jsxs("p",{className:"mt-2 text-xs text-amber-600",children:["No slot templates cover ",new Date(P).toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"short"}),"."]}),!At&&ft.length>0&&P&&gt.length>0&&e.jsx("div",{className:"mt-3 grid gap-3 sm:grid-cols-2",children:gt.map(n=>{const d=gs(n),g=d===ce,O=Ms&&n.label===Ms;return e.jsxs("button",{type:"button",className:`rounded-2xl border px-4 py-3 text-left transition focus:outline-none ${g?"border-slate-900 bg-slate-900/5 shadow-sm":"border-slate-200 hover:border-slate-400"}`,onClick:()=>be(d),children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:n.label||`Slot ${n.dayOfWeek}`}),e.jsxs("p",{className:"text-xs text-slate-500",children:[n.startTime,"  ",n.endTime]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-[11px] uppercase tracking-wide",children:[g&&e.jsx("span",{className:"rounded-full bg-slate-900 px-2 py-0.5 text-white",children:"New choice"}),O&&e.jsx("span",{className:"rounded-full bg-emerald-100 px-2 py-0.5 text-emerald-700",children:"Current slot"}),typeof n.capacity=="number"&&e.jsxs("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-slate-600",children:[n.capacity," jobs"]})]})]},d)})})]}),e.jsx(U,{type:"submit",className:"w-full",disabled:!P||!Tt,loading:va.isPending,children:"Confirm reschedule"})]})}),e.jsxs(Ze,{open:h.open,onClose:()=>p({order:null,open:!1}),title:`Job card  ${((Ha=(Wa=h.order)==null?void 0:Wa.serviceItem)==null?void 0:Ha.name)??""}`,size:"xxl",showCloseButton:!0,children:[Oi&&e.jsx("p",{className:"text-sm text-slate-400",children:"Preparing printable job summary"}),Di&&e.jsx("p",{className:"text-sm text-rose-500",children:"Unable to load job card. Please try again."}),W&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Fixzep Job Sheet"}),e.jsx("h3",{className:"text-2xl font-semibold text-slate-900",children:W.order.code||(V==null?void 0:V.id)||"Job Summary"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Status: ",e.jsx("span",{className:"font-semibold text-slate-900",children:(V==null?void 0:V.status)??"Not generated yet"})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(U,{type:"button",variant:"secondary",icon:e.jsx(Io,{className:"h-4 w-4"}),onClick:()=>window.print(),disabled:!V,title:V?void 0:"Generate a job card before printing",children:"Print"})})]}),se&&e.jsx("div",{className:"rounded-2xl border border-emerald-200 bg-emerald-50/80 p-4 text-sm text-emerald-800",children:"Job marked as completed. Chat, uploads, and status changes are locked for audit safety."}),!V&&e.jsx("div",{className:"rounded-2xl border border-dashed border-amber-200 bg-amber-50/60 p-4 text-sm text-amber-800",children:"No job card has been created for this order yet. Once the technician starts work, their updates will appear here."}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Customer & Property"}),!se&&!ha&&e.jsx("button",{type:"button",onClick:()=>{cr(!0),ns(!1),rs(""),is(""),ls(""),os(""),cs(""),ds("")},className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"Change Address"})]}),e.jsx("h4",{className:"mt-2 text-lg font-semibold text-slate-900",children:W.order.customer.name}),e.jsx("p",{className:"text-sm text-slate-600",children:W.order.customer.phone}),e.jsx("p",{className:"text-sm text-slate-600",children:W.order.customer.email||"Email not provided"}),ha?e.jsxs("div",{className:"mt-3 space-y-3",children:[S!=null&&S.addresses&&((Ka=S==null?void 0:S.addresses)==null?void 0:Ka.length)>0&&!as?e.jsxs(e.Fragment,{children:[e.jsxs(Qe,{label:"Select Address",value:ss,onChange:n=>{var O;const d=n.target.value;rs(d);const g=(O=S.addresses)==null?void 0:O.find($=>$.id===d);g&&(is(g.line1||""),ls(g.line2||""),os(g.city||""),cs(g.state||""),ds(g.postalCode||""))},children:[e.jsx("option",{value:"",children:"Choose an existing address"}),S.addresses.map(n=>e.jsxs("option",{value:n.id,children:[n.label||"Address"," - ",n.line1,", ",n.city," ",n.isDefault?"(Default)":""]},n.id))]}),e.jsx("button",{type:"button",onClick:()=>{ns(!0),rs(""),is(""),ls(""),os(""),cs(""),ds("")},className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"+ Add New Address"})]}):null,(as||!((Qa=S==null?void 0:S.addresses)!=null&&Qa.length)||ss)&&e.jsxs(e.Fragment,{children:[as&&(S==null?void 0:S.addresses)&&S.addresses.length>0&&e.jsx("button",{type:"button",onClick:()=>{ns(!1),is(""),ls(""),os(""),cs(""),ds("")},className:"text-xs text-slate-600 hover:text-slate-700",children:" Back to address list"}),e.jsx(L,{label:"Address Line 1 *",value:dr,onChange:n=>is(n.target.value),placeholder:"Street address"}),e.jsx(L,{label:"Address Line 2",value:pa,onChange:n=>ls(n.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(L,{label:"City *",value:ur,onChange:n=>os(n.target.value),placeholder:"City"}),e.jsx(L,{label:"State *",value:mr,onChange:n=>cs(n.target.value),placeholder:"State"})]}),e.jsx(L,{label:"Postal Code",value:xa,onChange:n=>ds(n.target.value),placeholder:"PIN Code"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{type:"button",onClick:()=>{var d;if(!ss&&!as&&((d=S==null?void 0:S.addresses)!=null&&d.length)){N.error("Please select an address or add a new one");return}if(!dr.trim()||!ur.trim()||!mr.trim()){N.error("Please fill required address fields");return}const n=typeof W.order.customer=="string"?W.order.customer:W.order.customer._id||W.order.customer._id;if(!n){N.error("Customer ID not found");return}Bs.mutate({customerId:n,addressId:ss||void 0,address:{line1:dr,line2:pa,city:ur,state:mr,postalCode:xa}})},loading:Bs.isPending,disabled:Bs.isPending,className:"flex-1",children:as?"Add Address":ss?"Update Order Address":"Save"}),e.jsx(U,{type:"button",variant:"secondary",onClick:()=>{cr(!1),ns(!1),rs("")},disabled:Bs.isPending,className:"flex-1",children:"Cancel"})]})]}):e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:e.jsx("p",{children:Id(W.order.customer)||"Address not provided"})})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Documents & Photos"}),e.jsxs("label",{className:`mt-3 flex flex-col items-center justify-center rounded-2xl border-2 border-dashed px-4 py-6 text-center text-sm transition ${se?"cursor-not-allowed border-slate-100 bg-slate-50 text-slate-400":"cursor-pointer border-slate-200 bg-slate-50/50 text-slate-500 hover:border-slate-400"}`,children:[e.jsx("input",{type:"file",className:"hidden",multiple:!0,onChange:Li,disabled:se}),e.jsx("span",{className:"font-semibold text-slate-900",children:"Drag & drop files"}),e.jsx("span",{className:"text-xs text-slate-500",children:"or click to browse"})]}),Ri?e.jsxs("div",{className:"mt-4 space-y-5 text-sm",children:[fr.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Stored files"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-3",children:fr.map((n,d)=>e.jsxs("div",{className:"relative rounded-xl border border-slate-100 bg-white/70 overflow-hidden group",children:[n.kind==="image"?e.jsx("div",{className:"aspect-square cursor-pointer",onClick:()=>Z({open:!0,url:n.url,name:n.name||`Image ${d+1}`}),children:e.jsx("img",{src:n.url,alt:n.name||`Image ${d+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity"})}):n.kind==="video"?e.jsx("div",{className:"aspect-square bg-slate-900",children:e.jsx("video",{src:n.url,className:"w-full h-full object-cover",controls:!0})}):e.jsxs("div",{className:"aspect-square flex flex-col items-center justify-center bg-slate-50 p-3",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("p",{className:"mt-2 text-xs text-slate-600 text-center truncate w-full px-2",children:n.name||"Document"})]}),!se&&e.jsx("button",{type:"button",className:"absolute top-2 right-2 p-1 rounded-full bg-rose-600 hover:bg-rose-700 text-white shadow-lg transition-all opacity-0 group-hover:opacity-100",onClick:g=>{g.stopPropagation(),Bi(n._id)},disabled:!n._id||br.isPending&&ia!==n._id,title:"Delete",children:br.isPending&&ia===n._id?e.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx(ys,{className:"h-4 w-4"})})]},n._id??`${n.url}-${d}`))})]}),Ge.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Pending upload"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-3",children:Ge.map((n,d)=>e.jsxs("div",{className:"relative rounded-xl border border-dashed border-slate-200 bg-slate-50 overflow-hidden group",children:[n.kind==="image"?e.jsx("div",{className:"aspect-square cursor-pointer",onClick:()=>Z({open:!0,url:n.url,name:n.name||`Image ${d+1}`}),children:e.jsx("img",{src:n.url,alt:n.name||`Image ${d+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity"})}):n.kind==="video"?e.jsx("div",{className:"aspect-square bg-slate-900",children:e.jsx("video",{src:n.url,className:"w-full h-full object-cover",controls:!0})}):e.jsxs("div",{className:"aspect-square flex flex-col items-center justify-center bg-slate-50 p-3",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("p",{className:"mt-2 text-xs text-slate-600 text-center truncate w-full px-2",children:n.name||"Document"})]}),!se&&e.jsx("button",{type:"button",className:"absolute top-2 right-2 p-1 rounded-full bg-slate-700 hover:bg-slate-800 text-white shadow-lg transition-all opacity-0 group-hover:opacity-100",onClick:g=>{g.stopPropagation(),Mi(d)},disabled:se,title:"Remove",children:e.jsx(ys,{className:"h-4 w-4"})})]},`${n.url}-${d}`))}),e.jsx(U,{type:"button",onClick:$i,className:"mt-4 w-full",disabled:se||!Ge.length||gr.isPending,loading:!se&&gr.isPending,children:`Upload ${Ge.length} Document${Ge.length>1?"s":""}`})]})]}):e.jsx("p",{className:"mt-3 text-xs text-slate-500",children:"No documents uploaded yet."})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Service Details"}),e.jsx("h4",{className:"mt-2 text-lg font-semibold text-slate-900",children:typeof W.order.serviceItem=="string"?W.order.serviceItem:(za=W.order.serviceItem)==null?void 0:za.name}),e.jsx("p",{className:"text-sm text-slate-600",children:typeof W.order.serviceCategory=="string"?W.order.serviceCategory:((Za=W.order.serviceCategory)==null?void 0:Za.name)||"Category not tagged"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:W.order.serviceItem&&typeof W.order.serviceItem!="string"?W.order.serviceItem.description||W.order.issueDescription||"No description provided.":W.order.issueDescription||"No description provided."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Additional Services"}),!se&&e.jsx(U,{variant:"secondary",onClick:()=>ua(!Es),className:"text-xs",children:Es?"Cancel":"+ Add Service"})]}),Es&&e.jsxs("div",{className:"mt-3 space-y-3 rounded-lg border border-slate-200 bg-slate-50 p-3",children:[e.jsxs(Qe,{label:"Select Service *",value:Ht,onChange:n=>ma(n.target.value),children:[e.jsx("option",{value:"",children:"Choose a service..."}),pr.map(n=>e.jsxs("option",{value:n._id,children:[n.name," - ",We(n.basePrice||0)]},n._id))]}),e.jsx(L,{label:"Quantity",type:"number",placeholder:"1",value:_s,onChange:n=>fa(n.target.value),min:"1",step:"1"}),Ht&&e.jsxs("div",{className:"rounded-lg bg-slate-100 p-2 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:"Total: "}),We((((Ya=pr.find(n=>n._id===Ht))==null?void 0:Ya.basePrice)||0)*parseFloat(_s||"1"))]}),e.jsx(U,{onClick:Hi,loading:wa.isPending,className:"w-full",children:"Add Service"})]}),V!=null&&V.extraWork&&V.extraWork.length>0?e.jsx("ul",{className:"mt-3 space-y-2 text-sm",children:V.extraWork.map((n,d)=>e.jsxs("li",{className:"flex items-center justify-between rounded-xl bg-slate-50 px-3 py-2",children:[e.jsx("span",{className:"text-slate-600",children:n.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:We(n.amount)}),!se&&e.jsx("button",{type:"button",onClick:g=>{var O;g.stopPropagation(),(O=h.order)!=null&&O._id&&Sa.mutate({orderId:h.order._id,index:d})},className:"text-rose-500 hover:text-rose-700 transition-colors",disabled:Sa.isPending,title:"Remove service",children:e.jsx(Ns,{className:"h-4 w-4"})})]})]},`${n.description}-${d}`))}):Es?null:e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"No additional services captured yet."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Activity Tracking"}),Ls.length>0&&e.jsxs("span",{className:"text-xs text-slate-400",children:[Ls.length," entries"]})]}),Ls.length===0?e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"No activity recorded yet for this job."}):e.jsx("ol",{className:"mt-4 space-y-4 border-l border-slate-100 pl-4 max-h-64 overflow-y-auto pr-2",children:Ls.map(n=>e.jsxs("li",{className:"relative pl-4",children:[e.jsx("span",{className:`absolute -left-2 top-2 block h-3 w-3 rounded-full ${n.accent||"bg-slate-300"}`}),e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:n.title}),n.description&&e.jsx("p",{className:"text-xs text-slate-500",children:n.description}),n.attachments&&n.attachments.length>0&&e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2",children:n.attachments.map((d,g)=>e.jsx("div",{className:"rounded-lg overflow-hidden border border-slate-100 bg-white",children:d.kind==="video"?e.jsx("video",{src:d.url,className:"w-full h-24 object-cover",controls:!0}):e.jsx("img",{src:d.url,alt:d.name||"Attachment",className:"w-full h-24 object-cover"})},`${d.url}-${g}`))}),n.timestamp&&e.jsx("p",{className:"text-[11px] text-slate-400",children:$e(n.timestamp)})]},n.id))}),e.jsxs("form",{className:"mt-4 space-y-3 rounded-2xl bg-slate-50/80 p-3",onSubmit:n=>{var g;if(n.preventDefault(),se){N.error("Completed job cards are view-only");return}if(!((g=h.order)!=null&&g._id)){N.error("Open an order before logging activity");return}const d=Vt.trim();d&&vr.mutate({orderId:h.order._id,message:d})},children:[e.jsx(Dt,{label:"Add a quick note",placeholder:"Share updates for finance, dispatch, or technicians",value:Vt,onChange:n=>lr(n.target.value),rows:3,disabled:se}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("p",{className:"text-[11px] text-slate-500",children:se?"Job completed  notes locked.":"Notes sync to the order history instantly."}),e.jsx(U,{type:"submit",className:"w-full sm:w-auto",disabled:Xi,loading:!se&&vr.isPending,children:"Send update"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Job & Payment Status"}),e.jsxs("div",{className:"mt-3 space-y-5",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-400",children:"Job progress"}),e.jsxs(Qe,{value:ae,onChange:n=>Ie(n.target.value),disabled:se,children:[e.jsx("option",{value:"",children:"Select status"}),ki.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]}),e.jsx(U,{type:"button",onClick:Ui,disabled:Yi,loading:!se&&ps.isPending,children:"Update job status"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[e.jsx(Ys,{variant:W.order.status,children:Pr(W.order.status)||"Status"}),e.jsx("span",{children:"Last change synced to technicians and finance."})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-400",children:"Payment status"}),V?e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs(Qe,{value:w,onChange:n=>ue(n.target.value),disabled:se,children:[e.jsx("option",{value:"",children:"Select payment status"}),Ei.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]}),e.jsx(U,{type:"button",onClick:Vi,disabled:Ji,loading:!se&&yr.isPending,children:"Update payment status"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[e.jsx(Ys,{variant:V.paymentStatus??"pending",children:Pr(V.paymentStatus)||"Pending"}),e.jsx("span",{children:"Tracks what finance should collect."})]})]}):e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Payment tracking unlocks once a job card is created."})]})]}),ms&&e.jsxs("div",{className:"mt-4 space-y-3 rounded-2xl border border-dashed border-rose-200 p-4",children:[e.jsx(Dt,{label:"Follow up reason",placeholder:"Explain why further follow up is required",value:Se,onChange:n=>_t(n.target.value),disabled:se}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Attach evidence (images/videos)"}),e.jsx("input",{type:"file",accept:"image/*,video/*",multiple:!0,onChange:Fi,disabled:se,className:"hidden",id:"followup-file-input"}),e.jsxs("label",{htmlFor:"followup-file-input",className:`flex flex-col items-center justify-center rounded-2xl border-2 border-dashed px-4 py-6 text-center text-sm transition cursor-pointer ${se?"border-slate-100 bg-slate-50 text-slate-400 cursor-not-allowed":"border-slate-200 bg-slate-50/50 text-slate-500 hover:border-slate-400"}`,children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"Drag & drop files"}),e.jsx("span",{className:"text-xs text-slate-500",children:"or click to browse"})]})]}),xt.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-3",children:xt.map((n,d)=>e.jsxs("div",{className:"relative rounded-xl border border-slate-100 bg-white/70 overflow-hidden group",children:[n.kind==="video"?e.jsx("div",{className:"aspect-square bg-slate-900",children:e.jsx("video",{src:n.url,className:"w-full h-full object-cover",controls:!0})}):e.jsx("div",{className:"aspect-square cursor-pointer",onClick:()=>Z({open:!0,url:n.url,name:n.name||`Evidence ${d+1}`}),children:e.jsx("img",{src:n.url,alt:n.name||"Attachment",className:"w-full h-full object-cover hover:opacity-90 transition-opacity"})}),!se&&e.jsx("button",{type:"button",className:"absolute top-2 right-2 p-1 rounded-full bg-rose-600 hover:bg-rose-700 text-white shadow-lg transition-all opacity-0 group-hover:opacity-100",onClick:g=>{g.stopPropagation(),qi(d)},disabled:se,title:"Remove",children:e.jsx(ys,{className:"h-4 w-4"})})]},`${n.name||"attachment"}-${d}`))}),e.jsx("p",{className:"text-[11px] text-rose-600",children:"Technician assignment will be cleared when a job enters follow up."})]}),ae!=="follow_up"&&(Ue==null?void 0:Ue.reason)&&e.jsxs("div",{className:"mt-4 rounded-xl border border-dashed border-rose-100 bg-rose-50/60 p-3 text-xs text-rose-800",children:[e.jsx("p",{className:"font-semibold text-rose-900",children:"Follow up in progress"}),e.jsx("p",{className:"mt-1 text-rose-800",children:Ue.reason}),(Ja=Ue.attachments)!=null&&Ja.length?e.jsx("div",{className:"mt-3 grid gap-3 sm:grid-cols-2",children:Ue.attachments.map((n,d)=>e.jsxs("div",{className:"rounded-xl border border-rose-100 p-2",children:[n.kind==="video"?e.jsx("video",{controls:!0,className:"h-28 w-full rounded-lg object-cover",src:n.url}):e.jsx("img",{src:n.url,alt:n.name||"Follow up evidence",className:"h-28 w-full rounded-lg object-cover"}),e.jsx("p",{className:"mt-1 text-[11px] text-rose-700 truncate",children:n.name||`Attachment ${d+1}`})]},`existing-${d}`))}):null]}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Syncs both job card and order status for finance follow-ups."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-900/10 bg-gradient-to-br from-slate-900 to-slate-800 p-5 text-white",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-white/70",children:"Schedule"}),e.jsx("p",{className:"mt-2 text-lg font-semibold",children:((Xa=W.order.preferredSlot)==null?void 0:Xa.label)||"Scheduled slot"}),e.jsxs("p",{className:"mt-1 text-sm text-white/80",children:[W.order.timeWindowStart?$e(W.order.timeWindowStart):"",e.jsx("span",{className:"mx-1 text-white/50",children:""}),W.order.timeWindowEnd?$e(W.order.timeWindowEnd):""]}),(V==null?void 0:V.technician)&&e.jsxs("p",{className:"mt-2 text-xs text-white/70",children:["Technician:"," ",typeof V.technician=="string"?V.technician:V.technician.name," ",typeof V.technician!="string"?` ${V.technician.mobile??""}`:""]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Spare Parts / Cost Summary"}),!se&&e.jsx(U,{variant:"secondary",onClick:()=>oa(!or),className:"text-xs",children:or?"Cancel":"+ Add Spare"})]}),or&&e.jsxs("div",{className:"mt-3 space-y-3 rounded-lg border border-slate-200 bg-slate-50 p-3",children:[e.jsxs(Qe,{label:"Select Spare Part *",value:Wt,onChange:n=>ca(n.target.value),children:[e.jsx("option",{value:"",children:"Choose a spare part..."}),hr.map(n=>e.jsxs("option",{value:n._id,children:[n.name," (",n.sku,") - ",We(n.unitPrice)]},n._id))]}),e.jsx(L,{label:"Quantity",type:"number",placeholder:"1",value:ks,onChange:n=>da(n.target.value),min:"1",step:"1"}),Wt&&e.jsxs("div",{className:"rounded-lg bg-slate-100 p-2 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:"Total: "}),We((((Ga=hr.find(n=>n._id===Wt))==null?void 0:Ga.unitPrice)||0)*parseFloat(ks||"1"))]}),e.jsx(U,{onClick:Wi,loading:ja.isPending,className:"w-full",children:"Add Spare Part"})]}),xr.length>0&&e.jsx("div",{className:"mt-3 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"text-xs uppercase tracking-wide text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2",children:"Item"}),e.jsx("th",{className:"px-3 py-2",children:"Qty"}),e.jsx("th",{className:"px-3 py-2",children:"Unit price"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Total"}),!se&&e.jsx("th",{className:"px-3 py-2"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:xr.map((n,d)=>{var F,oe,de;const g=typeof n.part=="string"?n.part:((F=n.part)==null?void 0:F.name)||((oe=n.part)==null?void 0:oe.sku)||"Part",O=(n==null?void 0:n.unitPrice)??(typeof(n==null?void 0:n.part)=="object"?((de=n.part)==null?void 0:de.unitPrice)??0:0),$=(n.quantity??0)*O;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 text-slate-700",children:g}),e.jsx("td",{className:"px-3 py-2 text-slate-500",children:n.quantity??0}),e.jsx("td",{className:"px-3 py-2 text-slate-500",children:We(O)}),e.jsx("td",{className:"px-3 py-2 text-right font-semibold text-slate-900",children:We($)}),!se&&e.jsx("td",{className:"px-3 py-2",children:e.jsx("button",{type:"button",onClick:Be=>{var Ke;Be.stopPropagation(),(Ke=h.order)!=null&&Ke._id&&Na.mutate({orderId:h.order._id,index:d})},className:"text-rose-500 hover:text-rose-700 transition-colors",disabled:Na.isPending,title:"Remove spare part",children:e.jsx(Ns,{className:"h-4 w-4"})})})]},`${g}-${d}`)})})]})}),e.jsxs("div",{className:"mt-4 space-y-2 rounded-2xl bg-slate-50 p-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Service Price"}),e.jsx("span",{className:"font-semibold text-slate-900",children:We(Rs)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Spare Parts Subtotal"}),e.jsx("span",{className:"font-semibold text-slate-900",children:We(Ds)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Additional Services"}),e.jsx("span",{className:"font-semibold text-slate-900",children:We(Fs)})]}),V!=null&&V.additionalCharges?e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Additional Charges"}),e.jsx("span",{className:"font-semibold text-slate-900",children:We(V.additionalCharges)})]}):null,e.jsxs("div",{className:"flex items-center justify-between border-t border-slate-200 pt-2 text-slate-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"font-semibold text-slate-900",children:We(Rs+Ds+Fs+((V==null?void 0:V.additionalCharges)??0))})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Tax (18%)"}),e.jsx("span",{className:"font-semibold text-slate-900",children:We((Rs+Ds+Fs+((V==null?void 0:V.additionalCharges)??0))*.18)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{className:"font-semibold text-emerald-600",children:["-",We(0)]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t-2 border-slate-300 pt-2 text-base font-bold text-slate-900",children:[e.jsx("span",{children:"Grand Total"}),e.jsx("span",{className:"text-lg",children:We((Rs+Ds+Fs+((V==null?void 0:V.additionalCharges)??0))*1.18)})]})]})]})]})]})]})]}),e.jsxs(Ci,{open:y.open,onClose:()=>{As()},title:`Calendar  ${y.name||""}`,widthClassName:"w-screen max-w-2xl",children:[c.order&&e.jsxs("div",{className:"mb-4 space-y-3",children:[e.jsxs("div",{className:"rounded-xl border border-blue-200 bg-blue-50 p-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-blue-600 font-semibold",children:"Assigning to order"}),e.jsxs("p",{className:"text-sm text-blue-900 mt-1",children:[(en=c.order.serviceItem)==null?void 0:en.name,"  ",(tn=c.order.customer)==null?void 0:tn.name]}),e.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:["Current slot: ",$e(c.order.timeWindowStart),"  ",$e(c.order.timeWindowEnd)]})]}),e.jsx("div",{className:`rounded-xl border-2 p-4 ${R.length>0?"border-emerald-400 bg-emerald-50":"border-slate-200 bg-slate-50"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:R.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-xs uppercase tracking-wide text-emerald-600 font-semibold",children:["Selected time slots (",R.length,")"]}),(()=>{const n=R[0],d=R.every(F=>F.date.toDateString()===n.date.toDateString()),g=[...R].sort((F,oe)=>{const de=lt(F.date,F.startTime).getTime(),Be=lt(oe.date,oe.startTime).getTime();return de-Be}),O=lt(g[0].date,g[0].startTime),$=lt(g[g.length-1].date,g[g.length-1].endTime);return e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm font-semibold text-emerald-900 mt-1",children:d?g[0].date.toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"short",year:"numeric"}):"Multiple days selected"}),e.jsxs("p",{className:"text-xs text-emerald-700 mt-0.5",children:["Effective window: ",O.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}),"  ",$.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})]}),e.jsx("ul",{className:"mt-2 space-y-1",children:g.map(F=>e.jsx("li",{className:"text-xs text-emerald-600",children:F.label||`${F.startTime} - ${F.endTime}`},`${F.date.toISOString()}-${F.startTime}-${F.endTime}`))}),(()=>{var Be,Ke;const F=(Be=c.order)!=null&&Be.timeWindowStart?new Date(c.order.timeWindowStart):null,oe=(Ke=c.order)!=null&&Ke.timeWindowEnd?new Date(c.order.timeWindowEnd):null;return F&&oe&&O.getTime()===F.getTime()&&$.getTime()===oe.getTime()?e.jsx("p",{className:"text-xs text-emerald-800 mt-2 font-medium",children:" Same as current order window"}):e.jsx("p",{className:"text-xs text-amber-600 mt-2 font-medium",children:" Order will be rescheduled to this window"})})()]})})()]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500 font-semibold",children:"No slot selected"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:" Select an available time slot from the calendar below"})]})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(U,{onClick:()=>{if(!y.technicianId||!c.order||R.length===0)return;const n=R[0];if(!R.every(Be=>Be.date.toDateString()===n.date.toDateString())){N.error("Please select slots from a single day");return}const g=[...R].sort((Be,Ke)=>{const et=lt(Be.date,Be.startTime).getTime(),$s=lt(Ke.date,Ke.startTime).getTime();return et-$s}),O=lt(g[0].date,g[0].startTime),$=lt(g[g.length-1].date,g[g.length-1].endTime),F=c.order.timeWindowStart?new Date(c.order.timeWindowStart):null,oe=c.order.timeWindowEnd?new Date(c.order.timeWindowEnd):null;F&&oe&&O.getTime()===F.getTime()&&$.getTime()===oe.getTime()?ga(y.technicianId):hs.mutate({orderId:c.order._id,technicianId:y.technicianId,newStart:O.toISOString(),newEnd:$.toISOString()})},loading:hs.isPending||Kt.isPending,disabled:R.length===0||hs.isPending||Kt.isPending,className:"whitespace-nowrap",children:hs.isPending||Kt.isPending?"Assigning...":"Assign Technician"}),R.length>0&&e.jsx("button",{type:"button",onClick:()=>te([]),className:"text-xs text-slate-500 hover:text-slate-700 transition-colors",children:"Clear selection"})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),n.preventDefault();const d=new Date(A);d.setDate(d.getDate()-7),_(d)},className:"px-3 py-1.5 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:" Previous"}),e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:[On(A)," - ",On(Pn(A,7)[6])]}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),n.preventDefault();const d=new Date(A);d.setDate(d.getDate()+7),_(d)},className:"px-3 py-1.5 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:"Next "})]}),(Os||At)&&e.jsx("p",{className:"text-sm text-slate-400 text-center py-8",children:"Loading calendar"}),!Os&&!At&&ft.length===0&&e.jsx("p",{className:"text-sm text-amber-600 text-center py-8",children:"No time slots configured. Add slots in admin settings."}),!Os&&!At&&ft.length>0&&e.jsx("div",{className:"space-y-1",onClick:n=>n.stopPropagation(),children:Pn(A,7).map(n=>{const d=n.getDay(),g=ft.filter(F=>F.dayOfWeek===d),O=n.toDateString()===new Date().toDateString(),$=n<new Date(new Date().setHours(0,0,0,0));return e.jsxs("div",{className:`rounded-xl border p-3 ${O?"border-blue-200 bg-blue-50/50":"border-slate-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("p",{className:`text-sm font-semibold ${O?"text-blue-900":"text-slate-900"}`,children:n.toLocaleDateString("en-IN",{weekday:"short",day:"numeric",month:"short"})}),O&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-blue-500 text-white px-2 py-0.5 rounded-full",children:"Today"}),$&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-slate-300 text-slate-600 px-2 py-0.5 rounded-full",children:"Past"})]}),g.length===0?e.jsx("p",{className:"text-xs text-slate-400 italic",children:"No slots configured for this day"}):e.jsx("div",{className:"grid grid-cols-2 gap-2",children:g.map(F=>{var rn,an,nn,ln;const oe=Rd(n,F.startTime,F.endTime,Ps),de=oe!==null,Be=lt(n,F.startTime),Ke=lt(n,F.endTime),et=Ke<new Date,$s=(rn=c.order)!=null&&rn.timeWindowStart?new Date(c.order.timeWindowStart):null,sn=(an=c.order)!=null&&an.timeWindowEnd?new Date(c.order.timeWindowEnd):null,wr=$s&&sn&&Be.getTime()===$s.getTime()&&Ke.getTime()===sn.getTime(),Gi=!de&&!et&&c.order&&y.technicianId,bt=R.some(Qt=>Qt.date.toDateString()===n.toDateString()&&Qt.startTime===F.startTime&&Qt.endTime===F.endTime);return e.jsxs("button",{type:"button",disabled:de||et||!c.order,onClick:Qt=>{Qt.stopPropagation(),Qt.preventDefault(),Gi&&te(bt?zt=>zt.filter(Nr=>!(Nr.date.toDateString()===n.toDateString()&&Nr.startTime===F.startTime&&Nr.endTime===F.endTime)):zt=>zt.length>0&&zt[0].date.toDateString()!==n.toDateString()?(N.error("Please select slots from a single day"),zt):[...zt,{date:n,startTime:F.startTime,endTime:F.endTime,label:F.label||`${F.startTime} - ${F.endTime}`}])},className:`
                              relative p-2 rounded-lg text-left text-xs transition-all
                              ${de?"bg-rose-50 border border-rose-200 cursor-not-allowed":et?"bg-slate-50 border border-slate-200 cursor-not-allowed opacity-50":bt?"bg-blue-100 border-2 border-blue-500 ring-2 ring-blue-200 cursor-pointer":wr?"bg-emerald-50 border-2 border-emerald-400 hover:bg-emerald-100 cursor-pointer":"bg-emerald-50/50 border border-emerald-200 hover:bg-emerald-100 hover:border-emerald-400 cursor-pointer"}
                            `,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`font-semibold ${de?"text-rose-700":et?"text-slate-400":bt?"text-blue-700":"text-emerald-700"}`,children:F.label||`${F.startTime} - ${F.endTime}`}),de&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-rose-100 text-rose-600 px-1.5 py-0.5 rounded",children:"Blocked"}),bt&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-blue-500 text-white px-1.5 py-0.5 rounded",children:"Selected"}),!de&&!et&&!bt&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-emerald-100 text-emerald-600 px-1.5 py-0.5 rounded",children:"Available"})]}),e.jsxs("p",{className:`mt-1 ${de?"text-rose-600":et?"text-slate-400":bt?"text-blue-600":"text-emerald-600"}`,children:[F.startTime,"  ",F.endTime]}),de&&oe&&e.jsx("div",{className:"mt-2 pt-2 border-t border-rose-200",children:((ln=(nn=oe.order)==null?void 0:nn.customer)==null?void 0:ln.name)&&e.jsx("p",{className:"text-rose-600 truncate",children:oe.order.customer.name})}),!de&&!et&&c.order&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-emerald-200",children:[e.jsx("p",{className:`font-medium ${bt?"text-blue-700":"text-emerald-700"}`,children:bt?' Click "Assign Technician" above':wr?" Current order slot":"Click to select"}),!wr&&!bt&&e.jsx("p",{className:"text-emerald-600 text-[10px]",children:"Will reschedule order"})]})]},`${n.toISOString()}-${F.startTime}-${F.endTime}`)})})]},n.toISOString())})}),hs.isPending&&e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl flex items-center gap-3",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"text-slate-700 font-medium",children:"Rescheduling and assigning"})]})}),!Os&&Ps.length>0&&e.jsxs("div",{className:"mt-6 pt-4 border-t border-slate-200",children:[e.jsxs("p",{className:"text-xs uppercase tracking-wide text-slate-500 font-semibold mb-3",children:["Blocked entries (",Ps.length,")"]}),e.jsx("ol",{className:"space-y-2 max-h-48 overflow-y-auto",children:Ps.map(n=>{var g,O,$,F,oe,de;const d=typeof((g=n.order)==null?void 0:g.serviceItem)=="string"?(O=n.order)==null?void 0:O.serviceItem:(F=($=n.order)==null?void 0:$.serviceItem)==null?void 0:F.name;return e.jsxs("li",{className:"rounded-lg border border-slate-100 p-2 text-xs",children:[e.jsxs("p",{className:"font-semibold text-slate-900",children:[$e(n.start)," ",e.jsx("span",{className:"text-slate-400",children:""})," ",$e(n.end)]}),e.jsxs("p",{className:"text-slate-500",children:[d||"Blocked slot",(de=(oe=n.order)==null?void 0:oe.customer)!=null&&de.name?`  ${n.order.customer.name}`:""]})]},n.id)})})]})]}),e.jsx(Ze,{open:i,onClose:()=>{l(!1),jr()},title:"Create New Order",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Customer Information"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{label:"Customer Phone Number",value:ke,onChange:n=>ye(n.target.value),placeholder:"Enter phone number",disabled:u}),e.jsx(U,{onClick:zi,loading:u,variant:"secondary",className:"mt-6",children:"Check"})]}),S&&e.jsxs("div",{className:"rounded-lg bg-emerald-50 p-3 text-sm text-emerald-800",children:[" Customer found: ",S.name]}),e.jsx(L,{label:"Customer Name *",value:ie,onChange:n=>me(n.target.value),placeholder:"Enter customer name",disabled:!!(S&&ie)}),e.jsx(L,{label:"Email",type:"email",value:xe,onChange:n=>we(n.target.value),placeholder:"customer@email.com",disabled:!!(S&&xe)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Service Address"}),S&&S.addresses&&S.addresses.length>0&&e.jsxs(Qe,{label:"Select Address *",value:M,onChange:n=>Qi(n.target.value),children:[e.jsx("option",{value:"",children:"Choose an address"}),S.addresses.map(n=>e.jsxs("option",{value:n.id,children:[n.label||"Address"," - ",n.line1,", ",n.city," ",n.isDefault?"(Default)":""]},n.id))]}),e.jsx(L,{label:"Address Line 1 *",value:De,onChange:n=>Ne(n.target.value),placeholder:"Street address",disabled:!!(S&&De)}),e.jsx(L,{label:"Address Line 2",value:Fe,onChange:n=>v(n.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(L,{label:"City *",value:ee,onChange:n=>le(n.target.value),placeholder:"City",disabled:!!(S&&ee)}),e.jsx(L,{label:"State *",value:Le,onChange:n=>E(n.target.value),placeholder:"State",disabled:!!(S&&Le)})]}),e.jsx(L,{label:"Postal Code",value:Y,onChange:n=>X(n.target.value),placeholder:"PIN Code",disabled:!!(S&&Y)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Service Details"}),e.jsxs(Qe,{label:"Service Category *",value:he,onChange:n=>{nt(n.target.value),Ct("")},children:[e.jsx("option",{value:"",children:"Select category"}),Ti.map(n=>e.jsx("option",{value:n._id,children:n.name},n._id))]}),e.jsxs(Qe,{label:"Service Item *",value:Ye,onChange:n=>Ct(n.target.value),disabled:!he,children:[e.jsx("option",{value:"",children:"Select service"}),Pi.map(n=>e.jsx("option",{value:n._id,children:n.name},n._id))]}),e.jsx(Dt,{label:"Issue Description",value:qt,onChange:n=>Et(n.target.value),placeholder:"Describe the issue...",rows:3})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Schedule"}),e.jsx(L,{label:"Order Date *",type:"date",value:it,onChange:n=>pe(n.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(L,{label:"Start Time *",type:"time",value:ht,onChange:n=>pt(n.target.value)}),e.jsx(L,{label:"End Time *",type:"time",value:kt,onChange:n=>Rt(n.target.value)})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(U,{onClick:Zi,loading:Ca.isPending,children:"Create Order"}),e.jsx(U,{variant:"secondary",onClick:()=>{l(!1),jr()},children:"Cancel"})]})]})}),z.open&&Bn.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[9999] flex flex-col bg-black/95 backdrop-blur-md animate-in fade-in duration-200",onClick:n=>{n.stopPropagation(),n.target===n.currentTarget&&(Z({open:!1,url:"",name:""}),B(100))},onKeyDown:n=>{n.key==="Escape"&&(n.stopPropagation(),Z({open:!1,url:"",name:""}),B(100))},tabIndex:-1,style:{isolation:"isolate"},children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-gradient-to-b from-black/60 to-transparent",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-semibold text-lg truncate",children:z.name}),e.jsx("p",{className:"text-white/60 text-sm mt-0.5",children:"Click and drag to pan  Scroll to zoom"})]}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),Z({open:!1,url:"",name:""}),B(100)},className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-all ml-4","aria-label":"Close image viewer",children:e.jsx(ys,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center overflow-auto p-8",onClick:n=>n.stopPropagation(),children:e.jsx("div",{className:"relative transition-transform duration-200 ease-out",style:{transform:`scale(${T/100})`,cursor:T>100?"move":"default"},children:e.jsx("img",{src:z.url,alt:z.name,className:"max-w-none shadow-2xl rounded-lg",style:{maxHeight:"80vh",maxWidth:T===100?"90vw":"none"},onClick:n=>n.stopPropagation(),onWheel:n=>{n.preventDefault();const d=n.deltaY>0?-10:10;B(g=>Math.min(Math.max(50,g+d),300))},draggable:!1})})}),e.jsxs("div",{className:"flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-t from-black/60 to-transparent",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm rounded-lg px-4 py-2",children:[e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),B(d=>Math.max(50,d-10))},disabled:T<=50,className:"p-2 rounded-lg hover:bg-white/10 text-white transition-all disabled:opacity-40 disabled:cursor-not-allowed",title:"Zoom out",children:e.jsx(ko,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center gap-2 px-3",children:[e.jsx("input",{type:"range",min:"50",max:"300",step:"10",value:T,onChange:n=>B(Number(n.target.value)),className:"w-32 h-1 bg-white/20 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, rgb(59 130 246) 0%, rgb(59 130 246) ${(T-50)/250*100}%, rgba(255,255,255,0.2) ${(T-50)/250*100}%, rgba(255,255,255,0.2) 100%)`},onClick:n=>n.stopPropagation()}),e.jsxs("span",{className:"text-white font-medium text-sm min-w-[3.5rem] text-center",children:[T,"%"]})]}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),B(d=>Math.min(300,d+10))},disabled:T>=300,className:"p-2 rounded-lg hover:bg-white/10 text-white transition-all disabled:opacity-40 disabled:cursor-not-allowed",title:"Zoom in",children:e.jsx(_o,{className:"h-5 w-5"})})]}),e.jsxs("button",{type:"button",onClick:n=>{n.stopPropagation(),B(100)},className:"px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white text-sm font-medium transition-all flex items-center gap-2",title:"Reset zoom",children:[e.jsx(dn,{className:"h-4 w-4"}),"Reset"]}),e.jsxs("button",{type:"button",onClick:n=>{n.stopPropagation(),window.open(z.url,"_blank")},className:"px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium transition-all flex items-center gap-2",title:"Open in new tab",children:[e.jsx(dn,{className:"h-4 w-4"}),"Full Screen"]})]})]}),document.body)]})},Ld=()=>{const t=tr(),s=St(),[r,a]=o.useState(!1),[i,l]=o.useState(null),[c,m]=o.useState(!1),[x,b]=o.useState(null),h=mt({defaultValues:{name:"",description:"",imageUrl:""}}),p=h.watch("imageUrl"),j=S=>{var G;const K=(G=S.target.files)==null?void 0:G[0];if(!K)return;const M=new FileReader;M.onload=()=>{typeof M.result=="string"&&h.setValue("imageUrl",M.result,{shouldDirty:!0,shouldValidate:!0})},M.readAsDataURL(K),S.target.value=""},{data:Q=[],isLoading:z}=ge({queryKey:["categories"],queryFn:Pe.categories}),Z=ne({mutationFn:S=>Pe.upsertCategory(S),onSuccess:()=>{N.success("Category saved"),s.invalidateQueries({queryKey:["categories"]}),h.reset(),a(!1)},onError:S=>{var K,M;return N.error(((M=(K=S==null?void 0:S.response)==null?void 0:K.data)==null?void 0:M.message)||"Failed to save category")}}),T=ne({mutationFn:S=>Pe.updateCategory(i._id,S),onSuccess:()=>{N.success("Category updated successfully"),s.invalidateQueries({queryKey:["categories"]}),h.reset(),l(null),a(!1)},onError:S=>{var K,M;return N.error(((M=(K=S==null?void 0:S.response)==null?void 0:K.data)==null?void 0:M.message)||"Failed to update category")}}),B=ne({mutationFn:S=>Pe.deleteCategory(S),onSuccess:()=>{N.success("Category deleted successfully"),s.invalidateQueries({queryKey:["categories"]}),m(!1),b(null)},onError:S=>{var K,M;return N.error(((M=(K=S==null?void 0:S.response)==null?void 0:K.data)==null?void 0:M.message)||"Failed to delete category")}}),C=ne({mutationFn:({categoryId:S,isActive:K})=>Pe.updateCategory(S,{isActive:K}),onSuccess:(S,K)=>{N.success(K.isActive?"Category activated":"Category deactivated"),s.invalidateQueries({queryKey:["categories"]})},onError:S=>{var K,M;return N.error(((M=(K=S==null?void 0:S.response)==null?void 0:K.data)==null?void 0:M.message)||"Failed to update status")}}),k=(S,K)=>{K.stopPropagation(),S._id&&C.mutate({categoryId:S._id,isActive:!(S.isActive??!0)})},P=()=>{l(null),h.reset({name:"",description:"",imageUrl:""}),a(!0)},I=(S,K)=>{K.stopPropagation(),l(S),h.reset({name:S.name,description:S.description||"",imageUrl:S.imageUrl||""}),a(!0)},ce=(S,K)=>{K.stopPropagation(),b(S),m(!0)},be=S=>{i?T.mutate(S):Z.mutate(S)},ke=()=>{x!=null&&x._id&&B.mutate(x._id)},ye=()=>{a(!1),l(null),h.reset()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Catalog"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Service Categories & Workflows"})]}),e.jsx(U,{onClick:P,children:"Add Category"})]}),e.jsxs(qe,{title:"Categories",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Click a category to manage its sub categories."}),z&&e.jsx("p",{className:"mt-4 text-sm text-slate-400",children:"Loading categories"}),!z&&Q.length===0&&e.jsx("p",{className:"mt-4 text-sm text-slate-400",children:"No categories yet. Create one using the form above."}),!z&&Q.length>0&&e.jsx("div",{className:"mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:Q.map(S=>{const K=S.isActive??!0;return e.jsxs("div",{className:`group relative flex flex-col items-center gap-3 rounded-2xl border bg-white p-6 text-center shadow-sm transition hover:-translate-y-1 hover:shadow-lg cursor-pointer ${K?"border-slate-100 hover:border-slate-200":"border-slate-200 bg-slate-50 opacity-60"}`,onClick:()=>t(`/catalog/${S._id}`),children:[!K&&e.jsx("div",{className:"absolute left-2 top-2",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 text-xs font-medium",children:"Inactive"})}),e.jsxs("div",{className:"absolute right-2 top-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{type:"button",onClick:M=>k(S,M),className:`p-1.5 rounded-lg bg-white/90 transition-colors shadow-sm ${K?"text-amber-500 hover:text-amber-700 hover:bg-amber-50":"text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50"}`,title:K?"Deactivate category":"Activate category",disabled:C.isPending,children:K?e.jsx(Fr,{className:"h-4 w-4"}):e.jsx(Lr,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:M=>I(S,M),className:"p-1.5 rounded-lg bg-white/90 text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors shadow-sm",title:"Edit category",children:e.jsx($t,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:M=>ce(S,M),className:"p-1.5 rounded-lg bg-white/90 text-rose-500 hover:text-rose-700 hover:bg-rose-50 transition-colors shadow-sm",title:"Delete category",children:e.jsx(Ns,{className:"h-4 w-4"})})]}),S.imageUrl?e.jsx("img",{src:S.imageUrl,alt:S.name,className:`h-24 w-24 rounded-2xl object-cover ${K?"":"grayscale"}`}):e.jsx("div",{className:"flex h-24 w-24 items-center justify-center rounded-2xl bg-slate-50 text-xs text-slate-400",children:"No image"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-900 group-hover:text-slate-700",children:S.name}),S.description&&e.jsx("p",{className:"mt-1 text-xs text-slate-500 line-clamp-2",children:S.description})]})]},S._id)})})]})]}),e.jsx(Ze,{open:r,onClose:ye,title:i?"Edit Category":"Add Category",children:e.jsxs("form",{className:"space-y-4",onSubmit:h.handleSubmit(be),children:[e.jsx(L,{label:"Name *",placeholder:"Electrical",...h.register("name",{required:!0})}),e.jsx(Dt,{label:"Description",placeholder:"Household electrical repairs",...h.register("description")}),e.jsx(L,{type:"file",accept:"image/*",label:"Upload image",onChange:j}),p&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:p,alt:"Category preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(U,{type:"button",variant:"ghost",onClick:ye,children:"Cancel"}),e.jsx(U,{type:"submit",loading:Z.isPending||T.isPending,children:i?"Update Category":"Save Category"})]})]})}),e.jsx(Ze,{open:c,onClose:()=>{m(!1),b(null)},title:"Delete Category",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-slate-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:x==null?void 0:x.name}),"? This action cannot be undone."]}),e.jsx("p",{className:"text-xs text-amber-600 bg-amber-50 p-3 rounded-lg",children:"Note: Categories with existing service items or orders cannot be deleted."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(U,{variant:"ghost",onClick:()=>{m(!1),b(null)},children:"Cancel"}),e.jsx(U,{variant:"primary",className:"!bg-rose-600 hover:!bg-rose-700",onClick:ke,loading:B.isPending,children:"Delete Category"})]})]})})]})},Md=()=>{const{categoryId:t}=Un(),s=tr(),r=St(),a=t??"",[i,l]=o.useState(!1),[c,m]=o.useState(null),[x,b]=o.useState(!1),[h,p]=o.useState(null),[j,Q]=o.useState(!1),{data:z=[],isLoading:Z}=ge({queryKey:["categories"],queryFn:Pe.categories}),T=z.find(E=>E._id===t),{data:B=[],isLoading:C}=ge({queryKey:["serviceItems",a],queryFn:()=>Pe.serviceItems(a),enabled:!!a}),k=mt({defaultValues:{category:a,name:"",description:"",basePrice:0,imageUrl:""}}),P=k.watch("imageUrl"),I=mt({defaultValues:{name:"",description:"",imageUrl:""}}),ce=I.watch("imageUrl"),be=E=>{var he;const Y=(he=E.target.files)==null?void 0:he[0];if(!Y)return;const X=new FileReader;X.onload=()=>{typeof X.result=="string"&&k.setValue("imageUrl",X.result,{shouldDirty:!0,shouldValidate:!0})},X.readAsDataURL(Y),E.target.value=""},ke=E=>{var he;const Y=(he=E.target.files)==null?void 0:he[0];if(!Y)return;const X=new FileReader;X.onload=()=>{typeof X.result=="string"&&I.setValue("imageUrl",X.result,{shouldDirty:!0,shouldValidate:!0})},X.readAsDataURL(Y),E.target.value=""};o.useEffect(()=>{a&&k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""})},[a,k]);const ye=ne({mutationFn:E=>Pe.upsertServiceItem(E),onSuccess:()=>{N.success("Sub category created"),r.invalidateQueries({queryKey:["serviceItems",a]}),k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""}),l(!1)},onError:E=>{var Y,X;return N.error(((X=(Y=E==null?void 0:E.response)==null?void 0:Y.data)==null?void 0:X.message)||"Failed to create sub category")}}),S=ne({mutationFn:E=>Pe.updateServiceItem(c._id,E),onSuccess:()=>{N.success("Sub category updated"),r.invalidateQueries({queryKey:["serviceItems",a]}),k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""}),m(null),l(!1)},onError:E=>{var Y,X;return N.error(((X=(Y=E==null?void 0:E.response)==null?void 0:Y.data)==null?void 0:X.message)||"Failed to update sub category")}}),K=ne({mutationFn:E=>Pe.deleteServiceItem(E),onSuccess:()=>{N.success("Sub category deleted"),r.invalidateQueries({queryKey:["serviceItems",a]}),b(!1),p(null)},onError:E=>{var Y,X;return N.error(((X=(Y=E==null?void 0:E.response)==null?void 0:Y.data)==null?void 0:X.message)||"Failed to delete sub category")}}),M=ne({mutationFn:E=>Pe.updateCategory(a,E),onSuccess:()=>{N.success("Category updated"),r.invalidateQueries({queryKey:["categories"]}),I.reset(),Q(!1)},onError:E=>{var Y,X;return N.error(((X=(Y=E==null?void 0:E.response)==null?void 0:Y.data)==null?void 0:X.message)||"Failed to update category")}}),G=ne({mutationFn:({itemId:E,isActive:Y})=>Pe.updateServiceItem(E,{isActive:Y}),onSuccess:(E,Y)=>{N.success(Y.isActive?"Sub category activated":"Sub category deactivated"),r.invalidateQueries({queryKey:["serviceItems",a]})},onError:E=>{var Y,X;return N.error(((X=(Y=E==null?void 0:E.response)==null?void 0:Y.data)==null?void 0:X.message)||"Failed to update status")}}),ie=ne({mutationFn:({isActive:E})=>Pe.updateCategory(a,{isActive:E}),onSuccess:(E,Y)=>{N.success(Y.isActive?"Category activated":"Category deactivated"),r.invalidateQueries({queryKey:["categories"]})},onError:E=>{var Y,X;return N.error(((X=(Y=E==null?void 0:E.response)==null?void 0:Y.data)==null?void 0:X.message)||"Failed to update status")}}),me=E=>{E._id&&G.mutate({itemId:E._id,isActive:!(E.isActive??!0)})},xe=()=>{T&&ie.mutate({isActive:!(T.isActive??!0)})},we=()=>{m(null),k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""}),l(!0)},De=E=>{m(E),k.reset({category:a,name:E.name,description:E.description||"",basePrice:E.basePrice||0,imageUrl:E.imageUrl||""}),l(!0)},Ne=E=>{p(E),b(!0)},Fe=()=>{T&&(I.reset({name:T.name,description:T.description||"",imageUrl:T.imageUrl||""}),Q(!0))},v=E=>{c?S.mutate(E):ye.mutate({...E,category:a})},ee=()=>{h!=null&&h._id&&K.mutate(h._id)},le=()=>{l(!1),m(null),k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""})},Le=E=>{M.mutate(E)};return a?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(U,{variant:"ghost",icon:e.jsx(ro,{className:"h-4 w-4"}),onClick:()=>s("/catalog"),children:"Back to catalog"}),e.jsxs("div",{className:"flex items-center gap-3",children:[(T==null?void 0:T.imageUrl)&&e.jsx("img",{src:T.imageUrl,alt:T.name,className:`h-12 w-12 rounded-xl object-cover ${T.isActive??!0?"":"grayscale opacity-60"}`}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Catalog"}),T&&!(T.isActive??!0)&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 text-xs font-medium",children:"Inactive"})]}),e.jsx("h1",{className:"mt-1 text-2xl font-bold text-slate-900",children:Z?"Loading":(T==null?void 0:T.name)||"Category not found"}),(T==null?void 0:T.description)&&e.jsx("p",{className:"text-sm text-slate-500",children:T.description})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[T&&e.jsxs(e.Fragment,{children:[e.jsx(U,{variant:"secondary",onClick:xe,loading:ie.isPending,icon:T.isActive??!0?e.jsx(Fr,{className:"h-4 w-4"}):e.jsx(Lr,{className:"h-4 w-4"}),className:T.isActive??!0?"":"!bg-emerald-50 !text-emerald-700 !border-emerald-200",children:T.isActive??!0?"Deactivate":"Activate"}),e.jsx(U,{variant:"secondary",onClick:Fe,icon:e.jsx($t,{className:"h-4 w-4"}),children:"Edit Category"})]}),e.jsx(U,{onClick:we,disabled:!T,children:"Add Sub Category"})]})]}),!Z&&!T&&e.jsx(qe,{children:e.jsx("p",{className:"text-sm text-rose-500",children:"We couldn't find that category. It may have been deleted."})}),T&&e.jsxs(qe,{title:`Sub Categories (${B.length})`,children:[C&&e.jsx("p",{className:"text-sm text-slate-400",children:"Loading sub categories"}),!C&&B.length===0&&e.jsx("p",{className:"text-sm text-slate-400",children:"No sub categories yet. Create one using the button above."}),!C&&B.length>0&&e.jsx("div",{className:"mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:B.map(E=>{const Y=E.isActive??!0;return e.jsxs("div",{className:`group relative flex flex-col items-center gap-3 rounded-2xl border bg-white p-6 text-center shadow-sm ${Y?"border-slate-100":"border-slate-200 bg-slate-50 opacity-60"}`,children:[!Y&&e.jsx("div",{className:"absolute left-2 top-2",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 text-xs font-medium",children:"Inactive"})}),e.jsxs("div",{className:"absolute right-2 top-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{type:"button",onClick:()=>me(E),className:`p-1.5 rounded-lg bg-white/90 transition-colors shadow-sm ${Y?"text-amber-500 hover:text-amber-700 hover:bg-amber-50":"text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50"}`,title:Y?"Deactivate sub category":"Activate sub category",disabled:G.isPending,children:Y?e.jsx(Fr,{className:"h-4 w-4"}):e.jsx(Lr,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>De(E),className:"p-1.5 rounded-lg bg-white/90 text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors shadow-sm",title:"Edit sub category",children:e.jsx($t,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>Ne(E),className:"p-1.5 rounded-lg bg-white/90 text-rose-500 hover:text-rose-700 hover:bg-rose-50 transition-colors shadow-sm",title:"Delete sub category",children:e.jsx(Ns,{className:"h-4 w-4"})})]}),E.imageUrl?e.jsx("img",{src:E.imageUrl,alt:E.name,className:`h-20 w-20 rounded-2xl object-cover ${Y?"":"grayscale"}`}):e.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-2xl bg-slate-50 text-xs text-slate-400",children:"No image"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-900",children:E.name}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2",children:E.description||""}),typeof E.basePrice=="number"&&e.jsxs("p",{className:"mt-1 text-sm font-medium text-slate-700",children:["Base ",E.basePrice.toFixed(2)]})]})]},E._id)})})]}),e.jsx(Ze,{open:i,onClose:le,title:c?"Edit Sub Category":"Add Sub Category",children:e.jsxs("form",{className:"space-y-4",onSubmit:k.handleSubmit(v),children:[e.jsx(L,{label:"Sub category name *",placeholder:"Fan installation",...k.register("name",{required:!0})}),e.jsx(Dt,{label:"Description",...k.register("description")}),e.jsx(L,{type:"file",accept:"image/*",label:"Upload image",onChange:be}),P&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:P,alt:"Sub category preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsx(L,{label:"Base price ()",type:"number",step:"0.01",...k.register("basePrice",{valueAsNumber:!0})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(U,{type:"button",variant:"ghost",onClick:le,children:"Cancel"}),e.jsx(U,{type:"submit",loading:ye.isPending||S.isPending,children:c?"Update Sub Category":"Save Sub Category"})]})]})}),e.jsx(Ze,{open:x,onClose:()=>{b(!1),p(null)},title:"Delete Sub Category",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-slate-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:h==null?void 0:h.name}),"? This action cannot be undone."]}),e.jsx("p",{className:"text-xs text-amber-600 bg-amber-50 p-3 rounded-lg",children:"Note: Sub categories with existing orders cannot be deleted."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(U,{variant:"ghost",onClick:()=>{b(!1),p(null)},children:"Cancel"}),e.jsx(U,{variant:"primary",className:"!bg-rose-600 hover:!bg-rose-700",onClick:ee,loading:K.isPending,children:"Delete Sub Category"})]})]})}),e.jsx(Ze,{open:j,onClose:()=>{Q(!1),I.reset()},title:"Edit Category",children:e.jsxs("form",{className:"space-y-4",onSubmit:I.handleSubmit(Le),children:[e.jsx(L,{label:"Name *",placeholder:"Electrical",...I.register("name",{required:!0})}),e.jsx(Dt,{label:"Description",placeholder:"Household electrical repairs",...I.register("description")}),e.jsx(L,{type:"file",accept:"image/*",label:"Upload image",onChange:ke}),ce&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:ce,alt:"Category preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(U,{type:"button",variant:"ghost",onClick:()=>{Q(!1),I.reset()},children:"Cancel"}),e.jsx(U,{type:"submit",loading:M.isPending,children:"Update Category"})]})]})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(U,{variant:"ghost",onClick:()=>s("/catalog"),children:"Back to catalog"}),e.jsx("p",{className:"text-sm text-rose-500",children:"No category selected."})]})},Bd=()=>{const t=St(),s=mt({defaultValues:{name:"",sku:"",unitPrice:0,imageUrl:""}}),r=s.watch("imageUrl"),{data:a=[]}=ge({queryKey:["spareParts"],queryFn:Or.list}),i=c=>{var b;const m=(b=c.target.files)==null?void 0:b[0];if(!m)return;const x=new FileReader;x.onload=()=>{typeof x.result=="string"&&s.setValue("imageUrl",x.result,{shouldDirty:!0,shouldValidate:!0})},x.readAsDataURL(m),c.target.value=""},l=ne({mutationFn:Or.upsert,onSuccess:()=>{N.success("Spare part saved"),t.invalidateQueries({queryKey:["spareParts"]}),s.reset()}});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Inventory"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Spare Parts Management"})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsx(qe,{title:"Add Spare Part",children:e.jsxs("form",{className:"space-y-4",onSubmit:s.handleSubmit(c=>l.mutate(c)),children:[e.jsx(L,{label:"Name",...s.register("name",{required:!0})}),e.jsx(L,{label:"SKU",...s.register("sku",{required:!0})}),e.jsx(L,{type:"number",step:"0.01",label:"Unit price",...s.register("unitPrice",{valueAsNumber:!0})}),e.jsx(L,{type:"file",accept:"image/*",label:"Upload image",onChange:i}),r&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:r,alt:"Spare part preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsx(U,{type:"submit",loading:l.isPending,children:"Save"})]})}),e.jsx(qe,{title:"Catalog",children:e.jsx("div",{className:"space-y-4",children:a.map(c=>{var m;return e.jsxs("div",{className:"flex items-center gap-4 rounded-2xl border border-slate-100 p-4",children:[c.imageUrl?e.jsx("img",{src:c.imageUrl,alt:c.name,className:"h-16 w-16 rounded-lg object-cover"}):e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-lg bg-slate-50 text-xs text-slate-400",children:"No image"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:c.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:["SKU: ",c.sku]}),e.jsxs("p",{className:"mt-1 text-sm text-slate-600",children:["",(m=c.unitPrice)==null?void 0:m.toFixed(2)]})]})]},c._id)})})})]})]})},Dn={name:"",email:"",phone:"",password:"",role:"technician",serviceItems:[],skills:[]},$d=()=>{const t=St(),s=mt({defaultValues:Dn}),r=ld({control:s.control,name:"role"}),{data:a=[]}=ge({queryKey:["serviceItems"],queryFn:()=>Pe.serviceItems()}),{data:i=[]}=ge({queryKey:["technician-skills"],queryFn:Dr.list}),l=ne({mutationFn:dl.create,onSuccess:()=>{N.success("User created"),s.reset(Dn)},onError:x=>{var b,h;return N.error(((h=(b=x==null?void 0:x.response)==null?void 0:b.data)==null?void 0:h.message)||"Failed to create user")}});o.useEffect(()=>{r==="admin"&&(s.setValue("serviceItems",[]),s.setValue("skills",[]))},[r,s]);const c=mt({defaultValues:{name:"",description:""}}),m=ne({mutationFn:Dr.create,onSuccess:()=>{N.success("Skill saved"),c.reset(),t.invalidateQueries({queryKey:["technician-skills"]})},onError:x=>{var b,h;return N.error(((h=(b=x==null?void 0:x.response)==null?void 0:b.data)==null?void 0:h.message)||"Failed to save skill")}});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Team"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Create Admin / Technician"})]}),e.jsx(qe,{children:e.jsxs("form",{className:"grid gap-4 md:grid-cols-2",onSubmit:s.handleSubmit(x=>l.mutate(x)),children:[e.jsx(L,{label:"Full name",...s.register("name",{required:!0})}),e.jsx(L,{label:"Email",type:"email",...s.register("email",{required:!0})}),e.jsx(L,{label:"Phone",...s.register("phone",{required:!0})}),e.jsx(L,{label:"Password",type:"password",...s.register("password",{required:!0})}),e.jsxs(Qe,{label:"Role",...s.register("role",{required:!0}),children:[e.jsx("option",{value:"technician",children:"Technician"}),e.jsx("option",{value:"admin",children:"Admin"})]}),r==="technician"&&e.jsxs("div",{className:"col-span-2 grid gap-6",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{className:"font-medium text-slate-900",children:"Service capabilities"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Select the catalog services this technician can perform."}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[a.map(x=>e.jsxs("label",{className:"flex items-center gap-2 rounded-xl border border-slate-200 p-3",children:[e.jsx("input",{type:"checkbox",value:x._id,...s.register("serviceItems"),className:"accent-slate-900"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:x.name})]},x._id)),!a.length&&e.jsx("span",{className:"text-xs text-slate-400",children:"No services available."})]})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{className:"font-medium text-slate-900",children:"Technician skills"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Pick applicable trade skills (electrician, plumber, pest control, etc.)."}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[i.map(x=>e.jsxs("label",{className:"flex items-center gap-2 rounded-xl border border-slate-200 p-3",children:[e.jsx("input",{type:"checkbox",value:x._id,...s.register("skills"),className:"accent-slate-900"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:x.name})]},x._id)),!i.length&&e.jsx("span",{className:"text-xs text-slate-400",children:"Add skill types below to start tagging technicians."})]})]})]}),e.jsx(U,{type:"submit",loading:l.isPending,className:"col-span-2",children:"Create User"})]})}),e.jsxs(qe,{title:"Manage Technician Skills",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Add or update the skill taxonomy used when creating technicians."}),e.jsxs("form",{className:"mt-4 grid gap-4 md:grid-cols-2",onSubmit:c.handleSubmit(x=>m.mutate(x)),children:[e.jsx(L,{label:"Skill name",placeholder:"Electrician",...c.register("name",{required:!0})}),e.jsx(L,{label:"Description",placeholder:"Optional",...c.register("description")}),e.jsx(U,{type:"submit",loading:m.isPending,className:"md:col-span-2",children:"Save Skill"})]})]})]})},Ws={label:"",dayOfWeek:0,startTime:"09:00",endTime:"10:00",intervalMinutes:60,capacity:1,isActive:!0},In=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map((t,s)=>({label:t,value:s})),qd=()=>{const t=St(),[s,r]=o.useState(null),a=mt({defaultValues:Ws}),{data:i=[],isLoading:l}=ge({queryKey:["time-slots"],queryFn:bs.list}),c=ne({mutationFn:({slotId:h,data:p})=>h?bs.update(h,p):bs.create(p),onSuccess:()=>{N.success(`Time slot ${s?"updated":"created"}`),t.invalidateQueries({queryKey:["time-slots"]}),r(null),a.reset(Ws)},onError:h=>{var p,j;return N.error(((j=(p=h==null?void 0:h.response)==null?void 0:p.data)==null?void 0:j.message)||"Unable to save time slot")}}),m=ne({mutationFn:h=>bs.remove(h),onSuccess:()=>{N.success("Time slot removed"),t.invalidateQueries({queryKey:["time-slots"]}),s&&s._id&&(r(null),a.reset(Ws))},onError:h=>{var p,j;return N.error(((j=(p=h==null?void 0:h.response)==null?void 0:p.data)==null?void 0:j.message)||"Unable to delete slot")}});o.useEffect(()=>{s?a.reset({label:`${s.startTime}-${s.endTime}`,dayOfWeek:s.dayOfWeek,startTime:s.startTime,endTime:s.endTime,intervalMinutes:s.intervalMinutes??60,capacity:s.capacity??1,isActive:s.isActive??!0,_id:s._id}):a.reset(Ws)},[s,a]);const x=h=>{const p={...h,intervalMinutes:h.intervalMinutes||60,capacity:h.capacity||1};c.mutate({slotId:s==null?void 0:s._id,data:p})},b=o.useMemo(()=>In.map(h=>({day:h,entries:i.filter(p=>p.dayOfWeek===h.value)})),[i]);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Scheduling"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Time Slot Templates"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Control reusable availability windows used by admin scheduling tooling."})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[360px,1fr]",children:[e.jsx(qe,{title:s?"Edit Time Slot":"Create Time Slot",children:e.jsxs("form",{className:"space-y-4",onSubmit:a.handleSubmit(x),children:[e.jsx(L,{label:"Label",placeholder:"Morning Prime",...a.register("label")}),e.jsx(Qe,{label:"Day of week",...a.register("dayOfWeek",{setValueAs:h=>Number(h)}),children:In.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(L,{type:"time",label:"Start",...a.register("startTime",{required:!0})}),e.jsx(L,{type:"time",label:"End",...a.register("endTime",{required:!0})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(L,{type:"number",label:"Interval (minutes)",min:15,step:15,...a.register("intervalMinutes",{valueAsNumber:!0,min:15})}),e.jsx(L,{type:"number",label:"Capacity",min:1,step:1,...a.register("capacity",{valueAsNumber:!0,min:1})})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 accent-slate-900",...a.register("isActive")}),"Active"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(U,{type:"submit",loading:c.isPending,className:"flex-1",children:s?"Update Slot":"Create Slot"}),s&&e.jsx(U,{type:"button",variant:"secondary",onClick:()=>r(null),children:"Cancel"})]})]})}),e.jsx(qe,{title:"Configured Slots",children:l?e.jsx("p",{className:"text-sm text-slate-500",children:"Loading time slots"}):e.jsx("div",{className:"space-y-5",children:b.map(({day:h,entries:p})=>e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:h.label}),e.jsxs("div",{className:"mt-2 space-y-3",children:[p.length===0&&e.jsx("p",{className:"text-sm text-slate-300",children:"No slots configured."}),p.map(j=>e.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl border border-slate-100 bg-white p-4 shadow-sm sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:j.label||`${j.startTime}  ${j.endTime}`}),e.jsxs("p",{className:"text-xs text-slate-500",children:[j.startTime,"  ",j.endTime,"  every ",j.intervalMinutes,"m  capacity ",j.capacity]}),!j.isActive&&e.jsx("p",{className:"text-xs text-rose-500",children:"Inactive"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{variant:"secondary",onClick:()=>r(j),children:"Edit"}),e.jsx(U,{variant:"secondary",className:"text-rose-600",onClick:()=>j._id&&m.mutate(j._id),loading:m.isPending&&m.variables===j._id,children:"Delete"})]})]},j._id))]})]},h.value))})})]})]})},Ud=[{value:"present",label:"Present"},{value:"absent",label:"Absent"},{value:"on_leave",label:"On leave"}],Vd=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"suspended",label:"Suspended"}],Rn=()=>new Date().toISOString().split("T")[0],Fn=(t,s)=>{if(!t||!s)return;const r=s.length===5?`${s}:00`:s;return new Date(`${t}T${r}`).toISOString()},Wd=()=>{var me,xe,we,De,Ne,Fe;const t=St(),[s,r]=qn(),[a,i]=o.useState(null),[l,c]=o.useState(()=>s.get("selected")),[m,x]=o.useState(!1),[b,h]=o.useState(null),{data:p=[],isLoading:j}=ge({queryKey:["technicians"],queryFn:Xt.list}),{data:Q=[]}=ge({queryKey:["categories"],queryFn:Pe.categories,enabled:m}),{data:z=[]}=ge({queryKey:["all-service-items"],queryFn:()=>Pe.serviceItems(),enabled:m}),{data:Z=[]}=ge({queryKey:["technician-skills"],queryFn:Dr.list,enabled:m});o.useEffect(()=>{if(l&&p.length>0&&!j){const v=p.find(le=>le.id===l);v&&i(v),c(null);const ee=new URLSearchParams(s);ee.delete("selected"),r(ee,{replace:!0})}},[p,l,j,s,r]);const{data:T=[],isFetching:B}=ge({queryKey:["technician-attendance",a==null?void 0:a.id],queryFn:()=>Xt.attendance(a.id),enabled:!!(a!=null&&a.id)}),C=mt({defaultValues:{date:Rn(),status:"present",checkInTime:"09:00",checkOutTime:"18:00"}}),k=mt({defaultValues:{name:"",email:"",phone:"",status:"active",experienceYears:0,workingHoursStart:"08:00",workingHoursEnd:"20:00",selectedSkills:[],selectedServiceItems:[],selectedServiceCategories:[]}});o.useEffect(()=>{C.reset({date:Rn(),status:"present",checkInTime:"09:00",checkOutTime:"18:00",note:""})},[C,a]);const P=ne({mutationFn:v=>{if(!a)throw new Error("Select a technician");return Xt.markAttendance(a.id,{date:v.date,status:v.status,checkInAt:Fn(v.date,v.checkInTime),checkOutAt:Fn(v.date,v.checkOutTime),note:v.note})},onSuccess:()=>{N.success("Attendance updated"),a&&t.invalidateQueries({queryKey:["technician-attendance",a.id]}),t.invalidateQueries({queryKey:["technicians"]})},onError:v=>{var ee,le;return N.error(((le=(ee=v==null?void 0:v.response)==null?void 0:ee.data)==null?void 0:le.message)||"Unable to save attendance")}}),I=ne({mutationFn:v=>{if(!b)throw new Error("No technician selected");return Xt.update(b.id,{name:v.name,email:v.email,phone:v.phone,status:v.status,experienceYears:v.experienceYears,workingHours:{start:v.workingHoursStart,end:v.workingHoursEnd},skills:v.selectedSkills,serviceItems:v.selectedServiceItems,serviceCategories:v.selectedServiceCategories})},onSuccess:v=>{N.success("Technician updated successfully"),t.invalidateQueries({queryKey:["technicians"]}),x(!1),h(null),(a==null?void 0:a.id)===v.id&&i(v)},onError:v=>{var ee,le;return N.error(((le=(ee=v==null?void 0:v.response)==null?void 0:ee.data)==null?void 0:le.message)||"Failed to update technician")}}),ce=o.useMemo(()=>T.slice(0,10),[T]),be=(v,ee)=>{var le,Le,E,Y,X;ee==null||ee.stopPropagation(),h(v),k.reset({name:v.name||"",email:v.email||"",phone:v.phone||"",status:v.status||"active",experienceYears:v.experienceYears||0,workingHoursStart:((le=v.workingHours)==null?void 0:le.start)||"08:00",workingHoursEnd:((Le=v.workingHours)==null?void 0:Le.end)||"20:00",selectedSkills:((E=v.skills)==null?void 0:E.map(he=>typeof he=="string"?he:he.id||he._id||"").filter(Boolean))||[],selectedServiceItems:((Y=v.serviceItems)==null?void 0:Y.map(he=>he.id||he._id||"").filter(Boolean))||[],selectedServiceCategories:((X=v.serviceCategories)==null?void 0:X.map(he=>he.id||he._id||"").filter(Boolean))||[]}),x(!0)},ke=()=>{x(!1),h(null),k.reset()},ye=v=>{const ee=k.getValues("selectedSkills");ee.includes(v)?k.setValue("selectedSkills",ee.filter(le=>le!==v)):k.setValue("selectedSkills",[...ee,v])},S=v=>{const ee=k.getValues("selectedServiceItems");ee.includes(v)?k.setValue("selectedServiceItems",ee.filter(le=>le!==v)):k.setValue("selectedServiceItems",[...ee,v])},K=v=>{const ee=k.getValues("selectedServiceCategories");ee.includes(v)?k.setValue("selectedServiceCategories",ee.filter(le=>le!==v)):k.setValue("selectedServiceCategories",[...ee,v])},M=k.watch("selectedSkills"),G=k.watch("selectedServiceItems"),ie=k.watch("selectedServiceCategories");return e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"flex flex-wrap items-end justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Operations"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Technician Roster"})]})}),e.jsx(qe,{title:"Technicians",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs uppercase tracking-wide text-slate-500",children:[e.jsx("th",{className:"px-4 py-3",children:"Name"}),e.jsx("th",{className:"px-4 py-3",children:"Contact"}),e.jsx("th",{className:"px-4 py-3",children:"Skills"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3",children:"Today"}),e.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[j&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-6 text-center text-slate-400",children:"Loading technicians"})}),!j&&p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-6 text-center text-slate-400",children:"No technicians found. Create technician users to populate this list."})}),p.map(v=>{var ee;return e.jsxs("tr",{className:"cursor-pointer transition hover:bg-slate-50",onClick:()=>i(v),children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:v.name}),e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-500",children:[v.phone||"",e.jsx("span",{className:"block text-xs text-slate-400",children:v.email||""})]}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-500",children:(ee=v.skills)!=null&&ee.length?v.skills.slice(0,3).join(", "):"Generalist"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`text-xs uppercase tracking-wide px-2 py-1 rounded-full ${v.status==="active"?"bg-emerald-50 text-emerald-700":v.status==="inactive"?"bg-slate-100 text-slate-600":"bg-rose-50 text-rose-700"}`,children:v.status||"active"})}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-500",children:v.todayAttendance?v.todayAttendance.status:"Not marked"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{type:"button",onClick:le=>be(v,le),className:"p-1.5 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors",title:"Edit technician",children:e.jsx($t,{className:"h-4 w-4"})})})]},v.id)})]})]})})}),e.jsx(Ci,{open:!!a,onClose:()=>i(null),title:(a==null?void 0:a.name)||"Technician",children:a&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-2xl border border-slate-200 p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Contact"}),e.jsx("p",{className:"text-base font-semibold text-slate-900",children:a.phone||""}),e.jsx("p",{className:"text-sm text-slate-500",children:a.email||""}),a.workingHours&&e.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["Hours ",a.workingHours.start||"--","  ",a.workingHours.end||"--"]})]}),e.jsx(U,{variant:"secondary",onClick:()=>be(a),icon:e.jsx($t,{className:"h-4 w-4"}),children:"Edit"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Skills"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:[(me=a.skills)==null?void 0:me.map(v=>e.jsx("span",{className:"rounded-full bg-emerald-50 px-3 py-1 text-emerald-700",children:v},v)),!((xe=a.skills)!=null&&xe.length)&&e.jsx("span",{className:"text-slate-400",children:"No skills tagged."})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Service items"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:[(we=a.serviceItems)==null?void 0:we.map(v=>e.jsx("span",{className:"rounded-full bg-slate-100 px-3 py-1",children:v.name},v.id||v.name)),!((De=a.serviceItems)!=null&&De.length)&&e.jsx("span",{className:"text-slate-400",children:"No service items mapped."})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Service categories"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:[(Ne=a.serviceCategories)==null?void 0:Ne.map(v=>e.jsx("span",{className:"rounded-full bg-blue-50 px-3 py-1 text-blue-700",children:v.name},v.id||v.name)),!((Fe=a.serviceCategories)!=null&&Fe.length)&&e.jsx("span",{className:"text-slate-400",children:"No categories mapped."})]})]})]}),e.jsx(qe,{title:"Mark attendance",children:e.jsxs("form",{className:"space-y-4",onSubmit:C.handleSubmit(v=>P.mutate(v)),children:[e.jsx(L,{type:"date",label:"Date",...C.register("date",{required:!0})}),e.jsx(Qe,{label:"Status",...C.register("status",{required:!0}),children:Ud.map(v=>e.jsx("option",{value:v.value,children:v.label},v.value))}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(L,{type:"time",label:"Check-in",...C.register("checkInTime")}),e.jsx(L,{type:"time",label:"Check-out",...C.register("checkOutTime")})]}),e.jsx(Dt,{label:"Notes",rows:3,...C.register("note")}),e.jsx(U,{type:"submit",loading:P.isPending,children:"Save attendance"})]})}),e.jsxs(qe,{title:"Attendance history",children:[B&&e.jsx("p",{className:"text-sm text-slate-400",children:"Loading attendance"}),!B&&ce.length===0&&e.jsx("p",{className:"text-sm text-slate-400",children:"No attendance records found."}),!B&&ce.length>0&&e.jsx("ul",{className:"space-y-3",children:ce.map(v=>e.jsxs("li",{className:"rounded-xl border border-slate-100 p-3",children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:[new Date(v.date).toLocaleDateString("en-IN",{weekday:"short",day:"numeric",month:"short"}),e.jsx("span",{className:"ml-2 text-xs uppercase tracking-wide text-slate-500",children:v.status})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[v.checkInAt?`In: ${$e(v.checkInAt)}`:"No check-in"," "," ",v.checkOutAt?`Out: ${$e(v.checkOutAt)}`:"No check-out"]}),v.note&&e.jsx("p",{className:"text-xs text-slate-500",children:v.note})]},v._id||v.date))})]})]})}),e.jsx(Ze,{open:m,onClose:ke,title:`Edit ${(b==null?void 0:b.name)||"Technician"}`,size:"xl",children:e.jsxs("form",{className:"space-y-6",onSubmit:k.handleSubmit(v=>I.mutate(v)),children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(L,{label:"Name *",...k.register("name",{required:!0})}),e.jsx(L,{label:"Email",type:"email",...k.register("email")}),e.jsx(L,{label:"Phone",...k.register("phone")}),e.jsx(Qe,{label:"Status",...k.register("status"),children:Vd.map(v=>e.jsx("option",{value:v.value,children:v.label},v.value))})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Work Details"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsx(L,{label:"Experience (years)",type:"number",step:"0.5",min:"0",...k.register("experienceYears",{valueAsNumber:!0})}),e.jsx(L,{label:"Working hours start",type:"time",...k.register("workingHoursStart")}),e.jsx(L,{label:"Working hours end",type:"time",...k.register("workingHoursEnd")})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Skills"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Z.map(v=>e.jsx("button",{type:"button",onClick:()=>ye(v._id),className:`rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${M.includes(v._id)?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:v.name},v._id)),Z.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No skills available. Create skills in settings."})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Service Categories"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Q.map(v=>e.jsx("button",{type:"button",onClick:()=>K(v._id),className:`rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${ie.includes(v._id)?"bg-blue-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:v.name},v._id)),Q.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No categories available."})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Service Items (Sub-categories)"}),e.jsx("div",{className:"max-h-48 overflow-y-auto border border-slate-200 rounded-xl p-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[z.map(v=>e.jsx("button",{type:"button",onClick:()=>S(v._id),className:`rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${G.includes(v._id)?"bg-slate-900 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:v.name},v._id)),z.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No service items available."})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(U,{type:"button",variant:"ghost",onClick:ke,children:"Cancel"}),e.jsx(U,{type:"submit",loading:I.isPending,children:"Save Changes"})]})]})})]})},Hd=()=>{const[t,s]=o.useState(null),[r,a]=o.useState(!1),[i,l]=o.useState(!1),[c,m]=o.useState(!1),[x,b]=o.useState(null),[h,p]=o.useState(!1),[j,Q]=o.useState(""),[z,Z]=o.useState(""),[T,B]=o.useState(""),[C,k]=o.useState(""),[P,I]=o.useState(""),[ce,be]=o.useState(""),[ke,ye]=o.useState(""),[S,K]=o.useState(""),[M,G]=o.useState(""),[ie,me]=o.useState(""),[xe,we]=o.useState(""),[De,Ne]=o.useState(""),[Fe,v]=o.useState(""),[ee,le]=o.useState(""),[Le,E]=o.useState(""),[Y,X]=o.useState(""),[he,nt]=o.useState(""),Ye=St(),{data:Ct=[],isLoading:it}=ge({queryKey:["customers"],queryFn:jt.list}),{data:pe,refetch:ht}=ge({queryKey:["customer-details",t==null?void 0:t.phone],queryFn:()=>t!=null&&t.phone?jt.findByPhone(t.phone):null,enabled:!!(t&&r)}),{data:pt=[]}=ge({queryKey:["customer-orders",t==null?void 0:t.id],queryFn:()=>Ee.list({customerId:t.id}),enabled:!!(t&&r)}),kt=ne({mutationFn:w=>jt.update(t.id,w),onSuccess:w=>{N.success("Customer updated successfully"),Ye.invalidateQueries({queryKey:["customers"]}),Ye.invalidateQueries({queryKey:["customer-details"]}),l(!1),w&&s(w)},onError:w=>{var ue,Se;return N.error(((Se=(ue=w==null?void 0:w.response)==null?void 0:ue.data)==null?void 0:Se.message)||"Failed to update customer")}}),Rt=ne({mutationFn:w=>jt.updateAddress(t.id,w),onSuccess:()=>{N.success(x?"Address updated successfully":"Address added successfully"),Ye.invalidateQueries({queryKey:["customer-details"]}),m(!1),te(),ht()},onError:w=>{var ue,Se;return N.error(((Se=(ue=w==null?void 0:w.response)==null?void 0:ue.data)==null?void 0:Se.message)||"Failed to update address")}}),qt=ne({mutationFn:w=>jt.deleteAddress(t.id,w),onSuccess:()=>{N.success("Address deleted successfully"),Ye.invalidateQueries({queryKey:["customer-details"]}),ht()},onError:w=>{var ue,Se;return N.error(((Se=(ue=w==null?void 0:w.response)==null?void 0:ue.data)==null?void 0:Se.message)||"Failed to delete address")}}),Et=ne({mutationFn:w=>jt.create(w),onSuccess:()=>{N.success("Customer created successfully"),Ye.invalidateQueries({queryKey:["customers"]}),p(!1),u()},onError:w=>{var ue,Se;return N.error(((Se=(ue=w==null?void 0:w.response)==null?void 0:ue.data)==null?void 0:Se.message)||"Failed to create customer")}}),u=()=>{k(""),I(""),be(""),ye(""),K(""),G(""),me(""),we("")},f=()=>{if(!C.trim()){N.error("Name is required");return}if(!ce.trim()){N.error("Phone number is required");return}const w={name:C.trim(),phone:ce.trim(),email:P.trim()||void 0};ke.trim()&&M.trim()&&ie.trim()&&(w.address={line1:ke.trim(),line2:S.trim()||void 0,city:M.trim(),state:ie.trim(),postalCode:xe.trim()||void 0}),Et.mutate(w)},y=w=>{s(w),a(!0)},D=()=>{a(!1),setTimeout(()=>s(null),200)},A=()=>{t&&(Q((pe==null?void 0:pe.name)||t.name||""),Z((pe==null?void 0:pe.email)||t.email||""),B((pe==null?void 0:pe.phone)||t.phone||""),l(!0))},_=()=>{if(!j.trim()){N.error("Name is required");return}kt.mutate({name:j.trim(),email:z.trim()||void 0,phone:T.trim()||void 0})},R=w=>{w?(b(w),Ne(w.label||""),v(w.line1||""),le(w.line2||""),E(w.city||""),X(w.state||""),nt(w.postalCode||"")):(b(null),te()),m(!0)},te=()=>{b(null),Ne(""),v(""),le(""),E(""),X(""),nt("")},ae=()=>{if(!Fe.trim()||!Le.trim()||!Y.trim()){N.error("Address line 1, city, and state are required");return}Rt.mutate({line1:Fe.trim(),line2:ee.trim()||void 0,city:Le.trim(),state:Y.trim(),postalCode:he.trim()||void 0,addressId:x==null?void 0:x.id})},Ie=w=>{window.confirm("Are you sure you want to delete this address?")&&qt.mutate(w)};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Customers"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Customer Directory"})]}),e.jsx(U,{onClick:()=>p(!0),icon:e.jsx(un,{className:"h-4 w-4"}),children:"Add Customer"})]}),e.jsx(qe,{title:"Customers",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs uppercase tracking-wide text-slate-500",children:[e.jsx("th",{className:"px-4 py-3",children:"Name"}),e.jsx("th",{className:"px-4 py-3",children:"Contact"}),e.jsx("th",{className:"px-4 py-3",children:"City"}),e.jsx("th",{className:"px-4 py-3",children:"Address"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[it&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-slate-400",children:"Loading customers"})}),!it&&Ct.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-slate-400",children:"No customers found."})}),Ct.map(w=>e.jsxs("tr",{className:"cursor-pointer hover:bg-slate-50 transition-colors",onClick:()=>y(w),children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:w.name}),e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-500",children:[w.phone||"",e.jsx("span",{className:"block text-xs text-slate-400",children:w.email||""})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-500",children:w.city||""}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-500",children:[w.addressLine1,w.addressLine2,w.postalCode].filter(Boolean).join(", ")||""})]},w.id))]})]})})}),e.jsx(Ze,{open:r,onClose:D,title:(t==null?void 0:t.name)||"Customer Details",size:"xl",showCloseButton:!0,children:t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Contact Information"}),e.jsx(U,{variant:"secondary",onClick:A,icon:e.jsx($t,{className:"h-4 w-4"}),children:"Edit"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Name"}),e.jsx("p",{className:"font-medium text-slate-900",children:(pe==null?void 0:pe.name)||t.name||""})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Phone"}),e.jsx("p",{className:"font-medium text-slate-900",children:(pe==null?void 0:pe.phone)||t.phone||""})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email"}),e.jsx("p",{className:"font-medium text-slate-900",children:(pe==null?void 0:pe.email)||t.email||""})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Addresses"}),e.jsx(U,{variant:"secondary",onClick:()=>R(),icon:e.jsx(un,{className:"h-4 w-4"}),children:"Add Address"})]}),pe!=null&&pe.addresses&&pe.addresses.length>0?e.jsx("div",{className:"space-y-3",children:pe.addresses.map((w,ue)=>e.jsx("div",{className:"rounded-lg border border-slate-200 p-3 bg-slate-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[w.label&&e.jsx("p",{className:"text-xs font-semibold text-slate-700 mb-1",children:w.label}),e.jsx("p",{className:"text-sm text-slate-900",children:w.line1}),w.line2&&e.jsx("p",{className:"text-sm text-slate-600",children:w.line2}),e.jsx("p",{className:"text-sm text-slate-600",children:[w.city,w.state,w.postalCode].filter(Boolean).join(", ")}),w.phone&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Phone: ",w.phone]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[w.isDefault&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-xs font-medium",children:"Default"}),e.jsx("button",{type:"button",onClick:Se=>{Se.stopPropagation(),R(w)},className:"p-1.5 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors",title:"Edit address",children:e.jsx($t,{className:"h-4 w-4"})}),!w.isDefault&&e.jsx("button",{type:"button",onClick:Se=>{Se.stopPropagation(),Ie(w.id)},disabled:qt.isPending,className:"p-1.5 rounded-lg text-rose-500 hover:text-rose-700 hover:bg-rose-50 transition-colors disabled:opacity-50",title:"Delete address",children:e.jsx(Ns,{className:"h-4 w-4"})})]})]})},w.id||ue))}):e.jsx("p",{className:"text-sm text-slate-500",children:"No addresses on file"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:["Order History (",pt.length,")"]}),pt.length>0?e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:pt.map(w=>{var ue;return e.jsx("div",{className:"rounded-lg border border-slate-200 p-3 hover:bg-slate-50 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:["#",w._id.slice(-8)]}),e.jsx(Ys,{variant:w.status,children:w.status})]}),e.jsx("p",{className:"text-xs text-slate-600",children:typeof w.serviceItem=="string"?w.serviceItem:((ue=w.serviceItem)==null?void 0:ue.name)||"Service"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Scheduled: ",$e(w.timeWindowStart)]})]})})},w._id)})}):e.jsx("p",{className:"text-sm text-slate-500",children:"No orders found"})]})]})}),e.jsx(Ze,{open:i,onClose:()=>l(!1),title:"Edit Customer",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{label:"Name *",value:j,onChange:w=>Q(w.target.value),placeholder:"Customer name"}),e.jsx(L,{label:"Email",type:"email",value:z,onChange:w=>Z(w.target.value),placeholder:"customer@email.com"}),e.jsx(L,{label:"Phone",value:T,onChange:w=>B(w.target.value),placeholder:"Phone number"}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(U,{onClick:_,loading:kt.isPending,children:"Save Changes"}),e.jsx(U,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"})]})]})}),e.jsx(Ze,{open:c,onClose:()=>{m(!1),te()},title:x?"Edit Address":"Add Address",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{label:"Label (optional)",value:De,onChange:w=>Ne(w.target.value),placeholder:"e.g. Home, Office"}),e.jsx(L,{label:"Address Line 1 *",value:Fe,onChange:w=>v(w.target.value),placeholder:"Street address"}),e.jsx(L,{label:"Address Line 2",value:ee,onChange:w=>le(w.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(L,{label:"City *",value:Le,onChange:w=>E(w.target.value),placeholder:"City"}),e.jsx(L,{label:"State *",value:Y,onChange:w=>X(w.target.value),placeholder:"State"})]}),e.jsx(L,{label:"Postal Code",value:he,onChange:w=>nt(w.target.value),placeholder:"PIN Code"}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(U,{onClick:ae,loading:Rt.isPending,children:x?"Update Address":"Add Address"}),e.jsx(U,{variant:"secondary",onClick:()=>{m(!1),te()},children:"Cancel"})]})]})}),e.jsx(Ze,{open:h,onClose:()=>{p(!1),u()},title:"Add New Customer",size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Contact Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{label:"Name *",value:C,onChange:w=>k(w.target.value),placeholder:"Customer name"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(L,{label:"Phone *",value:ce,onChange:w=>be(w.target.value),placeholder:"Phone number"}),e.jsx(L,{label:"Email",type:"email",value:P,onChange:w=>I(w.target.value),placeholder:"customer@email.com"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Address (Optional)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{label:"Address Line 1",value:ke,onChange:w=>ye(w.target.value),placeholder:"Street address"}),e.jsx(L,{label:"Address Line 2",value:S,onChange:w=>K(w.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(L,{label:"City",value:M,onChange:w=>G(w.target.value),placeholder:"City"}),e.jsx(L,{label:"State",value:ie,onChange:w=>me(w.target.value),placeholder:"State"}),e.jsx(L,{label:"Postal Code",value:xe,onChange:w=>we(w.target.value),placeholder:"PIN Code"})]})]}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"If you provide an address, line 1, city, and state are required."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(U,{onClick:f,loading:Et.isPending,children:"Create Customer"}),e.jsx(U,{variant:"secondary",onClick:()=>{p(!1),u()},children:"Cancel"})]})]})})]})},Bt={async listBanners(t){const s=t!==void 0?{isActive:t}:{},{data:r}=await H.get("/banners",{params:s});return r.data},async getBanner(t){const{data:s}=await H.get(`/banners/${t}`);return s.data},async createBanner(t){const{data:s}=await H.post("/banners",t);return s.data},async updateBanner(t,s){const{data:r}=await H.put(`/banners/${t}`,s);return r.data},async deleteBanner(t){const{data:s}=await H.delete(`/banners/${t}`);return s.data},async toggleBannerStatus(t){const{data:s}=await H.patch(`/banners/${t}/toggle`);return s.data},async reorderBanners(t){const{data:s}=await H.post("/banners/reorder",{banners:t});return s.data},async uploadImage(t){const s=new FormData;s.append("image",t);const{data:r}=await H.post("/banners/upload/image",s,{headers:{"Content-Type":"multipart/form-data"}}),a="https://admin.eopsys.xyz/api",i=r.data.imageUrl;return i.startsWith("http")?i:`${a.replace("/api","")}${i}`}},Kd=()=>{const[t,s]=o.useState([]),[r,a]=o.useState(!0),[i,l]=o.useState("");o.useEffect(()=>{c()},[]);const c=async()=>{try{a(!0);const b=await Bt.listBanners();s(b),l("")}catch(b){l("Failed to load banners"),console.error(b)}finally{a(!1)}},m=async b=>{if(window.confirm("Are you sure you want to delete this banner?"))try{await Bt.deleteBanner(b),s(t.filter(h=>h._id!==b))}catch(h){l("Failed to delete banner"),console.error(h)}},x=async b=>{try{const h=await Bt.toggleBannerStatus(b);s(t.map(p=>p._id===b?h:p))}catch(h){l("Failed to toggle banner status"),console.error(h)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Banners"}),e.jsx("a",{href:"/banners/new",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700",children:"+ Create Banner"})]}),i&&e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-sm text-red-700",children:i}),r?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"Loading banners..."})}):t.length===0?e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-12 text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"No banners yet"}),e.jsx("a",{href:"/banners/new",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700",children:"Create your first banner"})]}):e.jsx("div",{className:"grid gap-6",children:t.map(b=>e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"grid grid-cols-4 gap-6",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("img",{src:b.imageUrl,alt:b.title,className:"rounded-lg w-full h-32 object-cover"})}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:b.title}),b.subtitle&&e.jsx("p",{className:"text-sm text-gray-600",children:b.subtitle}),b.link&&e.jsx("p",{className:"text-sm text-blue-600 truncate",children:e.jsx("a",{href:b.link,target:"_blank",rel:"noopener noreferrer",children:b.link})}),b.startDate&&b.endDate&&e.jsxs("p",{className:"text-xs text-gray-500",children:[new Date(b.startDate).toLocaleDateString()," -"," ",new Date(b.endDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"col-span-1 flex flex-col gap-2 justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-xs font-semibold ${b.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:b.isActive?"Active":"Inactive"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x(b._id),className:"flex-1 rounded-lg text-xs font-medium px-3 py-2 border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:b.isActive?"Deactivate":"Activate"}),e.jsx("a",{href:`/banners/${b._id}`,className:"flex-1 rounded-lg text-xs font-medium px-3 py-2 bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors text-center",children:"Edit"}),e.jsx("button",{onClick:()=>m(b._id),className:"flex-1 rounded-lg text-xs font-medium px-3 py-2 border border-red-200 text-red-700 hover:bg-red-50 transition-colors",children:"Delete"})]})]})]})},b._id))})]})},Ln=()=>{const t=tr(),{bannerId:s}=Un(),r=o.useRef(null),[a,i]=o.useState(!!s),[l,c]=o.useState(!1),[m,x]=o.useState(!1),[b,h]=o.useState(""),[p,j]=o.useState({title:"",subtitle:"",imageUrl:"",link:"",isActive:!0,startDate:"",endDate:""});o.useEffect(()=>{s&&Q()},[s]);const Q=async()=>{if(s)try{i(!0);const B=await Bt.getBanner(s);j(B),h("")}catch(B){h("Failed to load banner"),console.error(B)}finally{i(!1)}},z=B=>{const{name:C,value:k,type:P}=B.target;j(I=>({...I,[C]:P==="checkbox"?B.target.checked:k}))},Z=async B=>{var k;const C=(k=B.target.files)==null?void 0:k[0];if(C){x(!0),h("");try{const P=await Bt.uploadImage(C);j(I=>({...I,imageUrl:P}))}catch(P){h("Failed to upload image"),console.error(P)}finally{x(!1),r.current&&(r.current.value="")}}},T=async B=>{B.preventDefault(),c(!0),h("");try{s?await Bt.updateBanner(s,p):await Bt.createBanner(p),t("/banners")}catch(C){h(`Failed to ${s?"update":"create"} banner`),console.error(C)}finally{c(!1)}};return a?e.jsx("div",{className:"text-center py-12",children:"Loading..."}):e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s?"Edit Banner":"Create Banner"})}),b&&e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-sm text-red-700",children:b}),e.jsxs("form",{onSubmit:T,className:"space-y-6 bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),e.jsx("input",{type:"text",name:"title",required:!0,value:p.title||"",onChange:z,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"Banner title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subtitle"}),e.jsx("input",{type:"text",name:"subtitle",value:p.subtitle||"",onChange:z,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"Banner subtitle"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL *"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"url",name:"imageUrl",required:!0,value:p.imageUrl||"",onChange:z,className:"flex-1 rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"https://example.com/image.jpg"}),e.jsx("button",{type:"button",onClick:()=>{var B;return(B=r.current)==null?void 0:B.click()},disabled:m,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg border border-gray-300 text-sm font-medium disabled:opacity-60",children:m?"Uploading...":"Upload"})]}),e.jsx("input",{ref:r,type:"file",accept:"image/*",onChange:Z,className:"hidden"})]}),p.imageUrl&&e.jsx("img",{src:p.imageUrl,alt:"Preview",className:"mt-3 rounded-lg max-h-48 object-cover"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link"}),e.jsx("input",{type:"url",name:"link",value:p.link||"",onChange:z,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"https://example.com"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"datetime-local",name:"startDate",value:p.startDate||"",onChange:z,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"datetime-local",name:"endDate",value:p.endDate||"",onChange:z,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"isActive",name:"isActive",checked:p.isActive||!1,onChange:z,className:"h-4 w-4 rounded border-gray-300"}),e.jsx("label",{className:"text-sm font-medium text-gray-700",htmlFor:"isActive",children:"Active"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:l,className:"flex-1 rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 disabled:opacity-60",children:l?"Saving...":"Save Banner"}),e.jsx("button",{type:"button",onClick:()=>t("/banners"),className:"flex-1 rounded-lg border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50",children:"Cancel"})]})]})]})},Qd=()=>e.jsxs(sl,{children:[e.jsx(Ve,{path:"/login",element:e.jsx(Sd,{})}),e.jsxs(Ve,{element:e.jsx(to,{children:e.jsx(ed,{})}),children:[e.jsx(Ve,{path:"/",element:e.jsx(kd,{})}),e.jsx(Ve,{path:"/orders",element:e.jsx(Fd,{})}),e.jsx(Ve,{path:"/customers",element:e.jsx(Hd,{})}),e.jsx(Ve,{path:"/catalog",element:e.jsx(Ld,{})}),e.jsx(Ve,{path:"/catalog/:categoryId",element:e.jsx(Md,{})}),e.jsx(Ve,{path:"/technicians",element:e.jsx(Wd,{})}),e.jsx(Ve,{path:"/spare-parts",element:e.jsx(Bd,{})}),e.jsx(Ve,{path:"/time-slots",element:e.jsx(qd,{})}),e.jsx(Ve,{path:"/users/new",element:e.jsx($d,{})}),e.jsx(Ve,{path:"/banners",element:e.jsx(Kd,{})}),e.jsx(Ve,{path:"/banners/new",element:e.jsx(Ln,{})}),e.jsx(Ve,{path:"/banners/:bannerId",element:e.jsx(Ln,{})})]}),e.jsx(Ve,{path:"*",element:e.jsx($n,{to:"/",replace:!0})})]}),zd=new ll({defaultOptions:{queries:{staleTime:6e4,refetchOnWindowFocus:!1,retry:1}}});Vn(document.getElementById("root")).render(e.jsx(o.StrictMode,{children:e.jsx(ol,{client:zd,children:e.jsx(Gl,{children:e.jsx(Yc,{children:e.jsxs(rl,{children:[e.jsx(Qd,{}),e.jsx(Xl,{position:"top-right"})]})})})})}));
