import{j as e,q as Gt,_ as es}from"./ui-BsaTBtI9.js";import{a as Wn,r as o,N as Hn,b as il,O as ll,m as we,u as ar,L as Zt,c as Kn,d as Qn,R as ol,f as We,B as cl}from"./vendor-BVDAFvKx.js";import{a as dl,A as ul,c as ml,u as St,b as ve,d as oe,Q as hl,e as pl}from"./data-CsO4I2n7.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(i){if(i.ep)return;i.ep=!0;const l=r(i);fetch(i.href,l)}})();var zn,hn=Wn;zn=hn.createRoot,hn.hydrateRoot;const K=dl.create({baseURL:"https://admin.fixzep.com/api",timeout:15e3});K.interceptors.request.use(t=>{const s=localStorage.getItem("fixzep_token");if(s){const r=ul.from(t.headers);r.set("Authorization",`Bearer ${s}`),t.headers=r}return t});const ee=async t=>(await t).data.data,xl={login:t=>ee(K.post("/auth/login",t))},Ee={list:(t={})=>ee(K.get("/admin/orders",{params:t})),create:t=>ee(K.post("/admin/orders",t)),assign:(t,s)=>ee(K.post(`/admin/orders/${t}/assign`,{technicianId:s})),candidates:t=>ee(K.get(`/admin/orders/${t}/technicians`)),jobCard:t=>ee(K.get(`/admin/orders/${t}/jobcard`)),reschedule:(t,s)=>ee(K.post(`/orders/${t}/reschedule`,s)),changeStatus:(t,s)=>ee(K.post(`/admin/orders/${t}/status`,s)),uploadMedia:(t,s)=>ee(K.post(`/admin/orders/${t}/media`,s)),deleteMedia:(t,s)=>ee(K.delete(`/admin/orders/${t}/media/${s}`)),updatePaymentStatus:(t,s)=>ee(K.post(`/admin/orders/${t}/payment-status`,s)),addHistoryNote:(t,s)=>ee(K.post(`/admin/orders/${t}/history`,s)),addSparePart:(t,s)=>ee(K.post(`/admin/orders/${t}/spare-parts`,s)),removeSparePart:(t,s)=>ee(K.delete(`/admin/orders/${t}/spare-parts/${s}`)),addAdditionalService:(t,s)=>ee(K.post(`/admin/orders/${t}/additional-services`,s)),removeAdditionalService:(t,s)=>ee(K.delete(`/admin/orders/${t}/additional-services/${s}`))},Ie={categories:()=>ee(K.get("/admin/categories")),serviceItems:t=>ee(K.get("/admin/service-items",{params:t?{categoryId:t}:void 0})),upsertCategory:t=>ee(K.post("/admin/categories",t)),updateCategory:(t,s)=>ee(K.put(`/admin/categories/${t}`,s)),deleteCategory:t=>ee(K.delete(`/admin/categories/${t}`)),upsertServiceItem:t=>ee(K.post("/admin/service-items",t)),updateServiceItem:(t,s)=>ee(K.put(`/admin/service-items/${t}`,s)),deleteServiceItem:t=>ee(K.delete(`/admin/service-items/${t}`))},vs={list:()=>ee(K.get("/admin/spare-parts")),upsert:t=>ee(K.post("/admin/spare-parts",t)),update:(t,s)=>ee(K.put(`/admin/spare-parts/${t}`,s)),delete:t=>ee(K.delete(`/admin/spare-parts/${t}`))},Rr={list:()=>ee(K.get("/admin/technician-skills")),create:t=>ee(K.post("/admin/technician-skills",t))},fl={create:t=>ee(K.post("/admin/users",t))},Xt={list:()=>ee(K.get("/admin/technicians")),get:t=>ee(K.get(`/admin/technicians/${t}`)),update:(t,s)=>ee(K.put(`/admin/technicians/${t}`,s)),availability:t=>ee(K.get(`/admin/technicians/${t}/availability`)),schedule:(t,s)=>ee(K.get(`/admin/technicians/${t}/schedule`,{params:s})),attendance:t=>ee(K.get(`/admin/technicians/${t}/attendance`)),markAttendance:(t,s)=>ee(K.post(`/admin/technicians/${t}/attendance`,s))},js={list:()=>ee(K.get("/admin/time-slots")),create:t=>ee(K.post("/admin/time-slots",t)),update:(t,s)=>ee(K.put(`/admin/time-slots/${t}`,s)),remove:t=>ee(K.delete(`/admin/time-slots/${t}`))},jt={list:()=>ee(K.get("/admin/customers")),findByPhone:t=>ee(K.get(`/admin/customers/phone/${t}`)),create:t=>ee(K.post("/admin/customers",t)),update:(t,s)=>ee(K.put(`/admin/customers/${t}`,s)),updateAddress:(t,s)=>ee(K.put(`/admin/customers/${t}/address`,s)),deleteAddress:(t,s)=>ee(K.delete(`/admin/customers/${t}/address/${s}`))};let gl={data:""},bl=t=>{if(typeof window=="object"){let s=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return s.nonce=window.__nonce__,s.parentNode||(t||document.head).appendChild(s),s.firstChild}return t||gl},yl=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,vl=/\/\*[^]*?\*\/|  +/g,pn=/\n+/g,Pt=(t,s)=>{let r="",a="",i="";for(let l in t){let c=t[l];l[0]=="@"?l[1]=="i"?r=l+" "+c+";":a+=l[1]=="f"?Pt(c,l):l+"{"+Pt(c,l[1]=="k"?"":s)+"}":typeof c=="object"?a+=Pt(c,s?s.replace(/([^,])+/g,u=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,g=>/&/.test(g)?g.replace(/&/g,u):u?u+" "+g:g)):l):c!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Pt.p?Pt.p(l,c):l+":"+c+";")}return r+(s&&i?s+"{"+i+"}":i)+a},yt={},Zn=t=>{if(typeof t=="object"){let s="";for(let r in t)s+=r+Zn(t[r]);return s}return t},jl=(t,s,r,a,i)=>{let l=Zn(t),c=yt[l]||(yt[l]=(g=>{let x=0,h=11;for(;x<g.length;)h=101*h+g.charCodeAt(x++)>>>0;return"go"+h})(l));if(!yt[c]){let g=l!==t?t:(x=>{let h,p,j=[{}];for(;h=yl.exec(x.replace(vl,""));)h[4]?j.shift():h[3]?(p=h[3].replace(pn," ").trim(),j.unshift(j[0][p]=j[0][p]||{})):j[0][h[1]]=h[2].replace(pn," ").trim();return j[0]})(t);yt[c]=Pt(i?{["@keyframes "+c]:g}:g,r?"":"."+c)}let u=r&&yt.g?yt.g:null;return r&&(yt.g=yt[c]),((g,x,h,p)=>{p?x.data=x.data.replace(p,g):x.data.indexOf(g)===-1&&(x.data=h?g+x.data:x.data+g)})(yt[c],s,a,u),c},wl=(t,s,r)=>t.reduce((a,i,l)=>{let c=s[l];if(c&&c.call){let u=c(r),g=u&&u.props&&u.props.className||/^go/.test(u)&&u;c=g?"."+g:u&&typeof u=="object"?u.props?"":Pt(u,""):u===!1?"":u}return a+i+(c??"")},"");function nr(t){let s=this||{},r=t.call?t(s.p):t;return jl(r.unshift?r.raw?wl(r,[].slice.call(arguments,1),s.p):r.reduce((a,i)=>Object.assign(a,i&&i.call?i(s.p):i),{}):r,bl(s.target),s.g,s.o,s.k)}let Yn,Ir,Fr;nr.bind({g:1});let wt=nr.bind({k:1});function Nl(t,s,r,a){Pt.p=s,Yn=t,Ir=r,Fr=a}function It(t,s){let r=this||{};return function(){let a=arguments;function i(l,c){let u=Object.assign({},l),g=u.className||i.className;r.p=Object.assign({theme:Ir&&Ir()},u),r.o=/ *go\d+/.test(g),u.className=nr.apply(r,a)+(g?" "+g:"");let x=t;return t[0]&&(x=u.as||t,delete u.as),Fr&&x[0]&&Fr(u),Yn(x,u)}return i}}var Sl=t=>typeof t=="function",er=(t,s)=>Sl(t)?t(s):t,Cl=(()=>{let t=0;return()=>(++t).toString()})(),Jn=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let s=matchMedia("(prefers-reduced-motion: reduce)");t=!s||s.matches}return t}})(),kl=20,Zr="default",Xn=(t,s)=>{let{toastLimit:r}=t.settings;switch(s.type){case 0:return{...t,toasts:[s.toast,...t.toasts].slice(0,r)};case 1:return{...t,toasts:t.toasts.map(c=>c.id===s.toast.id?{...c,...s.toast}:c)};case 2:let{toast:a}=s;return Xn(t,{type:t.toasts.find(c=>c.id===a.id)?1:0,toast:a});case 3:let{toastId:i}=s;return{...t,toasts:t.toasts.map(c=>c.id===i||i===void 0?{...c,dismissed:!0,visible:!1}:c)};case 4:return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(c=>c.id!==s.toastId)};case 5:return{...t,pausedAt:s.time};case 6:let l=s.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(c=>({...c,pauseDuration:c.pauseDuration+l}))}}},Zs=[],Gn={toasts:[],pausedAt:void 0,settings:{toastLimit:kl}},ct={},ei=(t,s=Zr)=>{ct[s]=Xn(ct[s]||Gn,t),Zs.forEach(([r,a])=>{r===s&&a(ct[s])})},ti=t=>Object.keys(ct).forEach(s=>ei(t,s)),El=t=>Object.keys(ct).find(s=>ct[s].toasts.some(r=>r.id===t)),ir=(t=Zr)=>s=>{ei(s,t)},_l={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Al=(t={},s=Zr)=>{let[r,a]=o.useState(ct[s]||Gn),i=o.useRef(ct[s]);o.useEffect(()=>(i.current!==ct[s]&&a(ct[s]),Zs.push([s,a]),()=>{let c=Zs.findIndex(([u])=>u===s);c>-1&&Zs.splice(c,1)}),[s]);let l=r.toasts.map(c=>{var u,g,x;return{...t,...t[c.type],...c,removeDelay:c.removeDelay||((u=t[c.type])==null?void 0:u.removeDelay)||(t==null?void 0:t.removeDelay),duration:c.duration||((g=t[c.type])==null?void 0:g.duration)||(t==null?void 0:t.duration)||_l[c.type],style:{...t.style,...(x=t[c.type])==null?void 0:x.style,...c.style}}});return{...r,toasts:l}},Tl=(t,s="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:s,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...r,id:(r==null?void 0:r.id)||Cl()}),Es=t=>(s,r)=>{let a=Tl(s,t,r);return ir(a.toasterId||El(a.id))({type:2,toast:a}),a.id},Pe=(t,s)=>Es("blank")(t,s);Pe.error=Es("error");Pe.success=Es("success");Pe.loading=Es("loading");Pe.custom=Es("custom");Pe.dismiss=(t,s)=>{let r={type:3,toastId:t};s?ir(s)(r):ti(r)};Pe.dismissAll=t=>Pe.dismiss(void 0,t);Pe.remove=(t,s)=>{let r={type:4,toastId:t};s?ir(s)(r):ti(r)};Pe.removeAll=t=>Pe.remove(void 0,t);Pe.promise=(t,s,r)=>{let a=Pe.loading(s.loading,{...r,...r==null?void 0:r.loading});return typeof t=="function"&&(t=t()),t.then(i=>{let l=s.success?er(s.success,i):void 0;return l?Pe.success(l,{id:a,...r,...r==null?void 0:r.success}):Pe.dismiss(a),i}).catch(i=>{let l=s.error?er(s.error,i):void 0;l?Pe.error(l,{id:a,...r,...r==null?void 0:r.error}):Pe.dismiss(a)}),t};var Pl=1e3,Ol=(t,s="default")=>{let{toasts:r,pausedAt:a}=Al(t,s),i=o.useRef(new Map).current,l=o.useCallback((p,j=Pl)=>{if(i.has(p))return;let Q=setTimeout(()=>{i.delete(p),c({type:4,toastId:p})},j);i.set(p,Q)},[]);o.useEffect(()=>{if(a)return;let p=Date.now(),j=r.map(Q=>{if(Q.duration===1/0)return;let Y=(Q.duration||0)+Q.pauseDuration-(p-Q.createdAt);if(Y<0){Q.visible&&Pe.dismiss(Q.id);return}return setTimeout(()=>Pe.dismiss(Q.id,s),Y)});return()=>{j.forEach(Q=>Q&&clearTimeout(Q))}},[r,a,s]);let c=o.useCallback(ir(s),[s]),u=o.useCallback(()=>{c({type:5,time:Date.now()})},[c]),g=o.useCallback((p,j)=>{c({type:1,toast:{id:p,height:j}})},[c]),x=o.useCallback(()=>{a&&c({type:6,time:Date.now()})},[a,c]),h=o.useCallback((p,j)=>{let{reverseOrder:Q=!1,gutter:Y=8,defaultPosition:z}=j||{},F=r.filter(k=>(k.position||z)===(p.position||z)&&k.height),J=F.findIndex(k=>k.id===p.id),L=F.filter((k,P)=>P<J&&k.visible).length;return F.filter(k=>k.visible).slice(...Q?[L+1]:[0,L]).reduce((k,P)=>k+(P.height||0)+Y,0)},[r]);return o.useEffect(()=>{r.forEach(p=>{if(p.dismissed)l(p.id,p.removeDelay);else{let j=i.get(p.id);j&&(clearTimeout(j),i.delete(p.id))}})},[r,l]),{toasts:r,handlers:{updateHeight:g,startPause:u,endPause:x,calculateOffset:h}}},Dl=wt`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Rl=wt`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Il=wt`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Fl=It("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Dl} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Rl} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Il} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Ll=wt`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Ml=It("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${Ll} 1s linear infinite;
`,Bl=wt`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,$l=wt`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,ql=It("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Bl} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${$l} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Ul=It("div")`
  position: absolute;
`,Vl=It("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Wl=wt`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Hl=It("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Wl} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Kl=({toast:t})=>{let{icon:s,type:r,iconTheme:a}=t;return s!==void 0?typeof s=="string"?o.createElement(Hl,null,s):s:r==="blank"?null:o.createElement(Vl,null,o.createElement(Ml,{...a}),r!=="loading"&&o.createElement(Ul,null,r==="error"?o.createElement(Fl,{...a}):o.createElement(ql,{...a})))},Ql=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,zl=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,Zl="0%{opacity:0;} 100%{opacity:1;}",Yl="0%{opacity:1;} 100%{opacity:0;}",Jl=It("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Xl=It("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Gl=(t,s)=>{let r=t.includes("top")?1:-1,[a,i]=Jn()?[Zl,Yl]:[Ql(r),zl(r)];return{animation:s?`${wt(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${wt(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},eo=o.memo(({toast:t,position:s,style:r,children:a})=>{let i=t.height?Gl(t.position||s||"top-center",t.visible):{opacity:0},l=o.createElement(Kl,{toast:t}),c=o.createElement(Xl,{...t.ariaProps},er(t.message,t));return o.createElement(Jl,{className:t.className,style:{...i,...r,...t.style}},typeof a=="function"?a({icon:l,message:c}):o.createElement(o.Fragment,null,l,c))});Nl(o.createElement);var to=({id:t,className:s,style:r,onHeightUpdate:a,children:i})=>{let l=o.useCallback(c=>{if(c){let u=()=>{let g=c.getBoundingClientRect().height;a(t,g)};u(),new MutationObserver(u).observe(c,{subtree:!0,childList:!0,characterData:!0})}},[t,a]);return o.createElement("div",{ref:l,className:s,style:r},i)},so=(t,s)=>{let r=t.includes("top"),a=r?{top:0}:{bottom:0},i=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Jn()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${s*(r?1:-1)}px)`,...a,...i}},ro=nr`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ws=16,ao=({reverseOrder:t,position:s="top-center",toastOptions:r,gutter:a,children:i,toasterId:l,containerStyle:c,containerClassName:u})=>{let{toasts:g,handlers:x}=Ol(r,l);return o.createElement("div",{"data-rht-toaster":l||"",style:{position:"fixed",zIndex:9999,top:Ws,left:Ws,right:Ws,bottom:Ws,pointerEvents:"none",...c},className:u,onMouseEnter:x.startPause,onMouseLeave:x.endPause},g.map(h=>{let p=h.position||s,j=x.calculateOffset(h,{reverseOrder:t,gutter:a,defaultPosition:s}),Q=so(p,j);return o.createElement(to,{id:h.id,key:h.id,onHeightUpdate:x.updateHeight,className:h.visible?ro:"",style:Q},h.type==="custom"?er(h.message,h):i?i(h):o.createElement(eo,{toast:h,position:p}))}))},w=Pe;const si=o.createContext(void 0),Er="fixzep_token",_r="fixzep_user",no=({children:t})=>{const[s,r]=o.useState(()=>localStorage.getItem(Er)),[a,i]=o.useState(()=>{const g=localStorage.getItem(_r);return g?JSON.parse(g):null});o.useEffect(()=>{s?localStorage.setItem(Er,s):localStorage.removeItem(Er)},[s]),o.useEffect(()=>{a?localStorage.setItem(_r,JSON.stringify(a)):localStorage.removeItem(_r)},[a]);const l=o.useCallback(async g=>{var x,h;try{const p=await xl.login(g);r(p.token),i(p.user),w.success("Welcome back, "+p.user.name.split(" ")[0])}catch(p){throw w.error(((h=(x=p==null?void 0:p.response)==null?void 0:x.data)==null?void 0:h.message)||"Unable to login"),p}},[]),c=o.useCallback(()=>{r(null),i(null),w.success("Logged out")},[]),u=o.useMemo(()=>({user:a,token:s,isAuthenticated:!!(s&&a),login:l,logout:c}),[l,c,s,a]);return e.jsx(si.Provider,{value:u,children:t})},io=()=>{const t=o.useContext(si);if(!t)throw new Error("useAuthContext must be used within AuthProvider");return t},Yr=()=>io(),lo=({children:t})=>{const{isAuthenticated:s}=Yr();return s?e.jsx(e.Fragment,{children:t}):e.jsx(Hn,{to:"/login",replace:!0})};function oo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const co=o.forwardRef(oo);function uo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const mo=o.forwardRef(uo);function ho({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))}const po=o.forwardRef(ho);function xo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"}))}const xn=o.forwardRef(xo);function fo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const go=o.forwardRef(fo);function bo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const ri=o.forwardRef(bo);function yo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}))}const vo=o.forwardRef(yo);function jo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const wo=o.forwardRef(jo);function No({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"}))}const So=o.forwardRef(No);function Co({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ko=o.forwardRef(Co);function Eo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25"}))}const _o=o.forwardRef(Eo);function Ao({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const Lr=o.forwardRef(Ao);function To({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const Mr=o.forwardRef(To);function Po({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607ZM13.5 10.5h-6"}))}const Oo=o.forwardRef(Po);function Do({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607ZM10.5 7.5v6m3-3h-6"}))}const Ro=o.forwardRef(Do);function Io({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const Rt=o.forwardRef(Io);function Fo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const Lo=o.forwardRef(Fo);function Mo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const fn=o.forwardRef(Mo);function Bo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z"}))}const $o=o.forwardRef(Bo);function qo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const Uo=o.forwardRef(qo);function Vo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const Wo=o.forwardRef(Vo);function Ho({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"}))}const Ko=o.forwardRef(Ho);function Qo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const ts=o.forwardRef(Qo);function zo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"}))}const Ar=o.forwardRef(zo);function Zo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))}const Yo=o.forwardRef(Zo);function Jo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75a4.5 4.5 0 0 1-4.884 4.484c-1.076-.091-2.264.071-2.95.904l-7.152 8.684a2.548 2.548 0 1 1-3.586-3.586l8.684-7.152c.833-.686.995-1.874.904-2.95a4.5 4.5 0 0 1 6.336-4.486l-3.276 3.276a3.004 3.004 0 0 0 2.25 2.25l3.276-3.276c.256.565.398 1.192.398 1.852Z"}),o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.867 19.125h.008v.008h-.008v-.008Z"}))}const gn=o.forwardRef(Jo);function Xo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Go=o.forwardRef(Xo);function ec({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const ws=o.forwardRef(ec);function ai(t){var s,r,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(s=0;s<i;s++)t[s]&&(r=ai(t[s]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function Nt(){for(var t,s,r=0,a="",i=arguments.length;r<i;r++)(t=arguments[r])&&(s=ai(t))&&(a&&(a+=" "),a+=s);return a}const tc=[{to:"/",label:"Overview",icon:Ko},{to:"/orders",label:"Orders",icon:So},{to:"/customers",label:"Customers",icon:Ar},{to:"/catalog",label:"Catalog",icon:gn},{to:"/technicians",label:"Technicians",icon:Ar},{to:"/spare-parts",label:"Spare Parts",icon:gn},{to:"/time-slots",label:"Time Slots",icon:ko},{to:"/banners",label:"Banners",icon:Lo},{to:"/users/new",label:"Create User",icon:Ar}],bn=()=>e.jsxs("aside",{className:"hidden lg:flex w-64 flex-col border-r border-slate-200 bg-white/90 backdrop-blur",children:[e.jsxs("div",{className:"px-6 py-5 border-b border-slate-200",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Fixzep Admin"}),e.jsx("p",{className:"mt-2 text-xl font-semibold text-slate-900",children:"Control Room"})]}),e.jsx("nav",{className:"flex-1 px-4 py-6 space-y-1",children:tc.map(t=>e.jsxs(il,{to:t.to,className:({isActive:s})=>Nt("flex items-center gap-3 rounded-xl px-4 py-3 text-sm font-medium transition-all",s?"bg-slate-900 text-white shadow-card":"text-slate-500 hover:bg-slate-100"),children:[e.jsx(t.icon,{className:"h-5 w-5"}),t.label]},t.to))})]}),ni=ml(t=>({isOpen:!1,toggle:()=>t(s=>({isOpen:!s.isOpen})),close:()=>t({isOpen:!1})})),ut=Object.create(null);ut.open="0";ut.close="1";ut.ping="2";ut.pong="3";ut.message="4";ut.upgrade="5";ut.noop="6";const Ys=Object.create(null);Object.keys(ut).forEach(t=>{Ys[ut[t]]=t});const Br={type:"error",data:"parser error"},ii=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",li=typeof ArrayBuffer=="function",oi=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,Jr=({type:t,data:s},r,a)=>ii&&s instanceof Blob?r?a(s):yn(s,a):li&&(s instanceof ArrayBuffer||oi(s))?r?a(s):yn(new Blob([s]),a):a(ut[t]+(s||"")),yn=(t,s)=>{const r=new FileReader;return r.onload=function(){const a=r.result.split(",")[1];s("b"+(a||""))},r.readAsDataURL(t)};function vn(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let Tr;function sc(t,s){if(ii&&t.data instanceof Blob)return t.data.arrayBuffer().then(vn).then(s);if(li&&(t.data instanceof ArrayBuffer||oi(t.data)))return s(vn(t.data));Jr(t,!1,r=>{Tr||(Tr=new TextEncoder),s(Tr.encode(r))})}const jn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ns=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<jn.length;t++)Ns[jn.charCodeAt(t)]=t;const rc=t=>{let s=t.length*.75,r=t.length,a,i=0,l,c,u,g;t[t.length-1]==="="&&(s--,t[t.length-2]==="="&&s--);const x=new ArrayBuffer(s),h=new Uint8Array(x);for(a=0;a<r;a+=4)l=Ns[t.charCodeAt(a)],c=Ns[t.charCodeAt(a+1)],u=Ns[t.charCodeAt(a+2)],g=Ns[t.charCodeAt(a+3)],h[i++]=l<<2|c>>4,h[i++]=(c&15)<<4|u>>2,h[i++]=(u&3)<<6|g&63;return x},ac=typeof ArrayBuffer=="function",Xr=(t,s)=>{if(typeof t!="string")return{type:"message",data:ci(t,s)};const r=t.charAt(0);return r==="b"?{type:"message",data:nc(t.substring(1),s)}:Ys[r]?t.length>1?{type:Ys[r],data:t.substring(1)}:{type:Ys[r]}:Br},nc=(t,s)=>{if(ac){const r=rc(t);return ci(r,s)}else return{base64:!0,data:t}},ci=(t,s)=>{switch(s){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},di="",ic=(t,s)=>{const r=t.length,a=new Array(r);let i=0;t.forEach((l,c)=>{Jr(l,!1,u=>{a[c]=u,++i===r&&s(a.join(di))})})},lc=(t,s)=>{const r=t.split(di),a=[];for(let i=0;i<r.length;i++){const l=Xr(r[i],s);if(a.push(l),l.type==="error")break}return a};function oc(){return new TransformStream({transform(t,s){sc(t,r=>{const a=r.length;let i;if(a<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,a);else if(a<65536){i=new Uint8Array(3);const l=new DataView(i.buffer);l.setUint8(0,126),l.setUint16(1,a)}else{i=new Uint8Array(9);const l=new DataView(i.buffer);l.setUint8(0,127),l.setBigUint64(1,BigInt(a))}t.data&&typeof t.data!="string"&&(i[0]|=128),s.enqueue(i),s.enqueue(r)})}})}let Pr;function Hs(t){return t.reduce((s,r)=>s+r.length,0)}function Ks(t,s){if(t[0].length===s)return t.shift();const r=new Uint8Array(s);let a=0;for(let i=0;i<s;i++)r[i]=t[0][a++],a===t[0].length&&(t.shift(),a=0);return t.length&&a<t[0].length&&(t[0]=t[0].slice(a)),r}function cc(t,s){Pr||(Pr=new TextDecoder);const r=[];let a=0,i=-1,l=!1;return new TransformStream({transform(c,u){for(r.push(c);;){if(a===0){if(Hs(r)<1)break;const g=Ks(r,1);l=(g[0]&128)===128,i=g[0]&127,i<126?a=3:i===126?a=1:a=2}else if(a===1){if(Hs(r)<2)break;const g=Ks(r,2);i=new DataView(g.buffer,g.byteOffset,g.length).getUint16(0),a=3}else if(a===2){if(Hs(r)<8)break;const g=Ks(r,8),x=new DataView(g.buffer,g.byteOffset,g.length),h=x.getUint32(0);if(h>Math.pow(2,21)-1){u.enqueue(Br);break}i=h*Math.pow(2,32)+x.getUint32(4),a=3}else{if(Hs(r)<i)break;const g=Ks(r,i);u.enqueue(Xr(l?g:Pr.decode(g),s)),a=0}if(i===0||i>t){u.enqueue(Br);break}}}})}const ui=4;function Ae(t){if(t)return dc(t)}function dc(t){for(var s in Ae.prototype)t[s]=Ae.prototype[s];return t}Ae.prototype.on=Ae.prototype.addEventListener=function(t,s){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(s),this};Ae.prototype.once=function(t,s){function r(){this.off(t,r),s.apply(this,arguments)}return r.fn=s,this.on(t,r),this};Ae.prototype.off=Ae.prototype.removeListener=Ae.prototype.removeAllListeners=Ae.prototype.removeEventListener=function(t,s){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var a,i=0;i<r.length;i++)if(a=r[i],a===s||a.fn===s){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};Ae.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var s=new Array(arguments.length-1),r=this._callbacks["$"+t],a=1;a<arguments.length;a++)s[a-1]=arguments[a];if(r){r=r.slice(0);for(var a=0,i=r.length;a<i;++a)r[a].apply(this,s)}return this};Ae.prototype.emitReserved=Ae.prototype.emit;Ae.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Ae.prototype.hasListeners=function(t){return!!this.listeners(t).length};const lr=typeof Promise=="function"&&typeof Promise.resolve=="function"?s=>Promise.resolve().then(s):(s,r)=>r(s,0),Xe=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),uc="arraybuffer";function mi(t,...s){return s.reduce((r,a)=>(t.hasOwnProperty(a)&&(r[a]=t[a]),r),{})}const mc=Xe.setTimeout,hc=Xe.clearTimeout;function or(t,s){s.useNativeTimers?(t.setTimeoutFn=mc.bind(Xe),t.clearTimeoutFn=hc.bind(Xe)):(t.setTimeoutFn=Xe.setTimeout.bind(Xe),t.clearTimeoutFn=Xe.clearTimeout.bind(Xe))}const pc=1.33;function xc(t){return typeof t=="string"?fc(t):Math.ceil((t.byteLength||t.size)*pc)}function fc(t){let s=0,r=0;for(let a=0,i=t.length;a<i;a++)s=t.charCodeAt(a),s<128?r+=1:s<2048?r+=2:s<55296||s>=57344?r+=3:(a++,r+=4);return r}function hi(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function gc(t){let s="";for(let r in t)t.hasOwnProperty(r)&&(s.length&&(s+="&"),s+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return s}function bc(t){let s={},r=t.split("&");for(let a=0,i=r.length;a<i;a++){let l=r[a].split("=");s[decodeURIComponent(l[0])]=decodeURIComponent(l[1])}return s}class yc extends Error{constructor(s,r,a){super(s),this.description=r,this.context=a,this.type="TransportError"}}class Gr extends Ae{constructor(s){super(),this.writable=!1,or(this,s),this.opts=s,this.query=s.query,this.socket=s.socket,this.supportsBinary=!s.forceBase64}onError(s,r,a){return super.emitReserved("error",new yc(s,r,a)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(s){this.readyState==="open"&&this.write(s)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(s){const r=Xr(s,this.socket.binaryType);this.onPacket(r)}onPacket(s){super.emitReserved("packet",s)}onClose(s){this.readyState="closed",super.emitReserved("close",s)}pause(s){}createUri(s,r={}){return s+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const s=this.opts.hostname;return s.indexOf(":")===-1?s:"["+s+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(s){const r=gc(s);return r.length?"?"+r:""}}class vc extends Gr{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(s){this.readyState="pausing";const r=()=>{this.readyState="paused",s()};if(this._polling||!this.writable){let a=0;this._polling&&(a++,this.once("pollComplete",function(){--a||r()})),this.writable||(a++,this.once("drain",function(){--a||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(s){const r=a=>{if(this.readyState==="opening"&&a.type==="open"&&this.onOpen(),a.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(a)};lc(s,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const s=()=>{this.write([{type:"close"}])};this.readyState==="open"?s():this.once("open",s)}write(s){this.writable=!1,ic(s,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const s=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=hi()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(s,r)}}let pi=!1;try{pi=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const jc=pi;function wc(){}class Nc extends vc{constructor(s){if(super(s),typeof location<"u"){const r=location.protocol==="https:";let a=location.port;a||(a=r?"443":"80"),this.xd=typeof location<"u"&&s.hostname!==location.hostname||a!==s.port}}doWrite(s,r){const a=this.request({method:"POST",data:s});a.on("success",r),a.on("error",(i,l)=>{this.onError("xhr post error",i,l)})}doPoll(){const s=this.request();s.on("data",this.onData.bind(this)),s.on("error",(r,a)=>{this.onError("xhr poll error",r,a)}),this.pollXhr=s}}class dt extends Ae{constructor(s,r,a){super(),this.createRequest=s,or(this,a),this._opts=a,this._method=a.method||"GET",this._uri=r,this._data=a.data!==void 0?a.data:null,this._create()}_create(){var s;const r=mi(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const a=this._xhr=this.createRequest(r);try{a.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){a.setDisableHeaderCheck&&a.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&a.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{a.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{a.setRequestHeader("Accept","*/*")}catch{}(s=this._opts.cookieJar)===null||s===void 0||s.addCookies(a),"withCredentials"in a&&(a.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(a.timeout=this._opts.requestTimeout),a.onreadystatechange=()=>{var i;a.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(a.getResponseHeader("set-cookie"))),a.readyState===4&&(a.status===200||a.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof a.status=="number"?a.status:0)},0))},a.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=dt.requestsCount++,dt.requests[this._index]=this)}_onError(s){this.emitReserved("error",s,this._xhr),this._cleanup(!0)}_cleanup(s){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=wc,s)try{this._xhr.abort()}catch{}typeof document<"u"&&delete dt.requests[this._index],this._xhr=null}}_onLoad(){const s=this._xhr.responseText;s!==null&&(this.emitReserved("data",s),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}dt.requestsCount=0;dt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",wn);else if(typeof addEventListener=="function"){const t="onpagehide"in Xe?"pagehide":"unload";addEventListener(t,wn,!1)}}function wn(){for(let t in dt.requests)dt.requests.hasOwnProperty(t)&&dt.requests[t].abort()}const Sc=function(){const t=xi({xdomain:!1});return t&&t.responseType!==null}();class Cc extends Nc{constructor(s){super(s);const r=s&&s.forceBase64;this.supportsBinary=Sc&&!r}request(s={}){return Object.assign(s,{xd:this.xd},this.opts),new dt(xi,this.uri(),s)}}function xi(t){const s=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!s||jc))return new XMLHttpRequest}catch{}if(!s)try{return new Xe[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const fi=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class kc extends Gr{get name(){return"websocket"}doOpen(){const s=this.uri(),r=this.opts.protocols,a=fi?{}:mi(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(a.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(s,r,a)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=s=>this.onClose({description:"websocket connection closed",context:s}),this.ws.onmessage=s=>this.onData(s.data),this.ws.onerror=s=>this.onError("websocket error",s)}write(s){this.writable=!1;for(let r=0;r<s.length;r++){const a=s[r],i=r===s.length-1;Jr(a,this.supportsBinary,l=>{try{this.doWrite(a,l)}catch{}i&&lr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const s=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=hi()),this.supportsBinary||(r.b64=1),this.createUri(s,r)}}const Or=Xe.WebSocket||Xe.MozWebSocket;class Ec extends kc{createSocket(s,r,a){return fi?new Or(s,r,a):r?new Or(s,r):new Or(s)}doWrite(s,r){this.ws.send(r)}}class _c extends Gr{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(s){return this.emitReserved("error",s)}this._transport.closed.then(()=>{this.onClose()}).catch(s=>{this.onError("webtransport error",s)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(s=>{const r=cc(Number.MAX_SAFE_INTEGER,this.socket.binaryType),a=s.readable.pipeThrough(r).getReader(),i=oc();i.readable.pipeTo(s.writable),this._writer=i.writable.getWriter();const l=()=>{a.read().then(({done:u,value:g})=>{u||(this.onPacket(g),l())}).catch(u=>{})};l();const c={type:"open"};this.query.sid&&(c.data=`{"sid":"${this.query.sid}"}`),this._writer.write(c).then(()=>this.onOpen())})})}write(s){this.writable=!1;for(let r=0;r<s.length;r++){const a=s[r],i=r===s.length-1;this._writer.write(a).then(()=>{i&&lr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var s;(s=this._transport)===null||s===void 0||s.close()}}const Ac={websocket:Ec,webtransport:_c,polling:Cc},Tc=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Pc=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function $r(t){if(t.length>8e3)throw"URI too long";const s=t,r=t.indexOf("["),a=t.indexOf("]");r!=-1&&a!=-1&&(t=t.substring(0,r)+t.substring(r,a).replace(/:/g,";")+t.substring(a,t.length));let i=Tc.exec(t||""),l={},c=14;for(;c--;)l[Pc[c]]=i[c]||"";return r!=-1&&a!=-1&&(l.source=s,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=Oc(l,l.path),l.queryKey=Dc(l,l.query),l}function Oc(t,s){const r=/\/{2,9}/g,a=s.replace(r,"/").split("/");return(s.slice(0,1)=="/"||s.length===0)&&a.splice(0,1),s.slice(-1)=="/"&&a.splice(a.length-1,1),a}function Dc(t,s){const r={};return s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,i,l){i&&(r[i]=l)}),r}const qr=typeof addEventListener=="function"&&typeof removeEventListener=="function",Js=[];qr&&addEventListener("offline",()=>{Js.forEach(t=>t())},!1);class Ot extends Ae{constructor(s,r){if(super(),this.binaryType=uc,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,s&&typeof s=="object"&&(r=s,s=null),s){const a=$r(s);r.hostname=a.host,r.secure=a.protocol==="https"||a.protocol==="wss",r.port=a.port,a.query&&(r.query=a.query)}else r.host&&(r.hostname=$r(r.host).host);or(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(a=>{const i=a.prototype.name;this.transports.push(i),this._transportsByName[i]=a}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=bc(this.opts.query)),qr&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Js.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(s){const r=Object.assign({},this.opts.query);r.EIO=ui,r.transport=s,this.id&&(r.sid=this.id);const a=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[s]);return new this._transportsByName[s](a)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const s=this.opts.rememberUpgrade&&Ot.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(s);r.open(),this.setTransport(r)}setTransport(s){this.transport&&this.transport.removeAllListeners(),this.transport=s,s.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",Ot.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",s),this.emitReserved("heartbeat"),s.type){case"open":this.onHandshake(JSON.parse(s.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=s.data,this._onError(r);break;case"message":this.emitReserved("data",s.data),this.emitReserved("message",s.data);break}}onHandshake(s){this.emitReserved("handshake",s),this.id=s.sid,this.transport.query.sid=s.sid,this._pingInterval=s.pingInterval,this._pingTimeout=s.pingTimeout,this._maxPayload=s.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const s=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+s,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},s),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const s=this._getWritablePackets();this.transport.send(s),this._prevBufferLen=s.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let a=0;a<this.writeBuffer.length;a++){const i=this.writeBuffer[a].data;if(i&&(r+=xc(i)),a>0&&r>this._maxPayload)return this.writeBuffer.slice(0,a);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const s=Date.now()>this._pingTimeoutTime;return s&&(this._pingTimeoutTime=0,lr(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),s}write(s,r,a){return this._sendPacket("message",s,r,a),this}send(s,r,a){return this._sendPacket("message",s,r,a),this}_sendPacket(s,r,a,i){if(typeof r=="function"&&(i=r,r=void 0),typeof a=="function"&&(i=a,a=null),this.readyState==="closing"||this.readyState==="closed")return;a=a||{},a.compress=a.compress!==!1;const l={type:s,data:r,options:a};this.emitReserved("packetCreate",l),this.writeBuffer.push(l),i&&this.once("flush",i),this.flush()}close(){const s=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),s()},a=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?a():s()}):this.upgrading?a():s()),this}_onError(s){if(Ot.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",s),this._onClose("transport error",s)}_onClose(s,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),qr&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const a=Js.indexOf(this._offlineEventListener);a!==-1&&Js.splice(a,1)}this.readyState="closed",this.id=null,this.emitReserved("close",s,r),this.writeBuffer=[],this._prevBufferLen=0}}}Ot.protocol=ui;class Rc extends Ot{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let s=0;s<this._upgrades.length;s++)this._probe(this._upgrades[s])}_probe(s){let r=this.createTransport(s),a=!1;Ot.priorWebsocketSuccess=!1;const i=()=>{a||(r.send([{type:"ping",data:"probe"}]),r.once("packet",p=>{if(!a)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;Ot.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{a||this.readyState!=="closed"&&(h(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const j=new Error("probe error");j.transport=r.name,this.emitReserved("upgradeError",j)}}))};function l(){a||(a=!0,h(),r.close(),r=null)}const c=p=>{const j=new Error("probe error: "+p);j.transport=r.name,l(),this.emitReserved("upgradeError",j)};function u(){c("transport closed")}function g(){c("socket closed")}function x(p){r&&p.name!==r.name&&l()}const h=()=>{r.removeListener("open",i),r.removeListener("error",c),r.removeListener("close",u),this.off("close",g),this.off("upgrading",x)};r.once("open",i),r.once("error",c),r.once("close",u),this.once("close",g),this.once("upgrading",x),this._upgrades.indexOf("webtransport")!==-1&&s!=="webtransport"?this.setTimeoutFn(()=>{a||r.open()},200):r.open()}onHandshake(s){this._upgrades=this._filterUpgrades(s.upgrades),super.onHandshake(s)}_filterUpgrades(s){const r=[];for(let a=0;a<s.length;a++)~this.transports.indexOf(s[a])&&r.push(s[a]);return r}}let Ic=class extends Rc{constructor(s,r={}){const a=typeof s=="object"?s:r;(!a.transports||a.transports&&typeof a.transports[0]=="string")&&(a.transports=(a.transports||["polling","websocket","webtransport"]).map(i=>Ac[i]).filter(i=>!!i)),super(s,a)}};function Fc(t,s="",r){let a=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),a=$r(t)),a.port||(/^(http|ws)$/.test(a.protocol)?a.port="80":/^(http|ws)s$/.test(a.protocol)&&(a.port="443")),a.path=a.path||"/";const l=a.host.indexOf(":")!==-1?"["+a.host+"]":a.host;return a.id=a.protocol+"://"+l+":"+a.port+s,a.href=a.protocol+"://"+l+(r&&r.port===a.port?"":":"+a.port),a}const Lc=typeof ArrayBuffer=="function",Mc=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,gi=Object.prototype.toString,Bc=typeof Blob=="function"||typeof Blob<"u"&&gi.call(Blob)==="[object BlobConstructor]",$c=typeof File=="function"||typeof File<"u"&&gi.call(File)==="[object FileConstructor]";function ea(t){return Lc&&(t instanceof ArrayBuffer||Mc(t))||Bc&&t instanceof Blob||$c&&t instanceof File}function Xs(t,s){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,a=t.length;r<a;r++)if(Xs(t[r]))return!0;return!1}if(ea(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Xs(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&Xs(t[r]))return!0;return!1}function qc(t){const s=[],r=t.data,a=t;return a.data=Ur(r,s),a.attachments=s.length,{packet:a,buffers:s}}function Ur(t,s){if(!t)return t;if(ea(t)){const r={_placeholder:!0,num:s.length};return s.push(t),r}else if(Array.isArray(t)){const r=new Array(t.length);for(let a=0;a<t.length;a++)r[a]=Ur(t[a],s);return r}else if(typeof t=="object"&&!(t instanceof Date)){const r={};for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=Ur(t[a],s));return r}return t}function Uc(t,s){return t.data=Vr(t.data,s),delete t.attachments,t}function Vr(t,s){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<s.length)return s[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=Vr(t[r],s);else if(typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=Vr(t[r],s));return t}const bi=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Vc=5;var ie;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(ie||(ie={}));class Wc{constructor(s){this.replacer=s}encode(s){return(s.type===ie.EVENT||s.type===ie.ACK)&&Xs(s)?this.encodeAsBinary({type:s.type===ie.EVENT?ie.BINARY_EVENT:ie.BINARY_ACK,nsp:s.nsp,data:s.data,id:s.id}):[this.encodeAsString(s)]}encodeAsString(s){let r=""+s.type;return(s.type===ie.BINARY_EVENT||s.type===ie.BINARY_ACK)&&(r+=s.attachments+"-"),s.nsp&&s.nsp!=="/"&&(r+=s.nsp+","),s.id!=null&&(r+=s.id),s.data!=null&&(r+=JSON.stringify(s.data,this.replacer)),r}encodeAsBinary(s){const r=qc(s),a=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(a),i}}class ta extends Ae{constructor(s){super(),this.reviver=s}add(s){let r;if(typeof s=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(s);const a=r.type===ie.BINARY_EVENT;a||r.type===ie.BINARY_ACK?(r.type=a?ie.EVENT:ie.ACK,this.reconstructor=new Hc(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(ea(s)||s.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(s),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+s)}decodeString(s){let r=0;const a={type:Number(s.charAt(0))};if(ie[a.type]===void 0)throw new Error("unknown packet type "+a.type);if(a.type===ie.BINARY_EVENT||a.type===ie.BINARY_ACK){const l=r+1;for(;s.charAt(++r)!=="-"&&r!=s.length;);const c=s.substring(l,r);if(c!=Number(c)||s.charAt(r)!=="-")throw new Error("Illegal attachments");a.attachments=Number(c)}if(s.charAt(r+1)==="/"){const l=r+1;for(;++r&&!(s.charAt(r)===","||r===s.length););a.nsp=s.substring(l,r)}else a.nsp="/";const i=s.charAt(r+1);if(i!==""&&Number(i)==i){const l=r+1;for(;++r;){const c=s.charAt(r);if(c==null||Number(c)!=c){--r;break}if(r===s.length)break}a.id=Number(s.substring(l,r+1))}if(s.charAt(++r)){const l=this.tryParse(s.substr(r));if(ta.isPayloadValid(a.type,l))a.data=l;else throw new Error("invalid payload")}return a}tryParse(s){try{return JSON.parse(s,this.reviver)}catch{return!1}}static isPayloadValid(s,r){switch(s){case ie.CONNECT:return tr(r);case ie.DISCONNECT:return r===void 0;case ie.CONNECT_ERROR:return typeof r=="string"||tr(r);case ie.EVENT:case ie.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&bi.indexOf(r[0])===-1);case ie.ACK:case ie.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Hc{constructor(s){this.packet=s,this.buffers=[],this.reconPack=s}takeBinaryData(s){if(this.buffers.push(s),this.buffers.length===this.reconPack.attachments){const r=Uc(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Kc(t){return typeof t=="string"}const Qc=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};function zc(t){return t===void 0||Qc(t)}function tr(t){return Object.prototype.toString.call(t)==="[object Object]"}function Zc(t,s){switch(t){case ie.CONNECT:return s===void 0||tr(s);case ie.DISCONNECT:return s===void 0;case ie.EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&bi.indexOf(s[0])===-1);case ie.ACK:return Array.isArray(s);case ie.CONNECT_ERROR:return typeof s=="string"||tr(s);default:return!1}}function Yc(t){return Kc(t.nsp)&&zc(t.id)&&Zc(t.type,t.data)}const Jc=Object.freeze(Object.defineProperty({__proto__:null,Decoder:ta,Encoder:Wc,get PacketType(){return ie},isPacketValid:Yc,protocol:Vc},Symbol.toStringTag,{value:"Module"}));function tt(t,s,r){return t.on(s,r),function(){t.off(s,r)}}const Xc=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class yi extends Ae{constructor(s,r,a){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=s,this.nsp=r,a&&a.auth&&(this.auth=a.auth),this._opts=Object.assign({},a),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const s=this.io;this.subs=[tt(s,"open",this.onopen.bind(this)),tt(s,"packet",this.onpacket.bind(this)),tt(s,"error",this.onerror.bind(this)),tt(s,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...s){return s.unshift("message"),this.emit.apply(this,s),this}emit(s,...r){var a,i,l;if(Xc.hasOwnProperty(s))throw new Error('"'+s.toString()+'" is a reserved event name');if(r.unshift(s),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const c={type:ie.EVENT,data:r};if(c.options={},c.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const h=this.ids++,p=r.pop();this._registerAckCallback(h,p),c.id=h}const u=(i=(a=this.io.engine)===null||a===void 0?void 0:a.transport)===null||i===void 0?void 0:i.writable,g=this.connected&&!(!((l=this.io.engine)===null||l===void 0)&&l._hasPingExpired());return this.flags.volatile&&!u||(g?(this.notifyOutgoingListeners(c),this.packet(c)):this.sendBuffer.push(c)),this.flags={},this}_registerAckCallback(s,r){var a;const i=(a=this.flags.timeout)!==null&&a!==void 0?a:this._opts.ackTimeout;if(i===void 0){this.acks[s]=r;return}const l=this.io.setTimeoutFn(()=>{delete this.acks[s];for(let u=0;u<this.sendBuffer.length;u++)this.sendBuffer[u].id===s&&this.sendBuffer.splice(u,1);r.call(this,new Error("operation has timed out"))},i),c=(...u)=>{this.io.clearTimeoutFn(l),r.apply(this,u)};c.withError=!0,this.acks[s]=c}emitWithAck(s,...r){return new Promise((a,i)=>{const l=(c,u)=>c?i(c):a(u);l.withError=!0,r.push(l),this.emit(s,...r)})}_addToQueue(s){let r;typeof s[s.length-1]=="function"&&(r=s.pop());const a={id:this._queueSeq++,tryCount:0,pending:!1,args:s,flags:Object.assign({fromQueue:!0},this.flags)};s.push((i,...l)=>(this._queue[0],i!==null?a.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...l)),a.pending=!1,this._drainQueue())),this._queue.push(a),this._drainQueue()}_drainQueue(s=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!s||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(s){s.nsp=this.nsp,this.io._packet(s)}onopen(){typeof this.auth=="function"?this.auth(s=>{this._sendConnectPacket(s)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(s){this.packet({type:ie.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},s):s})}onerror(s){this.connected||this.emitReserved("connect_error",s)}onclose(s,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",s,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(s=>{if(!this.sendBuffer.some(a=>String(a.id)===s)){const a=this.acks[s];delete this.acks[s],a.withError&&a.call(this,new Error("socket has been disconnected"))}})}onpacket(s){if(s.nsp===this.nsp)switch(s.type){case ie.CONNECT:s.data&&s.data.sid?this.onconnect(s.data.sid,s.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ie.EVENT:case ie.BINARY_EVENT:this.onevent(s);break;case ie.ACK:case ie.BINARY_ACK:this.onack(s);break;case ie.DISCONNECT:this.ondisconnect();break;case ie.CONNECT_ERROR:this.destroy();const a=new Error(s.data.message);a.data=s.data.data,this.emitReserved("connect_error",a);break}}onevent(s){const r=s.data||[];s.id!=null&&r.push(this.ack(s.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(s){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const a of r)a.apply(this,s)}super.emit.apply(this,s),this._pid&&s.length&&typeof s[s.length-1]=="string"&&(this._lastOffset=s[s.length-1])}ack(s){const r=this;let a=!1;return function(...i){a||(a=!0,r.packet({type:ie.ACK,id:s,data:i}))}}onack(s){const r=this.acks[s.id];typeof r=="function"&&(delete this.acks[s.id],r.withError&&s.data.unshift(null),r.apply(this,s.data))}onconnect(s,r){this.id=s,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(s=>this.emitEvent(s)),this.receiveBuffer=[],this.sendBuffer.forEach(s=>{this.notifyOutgoingListeners(s),this.packet(s)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(s=>s()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ie.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(s){return this.flags.compress=s,this}get volatile(){return this.flags.volatile=!0,this}timeout(s){return this.flags.timeout=s,this}onAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(s),this}prependAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(s),this}offAny(s){if(!this._anyListeners)return this;if(s){const r=this._anyListeners;for(let a=0;a<r.length;a++)if(s===r[a])return r.splice(a,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(s),this}prependAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(s),this}offAnyOutgoing(s){if(!this._anyOutgoingListeners)return this;if(s){const r=this._anyOutgoingListeners;for(let a=0;a<r.length;a++)if(s===r[a])return r.splice(a,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(s){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const a of r)a.apply(this,s.data)}}}function ss(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ss.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var s=Math.random(),r=Math.floor(s*this.jitter*t);t=Math.floor(s*10)&1?t+r:t-r}return Math.min(t,this.max)|0};ss.prototype.reset=function(){this.attempts=0};ss.prototype.setMin=function(t){this.ms=t};ss.prototype.setMax=function(t){this.max=t};ss.prototype.setJitter=function(t){this.jitter=t};class Wr extends Ae{constructor(s,r){var a;super(),this.nsps={},this.subs=[],s&&typeof s=="object"&&(r=s,s=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,or(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((a=r.randomizationFactor)!==null&&a!==void 0?a:.5),this.backoff=new ss({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=s;const i=r.parser||Jc;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(s){return arguments.length?(this._reconnection=!!s,s||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(s){return s===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=s,this)}reconnectionDelay(s){var r;return s===void 0?this._reconnectionDelay:(this._reconnectionDelay=s,(r=this.backoff)===null||r===void 0||r.setMin(s),this)}randomizationFactor(s){var r;return s===void 0?this._randomizationFactor:(this._randomizationFactor=s,(r=this.backoff)===null||r===void 0||r.setJitter(s),this)}reconnectionDelayMax(s){var r;return s===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=s,(r=this.backoff)===null||r===void 0||r.setMax(s),this)}timeout(s){return arguments.length?(this._timeout=s,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(s){if(~this._readyState.indexOf("open"))return this;this.engine=new Ic(this.uri,this.opts);const r=this.engine,a=this;this._readyState="opening",this.skipReconnect=!1;const i=tt(r,"open",function(){a.onopen(),s&&s()}),l=u=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",u),s?s(u):this.maybeReconnectOnOpen()},c=tt(r,"error",l);if(this._timeout!==!1){const u=this._timeout,g=this.setTimeoutFn(()=>{i(),l(new Error("timeout")),r.close()},u);this.opts.autoUnref&&g.unref(),this.subs.push(()=>{this.clearTimeoutFn(g)})}return this.subs.push(i),this.subs.push(c),this}connect(s){return this.open(s)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const s=this.engine;this.subs.push(tt(s,"ping",this.onping.bind(this)),tt(s,"data",this.ondata.bind(this)),tt(s,"error",this.onerror.bind(this)),tt(s,"close",this.onclose.bind(this)),tt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(s){try{this.decoder.add(s)}catch(r){this.onclose("parse error",r)}}ondecoded(s){lr(()=>{this.emitReserved("packet",s)},this.setTimeoutFn)}onerror(s){this.emitReserved("error",s)}socket(s,r){let a=this.nsps[s];return a?this._autoConnect&&!a.active&&a.connect():(a=new yi(this,s,r),this.nsps[s]=a),a}_destroy(s){const r=Object.keys(this.nsps);for(const a of r)if(this.nsps[a].active)return;this._close()}_packet(s){const r=this.encoder.encode(s);for(let a=0;a<r.length;a++)this.engine.write(r[a],s.options)}cleanup(){this.subs.forEach(s=>s()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(s,r){var a;this.cleanup(),(a=this.engine)===null||a===void 0||a.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",s,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const s=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const a=this.setTimeoutFn(()=>{s.skipReconnect||(this.emitReserved("reconnect_attempt",s.backoff.attempts),!s.skipReconnect&&s.open(i=>{i?(s._reconnecting=!1,s.reconnect(),this.emitReserved("reconnect_error",i)):s.onreconnect()}))},r);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}}onreconnect(){const s=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",s)}}const gs={};function Gs(t,s){typeof t=="object"&&(s=t,t=void 0),s=s||{};const r=Fc(t,s.path||"/socket.io"),a=r.source,i=r.id,l=r.path,c=gs[i]&&l in gs[i].nsps,u=s.forceNew||s["force new connection"]||s.multiplex===!1||c;let g;return u?g=new Wr(a,s):(gs[i]||(gs[i]=new Wr(a,s)),g=gs[i]),r.query&&!s.query&&(s.query=r.queryKey),g.socket(r.path,s)}Object.assign(Gs,{Manager:Wr,Socket:yi,io:Gs,connect:Gs});const Gc="/notification.wav";var Vn;const ed=typeof window<"u"&&((Vn=window.electronAPI)==null?void 0:Vn.isElectron)===!0,be={ORDER_CREATED:"ORDER_CREATED",ORDER_RESCHEDULED:"ORDER_RESCHEDULED",TECHNICIAN_ASSIGNED:"TECHNICIAN_ASSIGNED",JOB_UPDATED:"JOB_UPDATED",CUSTOMER_ORDER_PLACED:"CUSTOMER_ORDER_PLACED",PAYMENT_RECEIVED:"PAYMENT_RECEIVED",TECHNICIAN_CHECKED_IN:"TECHNICIAN_CHECKED_IN",CUSTOMER_APPROVAL_REQUIRED:"CUSTOMER_APPROVAL_REQUIRED",CUSTOMER_APPROVAL_UPDATED:"CUSTOMER_APPROVAL_UPDATED",TECHNICIAN_UNASSIGNED:"TECHNICIAN_UNASSIGNED",ORDER_CANCELLATION_REQUESTED:"ORDER_CANCELLATION_REQUESTED",ORDER_CANCELLED:"ORDER_CANCELLED",ORDER_ACTIVITY:"ORDER_ACTIVITY"},vi=o.createContext(null),td="https://admin.fixzep.com",sd=({children:t})=>{const[s,r]=o.useState(null),[a,i]=o.useState(!1),[l,c]=o.useState([]),[u,g]=o.useState(!0),x=St(),h=o.useRef(null),p=o.useRef(null);o.useEffect(()=>(h.current=new Audio(Gc),h.current.volume=.5,h.current.load(),()=>{h.current&&(h.current.pause(),h.current=null)}),[]),o.useEffect(()=>{const k=()=>{if(h.current&&!u){const A=h.current;A.volume=0,A.play().then(()=>{A.pause(),A.currentTime=0,A.volume=.5,g(!0),console.log("[Sound] Audio unlocked - notifications will play")}).catch(()=>{})}},P=["click","touchstart","keydown"];return P.forEach(A=>{document.addEventListener(A,k,{once:!1,passive:!0})}),()=>{P.forEach(A=>{document.removeEventListener(A,k)})}},[u]);const j=o.useCallback(()=>{h.current&&u?(h.current.currentTime=0,h.current.play().catch(k=>{console.log("[Sound] Could not play notification sound:",k.message)})):u||console.log("[Sound] Audio not yet unlocked - click anywhere to enable notification sounds")},[u]),Q=o.useCallback((k,P)=>{const A={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,event:k,payload:P,timestamp:new Date,read:!1};c(C=>[A,...C].slice(0,50))},[]),Y=o.useCallback(()=>{c([])},[]),z=o.useCallback((k,P)=>{let A="",C=e.jsx(ri,{className:"h-5 w-5 text-blue-500"});switch(k){case be.ORDER_CREATED:case be.CUSTOMER_ORDER_PLACED:A=`New order received${P.orderCode?`: #${P.orderCode}`:""}`,C=e.jsx("span",{className:"text-xl",children:""});break;case be.TECHNICIAN_ASSIGNED:A=`Technician assigned to order${P.orderCode?` #${P.orderCode}`:""}`,C=e.jsx("span",{className:"text-xl",children:""});break;case be.ORDER_RESCHEDULED:A=`Order rescheduled${P.orderCode?`: #${P.orderCode}`:""}`,C=e.jsx("span",{className:"text-xl",children:""});break;case be.PAYMENT_RECEIVED:A=`Payment received${P.amount?`: ${P.amount}`:""}`,C=e.jsx("span",{className:"text-xl",children:""});break;case be.TECHNICIAN_CHECKED_IN:A="Technician checked in",C=e.jsx("span",{className:"text-xl",children:""});break;case be.CUSTOMER_APPROVAL_REQUIRED:A="Customer approval required",C=e.jsx("span",{className:"text-xl",children:""});break;case be.CUSTOMER_APPROVAL_UPDATED:A="Customer approval updated",C=e.jsx("span",{className:"text-xl",children:""});break;case be.JOB_UPDATED:A="Job card updated",C=e.jsx("span",{className:"text-xl",children:""});break;case be.TECHNICIAN_UNASSIGNED:A="Technician unassigned from order",C=e.jsx("span",{className:"text-xl",children:""});break;case be.ORDER_CANCELLATION_REQUESTED:A=`Cancellation requested${P.orderCode?`: #${P.orderCode}`:""}`,C=e.jsx("span",{className:"text-xl",children:""});break;case be.ORDER_CANCELLED:A=`Order cancelled${P.orderCode?`: #${P.orderCode}`:""}`,C=e.jsx("span",{className:"text-xl",children:""});break;default:A="New notification received"}w(A,{icon:C,duration:5e3,position:"top-right",style:{borderRadius:"12px",background:"#1e293b",color:"#fff",padding:"12px 16px"}}),ed&&window.electronAPI&&window.electronAPI.showNotification("Fixzep Admin",A)},[]);o.useEffect(()=>{const k=localStorage.getItem("fixzep_token"),P=localStorage.getItem("fixzep_user");if(!k||!P)return;let A={};try{A=JSON.parse(P)}catch{return}const C=Gs(td,{transports:["websocket","polling"],autoConnect:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3});return p.current=A,C.on("connect",()=>{console.log("[Socket] Connected:",C.id),i(!0),A.role==="admin"?C.emit("admin:join",{userId:A.id}):A.role==="technician"?C.emit("technician:join",{userId:A.id}):C.emit("customer:join",{userId:A.id})}),C.on("disconnect",()=>{console.log("[Socket] Disconnected"),i(!1)}),C.on("connect_error",$=>{console.error("[Socket] Connection error:",$),i(!1)}),Object.values(be).forEach($=>{C.on($,V=>{console.log(`[Socket] Received ${$}:`,V),Q($,V),z($,V),($===be.ORDER_CREATED||$===be.CUSTOMER_ORDER_PLACED||$===be.ORDER_CANCELLATION_REQUESTED||$===be.ORDER_CANCELLED)&&j(),$===be.ORDER_CREATED||$===be.CUSTOMER_ORDER_PLACED?(x.invalidateQueries({queryKey:["orders"]}),x.invalidateQueries({queryKey:["dashboard"]})):$===be.TECHNICIAN_ASSIGNED||$===be.TECHNICIAN_UNASSIGNED?(x.invalidateQueries({queryKey:["orders"]}),x.invalidateQueries({queryKey:["technicians"]}),V!=null&&V.orderId&&x.invalidateQueries({queryKey:["order-jobcard",V.orderId]})):$===be.JOB_UPDATED||$===be.ORDER_CANCELLATION_REQUESTED||$===be.ORDER_CANCELLED?(x.invalidateQueries({queryKey:["orders"]}),V!=null&&V.orderId&&x.invalidateQueries({queryKey:["order-jobcard",V.orderId]})):$===be.ORDER_RESCHEDULED?(x.invalidateQueries({queryKey:["orders"]}),V!=null&&V.orderId&&x.invalidateQueries({queryKey:["order-jobcard",V.orderId]})):$===be.PAYMENT_RECEIVED?(x.invalidateQueries({queryKey:["orders"]}),V!=null&&V.orderId&&x.invalidateQueries({queryKey:["order-jobcard",V.orderId]})):$===be.ORDER_ACTIVITY&&V!=null&&V.orderId&&(x.invalidateQueries({queryKey:["orders"]}),x.invalidateQueries({queryKey:["order-jobcard",V.orderId]}))})}),r(C),()=>{C.disconnect(),r(null),i(!1),p.current=null}},[Q,z,j,x]);const F=o.useCallback(k=>{var P;s!=null&&s.connected&&k&&((P=p.current)!=null&&P.id)&&s.emit("order:join",{orderId:k,userId:p.current.id,role:"admin"})},[s]),J=o.useCallback(k=>{s!=null&&s.connected&&k&&s.emit("order:leave",{orderId:k})},[s]),L=l.filter(k=>!k.read).length;return e.jsx(vi.Provider,{value:{socket:s,isConnected:a,notifications:l,clearNotifications:Y,unreadCount:L,soundEnabled:u,joinOrder:F,leaveOrder:J},children:t})},ji=()=>{const t=o.useContext(vi);if(!t)throw new Error("useSocket must be used within a SocketProvider");return t},rd=()=>{const t=o.useMemo(()=>{var c;return typeof window<"u"&&((c=window.electronAPI)==null?void 0:c.isElectron)===!0},[]),s=o.useMemo(()=>t&&window.electronAPI?window.electronAPI.platform:"web",[t]),r=o.useCallback((c,u)=>{t&&window.electronAPI?window.electronAPI.showNotification(c,u):"Notification"in window&&Notification.permission==="granted"?new Notification(c,{body:u}):"Notification"in window&&Notification.permission!=="denied"&&Notification.requestPermission().then(g=>{g==="granted"&&new Notification(c,{body:u})})},[t]),a=o.useCallback(()=>{t&&window.electronAPI&&window.electronAPI.minimizeWindow()},[t]),i=o.useCallback(()=>{t&&window.electronAPI&&window.electronAPI.maximizeWindow()},[t]),l=o.useCallback(()=>{t&&window.electronAPI&&window.electronAPI.closeWindow()},[t]);return{isElectron:t,platform:s,showNotification:r,minimizeWindow:a,maximizeWindow:i,closeWindow:l}},ad=()=>{const{user:t,logout:s}=Yr(),r=ni(u=>u.toggle),{isConnected:a,unreadCount:i,soundEnabled:l}=ji(),{isElectron:c}=rd();return e.jsxs("header",{className:"flex items-center justify-between border-b border-slate-200 bg-white/80 px-6 py-4 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:r,className:"lg:hidden rounded-full border border-slate-200 p-2 text-slate-600",children:e.jsx(go,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Admin"}),e.jsxs("h2",{className:"text-lg font-semibold text-slate-900",children:["Welcome, ",t==null?void 0:t.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[c&&e.jsxs("div",{className:"flex items-center gap-1.5 rounded-full bg-slate-100 px-2 py-1",title:"Running as Desktop App",children:[e.jsx(_o,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Desktop"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",title:a?"Connected - Real-time updates active":"Disconnected - Reconnecting...",children:[e.jsx(Yo,{className:`h-4 w-4 ${a?"text-emerald-500":"text-slate-300"}`}),e.jsx("span",{className:`h-2 w-2 rounded-full ${a?"bg-emerald-500 animate-pulse":"bg-slate-300"}`})]}),e.jsx("div",{className:"flex items-center",title:l?"Sound notifications enabled":"Click anywhere to enable sound notifications",children:l?e.jsx(Uo,{className:"h-4 w-4 text-emerald-500"}):e.jsx(Wo,{className:"h-4 w-4 text-amber-500 animate-pulse"})}),e.jsxs("div",{className:"relative",children:[e.jsx(ri,{className:"h-5 w-5 text-slate-500"}),i>0&&e.jsx("span",{className:"absolute -right-1 -top-1 flex h-4 w-4 items-center justify-center rounded-full bg-rose-500 text-[10px] font-bold text-white",children:i>9?"9+":i})]}),e.jsx("button",{onClick:s,className:"rounded-full border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-600 hover:border-slate-900 hover:text-slate-900",children:"Logout"})]})]})},nd=()=>{const{isOpen:t,close:s}=ni();return e.jsxs("div",{className:"flex min-h-screen bg-slate-50 text-slate-900",children:[e.jsx(bn,{}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx(ad,{}),e.jsx("main",{className:"flex-1 px-4 py-6 sm:px-6 lg:px-10",children:e.jsx("div",{className:"mx-auto max-w-6xl",children:e.jsx(ll,{})})})]}),e.jsx("div",{className:Nt("fixed inset-0 z-40 bg-slate-900/60 backdrop-blur-sm transition-opacity lg:hidden",t?"opacity-100 pointer-events-auto":"pointer-events-none opacity-0"),onClick:s,children:e.jsx("div",{className:Nt("absolute inset-y-0 left-0 w-72 transform bg-white shadow-xl transition-transform",t?"translate-x-0":"-translate-x-full"),children:e.jsx(bn,{})})})]})};var _s=t=>t.type==="checkbox",Bt=t=>t instanceof Date,Ze=t=>t==null;const wi=t=>typeof t=="object";var Te=t=>!Ze(t)&&!Array.isArray(t)&&wi(t)&&!Bt(t),id=t=>Te(t)&&t.target?_s(t.target)?t.target.checked:t.target.value:t,ld=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,od=(t,s)=>t.has(ld(s)),cd=t=>{const s=t.constructor&&t.constructor.prototype;return Te(s)&&s.hasOwnProperty("isPrototypeOf")},sa=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Re(t){let s;const r=Array.isArray(t),a=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)s=new Date(t);else if(!(sa&&(t instanceof Blob||a))&&(r||Te(t)))if(s=r?[]:Object.create(Object.getPrototypeOf(t)),!r&&!cd(t))s=t;else for(const i in t)t.hasOwnProperty(i)&&(s[i]=Re(t[i]));else return t;return s}var cr=t=>/^\w*$/.test(t),ke=t=>t===void 0,ra=t=>Array.isArray(t)?t.filter(Boolean):[],aa=t=>ra(t.replace(/["|']|\]/g,"").split(/\.|\[/)),H=(t,s,r)=>{if(!s||!Te(t))return r;const a=(cr(s)?[s]:aa(s)).reduce((i,l)=>Ze(i)?i:i[l],t);return ke(a)||a===t?ke(t[s])?r:t[s]:a},ot=t=>typeof t=="boolean",je=(t,s,r)=>{let a=-1;const i=cr(s)?[s]:aa(s),l=i.length,c=l-1;for(;++a<l;){const u=i[a];let g=r;if(a!==c){const x=t[u];g=Te(x)||Array.isArray(x)?x:isNaN(+i[a+1])?{}:[]}if(u==="__proto__"||u==="constructor"||u==="prototype")return;t[u]=g,t=t[u]}};const Nn={BLUR:"blur",FOCUS_OUT:"focusout"},st={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},vt={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Ni=we.createContext(null);Ni.displayName="HookFormContext";const dd=()=>we.useContext(Ni);var ud=(t,s,r,a=!0)=>{const i={defaultValues:s._defaultValues};for(const l in t)Object.defineProperty(i,l,{get:()=>{const c=l;return s._proxyFormState[c]!==st.all&&(s._proxyFormState[c]=!a||st.all),t[c]}});return i};const Si=typeof window<"u"?we.useLayoutEffect:we.useEffect;var Je=t=>typeof t=="string",Hr=(t,s,r,a,i)=>Je(t)?(a&&s.watch.add(t),H(r,t,i)):Array.isArray(t)?t.map(l=>(a&&s.watch.add(l),H(r,l))):(a&&(s.watchAll=!0),r),Kr=t=>Ze(t)||!wi(t);function rt(t,s,r=new WeakSet){if(Kr(t)||Kr(s))return Object.is(t,s);if(Bt(t)&&Bt(s))return t.getTime()===s.getTime();const a=Object.keys(t),i=Object.keys(s);if(a.length!==i.length)return!1;if(r.has(t)||r.has(s))return!0;r.add(t),r.add(s);for(const l of a){const c=t[l];if(!i.includes(l))return!1;if(l!=="ref"){const u=s[l];if(Bt(c)&&Bt(u)||Te(c)&&Te(u)||Array.isArray(c)&&Array.isArray(u)?!rt(c,u,r):!Object.is(c,u))return!1}}return!0}function md(t){const s=dd(),{control:r=s.control,name:a,defaultValue:i,disabled:l,exact:c,compute:u}=t||{},g=we.useRef(i),x=we.useRef(u),h=we.useRef(void 0),p=we.useRef(r),j=we.useRef(a);x.current=u;const[Q,Y]=we.useState(()=>{const P=r._getWatch(a,g.current);return x.current?x.current(P):P}),z=we.useCallback(P=>{const A=Hr(a,r._names,P||r._formValues,!1,g.current);return x.current?x.current(A):A},[r._formValues,r._names,a]),F=we.useCallback(P=>{if(!l){const A=Hr(a,r._names,P||r._formValues,!1,g.current);if(x.current){const C=x.current(A);rt(C,h.current)||(Y(C),h.current=C)}else Y(A)}},[r._formValues,r._names,l,a]);Si(()=>((p.current!==r||!rt(j.current,a))&&(p.current=r,j.current=a,F()),r._subscribe({name:a,formState:{values:!0},exact:c,callback:P=>{F(P.values)}})),[r,c,a,F]),we.useEffect(()=>r._removeUnmounted());const J=p.current!==r,L=j.current,k=we.useMemo(()=>{if(l)return null;const P=!J&&!rt(L,a);return J||P?z():null},[l,J,a,L,z]);return k!==null?k:Q}var hd=(t,s,r,a,i)=>s?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[a]:i||!0}}:{},Cs=t=>Array.isArray(t)?t:[t],Sn=()=>{let t=[];return{get observers(){return t},next:i=>{for(const l of t)l.next&&l.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(l=>l!==i)}}),unsubscribe:()=>{t=[]}}};function Ci(t,s){const r={};for(const a in t)if(t.hasOwnProperty(a)){const i=t[a],l=s[a];if(i&&Te(i)&&l){const c=Ci(i,l);Te(c)&&(r[a]=c)}else t[a]&&(r[a]=l)}return r}var He=t=>Te(t)&&!Object.keys(t).length,na=t=>t.type==="file",at=t=>typeof t=="function",sr=t=>{if(!sa)return!1;const s=t?t.ownerDocument:0;return t instanceof(s&&s.defaultView?s.defaultView.HTMLElement:HTMLElement)},ki=t=>t.type==="select-multiple",ia=t=>t.type==="radio",pd=t=>ia(t)||_s(t),Dr=t=>sr(t)&&t.isConnected;function xd(t,s){const r=s.slice(0,-1).length;let a=0;for(;a<r;)t=ke(t)?a++:t[s[a++]];return t}function fd(t){for(const s in t)if(t.hasOwnProperty(s)&&!ke(t[s]))return!1;return!0}function _e(t,s){const r=Array.isArray(s)?s:cr(s)?[s]:aa(s),a=r.length===1?t:xd(t,r),i=r.length-1,l=r[i];return a&&delete a[l],i!==0&&(Te(a)&&He(a)||Array.isArray(a)&&fd(a))&&_e(t,r.slice(0,-1)),t}var gd=t=>{for(const s in t)if(at(t[s]))return!0;return!1};function Ei(t){return Array.isArray(t)||Te(t)&&!gd(t)}function Qr(t,s={}){for(const r in t){const a=t[r];Ei(a)?(s[r]=Array.isArray(a)?[]:{},Qr(a,s[r])):ke(a)||(s[r]=!0)}return s}function Jt(t,s,r){r||(r=Qr(s));for(const a in t){const i=t[a];if(Ei(i))ke(s)||Kr(r[a])?r[a]=Qr(i,Array.isArray(i)?[]:{}):Jt(i,Ze(s)?{}:s[a],r[a]);else{const l=s[a];r[a]=!rt(i,l)}}return r}const Cn={value:!1,isValid:!1},kn={value:!0,isValid:!0};var _i=t=>{if(Array.isArray(t)){if(t.length>1){const s=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:s,isValid:!!s.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!ke(t[0].attributes.value)?ke(t[0].value)||t[0].value===""?kn:{value:t[0].value,isValid:!0}:kn:Cn}return Cn},Ai=(t,{valueAsNumber:s,valueAsDate:r,setValueAs:a})=>ke(t)?t:s?t===""?NaN:t&&+t:r&&Je(t)?new Date(t):a?a(t):t;const En={isValid:!1,value:null};var Ti=t=>Array.isArray(t)?t.reduce((s,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:s,En):En;function _n(t){const s=t.ref;return na(s)?s.files:ia(s)?Ti(t.refs).value:ki(s)?[...s.selectedOptions].map(({value:r})=>r):_s(s)?_i(t.refs).value:Ai(ke(s.value)?t.ref.value:s.value,t)}var bd=(t,s,r,a)=>{const i={};for(const l of t){const c=H(s,l);c&&je(i,l,c._f)}return{criteriaMode:r,names:[...t],fields:i,shouldUseNativeValidation:a}},rr=t=>t instanceof RegExp,bs=t=>ke(t)?t:rr(t)?t.source:Te(t)?rr(t.value)?t.value.source:t.value:t,An=t=>({isOnSubmit:!t||t===st.onSubmit,isOnBlur:t===st.onBlur,isOnChange:t===st.onChange,isOnAll:t===st.all,isOnTouch:t===st.onTouched});const Tn="AsyncFunction";var yd=t=>!!t&&!!t.validate&&!!(at(t.validate)&&t.validate.constructor.name===Tn||Te(t.validate)&&Object.values(t.validate).find(s=>s.constructor.name===Tn)),vd=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),Pn=(t,s,r)=>!r&&(s.watchAll||s.watch.has(t)||[...s.watch].some(a=>t.startsWith(a)&&/^\.\w+/.test(t.slice(a.length))));const ks=(t,s,r,a)=>{for(const i of r||Object.keys(t)){const l=H(t,i);if(l){const{_f:c,...u}=l;if(c){if(c.refs&&c.refs[0]&&s(c.refs[0],i)&&!a)return!0;if(c.ref&&s(c.ref,c.name)&&!a)return!0;if(ks(u,s))break}else if(Te(u)&&ks(u,s))break}}};function On(t,s,r){const a=H(t,r);if(a||cr(r))return{error:a,name:r};const i=r.split(".");for(;i.length;){const l=i.join("."),c=H(s,l),u=H(t,l);if(c&&!Array.isArray(c)&&r!==l)return{name:r};if(u&&u.type)return{name:l,error:u};if(u&&u.root&&u.root.type)return{name:`${l}.root`,error:u.root};i.pop()}return{name:r}}var jd=(t,s,r,a)=>{r(t);const{name:i,...l}=t;return He(l)||Object.keys(l).length>=Object.keys(s).length||Object.keys(l).find(c=>s[c]===(!a||st.all))},wd=(t,s,r)=>!t||!s||t===s||Cs(t).some(a=>a&&(r?a===s:a.startsWith(s)||s.startsWith(a))),Nd=(t,s,r,a,i)=>i.isOnAll?!1:!r&&i.isOnTouch?!(s||t):(r?a.isOnBlur:i.isOnBlur)?!t:(r?a.isOnChange:i.isOnChange)?t:!0,Sd=(t,s)=>!ra(H(t,s)).length&&_e(t,s),Cd=(t,s,r)=>{const a=Cs(H(t,r));return je(a,"root",s[r]),je(t,r,a),t};function Dn(t,s,r="validate"){if(Je(t)||Array.isArray(t)&&t.every(Je)||ot(t)&&!t)return{type:r,message:Je(t)?t:"",ref:s}}var Yt=t=>Te(t)&&!rr(t)?t:{value:t,message:""},Rn=async(t,s,r,a,i,l)=>{const{ref:c,refs:u,required:g,maxLength:x,minLength:h,min:p,max:j,pattern:Q,validate:Y,name:z,valueAsNumber:F,mount:J}=t._f,L=H(r,z);if(!J||s.has(z))return{};const k=u?u[0]:c,P=B=>{i&&k.reportValidity&&(k.setCustomValidity(ot(B)?"":B||""),k.reportValidity())},A={},C=ia(c),$=_s(c),V=C||$,pe=(F||na(c))&&ke(c.value)&&ke(L)||sr(c)&&c.value===""||L===""||Array.isArray(L)&&!L.length,S=hd.bind(null,z,a,A),Z=(B,se,ce,xe=vt.maxLength,ye=vt.minLength)=>{const Ne=B?se:ce;A[z]={type:B?xe:ye,message:Ne,ref:c,...S(B?xe:ye,Ne)}};if(l?!Array.isArray(L)||!L.length:g&&(!V&&(pe||Ze(L))||ot(L)&&!L||$&&!_i(u).isValid||C&&!Ti(u).isValid)){const{value:B,message:se}=Je(g)?{value:!!g,message:g}:Yt(g);if(B&&(A[z]={type:vt.required,message:se,ref:k,...S(vt.required,se)},!a))return P(se),A}if(!pe&&(!Ze(p)||!Ze(j))){let B,se;const ce=Yt(j),xe=Yt(p);if(!Ze(L)&&!isNaN(L)){const ye=c.valueAsNumber||L&&+L;Ze(ce.value)||(B=ye>ce.value),Ze(xe.value)||(se=ye<xe.value)}else{const ye=c.valueAsDate||new Date(L),Ne=Fe=>new Date(new Date().toDateString()+" "+Fe),Oe=c.type=="time",Se=c.type=="week";Je(ce.value)&&L&&(B=Oe?Ne(L)>Ne(ce.value):Se?L>ce.value:ye>new Date(ce.value)),Je(xe.value)&&L&&(se=Oe?Ne(L)<Ne(xe.value):Se?L<xe.value:ye<new Date(xe.value))}if((B||se)&&(Z(!!B,ce.message,xe.message,vt.max,vt.min),!a))return P(A[z].message),A}if((x||h)&&!pe&&(Je(L)||l&&Array.isArray(L))){const B=Yt(x),se=Yt(h),ce=!Ze(B.value)&&L.length>+B.value,xe=!Ze(se.value)&&L.length<+se.value;if((ce||xe)&&(Z(ce,B.message,se.message),!a))return P(A[z].message),A}if(Q&&!pe&&Je(L)){const{value:B,message:se}=Yt(Q);if(rr(B)&&!L.match(B)&&(A[z]={type:vt.pattern,message:se,ref:c,...S(vt.pattern,se)},!a))return P(se),A}if(Y){if(at(Y)){const B=await Y(L,r),se=Dn(B,k);if(se&&(A[z]={...se,...S(vt.validate,se.message)},!a))return P(se.message),A}else if(Te(Y)){let B={};for(const se in Y){if(!He(B)&&!a)break;const ce=Dn(await Y[se](L,r),k,se);ce&&(B={...ce,...S(se,ce.message)},P(ce.message),a&&(A[z]=B))}if(!He(B)&&(A[z]={ref:k,...B},!a))return A}}return P(!0),A};const kd={mode:st.onSubmit,reValidateMode:st.onChange,shouldFocusError:!0};function Ed(t={}){let s={...kd,...t},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:at(s.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1},a={},i=Te(s.defaultValues)||Te(s.values)?Re(s.defaultValues||s.values)||{}:{},l=s.shouldUnregister?{}:Re(i),c={action:!1,mount:!1,watch:!1},u={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},g,x=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let p={...h};const j={array:Sn(),state:Sn()},Q=s.criteriaMode===st.all,Y=m=>f=>{clearTimeout(x),x=setTimeout(m,f)},z=async m=>{if(!s.disabled&&(h.isValid||p.isValid||m)){const f=s.resolver?He((await $()).errors):await pe(a,!0);f!==r.isValid&&j.state.next({isValid:f})}},F=(m,f)=>{!s.disabled&&(h.isValidating||h.validatingFields||p.isValidating||p.validatingFields)&&((m||Array.from(u.mount)).forEach(y=>{y&&(f?je(r.validatingFields,y,f):_e(r.validatingFields,y))}),j.state.next({validatingFields:r.validatingFields,isValidating:!He(r.validatingFields)}))},J=(m,f=[],y,D,T=!0,_=!0)=>{if(D&&y&&!s.disabled){if(c.action=!0,_&&Array.isArray(H(a,m))){const R=y(H(a,m),D.argA,D.argB);T&&je(a,m,R)}if(_&&Array.isArray(H(r.errors,m))){const R=y(H(r.errors,m),D.argA,D.argB);T&&je(r.errors,m,R),Sd(r.errors,m)}if((h.touchedFields||p.touchedFields)&&_&&Array.isArray(H(r.touchedFields,m))){const R=y(H(r.touchedFields,m),D.argA,D.argB);T&&je(r.touchedFields,m,R)}(h.dirtyFields||p.dirtyFields)&&(r.dirtyFields=Jt(i,l)),j.state.next({name:m,isDirty:Z(m,f),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else je(l,m,f)},L=(m,f)=>{je(r.errors,m,f),j.state.next({errors:r.errors})},k=m=>{r.errors=m,j.state.next({errors:r.errors,isValid:!1})},P=(m,f,y,D)=>{const T=H(a,m);if(T){const _=H(l,m,ke(y)?H(i,m):y);ke(_)||D&&D.defaultChecked||f?je(l,m,f?_:_n(T._f)):ce(m,_),c.mount&&!c.action&&z()}},A=(m,f,y,D,T)=>{let _=!1,R=!1;const ae={name:m};if(!s.disabled){if(!y||D){(h.isDirty||p.isDirty)&&(R=r.isDirty,r.isDirty=ae.isDirty=Z(),_=R!==ae.isDirty);const le=rt(H(i,m),f);R=!!H(r.dirtyFields,m),le?_e(r.dirtyFields,m):je(r.dirtyFields,m,!0),ae.dirtyFields=r.dirtyFields,_=_||(h.dirtyFields||p.dirtyFields)&&R!==!le}if(y){const le=H(r.touchedFields,m);le||(je(r.touchedFields,m,y),ae.touchedFields=r.touchedFields,_=_||(h.touchedFields||p.touchedFields)&&le!==y)}_&&T&&j.state.next(ae)}return _?ae:{}},C=(m,f,y,D)=>{const T=H(r.errors,m),_=(h.isValid||p.isValid)&&ot(f)&&r.isValid!==f;if(s.delayError&&y?(g=Y(()=>L(m,y)),g(s.delayError)):(clearTimeout(x),g=null,y?je(r.errors,m,y):_e(r.errors,m)),(y?!rt(T,y):T)||!He(D)||_){const R={...D,..._&&ot(f)?{isValid:f}:{},errors:r.errors,name:m};r={...r,...R},j.state.next(R)}},$=async m=>{F(m,!0);const f=await s.resolver(l,s.context,bd(m||u.mount,a,s.criteriaMode,s.shouldUseNativeValidation));return F(m),f},V=async m=>{const{errors:f}=await $(m);if(m)for(const y of m){const D=H(f,y);D?je(r.errors,y,D):_e(r.errors,y)}else r.errors=f;return f},pe=async(m,f,y={valid:!0})=>{for(const D in m){const T=m[D];if(T){const{_f:_,...R}=T;if(_){const ae=u.array.has(_.name),le=T._f&&yd(T._f);le&&h.validatingFields&&F([_.name],!0);const De=await Rn(T,u.disabled,l,Q,s.shouldUseNativeValidation&&!f,ae);if(le&&h.validatingFields&&F([_.name]),De[_.name]&&(y.valid=!1,f))break;!f&&(H(De,_.name)?ae?Cd(r.errors,De,_.name):je(r.errors,_.name,De[_.name]):_e(r.errors,_.name))}!He(R)&&await pe(R,f,y)}}return y.valid},S=()=>{for(const m of u.unMount){const f=H(a,m);f&&(f._f.refs?f._f.refs.every(y=>!Dr(y)):!Dr(f._f.ref))&&te(m)}u.unMount=new Set},Z=(m,f)=>!s.disabled&&(m&&f&&je(l,m,f),!rt(Fe(),i)),B=(m,f,y)=>Hr(m,u,{...c.mount?l:ke(f)?i:Je(m)?{[m]:f}:f},y,f),se=m=>ra(H(c.mount?l:i,m,s.shouldUnregister?H(i,m,[]):[])),ce=(m,f,y={})=>{const D=H(a,m);let T=f;if(D){const _=D._f;_&&(!_.disabled&&je(l,m,Ai(f,_)),T=sr(_.ref)&&Ze(f)?"":f,ki(_.ref)?[..._.ref.options].forEach(R=>R.selected=T.includes(R.value)):_.refs?_s(_.ref)?_.refs.forEach(R=>{(!R.defaultChecked||!R.disabled)&&(Array.isArray(T)?R.checked=!!T.find(ae=>ae===R.value):R.checked=T===R.value||!!T)}):_.refs.forEach(R=>R.checked=R.value===T):na(_.ref)?_.ref.value="":(_.ref.value=T,_.ref.type||j.state.next({name:m,values:Re(l)})))}(y.shouldDirty||y.shouldTouch)&&A(m,T,y.shouldTouch,y.shouldDirty,!0),y.shouldValidate&&Se(m)},xe=(m,f,y)=>{for(const D in f){if(!f.hasOwnProperty(D))return;const T=f[D],_=m+"."+D,R=H(a,_);(u.array.has(m)||Te(T)||R&&!R._f)&&!Bt(T)?xe(_,T,y):ce(_,T,y)}},ye=(m,f,y={})=>{const D=H(a,m),T=u.array.has(m),_=Re(f);je(l,m,_),T?(j.array.next({name:m,values:Re(l)}),(h.isDirty||h.dirtyFields||p.isDirty||p.dirtyFields)&&y.shouldDirty&&j.state.next({name:m,dirtyFields:Jt(i,l),isDirty:Z(m,_)})):D&&!D._f&&!Ze(_)?xe(m,_,y):ce(m,_,y),Pn(m,u)&&j.state.next({...r,name:m}),j.state.next({name:c.mount?m:void 0,values:Re(l)})},Ne=async m=>{c.mount=!0;const f=m.target;let y=f.name,D=!0;const T=H(a,y),_=le=>{D=Number.isNaN(le)||Bt(le)&&isNaN(le.getTime())||rt(le,H(l,y,le))},R=An(s.mode),ae=An(s.reValidateMode);if(T){let le,De;const N=f.type?_n(T._f):id(m),he=m.type===Nn.BLUR||m.type===Nn.FOCUS_OUT,Ce=!vd(T._f)&&!s.resolver&&!H(r.errors,y)&&!T._f.deps||Nd(he,H(r.touchedFields,y),r.isSubmitted,ae,R),_t=Pn(y,u,he);je(l,y,N),he?(!f||!f.readOnly)&&(T._f.onBlur&&T._f.onBlur(m),g&&g(0)):T._f.onChange&&T._f.onChange(m);const xt=A(y,N,he),Lt=!He(xt)||_t;if(!he&&j.state.next({name:y,type:m.type,values:Re(l)}),Ce)return(h.isValid||p.isValid)&&(s.mode==="onBlur"?he&&z():he||z()),Lt&&j.state.next({name:y,..._t?{}:xt});if(!he&&_t&&j.state.next({...r}),s.resolver){const{errors:Ge}=await $([y]);if(_(N),D){const Ut=On(r.errors,a,y),Vt=On(Ge,a,Ut.name||y);le=Vt.error,y=Vt.name,De=He(Ge)}}else F([y],!0),le=(await Rn(T,u.disabled,l,Q,s.shouldUseNativeValidation))[y],F([y]),_(N),D&&(le?De=!1:(h.isValid||p.isValid)&&(De=await pe(a,!0)));D&&(T._f.deps&&(!Array.isArray(T._f.deps)||T._f.deps.length>0)&&Se(T._f.deps),C(y,De,le,xt))}},Oe=(m,f)=>{if(H(r.errors,f)&&m.focus)return m.focus(),1},Se=async(m,f={})=>{let y,D;const T=Cs(m);if(s.resolver){const _=await V(ke(m)?m:T);y=He(_),D=m?!T.some(R=>H(_,R)):y}else m?(D=(await Promise.all(T.map(async _=>{const R=H(a,_);return await pe(R&&R._f?{[_]:R}:R)}))).every(Boolean),!(!D&&!r.isValid)&&z()):D=y=await pe(a);return j.state.next({...!Je(m)||(h.isValid||p.isValid)&&y!==r.isValid?{}:{name:m},...s.resolver||!m?{isValid:y}:{},errors:r.errors}),f.shouldFocus&&!D&&ks(a,Oe,m?T:u.mount),D},Fe=(m,f)=>{let y={...c.mount?l:i};return f&&(y=Ci(f.dirtyFields?r.dirtyFields:r.touchedFields,y)),ke(m)?y:Je(m)?H(y,m):m.map(D=>H(y,D))},v=(m,f)=>({invalid:!!H((f||r).errors,m),isDirty:!!H((f||r).dirtyFields,m),error:H((f||r).errors,m),isValidating:!!H(r.validatingFields,m),isTouched:!!H((f||r).touchedFields,m)}),re=m=>{m&&Cs(m).forEach(f=>_e(r.errors,f)),j.state.next({errors:m?r.errors:{}})},de=(m,f,y)=>{const D=(H(a,m,{_f:{}})._f||{}).ref,T=H(r.errors,m)||{},{ref:_,message:R,type:ae,...le}=T;je(r.errors,m,{...le,...f,ref:D}),j.state.next({name:m,errors:r.errors,isValid:!1}),y&&y.shouldFocus&&D&&D.focus&&D.focus()},Me=(m,f)=>at(m)?j.state.subscribe({next:y=>"values"in y&&m(B(void 0,f),y)}):B(m,f,!0),E=m=>j.state.subscribe({next:f=>{wd(m.name,f.name,m.exact)&&jd(f,m.formState||h,Ft,m.reRenderRoot)&&m.callback({values:{...l},...r,...f,defaultValues:i})}}).unsubscribe,G=m=>(c.mount=!0,p={...p,...m.formState},E({...m,formState:p})),te=(m,f={})=>{for(const y of m?Cs(m):u.mount)u.mount.delete(y),u.array.delete(y),f.keepValue||(_e(a,y),_e(l,y)),!f.keepError&&_e(r.errors,y),!f.keepDirty&&_e(r.dirtyFields,y),!f.keepTouched&&_e(r.touchedFields,y),!f.keepIsValidating&&_e(r.validatingFields,y),!s.shouldUnregister&&!f.keepDefaultValue&&_e(i,y);j.state.next({values:Re(l)}),j.state.next({...r,...f.keepDirty?{isDirty:Z()}:{}}),!f.keepIsValid&&z()},fe=({disabled:m,name:f})=>{(ot(m)&&c.mount||m||u.disabled.has(f))&&(m?u.disabled.add(f):u.disabled.delete(f))},nt=(m,f={})=>{let y=H(a,m);const D=ot(f.disabled)||ot(s.disabled);return je(a,m,{...y||{},_f:{...y&&y._f?y._f:{ref:{name:m}},name:m,mount:!0,...f}}),u.mount.add(m),y?fe({disabled:ot(f.disabled)?f.disabled:s.disabled,name:m}):P(m,!0,f.value),{...D?{disabled:f.disabled||s.disabled}:{},...s.progressive?{required:!!f.required,min:bs(f.min),max:bs(f.max),minLength:bs(f.minLength),maxLength:bs(f.maxLength),pattern:bs(f.pattern)}:{},name:m,onChange:Ne,onBlur:Ne,ref:T=>{if(T){nt(m,f),y=H(a,m);const _=ke(T.value)&&T.querySelectorAll&&T.querySelectorAll("input,select,textarea")[0]||T,R=pd(_),ae=y._f.refs||[];if(R?ae.find(le=>le===_):_===y._f.ref)return;je(a,m,{_f:{...y._f,...R?{refs:[...ae.filter(Dr),_,...Array.isArray(H(i,m))?[{}]:[]],ref:{type:_.type,name:m}}:{ref:_}}}),P(m,!1,void 0,_)}else y=H(a,m,{}),y._f&&(y._f.mount=!1),(s.shouldUnregister||f.shouldUnregister)&&!(od(u.array,m)&&c.action)&&u.unMount.add(m)}}},Ye=()=>s.shouldFocusError&&ks(a,Oe,u.mount),Ct=m=>{ot(m)&&(j.state.next({disabled:m}),ks(a,(f,y)=>{const D=H(a,y);D&&(f.disabled=D._f.disabled||m,Array.isArray(D._f.refs)&&D._f.refs.forEach(T=>{T.disabled=D._f.disabled||m}))},0,!1))},it=(m,f)=>async y=>{let D;y&&(y.preventDefault&&y.preventDefault(),y.persist&&y.persist());let T=Re(l);if(j.state.next({isSubmitting:!0}),s.resolver){const{errors:_,values:R}=await $();r.errors=_,T=Re(R)}else await pe(a);if(u.disabled.size)for(const _ of u.disabled)_e(T,_);if(_e(r.errors,"root"),He(r.errors)){j.state.next({errors:{}});try{await m(T,y)}catch(_){D=_}}else f&&await f({...r.errors},y),Ye(),setTimeout(Ye);if(j.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:He(r.errors)&&!D,submitCount:r.submitCount+1,errors:r.errors}),D)throw D},ge=(m,f={})=>{H(a,m)&&(ke(f.defaultValue)?ye(m,Re(H(i,m))):(ye(m,f.defaultValue),je(i,m,Re(f.defaultValue))),f.keepTouched||_e(r.touchedFields,m),f.keepDirty||(_e(r.dirtyFields,m),r.isDirty=f.defaultValue?Z(m,Re(H(i,m))):Z()),f.keepError||(_e(r.errors,m),h.isValid&&z()),j.state.next({...r}))},ht=(m,f={})=>{const y=m?Re(m):i,D=Re(y),T=He(m),_=T?i:D;if(f.keepDefaultValues||(i=y),!f.keepValues){if(f.keepDirtyValues){const R=new Set([...u.mount,...Object.keys(Jt(i,l))]);for(const ae of Array.from(R))H(r.dirtyFields,ae)?je(_,ae,H(l,ae)):ye(ae,H(_,ae))}else{if(sa&&ke(m))for(const R of u.mount){const ae=H(a,R);if(ae&&ae._f){const le=Array.isArray(ae._f.refs)?ae._f.refs[0]:ae._f.ref;if(sr(le)){const De=le.closest("form");if(De){De.reset();break}}}}if(f.keepFieldsRef)for(const R of u.mount)ye(R,H(_,R));else a={}}l=s.shouldUnregister?f.keepDefaultValues?Re(i):{}:Re(_),j.array.next({values:{..._}}),j.state.next({values:{..._}})}u={mount:f.keepDirtyValues?u.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},c.mount=!h.isValid||!!f.keepIsValid||!!f.keepDirtyValues||!s.shouldUnregister&&!He(_),c.watch=!!s.shouldUnregister,j.state.next({submitCount:f.keepSubmitCount?r.submitCount:0,isDirty:T?!1:f.keepDirty?r.isDirty:!!(f.keepDefaultValues&&!rt(m,i)),isSubmitted:f.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:T?{}:f.keepDirtyValues?f.keepDefaultValues&&l?Jt(i,l):r.dirtyFields:f.keepDefaultValues&&m?Jt(i,m):f.keepDirty?r.dirtyFields:{},touchedFields:f.keepTouched?r.touchedFields:{},errors:f.keepErrors?r.errors:{},isSubmitSuccessful:f.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},pt=(m,f)=>ht(at(m)?m(l):m,f),kt=(m,f={})=>{const y=H(a,m),D=y&&y._f;if(D){const T=D.refs?D.refs[0]:D.ref;T.focus&&(T.focus(),f.shouldSelect&&at(T.select)&&T.select())}},Ft=m=>{r={...r,...m}},Et={control:{register:nt,unregister:te,getFieldState:v,handleSubmit:it,setError:de,_subscribe:E,_runSchema:$,_focusError:Ye,_getWatch:B,_getDirty:Z,_setValid:z,_setFieldArray:J,_setDisabledField:fe,_setErrors:k,_getFieldArray:se,_reset:ht,_resetDefaultValues:()=>at(s.defaultValues)&&s.defaultValues().then(m=>{pt(m,s.resetOptions),j.state.next({isLoading:!1})}),_removeUnmounted:S,_disableForm:Ct,_subjects:j,_proxyFormState:h,get _fields(){return a},get _formValues(){return l},get _state(){return c},set _state(m){c=m},get _defaultValues(){return i},get _names(){return u},set _names(m){u=m},get _formState(){return r},get _options(){return s},set _options(m){s={...s,...m}}},subscribe:G,trigger:Se,register:nt,handleSubmit:it,watch:Me,setValue:ye,getValues:Fe,reset:pt,resetField:ge,clearErrors:re,unregister:te,setError:de,setFocus:kt,getFieldState:v};return{...Et,formControl:Et}}function mt(t={}){const s=we.useRef(void 0),r=we.useRef(void 0),[a,i]=we.useState({isDirty:!1,isValidating:!1,isLoading:at(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:at(t.defaultValues)?void 0:t.defaultValues});if(!s.current)if(t.formControl)s.current={...t.formControl,formState:a},t.defaultValues&&!at(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:c,...u}=Ed(t);s.current={...u,formState:a}}const l=s.current.control;return l._options=t,Si(()=>{const c=l._subscribe({formState:l._proxyFormState,callback:()=>i({...l._formState}),reRenderRoot:!0});return i(u=>({...u,isReady:!0})),l._formState.isReady=!0,c},[l]),we.useEffect(()=>l._disableForm(t.disabled),[l,t.disabled]),we.useEffect(()=>{t.mode&&(l._options.mode=t.mode),t.reValidateMode&&(l._options.reValidateMode=t.reValidateMode)},[l,t.mode,t.reValidateMode]),we.useEffect(()=>{t.errors&&(l._setErrors(t.errors),l._focusError())},[l,t.errors]),we.useEffect(()=>{t.shouldUnregister&&l._subjects.state.next({values:l._getWatch()})},[l,t.shouldUnregister]),we.useEffect(()=>{if(l._proxyFormState.isDirty){const c=l._getDirty();c!==a.isDirty&&l._subjects.state.next({isDirty:c})}},[l,a.isDirty]),we.useEffect(()=>{var c;t.values&&!rt(t.values,r.current)?(l._reset(t.values,{keepFieldsRef:!0,...l._options.resetOptions}),!((c=l._options.resetOptions)===null||c===void 0)&&c.keepIsValid||l._setValid(),r.current=t.values,i(u=>({...u}))):l._resetDefaultValues()},[l,t.values]),we.useEffect(()=>{l._state.mount||(l._setValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),s.current.formState=ud(a,l),s.current}const U=({children:t,className:s,variant:r="primary",icon:a,loading:i,disabled:l,...c})=>{const u={primary:"bg-slate-900 text-white hover:bg-slate-800",secondary:"bg-white text-slate-900 border border-slate-200 hover:border-slate-900",ghost:"bg-transparent text-slate-600 hover:text-slate-900",danger:"bg-rose-600 text-white hover:bg-rose-700"};return e.jsxs("button",{className:Nt("inline-flex items-center justify-center gap-2 rounded-xl px-4 py-2 text-sm font-semibold transition-all focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-900 disabled:opacity-60",u[r],s),disabled:l||i,...c,children:[i&&e.jsx("span",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white/30 border-l-white","aria-hidden":!0}),a,t]})},M=o.forwardRef(({label:t,className:s,helpText:r,icon:a,...i},l)=>e.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:[t&&e.jsx("span",{className:"font-medium text-slate-900",children:t}),e.jsxs("div",{className:"relative",children:[a&&e.jsx("span",{className:"pointer-events-none absolute inset-y-0 left-3 flex items-center text-slate-400",children:a}),e.jsx("input",{ref:l,className:Nt("w-full rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-slate-900 placeholder:text-slate-400 focus:border-slate-900 focus:outline-none",a&&"pl-10",s),...i})]}),r&&e.jsx("span",{className:"text-xs text-slate-400",children:r})]}));M.displayName="Input";const _d={email:"",password:"",role:"admin"},Ad=()=>{const{register:t,handleSubmit:s,formState:{isSubmitting:r}}=mt({defaultValues:_d}),{login:a,isAuthenticated:i}=Yr(),l=ar(),c=async u=>{await a(u),l("/",{replace:!0})};return o.useEffect(()=>{i&&l("/",{replace:!0})},[i,l]),i?null:e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 px-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-3xl border border-white/5 bg-white/10 p-8 backdrop-blur",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-white/70",children:"Fixzep"}),e.jsx("h1",{className:"mt-4 text-3xl font-bold text-white",children:"Admin Control Login"}),e.jsx("p",{className:"mt-2 text-sm text-white/70",children:"Use your admin credentials to access mission control."}),e.jsxs("form",{onSubmit:s(c),className:"mt-8 space-y-5",children:[e.jsx(M,{type:"email",label:"Email",placeholder:"admin@fixzep.com",...t("email",{required:!0}),className:"bg-white/90"}),e.jsx(M,{type:"password",label:"Password",placeholder:"",...t("password",{required:!0}),className:"bg-white/90"}),e.jsx(U,{type:"submit",loading:r,className:"w-full justify-center text-base",children:"Enter Dashboard"})]})]})})},Ke=({children:t,className:s,title:r,actions:a})=>e.jsxs("section",{className:Nt("rounded-2xl border border-white/60 bg-white/90 p-6 shadow-card backdrop-blur",s),children:[(r||a)&&e.jsxs("header",{className:"mb-4 flex items-center justify-between gap-4",children:[r&&e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:r}),a]}),t]}),qe=t=>new Intl.DateTimeFormat("en-IN",{dateStyle:"medium",timeStyle:"short"}).format(new Date(t)),Le=(t,s="INR")=>{const r=typeof t=="number"?t:0;return new Intl.NumberFormat("en-IN",{style:"currency",currency:s,maximumFractionDigits:2}).format(r)},Td=new Set(["completed","cancelled"]),Pd=()=>{var h;const{data:t=[],isLoading:s}=ve({queryKey:["orders","dashboard"],queryFn:()=>Ee.list()}),{data:r=[],isLoading:a}=ve({queryKey:["technicians","dashboard"],queryFn:()=>Xt.list()}),i=o.useMemo(()=>{const p=s?null:t.filter(Y=>!Td.has(Y.status)),j=p?p.filter(Y=>Y.status==="pending_assignment"):null,Q=a?null:r.filter(Y=>{var z;return((z=Y.todayAttendance)==null?void 0:z.status)==="present"});return[{label:"Open Orders",value:(p==null?void 0:p.length.toString())??"",delta:j?`${j.length} awaiting assignment`:"fetching",accent:p?"text-slate-900":"text-slate-400",link:"/orders"},{label:"Pending Assignments",value:(j==null?void 0:j.length.toString())??"",delta:p&&j?`${p.length-j.length} already scheduled`:"fetching",accent:j?j.length?"text-amber-600":"text-emerald-600":"text-slate-400",link:"/orders?status=pending_assignment"},{label:"Technicians Active",value:(Q==null?void 0:Q.length.toString())??"",delta:Q?`${r.length} on roster`:"fetching",accent:Q?Q.length?"text-emerald-600":"text-rose-600":"text-slate-400",link:"/technicians"}]},[t,r,s,a]),l=o.useMemo(()=>t.filter(p=>p.status==="pending_assignment"&&new Date(p.timeWindowStart).getTime()<Date.now()).sort((p,j)=>new Date(p.timeWindowStart).getTime()-new Date(j.timeWindowStart).getTime()),[t]),c=o.useMemo(()=>t.filter(p=>p.status==="rescheduled"||p.status==="awaiting_customer_approval"),[t]),u=o.useMemo(()=>r.filter(p=>!p.todayAttendance||p.todayAttendance.status!=="present"),[r]),g=[...l.slice(0,3).map(p=>({id:p._id,text:`${zr(p)} missed ${qe(p.timeWindowStart)} without technician assigned.`,link:`/orders?selected=${p._id}`})),...c.slice(0,2).map(p=>({id:`${p._id}-reschedule`,text:`${zr(p)} awaiting reschedule confirmation.`,link:`/orders?selected=${p._id}`}))],x=[l[0]?{text:Od(l[0],"Assign technician"),link:`/orders?selected=${l[0]._id}`}:null,u.length?{text:`Mark attendance for ${u[0].name} to include them in assignments.`,link:`/technicians?selected=${u[0].id}`}:null,c.length?{text:`Confirm reschedule for ${c[0].customer.name} (${(h=c[0].serviceItem)==null?void 0:h.name}).`,link:`/orders?selected=${c[0]._id}`}:null].filter(Boolean);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Mission Control"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Realtime Ops Snapshot"})]}),e.jsxs(Zt,{to:"/orders",className:"inline-flex items-center gap-2 rounded-2xl bg-slate-900 px-5 py-3 text-sm font-semibold text-white shadow-card",children:["Review Orders",e.jsx(po,{className:"h-4 w-4"})]})]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-3",children:i.map(p=>e.jsx(Zt,{to:p.link,className:"group",children:e.jsxs(Ke,{className:"transition-all duration-200 group-hover:shadow-lg group-hover:border-slate-200 group-hover:-translate-y-0.5",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:p.label}),e.jsx(mo,{className:"h-4 w-4 text-slate-300 transition-colors group-hover:text-slate-500"})]}),e.jsx("p",{className:`mt-3 text-3xl font-semibold ${p.accent}`,children:p.value}),e.jsx("p",{className:"mt-1 text-xs uppercase tracking-[0.3em] text-slate-400",children:p.delta})]})},p.label))}),e.jsx(Ke,{title:"Operations Heatmap",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-600",children:"Critical Alerts"}),g.length>0&&e.jsx(Zt,{to:"/orders",className:"text-xs text-slate-400 hover:text-slate-600 transition-colors",children:"View all "})]}),e.jsxs("ul",{className:"mt-4 space-y-3 text-sm",children:[g.length===0&&e.jsx("li",{className:"text-slate-400",children:"All clear. No SLA breaches detected."}),g.map(p=>e.jsx("li",{children:e.jsxs(Zt,{to:p.link,className:"text-slate-500 hover:text-slate-800 transition-colors cursor-pointer",children:[" ",p.text]})},p.id))]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-600",children:"Next Best Actions"}),x.length>0&&e.jsx(Zt,{to:"/orders",className:"text-xs text-slate-400 hover:text-slate-600 transition-colors",children:"View all "})]}),e.jsxs("ol",{className:"mt-4 space-y-3 text-sm",children:[x.length===0&&e.jsx("li",{className:"text-slate-400",children:"You're fully caught up for now."}),x.map((p,j)=>e.jsx("li",{children:e.jsxs(Zt,{to:p.link,className:"text-slate-500 hover:text-slate-800 transition-colors cursor-pointer",children:[j+1,". ",p.text]})},p.text))]})]})]})})]})},Od=(t,s="Update order")=>t?`${s} for ${zr(t)} scheduled ${qe(t.timeWindowStart)}.`:null,zr=t=>{var a,i;const s=((a=t.customer)==null?void 0:a.name)??"Customer",r=((i=t.serviceItem)==null?void 0:i.name)??"Service";return`${s} (${r})`},In={new:"bg-slate-100 text-slate-700",pending_assignment:"bg-amber-100 text-amber-800",assigned:"bg-blue-100 text-blue-800",in_progress:"bg-indigo-100 text-indigo-800",completed:"bg-emerald-100 text-emerald-700",cancelled:"bg-rose-100 text-rose-700",follow_up:"bg-orange-100 text-orange-800",unpaid:"bg-rose-100 text-rose-700",partially_paid:"bg-amber-100 text-amber-800",pending:"bg-slate-100 text-slate-700",partial:"bg-amber-100 text-amber-800",paid:"bg-emerald-100 text-emerald-700"},Ss=({variant:t="new",children:s})=>e.jsx("span",{className:Nt("rounded-full px-3 py-1 text-xs font-semibold capitalize",In[t]||In.new),children:s}),ze=o.forwardRef(({label:t,className:s,children:r,...a},i)=>e.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:[t&&e.jsx("span",{className:"font-medium text-slate-900",children:t}),e.jsx("select",{ref:i,className:Nt("w-full rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-slate-900 focus:border-slate-900 focus:outline-none",s),...a,children:r})]}));ze.displayName="Select";const Dt=o.forwardRef(({label:t,className:s,...r},a)=>e.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:[t&&e.jsx("span",{className:"font-medium text-slate-900",children:t}),e.jsx("textarea",{ref:a,className:Nt("w-full rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-slate-900 placeholder:text-slate-400 focus:border-slate-900 focus:outline-none",s),rows:r.rows||3,...r})]}));Dt.displayName="TextArea";const Dd={md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",xxl:"max-w-8xl"},Ue=({open:t,onClose:s,title:r,children:a,size:i="md",showCloseButton:l=!1})=>e.jsx(Gt,{appear:!0,show:t,as:o.Fragment,children:e.jsxs(es,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(Gt.Child,{as:o.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/50"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsx(Gt.Child,{as:o.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-150",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(es.Panel,{className:`w-full ${Dd[i]} transform rounded-2xl bg-white p-6 text-left align-middle shadow-xl`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx(es.Title,{as:"h3",className:"text-lg font-semibold text-slate-900",children:r}),l&&e.jsx("button",{type:"button",onClick:s,className:"rounded-full p-1 text-slate-500 transition hover:bg-slate-100 hover:text-slate-900","aria-label":"Close modal",children:""})]}),e.jsx("div",{className:"mt-4 space-y-4",children:a})]})})})})]})}),Pi=({open:t,onClose:s,title:r,children:a,widthClassName:i="w-screen max-w-lg"})=>e.jsx(Gt,{show:t,as:o.Fragment,appear:!0,children:e.jsxs(es,{as:"div",className:"relative z-[60]",onClose:()=>{},static:!0,children:[e.jsx(Gt.Child,{as:o.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 cursor-pointer",onClick:s,"aria-hidden":"true"})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"fixed inset-y-0 right-0 flex max-w-full pl-8",children:e.jsx(Gt.Child,{as:o.Fragment,enter:"transform transition ease-out duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in duration-200",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsx(es.Panel,{className:`pointer-events-auto ${i} bg-white shadow-2xl`,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-slate-100 px-6 py-4",children:[e.jsx("div",{children:e.jsx(es.Title,{className:"text-base font-semibold text-slate-900",children:r})}),e.jsxs("button",{type:"button",className:"rounded-full p-1 text-slate-400 transition hover:text-slate-600",onClick:s,children:[e.jsx("span",{className:"sr-only",children:"Close panel"}),e.jsx(ws,{className:"h-5 w-5"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:a})]})})})})})})]})}),ys=t=>t._id??`${t.dayOfWeek}-${t.startTime}-${t.endTime}-${t.label??""}`,Rd=t=>{const[s,r,a]=t.split("-"),i=Number(s),l=Number(r),c=Number(a);if(!Number.isFinite(i)||!Number.isFinite(l)||!Number.isFinite(c))return null;const u=new Date(i,l-1,c);return Number.isNaN(u.getTime())?null:u.getDay()},Id=[{value:"",label:"All statuses"},{value:"pending_assignment",label:"Pending assignment"},{value:"assigned",label:"Assigned"},{value:"in_progress",label:"In progress"},{value:"completed",label:"Completed"},{value:"cancellation_requested",label:"Cancellation requested"},{value:"follow_up",label:"Follow up"},{value:"unpaid",label:"Unpaid"},{value:"partially_paid",label:"Partially paid"}],Oi=[{value:"follow_up",label:"Follow up"},{value:"in_progress",label:"In progress"},{value:"completed",label:"Completed"}],Fd=Oi.map(t=>t.value),Di=[{value:"pending",label:"Pending"},{value:"partial",label:"Partially paid"},{value:"paid",label:"Paid"}],Ld=Di.map(t=>t.value),Qs=t=>{if(!t)return"";const s=t.replace(/_/g," ");return s.charAt(0).toUpperCase()+s.slice(1)},Md=t=>t?typeof t=="string"?t:t.name||"System":"System",Bd=t=>t?[t.addressLine1,t.addressLine2,t.city,t.state,t.postalCode].filter(Boolean).join(", "):"",Fn=(t,s=7)=>{const r=[];for(let a=0;a<s;a++){const i=new Date(t);i.setDate(t.getDate()+a),r.push(i)}return r},Ln=t=>t.toLocaleDateString("en-IN",{weekday:"short",day:"numeric",month:"short"}),$d=(t,s,r,a)=>{const[i,l]=s.split(":").map(Number),[c,u]=r.split(":").map(Number),g=new Date(t);g.setHours(i,l,0,0);const x=new Date(t);x.setHours(c,u,0,0);for(const h of a){const p=new Date(h.start),j=new Date(h.end);if(p<x&&j>g)return h}return null},lt=(t,s)=>{const[r,a]=s.split(":").map(Number),i=new Date(t);return i.setHours(r,a,0,0),i},qd=()=>{var Ta,Pa,Oa,Da,Ra,Ia,Fa,La,Ma,Ba,$a,qa,Ua,Va,Wa,Ha,Ka,Qa,za,Za,Ya,Ja,Xa,Ga,en,tn,sn,rn,an,nn,ln;const[t,s]=Kn(),[r,a]=o.useState(()=>t.get("status")||""),[i,l]=o.useState(!1),[c,u]=o.useState({order:null,open:!1}),[g,x]=o.useState({order:null,open:!1}),[h,p]=o.useState({order:null,open:!1}),[j,Q]=o.useState(()=>t.get("selected")),[Y,z]=o.useState({open:!1,url:"",name:""}),[F,J]=o.useState(100),[L,k]=o.useState(null),[P,A]=o.useState(""),[C,$]=o.useState(null),[V,pe]=o.useState(""),[S,Z]=o.useState(null),[B,se]=o.useState(""),[ce,xe]=o.useState(""),[ye,Ne]=o.useState(""),[Oe,Se]=o.useState(""),[Fe,v]=o.useState(""),[re,de]=o.useState(""),[Me,E]=o.useState(""),[G,te]=o.useState(""),[fe,nt]=o.useState(""),[Ye,Ct]=o.useState(""),[it,ge]=o.useState(""),[ht,pt]=o.useState("09:00"),[kt,Ft]=o.useState("11:00"),[qt,Et]=o.useState(""),[m,f]=o.useState(!1),[y,D]=o.useState({open:!1,technicianId:null,name:""}),[T,_]=o.useState(()=>{const n=new Date;return n.setHours(0,0,0,0),n}),[R,ae]=o.useState([]),[le,De]=o.useState(""),[N,he]=o.useState(""),[Ce,_t]=o.useState(""),[xt,Lt]=o.useState([]),[Ge,Ut]=o.useState([]),[Vt,dr]=o.useState(""),[la,oa]=o.useState(null),[ur,ca]=o.useState(!1),[Wt,da]=o.useState(""),[As,ua]=o.useState(""),[Ts,ma]=o.useState(!1),[Ht,ha]=o.useState(""),[pa,mr]=o.useState(!1),[rs,as]=o.useState(""),[ns,is]=o.useState(!1),[hr,ls]=o.useState(""),[xa,os]=o.useState(""),[pr,cs]=o.useState(""),[xr,ds]=o.useState(""),[fa,us]=o.useState(""),[Ps,ga]=o.useState("1"),Be=St(),{joinOrder:ba,leaveOrder:ya,isConnected:va}=ji(),ms=h.open&&((Ta=h.order)!=null&&Ta._id)?h.order._id:null;o.useEffect(()=>(ms&&va&&ba(ms),()=>{ms&&ya(ms)}),[ms,va,ba,ya]);const Os=()=>{u({order:null,open:!1}),D({open:!1,technicianId:null,name:""}),ae([])},Ri=n=>{ae([]),D({open:!0,technicianId:n.id,name:n.name||"Technician"})},ja=n=>{c.order&&Kt.mutate({orderId:c.order._id,technicianId:n})},{data:hs=[],isLoading:Ds}=ve({queryKey:["orders",r],queryFn:()=>Ee.list({status:r||void 0})});o.useEffect(()=>{if(j&&hs.length>0&&!Ds){const n=hs.find(b=>b._id===j);n&&p({order:n,open:!0}),Q(null);const d=new URLSearchParams(t);d.delete("selected"),s(d,{replace:!0})}},[hs,j,Ds,t,s]);const Ii=n=>{a(n);const d=new URLSearchParams(t);n?d.set("status",n):d.delete("status"),d.delete("selected"),s(d,{replace:!0})},{data:Fi=[]}=ve({queryKey:["categories"],queryFn:Ie.categories,enabled:i}),{data:Li=[]}=ve({queryKey:["service-items",fe],queryFn:()=>Ie.serviceItems(fe||void 0),enabled:i&&!!fe}),{data:fr=[]}=ve({queryKey:["spare-parts"],queryFn:vs.list,enabled:h.open}),{data:gr=[]}=ve({queryKey:["all-service-items"],queryFn:()=>Ie.serviceItems(),enabled:h.open}),{data:wa=[],isFetching:Na}=ve({queryKey:["order-technicians",(Pa=c.order)==null?void 0:Pa._id],queryFn:()=>Ee.candidates(c.order._id),enabled:c.open&&!!((Oa=c.order)!=null&&Oa._id)}),{data:Rs=[],isFetching:Is}=ve({queryKey:["technician-schedule",y.technicianId,T.toISOString()],queryFn:()=>{const n=new Date(T);return n.setDate(n.getDate()+7),Xt.schedule(y.technicianId,{start:T.toISOString(),end:n.toISOString()})},enabled:y.open&&!!y.technicianId}),{data:ft=[],isFetching:At}=ve({queryKey:["time-slots"],queryFn:()=>js.list(),enabled:g.open||y.open}),{data:q,isFetching:Mi,error:Bi}=ve({queryKey:["order-jobcard",(Da=h.order)==null?void 0:Da._id],queryFn:()=>Ee.jobCard(h.order._id),enabled:h.open&&!!((Ra=h.order)!=null&&Ra._id)}),X=(q==null?void 0:q.jobCard)??null,Ve=((Ia=q==null?void 0:q.order)==null?void 0:Ia.followUp)||null,br=(X==null?void 0:X.sparePartsUsed)??[],Fs=br.reduce((n,d)=>{var W;const b=(d==null?void 0:d.quantity)??0,O=(d==null?void 0:d.unitPrice)??(typeof(d==null?void 0:d.part)=="object"?((W=d.part)==null?void 0:W.unitPrice)??0:0);return n+b*O},0),Ls=((X==null?void 0:X.extraWork)??[]).reduce((n,d)=>n+((d==null?void 0:d.amount)??0),0),Ms=(Fa=q==null?void 0:q.order)==null?void 0:Fa.serviceItem,$i=typeof Ms=="string"?0:(Ms==null?void 0:Ms.basePrice)??0,Bs=(X==null?void 0:X.estimateAmount)??((La=q==null?void 0:q.order)==null?void 0:La.estimatedCost)??$i;o.useEffect(()=>{var d;console.log("Job Card Detail:",q),console.log("Job Card:",X);const n=(d=q==null?void 0:q.order)==null?void 0:d.status;n&&Fd.includes(n)?De(n):De("")},[(Ma=q==null?void 0:q.order)==null?void 0:Ma.status]),o.useEffect(()=>{X!=null&&X.paymentStatus&&Ld.includes(X.paymentStatus)?he(X.paymentStatus):he("")},[X==null?void 0:X.paymentStatus]),o.useEffect(()=>{if(!h.open){_t(""),Lt([]),Ut([]),dr("");return}Ve?(_t(Ve.reason||""),Lt(Ve.attachments||[])):le!=="follow_up"&&(_t(""),Lt([]))},[h.open,Ve==null?void 0:Ve.reason,(Ba=Ve==null?void 0:Ve.attachments)==null?void 0:Ba.length,le]);const $s=o.useMemo(()=>{var O;if(!q)return[];const n=[],{order:d}=q;((d==null?void 0:d.history)||[]).forEach((W,I)=>{if(!W)return;let ue="bg-blue-100",me=Qs(W.action)||"Update";switch(W.action){case"technician_checked_in":ue="bg-emerald-500",me="Technician Checked In";break;case"technician_checked_out":ue="bg-rose-500",me="Technician Checked Out";break;case"technician_progress_update":ue="bg-amber-500",me="Progress Update";break;case"technician_follow_up":ue="bg-orange-500",me="Follow Up Required";break;case"technician_assigned":ue="bg-indigo-500",me="Technician Assigned";break;case"order_rescheduled":ue="bg-purple-500",me="Order Rescheduled";break;case"order_created":ue="bg-slate-900",me="Order Created";break;default:ue="bg-blue-100"}n.push({id:`history-${I}`,title:me,description:[W.message,W.performedBy?`By ${Md(W.performedBy)}`:null].filter(Boolean).join("  "),timestamp:W.performedAt,accent:ue})}),(O=d==null?void 0:d.followUp)!=null&&O.reason&&(n.push({id:"follow-up-start",title:"Follow Up Requested",description:d.followUp.reason,timestamp:d.followUp.createdAt,accent:"bg-orange-500",attachments:d.followUp.attachments||[]}),d.followUp.resolvedAt&&n.push({id:"follow-up-resolved",title:"Follow Up Resolved",description:"Case moved out of follow up",timestamp:d.followUp.resolvedAt,accent:"bg-emerald-500"}));const b=W=>{if(!W)return Number.MAX_SAFE_INTEGER;const I=new Date(W).getTime();return Number.isNaN(I)?Number.MAX_SAFE_INTEGER:I};return n.sort((W,I)=>b(W.timestamp)-b(I.timestamp))},[q]),yr=(($a=q==null?void 0:q.order)==null?void 0:$a.media)??[],qi=yr.length>0||Ge.length>0,gt=o.useMemo(()=>{if(!P)return[];const n=Rd(P);return n===null?[]:ft.filter(d=>d.dayOfWeek===n)},[P,ft]),Tt=C&&gt.find(n=>ys(n)===C)||null,Mt=g.order,qs=(qa=Mt==null?void 0:Mt.preferredSlot)==null?void 0:qa.label,ps=le==="follow_up",ne=((Ua=q==null?void 0:q.order)==null?void 0:Ua.status)==="completed",Ui=n=>{if(ne){w.error("Completed job cards are view-only"),n.target.value="";return}const d=Array.from(n.target.files??[]);d.length&&(d.forEach(b=>{const O=new FileReader;O.onload=()=>{const W=O.result;typeof W=="string"&&Lt(I=>[...I,{url:W,kind:b.type.startsWith("video")?"video":"image",name:b.name}])},O.readAsDataURL(b)}),n.target.value="")},Vi=n=>{if(ne){w.error("Completed job cards are view-only"),n.target.value="";return}const d=Array.from(n.target.files??[]);d.length&&(d.forEach(b=>{const O=new FileReader;O.onload=()=>{const W=O.result;typeof W=="string"&&Ut(I=>[...I,{url:W,kind:b.type.startsWith("video")?"video":b.type.startsWith("image")?"image":"document",name:b.name}])},O.readAsDataURL(b)}),n.target.value="")},Wi=n=>{if(ne){w.error("Completed job cards are view-only");return}Ut(d=>d.filter((b,O)=>O!==n))},Hi=n=>{var d;if(ne){w.error("Completed job cards are view-only");return}if(!n){w.error("Unable to delete this file");return}if(!((d=h.order)!=null&&d._id)){w.error("Open an order before deleting documents");return}oa(n),jr.mutate({orderId:h.order._id,mediaId:n})},Ki=()=>{var n;if(ne){w.error("Completed job cards are view-only");return}if(!((n=h.order)!=null&&n._id)){w.error("Open an order before uploading documents");return}if(!Ge.length){w.error("Select at least one file to upload");return}vr.mutate({orderId:h.order._id,media:Ge})},Qi=n=>{if(ne){w.error("Completed job cards are view-only");return}Lt(d=>d.filter((b,O)=>O!==n))},zi=()=>{var n;if(ne){w.error("Completed job cards are view-only");return}if(!(!((n=h.order)!=null&&n._id)||!le)){if(ps){if(!Ce.trim()){w.error("Provide a follow-up reason");return}if(!xt.length){w.error("Attach at least one image or video");return}}if(le==="completed"&&(X==null?void 0:X.paymentStatus)!=="paid"){w.error("Set payment status to Paid before marking the job as completed");return}fs.mutate({orderId:h.order._id,status:le,reason:ps?Ce:void 0,attachments:ps?xt:void 0})}},Zi=()=>{var n;if(ne){w.error("Completed job cards are view-only");return}if(!(!((n=h.order)!=null&&n._id)||!N)){if(!X){w.error("Generate a job card before updating payment status");return}wr.mutate({orderId:h.order._id,status:N})}},Yi=()=>{var b;if(ne){w.error("Completed job cards are view-only");return}if(!((b=h.order)!=null&&b._id)){w.error("Open an order before adding spare parts");return}if(!Wt||!As){w.error("Please select a spare part and enter quantity");return}const n=parseFloat(As);if(isNaN(n)||n<=0){w.error("Quantity must be a positive number");return}const d=fr.find(O=>O._id===Wt);if(!d){w.error("Selected spare part not found");return}Ca.mutate({orderId:h.order._id,sparePart:{sparePartId:Wt,quantity:n,unitPrice:d.unitPrice}})},Ji=()=>{var O;if(ne){w.error("Completed job cards are view-only");return}if(!((O=h.order)!=null&&O._id)){w.error("Open an order before adding services");return}if(!Ht||!Ps){w.error("Please select a service and enter quantity");return}const n=parseFloat(Ps);if(isNaN(n)||n<=0){w.error("Quantity must be a positive number");return}const d=gr.find(W=>W._id===Ht);if(!d){w.error("Selected service not found");return}const b=(d.basePrice||0)*n;ka.mutate({orderId:h.order._id,service:{description:`${d.name} (x${n})`,amount:b,serviceItemId:Ht}})};o.useEffect(()=>{if(g.open&&g.order){const n=g.order.timeWindowStart?new Date(g.order.timeWindowStart).toISOString().split("T")[0]:"";A(n)}else A(""),$(null)},[g.open,g.order]),o.useEffect(()=>{var b,O;if(!g.open)return;if(!P){C!==null&&$(null);return}if(!gt.length){C!==null&&$(null);return}if(C&&gt.some(W=>ys(W)===C))return;const n=(O=(b=g.order)==null?void 0:b.preferredSlot)==null?void 0:O.label;if(n){const W=gt.find(I=>I.label===n);if(W){const I=ys(W);I!==C&&$(I);return}}const d=ys(gt[0]);d!==C&&$(d)},[g.open,P,gt,C,g.order]);const Kt=oe({mutationFn:({orderId:n,technicianId:d})=>Ee.assign(n,d),onMutate:({technicianId:n})=>k(n),onSuccess:()=>{w.success("Technician assigned"),Be.invalidateQueries({queryKey:["orders"]}),Os()},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Assignment failed")},onSettled:()=>k(null)}),xs=oe({mutationFn:async({orderId:n,technicianId:d,newStart:b,newEnd:O})=>(await Ee.reschedule(n,{newStart:b,newEnd:O}),Ee.assign(n,d)),onSuccess:()=>{w.success("Order rescheduled and technician assigned!"),Be.invalidateQueries({queryKey:["orders"]}),Be.invalidateQueries({queryKey:["technician-schedule"]}),Os()},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Failed to assign with new slot")}}),Sa=oe({mutationFn:({orderId:n,newStart:d,newEnd:b})=>Ee.reschedule(n,{newStart:d,newEnd:b}),onSuccess:()=>{w.success("Order rescheduled"),Be.invalidateQueries({queryKey:["orders"]}),x({order:null,open:!1})},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Reschedule failed")}}),fs=oe({mutationFn:({orderId:n,status:d,reason:b,attachments:O})=>Ee.changeStatus(n,{status:d,reason:b,attachments:O}),onSuccess:()=>{var n;w.success("Status updated"),(n=h.order)!=null&&n._id&&Be.invalidateQueries({queryKey:["order-jobcard",h.order._id]}),Be.invalidateQueries({queryKey:["orders"]})},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Unable to update status")}}),vr=oe({mutationFn:({orderId:n,media:d})=>Ee.uploadMedia(n,{media:d}),onSuccess:()=>{var n;w.success("Documents uploaded"),Ut([]),(n=h.order)!=null&&n._id&&Be.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Unable to upload documents")}}),jr=oe({mutationFn:({orderId:n,mediaId:d})=>Ee.deleteMedia(n,d),onSuccess:()=>{var n;w.success("Document removed"),(n=h.order)!=null&&n._id&&Be.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Unable to delete document")},onSettled:()=>oa(null)}),wr=oe({mutationFn:({orderId:n,status:d})=>Ee.updatePaymentStatus(n,{status:d}),onSuccess:()=>{var n;w.success("Payment status updated"),(n=h.order)!=null&&n._id&&Be.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Unable to update payment status")}}),Nr=oe({mutationFn:({orderId:n,message:d})=>Ee.addHistoryNote(n,{message:d}),onSuccess:(n,d)=>{w.success("Activity note added"),dr(""),Be.setQueryData(["order-jobcard",d.orderId],n)},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Unable to record note")}}),Ca=oe({mutationFn:({orderId:n,sparePart:d})=>Ee.addSparePart(n,d),onSuccess:(n,d)=>{w.success("Spare part added"),da(""),ua(""),ca(!1),Be.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Unable to add spare part")}}),ka=oe({mutationFn:({orderId:n,service:d})=>Ee.addAdditionalService(n,d),onSuccess:(n,d)=>{w.success("Additional service added"),ha(""),ga("1"),ma(!1),Be.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Unable to add service")}}),Ea=oe({mutationFn:({orderId:n,index:d})=>Ee.removeSparePart(n,d),onSuccess:(n,d)=>{w.success("Spare part removed"),Be.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Unable to remove spare part")}}),_a=oe({mutationFn:({orderId:n,index:d})=>Ee.removeAdditionalService(n,d),onSuccess:(n,d)=>{w.success("Additional service removed"),Be.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Unable to remove service")}}),Us=oe({mutationFn:({customerId:n,addressId:d,address:b})=>jt.updateAddress(n,{...b,addressId:d}),onSuccess:(n,d)=>{var b;w.success(d.addressId?"Order address updated":"New address added successfully"),mr(!1),is(!1),as(""),(b=h.order)!=null&&b._id&&Be.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Unable to update address")}}),Xi=oe({mutationFn:n=>jt.findByPhone(n),onSuccess:n=>{var d,b;if(n){Z(n),xe(n.name||""),Ne(n.email||"");const O=((d=n.addresses)==null?void 0:d.find(W=>W.isDefault))||((b=n.addresses)==null?void 0:b[0]);O?(se(O.id),Se(O.line1||""),v(O.line2||""),de(O.city||""),E(O.state||""),te(O.postalCode||"")):(Se(n.addressLine1||""),v(n.addressLine2||""),de(n.city||""),E(""),te(n.postalCode||"")),w.success("Customer found!")}else Z(null),se(""),xe(""),Ne(""),Se(""),v(""),de(""),E(""),te(""),w("Customer not found. Please enter details to create new customer.",{icon:""});f(!1)},onError:()=>{w.error("Failed to check customer"),f(!1)}}),Aa=oe({mutationFn:async n=>{if(!S){const d=await jt.create({name:ce,phone:V,email:ye,address:{line1:Oe,line2:Fe,city:re,state:Me,postalCode:G}});return Ee.create({...n,customerId:d.id})}return Ee.create(n)},onSuccess:()=>{w.success("Order created successfully!"),l(!1),Sr(),Be.invalidateQueries({queryKey:["orders"]})},onError:n=>{var d,b;return w.error(((b=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:b.message)||"Failed to create order")}}),Sr=()=>{pe(""),Z(null),se(""),xe(""),Ne(""),Se(""),v(""),de(""),E(""),te(""),nt(""),Ct(""),ge(""),pt("09:00"),Ft("11:00"),Et("")},Gi=n=>{var b;se(n);const d=(b=S==null?void 0:S.addresses)==null?void 0:b.find(O=>O.id===n);d&&(Se(d.line1||""),v(d.line2||""),de(d.city||""),E(d.state||""),te(d.postalCode||""))},el=()=>{if(!V.trim()){w.error("Please enter phone number");return}f(!0),Xi.mutate(V)},tl=()=>{if(!V||!ce||!Ye||!it){w.error("Please fill all required fields");return}const n=B,d=Oe&&re&&Me;if(!n&&!d){w.error("Please select an address or fill in address details");return}const b=new Date(`${it}T${ht}`),O=new Date(`${it}T${kt}`),W={customerId:S==null?void 0:S.id,serviceItem:Ye,scheduledAt:b.toISOString(),timeWindowStart:b.toISOString(),timeWindowEnd:O.toISOString(),issueDescription:qt,slotLabel:`${ht} - ${kt}`};B?W.addressId=B:d&&(W.address={line1:Oe,line2:Fe,city:re,state:Me,postalCode:G}),Aa.mutate(W)},sl=!((Va=h.order)!=null&&Va._id)||!le||fs.isPending||ps&&(!Ce.trim()||xt.length===0)||le==="completed"&&(X==null?void 0:X.paymentStatus)!=="paid"||ne,rl=!((Wa=h.order)!=null&&Wa._id)||!X||!N||wr.isPending||ne,al=!((Ha=h.order)!=null&&Ha._id)||!Vt.trim()||Nr.isPending||ne;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Live Orders"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Admin Assignment Console"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(U,{onClick:()=>l(!0),children:"+ Create Order"}),e.jsx(ze,{value:r,onChange:n=>Ii(n.target.value),children:Id.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))})]})]}),e.jsx(Ke,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs uppercase tracking-wide text-slate-500",children:[e.jsx("th",{className:"px-4 py-3",children:"Customer"}),e.jsx("th",{className:"px-4 py-3",children:"Service"}),e.jsx("th",{className:"px-4 py-3",children:"Schedule"}),e.jsx("th",{className:"px-4 py-3",children:"Technician"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3",children:"Payment"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[Ds&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-slate-400",children:"Loading orders"})}),!Ds&&hs.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-slate-400",children:"No orders found for this filter."})}),hs.map(n=>{var d,b;return e.jsxs("tr",{className:"text-sm cursor-pointer transition-colors hover:bg-slate-50",onClick:()=>p({order:n,open:!0}),children:[e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("p",{className:"font-semibold text-slate-900",children:n.customer.name}),e.jsx("p",{className:"text-xs text-slate-500",children:n.customer.city})]}),e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("p",{className:"font-medium text-slate-900",children:(d=n.serviceItem)==null?void 0:d.name}),e.jsx("p",{className:"text-xs text-slate-500",children:(b=n.serviceCategory)==null?void 0:b.name})]}),e.jsxs("td",{className:"px-4 py-4 text-sm text-slate-600",children:[qe(n.timeWindowStart),e.jsxs("span",{className:"block text-xs text-slate-400",children:[" ",qe(n.timeWindowEnd)]})]}),e.jsx("td",{className:"px-4 py-4",children:n.assignedTechnician?e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-emerald-600",children:n.assignedTechnician.name}),e.jsx("p",{className:"text-xs text-slate-500",children:"Assigned technician"})]}):e.jsx("p",{className:"text-xs text-slate-400",children:"Not assigned"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx(Ss,{variant:n.status,children:n.status.replace(/_/g," ")})}),e.jsx("td",{className:"px-4 py-4",children:n.paymentStatus?e.jsx(Ss,{variant:n.paymentStatus==="paid"?"emerald":n.paymentStatus==="partial"?"amber":"slate",children:Qs(n.paymentStatus)}):e.jsx("span",{className:"text-xs text-slate-400",children:""})}),e.jsx("td",{className:"px-4 py-4 text-right",children:n.status==="completed"?e.jsx("span",{className:"text-xs text-slate-400",children:"Completed"}):n.status==="cancellation_requested"?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(U,{variant:"secondary",onClick:O=>{O.stopPropagation();const W=window.prompt("Optional: Add a note for approving cancellation")||void 0;fs.mutate({orderId:n._id,status:"cancelled",reason:(W==null?void 0:W.trim())||void 0})},className:"text-xs",children:"Approve Cancel"}),e.jsx(U,{variant:"secondary",onClick:O=>{O.stopPropagation();const W=window.prompt("Optional: Add a note for rejecting cancellation")||void 0,I=n.assignedTechnician?"assigned":"pending_assignment";fs.mutate({orderId:n._id,status:I,reason:(W==null?void 0:W.trim())||void 0})},className:"text-xs",children:"Reject Cancel"})]}):e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(U,{variant:"secondary",onClick:O=>{O.stopPropagation(),x({order:n,open:!0})},className:"text-xs",children:"Reschedule"}),e.jsx(U,{onClick:O=>{O.stopPropagation(),u({order:n,open:!0})},className:"text-xs",children:n.assignedTechnician?"Reassign":"Assign"})]})})]},n._id)})]})]})})}),e.jsxs(Ue,{open:c.open,onClose:()=>{y.open||Os()},title:"Assign Technician",children:[e.jsxs("p",{className:"text-sm text-slate-500",children:["Technicians shown are certified for"," ",e.jsx("span",{className:"font-semibold text-slate-900",children:(Qa=(Ka=c.order)==null?void 0:Ka.serviceItem)==null?void 0:Qa.name})," and reflect real-time slot availability."]}),((za=c.order)==null?void 0:za.assignedTechnician)&&e.jsxs("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-800",children:["Currently assigned to ",e.jsx("span",{className:"font-semibold",children:c.order.assignedTechnician.name}),". Select another technician below to reassign."]}),Na&&e.jsx("p",{className:"text-sm text-slate-400",children:"Loading technician roster"}),!Na&&wa.length===0&&e.jsx("p",{className:"text-sm text-slate-400",children:"No technicians match this service yet. Add a profile from the Technicians tab."}),e.jsx("div",{className:"space-y-3",children:wa.map(n=>{var O,W,I,ue,me,$e,Qe;const d=(W=(O=c.order)==null?void 0:O.assignedTechnician)==null?void 0:W._id,b=d?d===n.id:!1;return e.jsxs("div",{className:`flex flex-col gap-4 rounded-2xl border p-4 shadow-sm sm:flex-row sm:items-start sm:justify-between ${b?"border-amber-200 bg-amber-50/60":"border-slate-100"}`,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("p",{className:"font-semibold text-slate-900",children:n.name||"Unnamed technician"}),e.jsx("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-xs font-semibold ${n.isAvailable?"bg-emerald-50 text-emerald-700":"bg-rose-50 text-rose-600"}`,children:n.isAvailable?e.jsxs(e.Fragment,{children:[e.jsx(wo,{className:"h-4 w-4"})," Available"]}):e.jsxs(e.Fragment,{children:[e.jsx(Go,{className:"h-4 w-4"})," Busy in slot"]})}),b&&e.jsx("span",{className:"rounded-full bg-amber-100 px-2 py-0.5 text-xs font-semibold text-amber-700",children:"Current"})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[(I=n.skills)!=null&&I.length?n.skills.slice(0,3).join(", "):"Generalist",typeof n.experienceYears=="number"&&`  ${n.experienceYears} yrs exp`,n.phone&&`  ${n.phone}`]}),((ue=n.workingHours)==null?void 0:ue.start)&&((me=n.workingHours)==null?void 0:me.end)&&e.jsxs("p",{className:"text-xs text-slate-400",children:["Preferred hours ",n.workingHours.start,"  ",n.workingHours.end]}),($e=n.serviceItems)!=null&&$e.length?e.jsxs("p",{className:"text-xs text-slate-400",children:["Services: ",n.serviceItems.map(et=>et.name).join(", ")]}):null]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:items-end",children:[e.jsx(U,{type:"button",variant:"secondary",icon:e.jsx(vo,{className:"h-4 w-4"}),onClick:()=>Ri(n),children:"Calendar"}),e.jsx(U,{type:"button",onClick:()=>ja(n.id),disabled:!n.isAvailable||b||Kt.isPending,loading:Kt.isPending&&L===n.id,children:(Qe=c.order)!=null&&Qe.assignedTechnician?"Reassign":"Assign"})]})]},n.id)})})]}),e.jsx(Ue,{open:g.open,onClose:()=>x({order:null,open:!1}),title:"Reschedule Order",children:Mt&&e.jsxs("form",{className:"space-y-5",onSubmit:n=>{if(n.preventDefault(),!P||!Tt){w.error("Select a date and a slot to reschedule");return}const d=(W,I)=>{const ue=I.length===5?`${I}:00`:I;return new Date(`${W}T${ue}`).toISOString()},b=d(P,Tt.startTime),O=d(P,Tt.endTime);Sa.mutate({orderId:Mt._id,newStart:b,newEnd:O})},children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Currently scheduled"}),e.jsxs("p",{className:"mt-2 text-sm font-semibold text-slate-900",children:[qe(Mt.timeWindowStart),e.jsx("span",{className:"mx-1 text-slate-400",children:""}),qe(Mt.timeWindowEnd)]}),qs&&e.jsxs("p",{className:"text-xs text-slate-500",children:["Slot: ",qs]}),e.jsx("p",{className:"mt-3 text-xs text-slate-500",children:"Rescheduling keeps the same service and technician assignment rules. Pick a new day & slot below so we can notify the customer and crew."})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(M,{type:"date",label:"Target date",value:P,min:new Date().toISOString().split("T")[0],onChange:n=>A(n.target.value),required:!0}),e.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 p-4 text-sm text-slate-600",children:P&&Tt?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-semibold text-slate-900",children:"New slot preview"}),e.jsxs("p",{children:[Tt.label||"Custom slot"," on ",new Date(P).toLocaleDateString("en-IN",{dateStyle:"medium"})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[Tt.startTime,"  ",Tt.endTime]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-semibold text-slate-900",children:"Awaiting selection"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Pick a date and slot to generate a fresh appointment window."})]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Available time slots"}),At&&e.jsx("p",{className:"mt-2 text-xs text-slate-400",children:"Loading slot templates"}),!At&&ft.length===0&&e.jsx("p",{className:"mt-2 text-xs text-rose-500",children:"No time slots configured yet. Create slots in the admin settings."}),!At&&ft.length>0&&!P&&e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Pick a date first to preview relevant slot templates."}),!At&&ft.length>0&&P&&gt.length===0&&e.jsxs("p",{className:"mt-2 text-xs text-amber-600",children:["No slot templates cover ",new Date(P).toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"short"}),"."]}),!At&&ft.length>0&&P&&gt.length>0&&e.jsx("div",{className:"mt-3 grid gap-3 sm:grid-cols-2",children:gt.map(n=>{const d=ys(n),b=d===C,O=qs&&n.label===qs;return e.jsxs("button",{type:"button",className:`rounded-2xl border px-4 py-3 text-left transition focus:outline-none ${b?"border-slate-900 bg-slate-900/5 shadow-sm":"border-slate-200 hover:border-slate-400"}`,onClick:()=>$(d),children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:n.label||`Slot ${n.dayOfWeek}`}),e.jsxs("p",{className:"text-xs text-slate-500",children:[n.startTime,"  ",n.endTime]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-[11px] uppercase tracking-wide",children:[b&&e.jsx("span",{className:"rounded-full bg-slate-900 px-2 py-0.5 text-white",children:"New choice"}),O&&e.jsx("span",{className:"rounded-full bg-emerald-100 px-2 py-0.5 text-emerald-700",children:"Current slot"}),typeof n.capacity=="number"&&e.jsxs("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-slate-600",children:[n.capacity," jobs"]})]})]},d)})})]}),e.jsx(U,{type:"submit",className:"w-full",disabled:!P||!Tt,loading:Sa.isPending,children:"Confirm reschedule"})]})}),e.jsxs(Ue,{open:h.open,onClose:()=>p({order:null,open:!1}),title:`Job card  ${((Ya=(Za=h.order)==null?void 0:Za.serviceItem)==null?void 0:Ya.name)??""}`,size:"xxl",showCloseButton:!0,children:[Mi&&e.jsx("p",{className:"text-sm text-slate-400",children:"Preparing printable job summary"}),Bi&&e.jsx("p",{className:"text-sm text-rose-500",children:"Unable to load job card. Please try again."}),q&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Fixzep Job Sheet"}),e.jsx("h3",{className:"text-2xl font-semibold text-slate-900",children:q.order.code||(X==null?void 0:X.id)||"Job Summary"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Status: ",e.jsx("span",{className:"font-semibold text-slate-900",children:(X==null?void 0:X.status)??"Not generated yet"})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(U,{type:"button",variant:"secondary",icon:e.jsx($o,{className:"h-4 w-4"}),onClick:()=>window.print(),disabled:!X,title:X?void 0:"Generate a job card before printing",children:"Print"})})]}),ne&&e.jsx("div",{className:"rounded-2xl border border-emerald-200 bg-emerald-50/80 p-4 text-sm text-emerald-800",children:"Job marked as completed. Chat, uploads, and status changes are locked for audit safety."}),!X&&e.jsx("div",{className:"rounded-2xl border border-dashed border-amber-200 bg-amber-50/60 p-4 text-sm text-amber-800",children:"No job card has been created for this order yet. Once the technician starts work, their updates will appear here."}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Customer & Property"}),!ne&&!pa&&e.jsx("button",{type:"button",onClick:()=>{mr(!0),is(!1),as(""),ls(""),os(""),cs(""),ds(""),us("")},className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"Change Address"})]}),e.jsx("h4",{className:"mt-2 text-lg font-semibold text-slate-900",children:q.order.customer.name}),e.jsx("p",{className:"text-sm text-slate-600",children:q.order.customer.phone}),e.jsx("p",{className:"text-sm text-slate-600",children:q.order.customer.email||"Email not provided"}),pa?e.jsxs("div",{className:"mt-3 space-y-3",children:[S!=null&&S.addresses&&((Ja=S==null?void 0:S.addresses)==null?void 0:Ja.length)>0&&!ns?e.jsxs(e.Fragment,{children:[e.jsxs(ze,{label:"Select Address",value:rs,onChange:n=>{var O;const d=n.target.value;as(d);const b=(O=S.addresses)==null?void 0:O.find(W=>W.id===d);b&&(ls(b.line1||""),os(b.line2||""),cs(b.city||""),ds(b.state||""),us(b.postalCode||""))},children:[e.jsx("option",{value:"",children:"Choose an existing address"}),S.addresses.map(n=>e.jsxs("option",{value:n.id,children:[n.label||"Address"," - ",n.line1,", ",n.city," ",n.isDefault?"(Default)":""]},n.id))]}),e.jsx("button",{type:"button",onClick:()=>{is(!0),as(""),ls(""),os(""),cs(""),ds(""),us("")},className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"+ Add New Address"})]}):null,(ns||!((Xa=S==null?void 0:S.addresses)!=null&&Xa.length)||rs)&&e.jsxs(e.Fragment,{children:[ns&&(S==null?void 0:S.addresses)&&S.addresses.length>0&&e.jsx("button",{type:"button",onClick:()=>{is(!1),ls(""),os(""),cs(""),ds(""),us("")},className:"text-xs text-slate-600 hover:text-slate-700",children:" Back to address list"}),e.jsx(M,{label:"Address Line 1 *",value:hr,onChange:n=>ls(n.target.value),placeholder:"Street address"}),e.jsx(M,{label:"Address Line 2",value:xa,onChange:n=>os(n.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(M,{label:"City *",value:pr,onChange:n=>cs(n.target.value),placeholder:"City"}),e.jsx(M,{label:"State *",value:xr,onChange:n=>ds(n.target.value),placeholder:"State"})]}),e.jsx(M,{label:"Postal Code",value:fa,onChange:n=>us(n.target.value),placeholder:"PIN Code"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{type:"button",onClick:()=>{var d;if(!rs&&!ns&&((d=S==null?void 0:S.addresses)!=null&&d.length)){w.error("Please select an address or add a new one");return}if(!hr.trim()||!pr.trim()||!xr.trim()){w.error("Please fill required address fields");return}const n=typeof q.order.customer=="string"?q.order.customer:q.order.customer._id||q.order.customer._id;if(!n){w.error("Customer ID not found");return}Us.mutate({customerId:n,addressId:rs||void 0,address:{line1:hr,line2:xa,city:pr,state:xr,postalCode:fa}})},loading:Us.isPending,disabled:Us.isPending,className:"flex-1",children:ns?"Add Address":rs?"Update Order Address":"Save"}),e.jsx(U,{type:"button",variant:"secondary",onClick:()=>{mr(!1),is(!1),as("")},disabled:Us.isPending,className:"flex-1",children:"Cancel"})]})]}):e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:e.jsx("p",{children:Bd(q.order.customer)||"Address not provided"})})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Documents & Photos"}),e.jsxs("label",{className:`mt-3 flex flex-col items-center justify-center rounded-2xl border-2 border-dashed px-4 py-6 text-center text-sm transition ${ne?"cursor-not-allowed border-slate-100 bg-slate-50 text-slate-400":"cursor-pointer border-slate-200 bg-slate-50/50 text-slate-500 hover:border-slate-400"}`,children:[e.jsx("input",{type:"file",className:"hidden",multiple:!0,onChange:Vi,disabled:ne}),e.jsx("span",{className:"font-semibold text-slate-900",children:"Drag & drop files"}),e.jsx("span",{className:"text-xs text-slate-500",children:"or click to browse"})]}),qi?e.jsxs("div",{className:"mt-4 space-y-5 text-sm",children:[yr.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Stored files"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-3",children:yr.map((n,d)=>e.jsxs("div",{className:"relative rounded-xl border border-slate-100 bg-white/70 overflow-hidden group",children:[n.kind==="image"?e.jsx("div",{className:"aspect-square cursor-pointer",onClick:()=>z({open:!0,url:n.url,name:n.name||`Image ${d+1}`}),children:e.jsx("img",{src:n.url,alt:n.name||`Image ${d+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity"})}):n.kind==="video"?e.jsx("div",{className:"aspect-square bg-slate-900",children:e.jsx("video",{src:n.url,className:"w-full h-full object-cover",controls:!0})}):e.jsxs("div",{className:"aspect-square flex flex-col items-center justify-center bg-slate-50 p-3",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("p",{className:"mt-2 text-xs text-slate-600 text-center truncate w-full px-2",children:n.name||"Document"})]}),!ne&&e.jsx("button",{type:"button",className:"absolute top-2 right-2 p-1 rounded-full bg-rose-600 hover:bg-rose-700 text-white shadow-lg transition-all opacity-0 group-hover:opacity-100",onClick:b=>{b.stopPropagation(),Hi(n._id)},disabled:!n._id||jr.isPending&&la!==n._id,title:"Delete",children:jr.isPending&&la===n._id?e.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx(ws,{className:"h-4 w-4"})})]},n._id??`${n.url}-${d}`))})]}),Ge.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Pending upload"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-3",children:Ge.map((n,d)=>e.jsxs("div",{className:"relative rounded-xl border border-dashed border-slate-200 bg-slate-50 overflow-hidden group",children:[n.kind==="image"?e.jsx("div",{className:"aspect-square cursor-pointer",onClick:()=>z({open:!0,url:n.url,name:n.name||`Image ${d+1}`}),children:e.jsx("img",{src:n.url,alt:n.name||`Image ${d+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity"})}):n.kind==="video"?e.jsx("div",{className:"aspect-square bg-slate-900",children:e.jsx("video",{src:n.url,className:"w-full h-full object-cover",controls:!0})}):e.jsxs("div",{className:"aspect-square flex flex-col items-center justify-center bg-slate-50 p-3",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("p",{className:"mt-2 text-xs text-slate-600 text-center truncate w-full px-2",children:n.name||"Document"})]}),!ne&&e.jsx("button",{type:"button",className:"absolute top-2 right-2 p-1 rounded-full bg-slate-700 hover:bg-slate-800 text-white shadow-lg transition-all opacity-0 group-hover:opacity-100",onClick:b=>{b.stopPropagation(),Wi(d)},disabled:ne,title:"Remove",children:e.jsx(ws,{className:"h-4 w-4"})})]},`${n.url}-${d}`))}),e.jsx(U,{type:"button",onClick:Ki,className:"mt-4 w-full",disabled:ne||!Ge.length||vr.isPending,loading:!ne&&vr.isPending,children:`Upload ${Ge.length} Document${Ge.length>1?"s":""}`})]})]}):e.jsx("p",{className:"mt-3 text-xs text-slate-500",children:"No documents uploaded yet."})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Service Details"}),e.jsx("h4",{className:"mt-2 text-lg font-semibold text-slate-900",children:typeof q.order.serviceItem=="string"?q.order.serviceItem:(Ga=q.order.serviceItem)==null?void 0:Ga.name}),e.jsx("p",{className:"text-sm text-slate-600",children:typeof q.order.serviceCategory=="string"?q.order.serviceCategory:((en=q.order.serviceCategory)==null?void 0:en.name)||"Category not tagged"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:q.order.serviceItem&&typeof q.order.serviceItem!="string"?q.order.serviceItem.description||q.order.issueDescription||"No description provided.":q.order.issueDescription||"No description provided."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Additional Services"}),!ne&&e.jsx(U,{variant:"secondary",onClick:()=>ma(!Ts),className:"text-xs",children:Ts?"Cancel":"+ Add Service"})]}),Ts&&e.jsxs("div",{className:"mt-3 space-y-3 rounded-lg border border-slate-200 bg-slate-50 p-3",children:[e.jsxs(ze,{label:"Select Service *",value:Ht,onChange:n=>ha(n.target.value),children:[e.jsx("option",{value:"",children:"Choose a service..."}),gr.map(n=>e.jsxs("option",{value:n._id,children:[n.name," - ",Le(n.basePrice||0)]},n._id))]}),e.jsx(M,{label:"Quantity",type:"number",placeholder:"1",value:Ps,onChange:n=>ga(n.target.value),min:"1",step:"1"}),Ht&&e.jsxs("div",{className:"rounded-lg bg-slate-100 p-2 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:"Total: "}),Le((((tn=gr.find(n=>n._id===Ht))==null?void 0:tn.basePrice)||0)*parseFloat(Ps||"1"))]}),e.jsx(U,{onClick:Ji,loading:ka.isPending,className:"w-full",children:"Add Service"})]}),X!=null&&X.extraWork&&X.extraWork.length>0?e.jsx("ul",{className:"mt-3 space-y-2 text-sm",children:X.extraWork.map((n,d)=>e.jsxs("li",{className:"flex items-center justify-between rounded-xl bg-slate-50 px-3 py-2",children:[e.jsx("span",{className:"text-slate-600",children:n.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:Le(n.amount)}),!ne&&e.jsx("button",{type:"button",onClick:b=>{var O;b.stopPropagation(),(O=h.order)!=null&&O._id&&_a.mutate({orderId:h.order._id,index:d})},className:"text-rose-500 hover:text-rose-700 transition-colors",disabled:_a.isPending,title:"Remove service",children:e.jsx(ts,{className:"h-4 w-4"})})]})]},`${n.description}-${d}`))}):Ts?null:e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"No additional services captured yet."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Activity Tracking"}),$s.length>0&&e.jsxs("span",{className:"text-xs text-slate-400",children:[$s.length," entries"]})]}),$s.length===0?e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"No activity recorded yet for this job."}):e.jsx("ol",{className:"mt-4 space-y-4 border-l border-slate-100 pl-4 max-h-64 overflow-y-auto pr-2",children:$s.map(n=>e.jsxs("li",{className:"relative pl-4",children:[e.jsx("span",{className:`absolute -left-2 top-2 block h-3 w-3 rounded-full ${n.accent||"bg-slate-300"}`}),e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:n.title}),n.description&&e.jsx("p",{className:"text-xs text-slate-500",children:n.description}),n.attachments&&n.attachments.length>0&&e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2",children:n.attachments.map((d,b)=>e.jsx("div",{className:"rounded-lg overflow-hidden border border-slate-100 bg-white",children:d.kind==="video"?e.jsx("video",{src:d.url,className:"w-full h-24 object-cover",controls:!0}):e.jsx("img",{src:d.url,alt:d.name||"Attachment",className:"w-full h-24 object-cover"})},`${d.url}-${b}`))}),n.timestamp&&e.jsx("p",{className:"text-[11px] text-slate-400",children:qe(n.timestamp)})]},n.id))}),e.jsxs("form",{className:"mt-4 space-y-3 rounded-2xl bg-slate-50/80 p-3",onSubmit:n=>{var b;if(n.preventDefault(),ne){w.error("Completed job cards are view-only");return}if(!((b=h.order)!=null&&b._id)){w.error("Open an order before logging activity");return}const d=Vt.trim();d&&Nr.mutate({orderId:h.order._id,message:d})},children:[e.jsx(Dt,{label:"Add a quick note",placeholder:"Share updates for finance, dispatch, or technicians",value:Vt,onChange:n=>dr(n.target.value),rows:3,disabled:ne}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("p",{className:"text-[11px] text-slate-500",children:ne?"Job completed  notes locked.":"Notes sync to the order history instantly."}),e.jsx(U,{type:"submit",className:"w-full sm:w-auto",disabled:al,loading:!ne&&Nr.isPending,children:"Send update"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Job & Payment Status"}),e.jsxs("div",{className:"mt-3 space-y-5",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-400",children:"Job progress"}),e.jsxs(ze,{value:le,onChange:n=>De(n.target.value),disabled:ne,children:[e.jsx("option",{value:"",children:"Select status"}),Oi.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]}),e.jsx(U,{type:"button",onClick:zi,disabled:sl,loading:!ne&&fs.isPending,children:"Update job status"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[e.jsx(Ss,{variant:q.order.status,children:Qs(q.order.status)||"Status"}),e.jsx("span",{children:"Last change synced to technicians and finance."})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-400",children:"Payment status"}),X?e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs(ze,{value:N,onChange:n=>he(n.target.value),disabled:ne,children:[e.jsx("option",{value:"",children:"Select payment status"}),Di.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]}),e.jsx(U,{type:"button",onClick:Zi,disabled:rl,loading:!ne&&wr.isPending,children:"Update payment status"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[e.jsx(Ss,{variant:X.paymentStatus??"pending",children:Qs(X.paymentStatus)||"Pending"}),e.jsx("span",{children:"Tracks what finance should collect."})]}),q.paymentBalance&&e.jsxs("div",{className:"mt-4 space-y-2 rounded-xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-400 font-semibold",children:"Payment Balance"}),e.jsxs("div",{className:"space-y-1.5 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Total Due"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Le(q.paymentBalance.totalDue)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Total Paid"}),e.jsx("span",{className:"font-semibold text-emerald-600",children:Le(q.paymentBalance.totalPaid)})]}),q.paymentBalance.remainingBalance>0&&e.jsxs("div",{className:"flex items-center justify-between border-t border-slate-200 pt-1.5",children:[e.jsx("span",{className:"text-slate-600",children:"Remaining Balance"}),e.jsx("span",{className:"font-bold text-red-600",children:Le(q.paymentBalance.remainingBalance)})]}),q.paymentBalance.paymentCount>0&&e.jsxs("div",{className:"text-xs text-slate-500 pt-1",children:[q.paymentBalance.paymentCount," payment",q.paymentBalance.paymentCount>1?"s":""," received"]})]})]})]}):e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Payment tracking unlocks once a job card is created."})]})]}),ps&&e.jsxs("div",{className:"mt-4 space-y-3 rounded-2xl border border-dashed border-rose-200 p-4",children:[e.jsx(Dt,{label:"Follow up reason",placeholder:"Explain why further follow up is required",value:Ce,onChange:n=>_t(n.target.value),disabled:ne}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Attach evidence (images/videos)"}),e.jsx("input",{type:"file",accept:"image/*,video/*",multiple:!0,onChange:Ui,disabled:ne,className:"hidden",id:"followup-file-input"}),e.jsxs("label",{htmlFor:"followup-file-input",className:`flex flex-col items-center justify-center rounded-2xl border-2 border-dashed px-4 py-6 text-center text-sm transition cursor-pointer ${ne?"border-slate-100 bg-slate-50 text-slate-400 cursor-not-allowed":"border-slate-200 bg-slate-50/50 text-slate-500 hover:border-slate-400"}`,children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"Drag & drop files"}),e.jsx("span",{className:"text-xs text-slate-500",children:"or click to browse"})]})]}),xt.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-3",children:xt.map((n,d)=>e.jsxs("div",{className:"relative rounded-xl border border-slate-100 bg-white/70 overflow-hidden group",children:[n.kind==="video"?e.jsx("div",{className:"aspect-square bg-slate-900",children:e.jsx("video",{src:n.url,className:"w-full h-full object-cover",controls:!0})}):e.jsx("div",{className:"aspect-square cursor-pointer",onClick:()=>z({open:!0,url:n.url,name:n.name||`Evidence ${d+1}`}),children:e.jsx("img",{src:n.url,alt:n.name||"Attachment",className:"w-full h-full object-cover hover:opacity-90 transition-opacity"})}),!ne&&e.jsx("button",{type:"button",className:"absolute top-2 right-2 p-1 rounded-full bg-rose-600 hover:bg-rose-700 text-white shadow-lg transition-all opacity-0 group-hover:opacity-100",onClick:b=>{b.stopPropagation(),Qi(d)},disabled:ne,title:"Remove",children:e.jsx(ws,{className:"h-4 w-4"})})]},`${n.name||"attachment"}-${d}`))}),e.jsx("p",{className:"text-[11px] text-rose-600",children:"Technician assignment will be cleared when a job enters follow up."})]}),le!=="follow_up"&&(Ve==null?void 0:Ve.reason)&&e.jsxs("div",{className:"mt-4 rounded-xl border border-dashed border-rose-100 bg-rose-50/60 p-3 text-xs text-rose-800",children:[e.jsx("p",{className:"font-semibold text-rose-900",children:"Follow up in progress"}),e.jsx("p",{className:"mt-1 text-rose-800",children:Ve.reason}),(sn=Ve.attachments)!=null&&sn.length?e.jsx("div",{className:"mt-3 grid gap-3 sm:grid-cols-2",children:Ve.attachments.map((n,d)=>e.jsxs("div",{className:"rounded-xl border border-rose-100 p-2",children:[n.kind==="video"?e.jsx("video",{controls:!0,className:"h-28 w-full rounded-lg object-cover",src:n.url}):e.jsx("img",{src:n.url,alt:n.name||"Follow up evidence",className:"h-28 w-full rounded-lg object-cover"}),e.jsx("p",{className:"mt-1 text-[11px] text-rose-700 truncate",children:n.name||`Attachment ${d+1}`})]},`existing-${d}`))}):null]}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Syncs both job card and order status for finance follow-ups."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-900/10 bg-gradient-to-br from-slate-900 to-slate-800 p-5 text-white",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-white/70",children:"Schedule"}),e.jsx("p",{className:"mt-2 text-lg font-semibold",children:((rn=q.order.preferredSlot)==null?void 0:rn.label)||"Scheduled slot"}),e.jsxs("p",{className:"mt-1 text-sm text-white/80",children:[q.order.timeWindowStart?qe(q.order.timeWindowStart):"",e.jsx("span",{className:"mx-1 text-white/50",children:""}),q.order.timeWindowEnd?qe(q.order.timeWindowEnd):""]}),(X==null?void 0:X.technician)&&e.jsxs("p",{className:"mt-2 text-xs text-white/70",children:["Technician:"," ",typeof X.technician=="string"?X.technician:X.technician.name," ",typeof X.technician!="string"?` ${X.technician.mobile??""}`:""]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Spare Parts / Cost Summary"}),!ne&&e.jsx(U,{variant:"secondary",onClick:()=>ca(!ur),className:"text-xs",children:ur?"Cancel":"+ Add Spare"})]}),ur&&e.jsxs("div",{className:"mt-3 space-y-3 rounded-lg border border-slate-200 bg-slate-50 p-3",children:[e.jsxs(ze,{label:"Select Spare Part *",value:Wt,onChange:n=>da(n.target.value),children:[e.jsx("option",{value:"",children:"Choose a spare part..."}),fr.map(n=>e.jsxs("option",{value:n._id,children:[n.name," (",n.sku,") - ",Le(n.unitPrice)]},n._id))]}),e.jsx(M,{label:"Quantity",type:"number",placeholder:"1",value:As,onChange:n=>ua(n.target.value),min:"1",step:"1"}),Wt&&e.jsxs("div",{className:"rounded-lg bg-slate-100 p-2 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:"Total: "}),Le((((an=fr.find(n=>n._id===Wt))==null?void 0:an.unitPrice)||0)*parseFloat(As||"1"))]}),e.jsx(U,{onClick:Yi,loading:Ca.isPending,className:"w-full",children:"Add Spare Part"})]}),br.length>0&&e.jsx("div",{className:"mt-3 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"text-xs uppercase tracking-wide text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2",children:"Item"}),e.jsx("th",{className:"px-3 py-2",children:"Qty"}),e.jsx("th",{className:"px-3 py-2",children:"Unit price"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Total"}),!ne&&e.jsx("th",{className:"px-3 py-2"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:br.map((n,d)=>{var I,ue,me;const b=typeof n.part=="string"?n.part:((I=n.part)==null?void 0:I.name)||((ue=n.part)==null?void 0:ue.sku)||"Part",O=(n==null?void 0:n.unitPrice)??(typeof(n==null?void 0:n.part)=="object"?((me=n.part)==null?void 0:me.unitPrice)??0:0),W=(n.quantity??0)*O;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 text-slate-700",children:b}),e.jsx("td",{className:"px-3 py-2 text-slate-500",children:n.quantity??0}),e.jsx("td",{className:"px-3 py-2 text-slate-500",children:Le(O)}),e.jsx("td",{className:"px-3 py-2 text-right font-semibold text-slate-900",children:Le(W)}),!ne&&e.jsx("td",{className:"px-3 py-2",children:e.jsx("button",{type:"button",onClick:$e=>{var Qe;$e.stopPropagation(),(Qe=h.order)!=null&&Qe._id&&Ea.mutate({orderId:h.order._id,index:d})},className:"text-rose-500 hover:text-rose-700 transition-colors",disabled:Ea.isPending,title:"Remove spare part",children:e.jsx(ts,{className:"h-4 w-4"})})})]},`${b}-${d}`)})})]})}),e.jsxs("div",{className:"mt-4 space-y-2 rounded-2xl bg-slate-50 p-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Service Price"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Le(Bs)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Spare Parts Subtotal"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Le(Fs)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Additional Services"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Le(Ls)})]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-slate-200 pt-2 text-slate-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Le(Bs+Fs+Ls)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Tax (18%)"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Le((Bs+Fs+Ls)*.18)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{className:"font-semibold text-emerald-600",children:["-",Le(0)]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t-2 border-slate-300 pt-2 text-base font-bold text-slate-900",children:[e.jsx("span",{children:"Grand Total"}),e.jsx("span",{className:"text-lg",children:Le((Bs+Fs+Ls)*1.18)})]})]})]})]})]})]})]}),e.jsxs(Pi,{open:y.open,onClose:()=>{Os()},title:`Calendar  ${y.name||""}`,widthClassName:"w-screen max-w-2xl",children:[c.order&&e.jsxs("div",{className:"mb-4 space-y-3",children:[e.jsxs("div",{className:"rounded-xl border border-blue-200 bg-blue-50 p-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-blue-600 font-semibold",children:"Assigning to order"}),e.jsxs("p",{className:"text-sm text-blue-900 mt-1",children:[(nn=c.order.serviceItem)==null?void 0:nn.name,"  ",(ln=c.order.customer)==null?void 0:ln.name]}),e.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:["Current slot: ",qe(c.order.timeWindowStart),"  ",qe(c.order.timeWindowEnd)]})]}),e.jsx("div",{className:`rounded-xl border-2 p-4 ${R.length>0?"border-emerald-400 bg-emerald-50":"border-slate-200 bg-slate-50"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:R.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-xs uppercase tracking-wide text-emerald-600 font-semibold",children:["Selected time slots (",R.length,")"]}),(()=>{const n=R[0],d=R.every(I=>I.date.toDateString()===n.date.toDateString()),b=[...R].sort((I,ue)=>{const me=lt(I.date,I.startTime).getTime(),$e=lt(ue.date,ue.startTime).getTime();return me-$e}),O=lt(b[0].date,b[0].startTime),W=lt(b[b.length-1].date,b[b.length-1].endTime);return e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm font-semibold text-emerald-900 mt-1",children:d?b[0].date.toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"short",year:"numeric"}):"Multiple days selected"}),e.jsxs("p",{className:"text-xs text-emerald-700 mt-0.5",children:["Effective window: ",O.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}),"  ",W.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})]}),e.jsx("ul",{className:"mt-2 space-y-1",children:b.map(I=>e.jsx("li",{className:"text-xs text-emerald-600",children:I.label||`${I.startTime} - ${I.endTime}`},`${I.date.toISOString()}-${I.startTime}-${I.endTime}`))}),(()=>{var $e,Qe;const I=($e=c.order)!=null&&$e.timeWindowStart?new Date(c.order.timeWindowStart):null,ue=(Qe=c.order)!=null&&Qe.timeWindowEnd?new Date(c.order.timeWindowEnd):null;return I&&ue&&O.getTime()===I.getTime()&&W.getTime()===ue.getTime()?e.jsx("p",{className:"text-xs text-emerald-800 mt-2 font-medium",children:" Same as current order window"}):e.jsx("p",{className:"text-xs text-amber-600 mt-2 font-medium",children:" Order will be rescheduled to this window"})})()]})})()]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500 font-semibold",children:"No slot selected"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:" Select an available time slot from the calendar below"})]})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(U,{onClick:()=>{if(!y.technicianId||!c.order||R.length===0)return;const n=R[0];if(!R.every($e=>$e.date.toDateString()===n.date.toDateString())){w.error("Please select slots from a single day");return}const b=[...R].sort(($e,Qe)=>{const et=lt($e.date,$e.startTime).getTime(),Vs=lt(Qe.date,Qe.startTime).getTime();return et-Vs}),O=lt(b[0].date,b[0].startTime),W=lt(b[b.length-1].date,b[b.length-1].endTime),I=c.order.timeWindowStart?new Date(c.order.timeWindowStart):null,ue=c.order.timeWindowEnd?new Date(c.order.timeWindowEnd):null;I&&ue&&O.getTime()===I.getTime()&&W.getTime()===ue.getTime()?ja(y.technicianId):xs.mutate({orderId:c.order._id,technicianId:y.technicianId,newStart:O.toISOString(),newEnd:W.toISOString()})},loading:xs.isPending||Kt.isPending,disabled:R.length===0||xs.isPending||Kt.isPending,className:"whitespace-nowrap",children:xs.isPending||Kt.isPending?"Assigning...":"Assign Technician"}),R.length>0&&e.jsx("button",{type:"button",onClick:()=>ae([]),className:"text-xs text-slate-500 hover:text-slate-700 transition-colors",children:"Clear selection"})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),n.preventDefault();const d=new Date(T);d.setDate(d.getDate()-7),_(d)},className:"px-3 py-1.5 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:" Previous"}),e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:[Ln(T)," - ",Ln(Fn(T,7)[6])]}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),n.preventDefault();const d=new Date(T);d.setDate(d.getDate()+7),_(d)},className:"px-3 py-1.5 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:"Next "})]}),(Is||At)&&e.jsx("p",{className:"text-sm text-slate-400 text-center py-8",children:"Loading calendar"}),!Is&&!At&&ft.length===0&&e.jsx("p",{className:"text-sm text-amber-600 text-center py-8",children:"No time slots configured. Add slots in admin settings."}),!Is&&!At&&ft.length>0&&e.jsx("div",{className:"space-y-1",onClick:n=>n.stopPropagation(),children:Fn(T,7).map(n=>{const d=n.getDay(),b=ft.filter(I=>I.dayOfWeek===d),O=n.toDateString()===new Date().toDateString(),W=n<new Date(new Date().setHours(0,0,0,0));return e.jsxs("div",{className:`rounded-xl border p-3 ${O?"border-blue-200 bg-blue-50/50":"border-slate-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("p",{className:`text-sm font-semibold ${O?"text-blue-900":"text-slate-900"}`,children:n.toLocaleDateString("en-IN",{weekday:"short",day:"numeric",month:"short"})}),O&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-blue-500 text-white px-2 py-0.5 rounded-full",children:"Today"}),W&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-slate-300 text-slate-600 px-2 py-0.5 rounded-full",children:"Past"})]}),b.length===0?e.jsx("p",{className:"text-xs text-slate-400 italic",children:"No slots configured for this day"}):e.jsx("div",{className:"grid grid-cols-2 gap-2",children:b.map(I=>{var cn,dn,un,mn;const ue=$d(n,I.startTime,I.endTime,Rs),me=ue!==null,$e=lt(n,I.startTime),Qe=lt(n,I.endTime),et=Qe<new Date,Vs=(cn=c.order)!=null&&cn.timeWindowStart?new Date(c.order.timeWindowStart):null,on=(dn=c.order)!=null&&dn.timeWindowEnd?new Date(c.order.timeWindowEnd):null,Cr=Vs&&on&&$e.getTime()===Vs.getTime()&&Qe.getTime()===on.getTime(),nl=!me&&!et&&c.order&&y.technicianId,bt=R.some(Qt=>Qt.date.toDateString()===n.toDateString()&&Qt.startTime===I.startTime&&Qt.endTime===I.endTime);return e.jsxs("button",{type:"button",disabled:me||et||!c.order,onClick:Qt=>{Qt.stopPropagation(),Qt.preventDefault(),nl&&ae(bt?zt=>zt.filter(kr=>!(kr.date.toDateString()===n.toDateString()&&kr.startTime===I.startTime&&kr.endTime===I.endTime)):zt=>zt.length>0&&zt[0].date.toDateString()!==n.toDateString()?(w.error("Please select slots from a single day"),zt):[...zt,{date:n,startTime:I.startTime,endTime:I.endTime,label:I.label||`${I.startTime} - ${I.endTime}`}])},className:`
                              relative p-2 rounded-lg text-left text-xs transition-all
                              ${me?"bg-rose-50 border border-rose-200 cursor-not-allowed":et?"bg-slate-50 border border-slate-200 cursor-not-allowed opacity-50":bt?"bg-blue-100 border-2 border-blue-500 ring-2 ring-blue-200 cursor-pointer":Cr?"bg-emerald-50 border-2 border-emerald-400 hover:bg-emerald-100 cursor-pointer":"bg-emerald-50/50 border border-emerald-200 hover:bg-emerald-100 hover:border-emerald-400 cursor-pointer"}
                            `,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`font-semibold ${me?"text-rose-700":et?"text-slate-400":bt?"text-blue-700":"text-emerald-700"}`,children:I.label||`${I.startTime} - ${I.endTime}`}),me&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-rose-100 text-rose-600 px-1.5 py-0.5 rounded",children:"Blocked"}),bt&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-blue-500 text-white px-1.5 py-0.5 rounded",children:"Selected"}),!me&&!et&&!bt&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-emerald-100 text-emerald-600 px-1.5 py-0.5 rounded",children:"Available"})]}),e.jsxs("p",{className:`mt-1 ${me?"text-rose-600":et?"text-slate-400":bt?"text-blue-600":"text-emerald-600"}`,children:[I.startTime,"  ",I.endTime]}),me&&ue&&e.jsx("div",{className:"mt-2 pt-2 border-t border-rose-200",children:((mn=(un=ue.order)==null?void 0:un.customer)==null?void 0:mn.name)&&e.jsx("p",{className:"text-rose-600 truncate",children:ue.order.customer.name})}),!me&&!et&&c.order&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-emerald-200",children:[e.jsx("p",{className:`font-medium ${bt?"text-blue-700":"text-emerald-700"}`,children:bt?' Click "Assign Technician" above':Cr?" Current order slot":"Click to select"}),!Cr&&!bt&&e.jsx("p",{className:"text-emerald-600 text-[10px]",children:"Will reschedule order"})]})]},`${n.toISOString()}-${I.startTime}-${I.endTime}`)})})]},n.toISOString())})}),xs.isPending&&e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl flex items-center gap-3",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"text-slate-700 font-medium",children:"Rescheduling and assigning"})]})}),!Is&&Rs.length>0&&e.jsxs("div",{className:"mt-6 pt-4 border-t border-slate-200",children:[e.jsxs("p",{className:"text-xs uppercase tracking-wide text-slate-500 font-semibold mb-3",children:["Blocked entries (",Rs.length,")"]}),e.jsx("ol",{className:"space-y-2 max-h-48 overflow-y-auto",children:Rs.map(n=>{var b,O,W,I,ue,me;const d=typeof((b=n.order)==null?void 0:b.serviceItem)=="string"?(O=n.order)==null?void 0:O.serviceItem:(I=(W=n.order)==null?void 0:W.serviceItem)==null?void 0:I.name;return e.jsxs("li",{className:"rounded-lg border border-slate-100 p-2 text-xs",children:[e.jsxs("p",{className:"font-semibold text-slate-900",children:[qe(n.start)," ",e.jsx("span",{className:"text-slate-400",children:""})," ",qe(n.end)]}),e.jsxs("p",{className:"text-slate-500",children:[d||"Blocked slot",(me=(ue=n.order)==null?void 0:ue.customer)!=null&&me.name?`  ${n.order.customer.name}`:""]})]},n.id)})})]})]}),e.jsx(Ue,{open:i,onClose:()=>{l(!1),Sr()},title:"Create New Order",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Customer Information"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(M,{label:"Customer Phone Number",value:V,onChange:n=>pe(n.target.value),placeholder:"Enter phone number",disabled:m}),e.jsx(U,{onClick:el,loading:m,variant:"secondary",className:"mt-6",children:"Check"})]}),S&&e.jsxs("div",{className:"rounded-lg bg-emerald-50 p-3 text-sm text-emerald-800",children:[" Customer found: ",S.name]}),e.jsx(M,{label:"Customer Name *",value:ce,onChange:n=>xe(n.target.value),placeholder:"Enter customer name",disabled:!!(S&&ce)}),e.jsx(M,{label:"Email",type:"email",value:ye,onChange:n=>Ne(n.target.value),placeholder:"customer@email.com",disabled:!!(S&&ye)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Service Address"}),S&&S.addresses&&S.addresses.length>0&&e.jsxs(ze,{label:"Select Address *",value:B,onChange:n=>Gi(n.target.value),children:[e.jsx("option",{value:"",children:"Choose an address"}),S.addresses.map(n=>e.jsxs("option",{value:n.id,children:[n.label||"Address"," - ",n.line1,", ",n.city," ",n.isDefault?"(Default)":""]},n.id))]}),e.jsx(M,{label:"Address Line 1 *",value:Oe,onChange:n=>Se(n.target.value),placeholder:"Street address",disabled:!!(S&&Oe)}),e.jsx(M,{label:"Address Line 2",value:Fe,onChange:n=>v(n.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(M,{label:"City *",value:re,onChange:n=>de(n.target.value),placeholder:"City",disabled:!!(S&&re)}),e.jsx(M,{label:"State *",value:Me,onChange:n=>E(n.target.value),placeholder:"State",disabled:!!(S&&Me)})]}),e.jsx(M,{label:"Postal Code",value:G,onChange:n=>te(n.target.value),placeholder:"PIN Code",disabled:!!(S&&G)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Service Details"}),e.jsxs(ze,{label:"Service Category *",value:fe,onChange:n=>{nt(n.target.value),Ct("")},children:[e.jsx("option",{value:"",children:"Select category"}),Fi.map(n=>e.jsx("option",{value:n._id,children:n.name},n._id))]}),e.jsxs(ze,{label:"Service Item *",value:Ye,onChange:n=>Ct(n.target.value),disabled:!fe,children:[e.jsx("option",{value:"",children:"Select service"}),Li.map(n=>e.jsx("option",{value:n._id,children:n.name},n._id))]}),e.jsx(Dt,{label:"Issue Description",value:qt,onChange:n=>Et(n.target.value),placeholder:"Describe the issue...",rows:3})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Schedule"}),e.jsx(M,{label:"Order Date *",type:"date",value:it,onChange:n=>ge(n.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(M,{label:"Start Time *",type:"time",value:ht,onChange:n=>pt(n.target.value)}),e.jsx(M,{label:"End Time *",type:"time",value:kt,onChange:n=>Ft(n.target.value)})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(U,{onClick:tl,loading:Aa.isPending,children:"Create Order"}),e.jsx(U,{variant:"secondary",onClick:()=>{l(!1),Sr()},children:"Cancel"})]})]})}),Y.open&&Wn.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[9999] flex flex-col bg-black/95 backdrop-blur-md animate-in fade-in duration-200",onClick:n=>{n.stopPropagation(),n.target===n.currentTarget&&(z({open:!1,url:"",name:""}),J(100))},onKeyDown:n=>{n.key==="Escape"&&(n.stopPropagation(),z({open:!1,url:"",name:""}),J(100))},tabIndex:-1,style:{isolation:"isolate"},children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-gradient-to-b from-black/60 to-transparent",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-semibold text-lg truncate",children:Y.name}),e.jsx("p",{className:"text-white/60 text-sm mt-0.5",children:"Click and drag to pan  Scroll to zoom"})]}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),z({open:!1,url:"",name:""}),J(100)},className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-all ml-4","aria-label":"Close image viewer",children:e.jsx(ws,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center overflow-auto p-8",onClick:n=>n.stopPropagation(),children:e.jsx("div",{className:"relative transition-transform duration-200 ease-out",style:{transform:`scale(${F/100})`,cursor:F>100?"move":"default"},children:e.jsx("img",{src:Y.url,alt:Y.name,className:"max-w-none shadow-2xl rounded-lg",style:{maxHeight:"80vh",maxWidth:F===100?"90vw":"none"},onClick:n=>n.stopPropagation(),onWheel:n=>{n.preventDefault();const d=n.deltaY>0?-10:10;J(b=>Math.min(Math.max(50,b+d),300))},draggable:!1})})}),e.jsxs("div",{className:"flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-t from-black/60 to-transparent",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm rounded-lg px-4 py-2",children:[e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),J(d=>Math.max(50,d-10))},disabled:F<=50,className:"p-2 rounded-lg hover:bg-white/10 text-white transition-all disabled:opacity-40 disabled:cursor-not-allowed",title:"Zoom out",children:e.jsx(Oo,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center gap-2 px-3",children:[e.jsx("input",{type:"range",min:"50",max:"300",step:"10",value:F,onChange:n=>J(Number(n.target.value)),className:"w-32 h-1 bg-white/20 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, rgb(59 130 246) 0%, rgb(59 130 246) ${(F-50)/250*100}%, rgba(255,255,255,0.2) ${(F-50)/250*100}%, rgba(255,255,255,0.2) 100%)`},onClick:n=>n.stopPropagation()}),e.jsxs("span",{className:"text-white font-medium text-sm min-w-[3.5rem] text-center",children:[F,"%"]})]}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),J(d=>Math.min(300,d+10))},disabled:F>=300,className:"p-2 rounded-lg hover:bg-white/10 text-white transition-all disabled:opacity-40 disabled:cursor-not-allowed",title:"Zoom in",children:e.jsx(Ro,{className:"h-5 w-5"})})]}),e.jsxs("button",{type:"button",onClick:n=>{n.stopPropagation(),J(100)},className:"px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white text-sm font-medium transition-all flex items-center gap-2",title:"Reset zoom",children:[e.jsx(xn,{className:"h-4 w-4"}),"Reset"]}),e.jsxs("button",{type:"button",onClick:n=>{n.stopPropagation(),window.open(Y.url,"_blank")},className:"px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium transition-all flex items-center gap-2",title:"Open in new tab",children:[e.jsx(xn,{className:"h-4 w-4"}),"Full Screen"]})]})]}),document.body)]})},Ud=()=>{const t=ar(),s=St(),[r,a]=o.useState(!1),[i,l]=o.useState(null),[c,u]=o.useState(!1),[g,x]=o.useState(null),h=mt({defaultValues:{name:"",description:"",imageUrl:""}}),p=h.watch("imageUrl"),j=S=>{var se;const Z=(se=S.target.files)==null?void 0:se[0];if(!Z)return;const B=new FileReader;B.onload=()=>{typeof B.result=="string"&&h.setValue("imageUrl",B.result,{shouldDirty:!0,shouldValidate:!0})},B.readAsDataURL(Z),S.target.value=""},{data:Q=[],isLoading:Y}=ve({queryKey:["categories"],queryFn:Ie.categories}),z=oe({mutationFn:S=>Ie.upsertCategory(S),onSuccess:()=>{w.success("Category saved"),s.invalidateQueries({queryKey:["categories"]}),h.reset(),a(!1)},onError:S=>{var Z,B;return w.error(((B=(Z=S==null?void 0:S.response)==null?void 0:Z.data)==null?void 0:B.message)||"Failed to save category")}}),F=oe({mutationFn:S=>Ie.updateCategory(i._id,S),onSuccess:()=>{w.success("Category updated successfully"),s.invalidateQueries({queryKey:["categories"]}),h.reset(),l(null),a(!1)},onError:S=>{var Z,B;return w.error(((B=(Z=S==null?void 0:S.response)==null?void 0:Z.data)==null?void 0:B.message)||"Failed to update category")}}),J=oe({mutationFn:S=>Ie.deleteCategory(S),onSuccess:()=>{w.success("Category deleted successfully"),s.invalidateQueries({queryKey:["categories"]}),u(!1),x(null)},onError:S=>{var Z,B;return w.error(((B=(Z=S==null?void 0:S.response)==null?void 0:Z.data)==null?void 0:B.message)||"Failed to delete category")}}),L=oe({mutationFn:({categoryId:S,isActive:Z})=>Ie.updateCategory(S,{isActive:Z}),onSuccess:(S,Z)=>{w.success(Z.isActive?"Category activated":"Category deactivated"),s.invalidateQueries({queryKey:["categories"]})},onError:S=>{var Z,B;return w.error(((B=(Z=S==null?void 0:S.response)==null?void 0:Z.data)==null?void 0:B.message)||"Failed to update status")}}),k=(S,Z)=>{Z.stopPropagation(),S._id&&L.mutate({categoryId:S._id,isActive:!(S.isActive??!0)})},P=()=>{l(null),h.reset({name:"",description:"",imageUrl:""}),a(!0)},A=(S,Z)=>{Z.stopPropagation(),l(S),h.reset({name:S.name,description:S.description||"",imageUrl:S.imageUrl||""}),a(!0)},C=(S,Z)=>{Z.stopPropagation(),x(S),u(!0)},$=S=>{i?F.mutate(S):z.mutate(S)},V=()=>{g!=null&&g._id&&J.mutate(g._id)},pe=()=>{a(!1),l(null),h.reset()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Catalog"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Service Categories & Workflows"})]}),e.jsx(U,{onClick:P,children:"Add Category"})]}),e.jsxs(Ke,{title:"Categories",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Click a category to manage its sub categories."}),Y&&e.jsx("p",{className:"mt-4 text-sm text-slate-400",children:"Loading categories"}),!Y&&Q.length===0&&e.jsx("p",{className:"mt-4 text-sm text-slate-400",children:"No categories yet. Create one using the form above."}),!Y&&Q.length>0&&e.jsx("div",{className:"mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:Q.map(S=>{const Z=S.isActive??!0;return e.jsxs("div",{className:`group relative flex flex-col items-center gap-3 rounded-2xl border bg-white p-6 text-center shadow-sm transition hover:-translate-y-1 hover:shadow-lg cursor-pointer ${Z?"border-slate-100 hover:border-slate-200":"border-slate-200 bg-slate-50 opacity-60"}`,onClick:()=>t(`/catalog/${S._id}`),children:[!Z&&e.jsx("div",{className:"absolute left-2 top-2",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 text-xs font-medium",children:"Inactive"})}),e.jsxs("div",{className:"absolute right-2 top-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{type:"button",onClick:B=>k(S,B),className:`p-1.5 rounded-lg bg-white/90 transition-colors shadow-sm ${Z?"text-amber-500 hover:text-amber-700 hover:bg-amber-50":"text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50"}`,title:Z?"Deactivate category":"Activate category",disabled:L.isPending,children:Z?e.jsx(Lr,{className:"h-4 w-4"}):e.jsx(Mr,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:B=>A(S,B),className:"p-1.5 rounded-lg bg-white/90 text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors shadow-sm",title:"Edit category",children:e.jsx(Rt,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:B=>C(S,B),className:"p-1.5 rounded-lg bg-white/90 text-rose-500 hover:text-rose-700 hover:bg-rose-50 transition-colors shadow-sm",title:"Delete category",children:e.jsx(ts,{className:"h-4 w-4"})})]}),S.imageUrl?e.jsx("img",{src:S.imageUrl,alt:S.name,className:`h-24 w-24 rounded-2xl object-cover ${Z?"":"grayscale"}`}):e.jsx("div",{className:"flex h-24 w-24 items-center justify-center rounded-2xl bg-slate-50 text-xs text-slate-400",children:"No image"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-900 group-hover:text-slate-700",children:S.name}),S.description&&e.jsx("p",{className:"mt-1 text-xs text-slate-500 line-clamp-2",children:S.description})]})]},S._id)})})]})]}),e.jsx(Ue,{open:r,onClose:pe,title:i?"Edit Category":"Add Category",children:e.jsxs("form",{className:"space-y-4",onSubmit:h.handleSubmit($),children:[e.jsx(M,{label:"Name *",placeholder:"Electrical",...h.register("name",{required:!0})}),e.jsx(Dt,{label:"Description",placeholder:"Household electrical repairs",...h.register("description")}),e.jsx(M,{type:"file",accept:"image/*",label:"Upload image",onChange:j}),p&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:p,alt:"Category preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(U,{type:"button",variant:"ghost",onClick:pe,children:"Cancel"}),e.jsx(U,{type:"submit",loading:z.isPending||F.isPending,children:i?"Update Category":"Save Category"})]})]})}),e.jsx(Ue,{open:c,onClose:()=>{u(!1),x(null)},title:"Delete Category",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-slate-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:g==null?void 0:g.name}),"? This action cannot be undone."]}),e.jsx("p",{className:"text-xs text-amber-600 bg-amber-50 p-3 rounded-lg",children:"Note: Categories with existing service items or orders cannot be deleted."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(U,{variant:"ghost",onClick:()=>{u(!1),x(null)},children:"Cancel"}),e.jsx(U,{variant:"primary",className:"!bg-rose-600 hover:!bg-rose-700",onClick:V,loading:J.isPending,children:"Delete Category"})]})]})})]})},Vd=()=>{const{categoryId:t}=Qn(),s=ar(),r=St(),a=t??"",[i,l]=o.useState(!1),[c,u]=o.useState(null),[g,x]=o.useState(!1),[h,p]=o.useState(null),[j,Q]=o.useState(!1),{data:Y=[],isLoading:z}=ve({queryKey:["categories"],queryFn:Ie.categories}),F=Y.find(E=>E._id===t),{data:J=[],isLoading:L}=ve({queryKey:["serviceItems",a],queryFn:()=>Ie.serviceItems(a),enabled:!!a}),k=mt({defaultValues:{category:a,name:"",description:"",basePrice:0,imageUrl:""}}),P=k.watch("imageUrl"),A=mt({defaultValues:{name:"",description:"",imageUrl:""}}),C=A.watch("imageUrl"),$=E=>{var fe;const G=(fe=E.target.files)==null?void 0:fe[0];if(!G)return;const te=new FileReader;te.onload=()=>{typeof te.result=="string"&&k.setValue("imageUrl",te.result,{shouldDirty:!0,shouldValidate:!0})},te.readAsDataURL(G),E.target.value=""},V=E=>{var fe;const G=(fe=E.target.files)==null?void 0:fe[0];if(!G)return;const te=new FileReader;te.onload=()=>{typeof te.result=="string"&&A.setValue("imageUrl",te.result,{shouldDirty:!0,shouldValidate:!0})},te.readAsDataURL(G),E.target.value=""};o.useEffect(()=>{a&&k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""})},[a,k]);const pe=oe({mutationFn:E=>Ie.upsertServiceItem(E),onSuccess:()=>{w.success("Sub category created"),r.invalidateQueries({queryKey:["serviceItems",a]}),k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""}),l(!1)},onError:E=>{var G,te;return w.error(((te=(G=E==null?void 0:E.response)==null?void 0:G.data)==null?void 0:te.message)||"Failed to create sub category")}}),S=oe({mutationFn:E=>Ie.updateServiceItem(c._id,E),onSuccess:()=>{w.success("Sub category updated"),r.invalidateQueries({queryKey:["serviceItems",a]}),k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""}),u(null),l(!1)},onError:E=>{var G,te;return w.error(((te=(G=E==null?void 0:E.response)==null?void 0:G.data)==null?void 0:te.message)||"Failed to update sub category")}}),Z=oe({mutationFn:E=>Ie.deleteServiceItem(E),onSuccess:()=>{w.success("Sub category deleted"),r.invalidateQueries({queryKey:["serviceItems",a]}),x(!1),p(null)},onError:E=>{var G,te;return w.error(((te=(G=E==null?void 0:E.response)==null?void 0:G.data)==null?void 0:te.message)||"Failed to delete sub category")}}),B=oe({mutationFn:E=>Ie.updateCategory(a,E),onSuccess:()=>{w.success("Category updated"),r.invalidateQueries({queryKey:["categories"]}),A.reset(),Q(!1)},onError:E=>{var G,te;return w.error(((te=(G=E==null?void 0:E.response)==null?void 0:G.data)==null?void 0:te.message)||"Failed to update category")}}),se=oe({mutationFn:({itemId:E,isActive:G})=>Ie.updateServiceItem(E,{isActive:G}),onSuccess:(E,G)=>{w.success(G.isActive?"Sub category activated":"Sub category deactivated"),r.invalidateQueries({queryKey:["serviceItems",a]})},onError:E=>{var G,te;return w.error(((te=(G=E==null?void 0:E.response)==null?void 0:G.data)==null?void 0:te.message)||"Failed to update status")}}),ce=oe({mutationFn:({isActive:E})=>Ie.updateCategory(a,{isActive:E}),onSuccess:(E,G)=>{w.success(G.isActive?"Category activated":"Category deactivated"),r.invalidateQueries({queryKey:["categories"]})},onError:E=>{var G,te;return w.error(((te=(G=E==null?void 0:E.response)==null?void 0:G.data)==null?void 0:te.message)||"Failed to update status")}}),xe=E=>{E._id&&se.mutate({itemId:E._id,isActive:!(E.isActive??!0)})},ye=()=>{F&&ce.mutate({isActive:!(F.isActive??!0)})},Ne=()=>{u(null),k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""}),l(!0)},Oe=E=>{u(E),k.reset({category:a,name:E.name,description:E.description||"",basePrice:E.basePrice||0,imageUrl:E.imageUrl||""}),l(!0)},Se=E=>{p(E),x(!0)},Fe=()=>{F&&(A.reset({name:F.name,description:F.description||"",imageUrl:F.imageUrl||""}),Q(!0))},v=E=>{c?S.mutate(E):pe.mutate({...E,category:a})},re=()=>{h!=null&&h._id&&Z.mutate(h._id)},de=()=>{l(!1),u(null),k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""})},Me=E=>{B.mutate(E)};return a?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(U,{variant:"ghost",icon:e.jsx(co,{className:"h-4 w-4"}),onClick:()=>s("/catalog"),children:"Back to catalog"}),e.jsxs("div",{className:"flex items-center gap-3",children:[(F==null?void 0:F.imageUrl)&&e.jsx("img",{src:F.imageUrl,alt:F.name,className:`h-12 w-12 rounded-xl object-cover ${F.isActive??!0?"":"grayscale opacity-60"}`}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Catalog"}),F&&!(F.isActive??!0)&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 text-xs font-medium",children:"Inactive"})]}),e.jsx("h1",{className:"mt-1 text-2xl font-bold text-slate-900",children:z?"Loading":(F==null?void 0:F.name)||"Category not found"}),(F==null?void 0:F.description)&&e.jsx("p",{className:"text-sm text-slate-500",children:F.description})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[F&&e.jsxs(e.Fragment,{children:[e.jsx(U,{variant:"secondary",onClick:ye,loading:ce.isPending,icon:F.isActive??!0?e.jsx(Lr,{className:"h-4 w-4"}):e.jsx(Mr,{className:"h-4 w-4"}),className:F.isActive??!0?"":"!bg-emerald-50 !text-emerald-700 !border-emerald-200",children:F.isActive??!0?"Deactivate":"Activate"}),e.jsx(U,{variant:"secondary",onClick:Fe,icon:e.jsx(Rt,{className:"h-4 w-4"}),children:"Edit Category"})]}),e.jsx(U,{onClick:Ne,disabled:!F,children:"Add Sub Category"})]})]}),!z&&!F&&e.jsx(Ke,{children:e.jsx("p",{className:"text-sm text-rose-500",children:"We couldn't find that category. It may have been deleted."})}),F&&e.jsxs(Ke,{title:`Sub Categories (${J.length})`,children:[L&&e.jsx("p",{className:"text-sm text-slate-400",children:"Loading sub categories"}),!L&&J.length===0&&e.jsx("p",{className:"text-sm text-slate-400",children:"No sub categories yet. Create one using the button above."}),!L&&J.length>0&&e.jsx("div",{className:"mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:J.map(E=>{const G=E.isActive??!0;return e.jsxs("div",{className:`group relative flex flex-col items-center gap-3 rounded-2xl border bg-white p-6 text-center shadow-sm ${G?"border-slate-100":"border-slate-200 bg-slate-50 opacity-60"}`,children:[!G&&e.jsx("div",{className:"absolute left-2 top-2",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 text-xs font-medium",children:"Inactive"})}),e.jsxs("div",{className:"absolute right-2 top-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{type:"button",onClick:()=>xe(E),className:`p-1.5 rounded-lg bg-white/90 transition-colors shadow-sm ${G?"text-amber-500 hover:text-amber-700 hover:bg-amber-50":"text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50"}`,title:G?"Deactivate sub category":"Activate sub category",disabled:se.isPending,children:G?e.jsx(Lr,{className:"h-4 w-4"}):e.jsx(Mr,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>Oe(E),className:"p-1.5 rounded-lg bg-white/90 text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors shadow-sm",title:"Edit sub category",children:e.jsx(Rt,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>Se(E),className:"p-1.5 rounded-lg bg-white/90 text-rose-500 hover:text-rose-700 hover:bg-rose-50 transition-colors shadow-sm",title:"Delete sub category",children:e.jsx(ts,{className:"h-4 w-4"})})]}),E.imageUrl?e.jsx("img",{src:E.imageUrl,alt:E.name,className:`h-20 w-20 rounded-2xl object-cover ${G?"":"grayscale"}`}):e.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-2xl bg-slate-50 text-xs text-slate-400",children:"No image"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-900",children:E.name}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2",children:E.description||""}),typeof E.basePrice=="number"&&e.jsxs("p",{className:"mt-1 text-sm font-medium text-slate-700",children:["Base ",E.basePrice.toFixed(2)]})]})]},E._id)})})]}),e.jsx(Ue,{open:i,onClose:de,title:c?"Edit Sub Category":"Add Sub Category",children:e.jsxs("form",{className:"space-y-4",onSubmit:k.handleSubmit(v),children:[e.jsx(M,{label:"Sub category name *",placeholder:"Fan installation",...k.register("name",{required:!0})}),e.jsx(Dt,{label:"Description",...k.register("description")}),e.jsx(M,{type:"file",accept:"image/*",label:"Upload image",onChange:$}),P&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:P,alt:"Sub category preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsx(M,{label:"Base price ()",type:"number",step:"0.01",...k.register("basePrice",{valueAsNumber:!0})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(U,{type:"button",variant:"ghost",onClick:de,children:"Cancel"}),e.jsx(U,{type:"submit",loading:pe.isPending||S.isPending,children:c?"Update Sub Category":"Save Sub Category"})]})]})}),e.jsx(Ue,{open:g,onClose:()=>{x(!1),p(null)},title:"Delete Sub Category",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-slate-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:h==null?void 0:h.name}),"? This action cannot be undone."]}),e.jsx("p",{className:"text-xs text-amber-600 bg-amber-50 p-3 rounded-lg",children:"Note: Sub categories with existing orders cannot be deleted."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(U,{variant:"ghost",onClick:()=>{x(!1),p(null)},children:"Cancel"}),e.jsx(U,{variant:"primary",className:"!bg-rose-600 hover:!bg-rose-700",onClick:re,loading:Z.isPending,children:"Delete Sub Category"})]})]})}),e.jsx(Ue,{open:j,onClose:()=>{Q(!1),A.reset()},title:"Edit Category",children:e.jsxs("form",{className:"space-y-4",onSubmit:A.handleSubmit(Me),children:[e.jsx(M,{label:"Name *",placeholder:"Electrical",...A.register("name",{required:!0})}),e.jsx(Dt,{label:"Description",placeholder:"Household electrical repairs",...A.register("description")}),e.jsx(M,{type:"file",accept:"image/*",label:"Upload image",onChange:V}),C&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:C,alt:"Category preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(U,{type:"button",variant:"ghost",onClick:()=>{Q(!1),A.reset()},children:"Cancel"}),e.jsx(U,{type:"submit",loading:B.isPending,children:"Update Category"})]})]})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(U,{variant:"ghost",onClick:()=>s("/catalog"),children:"Back to catalog"}),e.jsx("p",{className:"text-sm text-rose-500",children:"No category selected."})]})},Wd=()=>{const t=St(),[s,r]=o.useState(!1),[a,i]=o.useState(null),[l,c]=o.useState(!1),[u,g]=o.useState(null),x=mt({defaultValues:{name:"",sku:"",unitPrice:0,imageUrl:""}}),h=x.watch("imageUrl"),{data:p=[]}=ve({queryKey:["spareParts"],queryFn:vs.list}),j=C=>{var pe;const $=(pe=C.target.files)==null?void 0:pe[0];if(!$)return;const V=new FileReader;V.onload=()=>{typeof V.result=="string"&&x.setValue("imageUrl",V.result,{shouldDirty:!0,shouldValidate:!0})},V.readAsDataURL($),C.target.value=""},Q=oe({mutationFn:vs.upsert,onSuccess:()=>{w.success("Spare part saved"),t.invalidateQueries({queryKey:["spareParts"]}),x.reset(),r(!1)},onError:C=>{var $,V;return w.error(((V=($=C==null?void 0:C.response)==null?void 0:$.data)==null?void 0:V.message)||"Failed to save spare part")}}),Y=oe({mutationFn:C=>vs.update(a._id,C),onSuccess:()=>{w.success("Spare part updated successfully"),t.invalidateQueries({queryKey:["spareParts"]}),x.reset(),i(null),r(!1)},onError:C=>{var $,V;return w.error(((V=($=C==null?void 0:C.response)==null?void 0:$.data)==null?void 0:V.message)||"Failed to update spare part")}}),z=oe({mutationFn:C=>vs.delete(C),onSuccess:()=>{w.success("Spare part deleted successfully"),t.invalidateQueries({queryKey:["spareParts"]}),c(!1),g(null)},onError:C=>{var $,V;return w.error(((V=($=C==null?void 0:C.response)==null?void 0:$.data)==null?void 0:V.message)||"Failed to delete spare part")}}),F=()=>{i(null),x.reset({name:"",sku:"",unitPrice:0,imageUrl:""}),r(!0)},J=(C,$)=>{$.stopPropagation(),i(C),x.reset({name:C.name,sku:C.sku,unitPrice:C.unitPrice||0,imageUrl:C.imageUrl||""}),r(!0)},L=(C,$)=>{$.stopPropagation(),g(C),c(!0)},k=C=>{a?Y.mutate(C):Q.mutate(C)},P=()=>{u!=null&&u._id&&z.mutate(u._id)},A=()=>{r(!1),i(null),x.reset()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Inventory"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Spare Parts Management"})]}),e.jsx(U,{onClick:F,children:"Add Spare Part"})]}),e.jsx(Ke,{title:"Spare Parts Catalog",children:e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:p.length===0?e.jsx("p",{className:"col-span-full text-center text-sm text-slate-500",children:"No spare parts added yet"}):p.map(C=>{var $;return e.jsxs("div",{className:"group relative flex items-center gap-4 rounded-2xl border border-slate-100 p-4 transition hover:border-slate-200 hover:shadow-sm",children:[C.imageUrl?e.jsx("img",{src:C.imageUrl,alt:C.name,className:"h-16 w-16 rounded-lg object-cover"}):e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-lg bg-slate-50 text-xs text-slate-400",children:"No image"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900 truncate",children:C.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:["SKU: ",C.sku]}),e.jsxs("p",{className:"mt-1 text-sm font-medium text-slate-600",children:["",($=C.unitPrice)==null?void 0:$.toFixed(2)]})]}),e.jsxs("div",{className:"absolute right-2 top-2 flex gap-1 opacity-0 transition-opacity group-hover:opacity-100",children:[e.jsx("button",{type:"button",onClick:V=>J(C,V),className:"rounded-lg bg-white p-1.5 text-slate-600 shadow-sm transition hover:bg-slate-50 hover:text-blue-600",title:"Edit",children:e.jsx(Rt,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:V=>L(C,V),className:"rounded-lg bg-white p-1.5 text-slate-600 shadow-sm transition hover:bg-rose-50 hover:text-rose-600",title:"Delete",children:e.jsx(ts,{className:"h-4 w-4"})})]})]},C._id)})})})]}),e.jsx(Ue,{open:s,onClose:A,title:a?"Edit Spare Part":"Add Spare Part",children:e.jsxs("form",{className:"space-y-4",onSubmit:x.handleSubmit(k),children:[e.jsx(M,{label:"Name",...x.register("name",{required:!0})}),e.jsx(M,{label:"SKU",...x.register("sku",{required:!0}),disabled:!!a}),e.jsx(M,{type:"number",step:"0.01",label:"Unit price",...x.register("unitPrice",{valueAsNumber:!0,required:!0})}),e.jsx(M,{type:"file",accept:"image/*",label:"Upload image",onChange:j}),h&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:h,alt:"Spare part preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(U,{type:"button",variant:"secondary",onClick:A,children:"Cancel"}),e.jsx(U,{type:"submit",loading:Q.isPending||Y.isPending,children:a?"Update":"Save"})]})]})}),e.jsx(Ue,{open:l,onClose:()=>c(!1),title:"Delete Spare Part",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-slate-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:u==null?void 0:u.name}),"? This action cannot be undone."]}),e.jsx("p",{className:"text-xs text-amber-600",children:" This spare part may be referenced in existing job cards. Deleting it will not affect historical records but it will no longer be available for new orders."}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(U,{type:"button",variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx(U,{type:"button",variant:"danger",onClick:P,loading:z.isPending,children:"Delete"})]})]})})]})},Mn={name:"",email:"",phone:"",password:"",role:"technician",serviceItems:[],skills:[]},Hd=()=>{const t=St(),s=mt({defaultValues:Mn}),r=md({control:s.control,name:"role"}),{data:a=[]}=ve({queryKey:["technician-skills"],queryFn:Rr.list}),i=oe({mutationFn:fl.create,onSuccess:()=>{w.success("User created"),s.reset(Mn)},onError:u=>{var g,x;return w.error(((x=(g=u==null?void 0:u.response)==null?void 0:g.data)==null?void 0:x.message)||"Failed to create user")}});o.useEffect(()=>{r==="admin"&&(s.setValue("serviceItems",[]),s.setValue("skills",[]))},[r,s]);const l=mt({defaultValues:{name:"",description:""}}),c=oe({mutationFn:Rr.create,onSuccess:()=>{w.success("Skill saved"),l.reset(),t.invalidateQueries({queryKey:["technician-skills"]})},onError:u=>{var g,x;return w.error(((x=(g=u==null?void 0:u.response)==null?void 0:g.data)==null?void 0:x.message)||"Failed to save skill")}});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Team"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Create Admin / Technician"})]}),e.jsx(Ke,{children:e.jsxs("form",{className:"grid gap-4 md:grid-cols-2",onSubmit:s.handleSubmit(u=>i.mutate(u)),children:[e.jsx(M,{label:"Full name",...s.register("name",{required:!0})}),e.jsx(M,{label:"Email",type:"email",...s.register("email",{required:!0})}),e.jsx(M,{label:"Phone",...s.register("phone",{required:!0})}),e.jsx(M,{label:"Password",type:"password",...s.register("password",{required:!0})}),e.jsxs(ze,{label:"Role",...s.register("role",{required:!0}),children:[e.jsx("option",{value:"technician",children:"Technician"}),e.jsx("option",{value:"admin",children:"Admin"})]}),r==="technician"&&e.jsx("div",{className:"col-span-2 grid gap-6",children:e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{className:"font-medium text-slate-900",children:"Technician skills"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Pick applicable trade skills (electrician, plumber, pest control, etc.)."}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[a.map(u=>e.jsxs("label",{className:"flex items-center gap-2 rounded-xl border border-slate-200 p-3",children:[e.jsx("input",{type:"checkbox",value:u._id,...s.register("skills"),className:"accent-slate-900"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:u.name})]},u._id)),!a.length&&e.jsx("span",{className:"text-xs text-slate-400",children:"Add skill types below to start tagging technicians."})]})]})}),e.jsx(U,{type:"submit",loading:i.isPending,className:"col-span-2",children:"Create User"})]})}),e.jsxs(Ke,{title:"Manage Technician Skills",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Add or update the skill taxonomy used when creating technicians."}),e.jsxs("form",{className:"mt-4 grid gap-4 md:grid-cols-2",onSubmit:l.handleSubmit(u=>c.mutate(u)),children:[e.jsx(M,{label:"Skill name",placeholder:"Electrician",...l.register("name",{required:!0})}),e.jsx(M,{label:"Description",placeholder:"Optional",...l.register("description")}),e.jsx(U,{type:"submit",loading:c.isPending,className:"md:col-span-2",children:"Save Skill"})]})]})]})},zs={label:"",dayOfWeek:0,startTime:"09:00",endTime:"10:00",intervalMinutes:60,capacity:1,isActive:!0},Bn=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map((t,s)=>({label:t,value:s})),Kd=()=>{const t=St(),[s,r]=o.useState(null),a=mt({defaultValues:zs}),{data:i=[],isLoading:l}=ve({queryKey:["time-slots"],queryFn:js.list}),c=oe({mutationFn:({slotId:h,data:p})=>h?js.update(h,p):js.create(p),onSuccess:()=>{w.success(`Time slot ${s?"updated":"created"}`),t.invalidateQueries({queryKey:["time-slots"]}),r(null),a.reset(zs)},onError:h=>{var p,j;return w.error(((j=(p=h==null?void 0:h.response)==null?void 0:p.data)==null?void 0:j.message)||"Unable to save time slot")}}),u=oe({mutationFn:h=>js.remove(h),onSuccess:()=>{w.success("Time slot removed"),t.invalidateQueries({queryKey:["time-slots"]}),s&&s._id&&(r(null),a.reset(zs))},onError:h=>{var p,j;return w.error(((j=(p=h==null?void 0:h.response)==null?void 0:p.data)==null?void 0:j.message)||"Unable to delete slot")}});o.useEffect(()=>{s?a.reset({label:`${s.startTime}-${s.endTime}`,dayOfWeek:s.dayOfWeek,startTime:s.startTime,endTime:s.endTime,intervalMinutes:s.intervalMinutes??60,capacity:s.capacity??1,isActive:s.isActive??!0,_id:s._id}):a.reset(zs)},[s,a]);const g=h=>{const p={...h,intervalMinutes:h.intervalMinutes||60,capacity:h.capacity||1};c.mutate({slotId:s==null?void 0:s._id,data:p})},x=o.useMemo(()=>Bn.map(h=>({day:h,entries:i.filter(p=>p.dayOfWeek===h.value)})),[i]);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Scheduling"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Time Slot Templates"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Control reusable availability windows used by admin scheduling tooling."})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[360px,1fr]",children:[e.jsx(Ke,{title:s?"Edit Time Slot":"Create Time Slot",children:e.jsxs("form",{className:"space-y-4",onSubmit:a.handleSubmit(g),children:[e.jsx(M,{label:"Label",placeholder:"Morning Prime",...a.register("label")}),e.jsx(ze,{label:"Day of week",...a.register("dayOfWeek",{setValueAs:h=>Number(h)}),children:Bn.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(M,{type:"time",label:"Start",...a.register("startTime",{required:!0})}),e.jsx(M,{type:"time",label:"End",...a.register("endTime",{required:!0})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(M,{type:"number",label:"Interval (minutes)",min:15,step:15,...a.register("intervalMinutes",{valueAsNumber:!0,min:15})}),e.jsx(M,{type:"number",label:"Capacity",min:1,step:1,...a.register("capacity",{valueAsNumber:!0,min:1})})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 accent-slate-900",...a.register("isActive")}),"Active"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(U,{type:"submit",loading:c.isPending,className:"flex-1",children:s?"Update Slot":"Create Slot"}),s&&e.jsx(U,{type:"button",variant:"secondary",onClick:()=>r(null),children:"Cancel"})]})]})}),e.jsx(Ke,{title:"Configured Slots",children:l?e.jsx("p",{className:"text-sm text-slate-500",children:"Loading time slots"}):e.jsx("div",{className:"space-y-5",children:x.map(({day:h,entries:p})=>e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:h.label}),e.jsxs("div",{className:"mt-2 space-y-3",children:[p.length===0&&e.jsx("p",{className:"text-sm text-slate-300",children:"No slots configured."}),p.map(j=>e.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl border border-slate-100 bg-white p-4 shadow-sm sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:j.label||`${j.startTime}  ${j.endTime}`}),e.jsxs("p",{className:"text-xs text-slate-500",children:[j.startTime,"  ",j.endTime,"  every ",j.intervalMinutes,"m  capacity ",j.capacity]}),!j.isActive&&e.jsx("p",{className:"text-xs text-rose-500",children:"Inactive"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{variant:"secondary",onClick:()=>r(j),children:"Edit"}),e.jsx(U,{variant:"secondary",className:"text-rose-600",onClick:()=>j._id&&u.mutate(j._id),loading:u.isPending&&u.variables===j._id,children:"Delete"})]})]},j._id))]})]},h.value))})})]})]})},Qd=[{value:"present",label:"Present"},{value:"absent",label:"Absent"},{value:"on_leave",label:"On leave"}],zd=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"suspended",label:"Suspended"}],$n=()=>new Date().toISOString().split("T")[0],qn=(t,s)=>{if(!t||!s)return;const r=s.length===5?`${s}:00`:s;return new Date(`${t}T${r}`).toISOString()},Zd=()=>{var xe,ye,Ne,Oe,Se,Fe;const t=St(),[s,r]=Kn(),[a,i]=o.useState(null),[l,c]=o.useState(()=>s.get("selected")),[u,g]=o.useState(!1),[x,h]=o.useState(null),{data:p=[],isLoading:j}=ve({queryKey:["technicians"],queryFn:Xt.list}),{data:Q=[]}=ve({queryKey:["categories"],queryFn:Ie.categories,enabled:u}),{data:Y=[]}=ve({queryKey:["all-service-items"],queryFn:()=>Ie.serviceItems(),enabled:u}),{data:z=[]}=ve({queryKey:["technician-skills"],queryFn:Rr.list,enabled:u});o.useEffect(()=>{if(l&&p.length>0&&!j){const v=p.find(de=>de.id===l);v&&i(v),c(null);const re=new URLSearchParams(s);re.delete("selected"),r(re,{replace:!0})}},[p,l,j,s,r]);const{data:F=[],isFetching:J}=ve({queryKey:["technician-attendance",a==null?void 0:a.id],queryFn:()=>Xt.attendance(a.id),enabled:!!(a!=null&&a.id)}),L=mt({defaultValues:{date:$n(),status:"present",checkInTime:"09:00",checkOutTime:"18:00"}}),k=mt({defaultValues:{name:"",email:"",phone:"",status:"active",experienceYears:0,workingHoursStart:"08:00",workingHoursEnd:"20:00",selectedSkills:[],selectedServiceItems:[],selectedServiceCategories:[]}});o.useEffect(()=>{L.reset({date:$n(),status:"present",checkInTime:"09:00",checkOutTime:"18:00",note:""})},[L,a]);const P=oe({mutationFn:v=>{if(!a)throw new Error("Select a technician");return Xt.markAttendance(a.id,{date:v.date,status:v.status,checkInAt:qn(v.date,v.checkInTime),checkOutAt:qn(v.date,v.checkOutTime),note:v.note})},onSuccess:()=>{w.success("Attendance updated"),a&&t.invalidateQueries({queryKey:["technician-attendance",a.id]}),t.invalidateQueries({queryKey:["technicians"]})},onError:v=>{var re,de;return w.error(((de=(re=v==null?void 0:v.response)==null?void 0:re.data)==null?void 0:de.message)||"Unable to save attendance")}}),A=oe({mutationFn:v=>{if(!x)throw new Error("No technician selected");return Xt.update(x.id,{name:v.name,email:v.email,phone:v.phone,status:v.status,experienceYears:v.experienceYears,workingHours:{start:v.workingHoursStart,end:v.workingHoursEnd},skills:v.selectedSkills,serviceItems:v.selectedServiceItems,serviceCategories:v.selectedServiceCategories})},onSuccess:v=>{w.success("Technician updated successfully"),t.invalidateQueries({queryKey:["technicians"]}),g(!1),h(null),(a==null?void 0:a.id)===v.id&&i(v)},onError:v=>{var re,de;return w.error(((de=(re=v==null?void 0:v.response)==null?void 0:re.data)==null?void 0:de.message)||"Failed to update technician")}}),C=o.useMemo(()=>F.slice(0,10),[F]),$=(v,re)=>{var de,Me,E,G,te;re==null||re.stopPropagation(),h(v),k.reset({name:v.name||"",email:v.email||"",phone:v.phone||"",status:v.status||"active",experienceYears:v.experienceYears||0,workingHoursStart:((de=v.workingHours)==null?void 0:de.start)||"08:00",workingHoursEnd:((Me=v.workingHours)==null?void 0:Me.end)||"20:00",selectedSkills:((E=v.skills)==null?void 0:E.map(fe=>typeof fe=="string"?fe:fe.id||fe._id||"").filter(Boolean))||[],selectedServiceItems:((G=v.serviceItems)==null?void 0:G.map(fe=>fe.id||fe._id||"").filter(Boolean))||[],selectedServiceCategories:((te=v.serviceCategories)==null?void 0:te.map(fe=>fe.id||fe._id||"").filter(Boolean))||[]}),g(!0)},V=()=>{g(!1),h(null),k.reset()},pe=v=>{const re=k.getValues("selectedSkills");re.includes(v)?k.setValue("selectedSkills",re.filter(de=>de!==v)):k.setValue("selectedSkills",[...re,v])},S=v=>{const re=k.getValues("selectedServiceItems");re.includes(v)?k.setValue("selectedServiceItems",re.filter(de=>de!==v)):k.setValue("selectedServiceItems",[...re,v])},Z=v=>{const re=k.getValues("selectedServiceCategories");re.includes(v)?k.setValue("selectedServiceCategories",re.filter(de=>de!==v)):k.setValue("selectedServiceCategories",[...re,v])},B=k.watch("selectedSkills"),se=k.watch("selectedServiceItems"),ce=k.watch("selectedServiceCategories");return e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"flex flex-wrap items-end justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Operations"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Technician Roster"})]})}),e.jsx(Ke,{title:"Technicians",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs uppercase tracking-wide text-slate-500",children:[e.jsx("th",{className:"px-4 py-3",children:"Name"}),e.jsx("th",{className:"px-4 py-3",children:"Contact"}),e.jsx("th",{className:"px-4 py-3",children:"Skills"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3",children:"Today"}),e.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[j&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-6 text-center text-slate-400",children:"Loading technicians"})}),!j&&p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-6 text-center text-slate-400",children:"No technicians found. Create technician users to populate this list."})}),p.map(v=>{var re;return e.jsxs("tr",{className:"cursor-pointer transition hover:bg-slate-50",onClick:()=>i(v),children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:v.name}),e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-500",children:[v.phone||"",e.jsx("span",{className:"block text-xs text-slate-400",children:v.email||""})]}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-500",children:(re=v.skills)!=null&&re.length?v.skills.slice(0,3).join(", "):"Generalist"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`text-xs uppercase tracking-wide px-2 py-1 rounded-full ${v.status==="active"?"bg-emerald-50 text-emerald-700":v.status==="inactive"?"bg-slate-100 text-slate-600":"bg-rose-50 text-rose-700"}`,children:v.status||"active"})}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-500",children:v.todayAttendance?v.todayAttendance.status:"Not marked"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{type:"button",onClick:de=>$(v,de),className:"p-1.5 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors",title:"Edit technician",children:e.jsx(Rt,{className:"h-4 w-4"})})})]},v.id)})]})]})})}),e.jsx(Pi,{open:!!a,onClose:()=>i(null),title:(a==null?void 0:a.name)||"Technician",children:a&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-2xl border border-slate-200 p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Contact"}),e.jsx("p",{className:"text-base font-semibold text-slate-900",children:a.phone||""}),e.jsx("p",{className:"text-sm text-slate-500",children:a.email||""}),a.workingHours&&e.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["Hours ",a.workingHours.start||"--","  ",a.workingHours.end||"--"]})]}),e.jsx(U,{variant:"secondary",onClick:()=>$(a),icon:e.jsx(Rt,{className:"h-4 w-4"}),children:"Edit"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Skills"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:[(xe=a.skills)==null?void 0:xe.map(v=>e.jsx("span",{className:"rounded-full bg-emerald-50 px-3 py-1 text-emerald-700",children:v},v)),!((ye=a.skills)!=null&&ye.length)&&e.jsx("span",{className:"text-slate-400",children:"No skills tagged."})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Service items"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:[(Ne=a.serviceItems)==null?void 0:Ne.map(v=>e.jsx("span",{className:"rounded-full bg-slate-100 px-3 py-1",children:v.name},v.id||v.name)),!((Oe=a.serviceItems)!=null&&Oe.length)&&e.jsx("span",{className:"text-slate-400",children:"No service items mapped."})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Service categories"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:[(Se=a.serviceCategories)==null?void 0:Se.map(v=>e.jsx("span",{className:"rounded-full bg-blue-50 px-3 py-1 text-blue-700",children:v.name},v.id||v.name)),!((Fe=a.serviceCategories)!=null&&Fe.length)&&e.jsx("span",{className:"text-slate-400",children:"No categories mapped."})]})]})]}),e.jsx(Ke,{title:"Mark attendance",children:e.jsxs("form",{className:"space-y-4",onSubmit:L.handleSubmit(v=>P.mutate(v)),children:[e.jsx(M,{type:"date",label:"Date",...L.register("date",{required:!0})}),e.jsx(ze,{label:"Status",...L.register("status",{required:!0}),children:Qd.map(v=>e.jsx("option",{value:v.value,children:v.label},v.value))}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(M,{type:"time",label:"Check-in",...L.register("checkInTime")}),e.jsx(M,{type:"time",label:"Check-out",...L.register("checkOutTime")})]}),e.jsx(Dt,{label:"Notes",rows:3,...L.register("note")}),e.jsx(U,{type:"submit",loading:P.isPending,children:"Save attendance"})]})}),e.jsxs(Ke,{title:"Attendance history",children:[J&&e.jsx("p",{className:"text-sm text-slate-400",children:"Loading attendance"}),!J&&C.length===0&&e.jsx("p",{className:"text-sm text-slate-400",children:"No attendance records found."}),!J&&C.length>0&&e.jsx("ul",{className:"space-y-3",children:C.map(v=>e.jsxs("li",{className:"rounded-xl border border-slate-100 p-3",children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:[new Date(v.date).toLocaleDateString("en-IN",{weekday:"short",day:"numeric",month:"short"}),e.jsx("span",{className:"ml-2 text-xs uppercase tracking-wide text-slate-500",children:v.status})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[v.checkInAt?`In: ${qe(v.checkInAt)}`:"No check-in"," "," ",v.checkOutAt?`Out: ${qe(v.checkOutAt)}`:"No check-out"]}),v.note&&e.jsx("p",{className:"text-xs text-slate-500",children:v.note})]},v._id||v.date))})]})]})}),e.jsx(Ue,{open:u,onClose:V,title:`Edit ${(x==null?void 0:x.name)||"Technician"}`,size:"xl",children:e.jsxs("form",{className:"space-y-6",onSubmit:k.handleSubmit(v=>A.mutate(v)),children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(M,{label:"Name *",...k.register("name",{required:!0})}),e.jsx(M,{label:"Email",type:"email",...k.register("email")}),e.jsx(M,{label:"Phone",...k.register("phone")}),e.jsx(ze,{label:"Status",...k.register("status"),children:zd.map(v=>e.jsx("option",{value:v.value,children:v.label},v.value))})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Work Details"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsx(M,{label:"Experience (years)",type:"number",step:"0.5",min:"0",...k.register("experienceYears",{valueAsNumber:!0})}),e.jsx(M,{label:"Working hours start",type:"time",...k.register("workingHoursStart")}),e.jsx(M,{label:"Working hours end",type:"time",...k.register("workingHoursEnd")})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Skills"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[z.map(v=>e.jsx("button",{type:"button",onClick:()=>pe(v._id),className:`rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${B.includes(v._id)?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:v.name},v._id)),z.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No skills available. Create skills in settings."})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Service Categories"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Q.map(v=>e.jsx("button",{type:"button",onClick:()=>Z(v._id),className:`rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${ce.includes(v._id)?"bg-blue-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:v.name},v._id)),Q.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No categories available."})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Service Items (Sub-categories)"}),e.jsx("div",{className:"max-h-48 overflow-y-auto border border-slate-200 rounded-xl p-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Y.map(v=>e.jsx("button",{type:"button",onClick:()=>S(v._id),className:`rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${se.includes(v._id)?"bg-slate-900 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:v.name},v._id)),Y.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No service items available."})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(U,{type:"button",variant:"ghost",onClick:V,children:"Cancel"}),e.jsx(U,{type:"submit",loading:A.isPending,children:"Save Changes"})]})]})})]})},Yd=()=>{const[t,s]=o.useState(null),[r,a]=o.useState(!1),[i,l]=o.useState(!1),[c,u]=o.useState(!1),[g,x]=o.useState(null),[h,p]=o.useState(!1),[j,Q]=o.useState(""),[Y,z]=o.useState(""),[F,J]=o.useState(""),[L,k]=o.useState(""),[P,A]=o.useState(""),[C,$]=o.useState(""),[V,pe]=o.useState(""),[S,Z]=o.useState(""),[B,se]=o.useState(""),[ce,xe]=o.useState(""),[ye,Ne]=o.useState(""),[Oe,Se]=o.useState(""),[Fe,v]=o.useState(""),[re,de]=o.useState(""),[Me,E]=o.useState(""),[G,te]=o.useState(""),[fe,nt]=o.useState(""),Ye=St(),{data:Ct=[],isLoading:it}=ve({queryKey:["customers"],queryFn:jt.list}),{data:ge,refetch:ht}=ve({queryKey:["customer-details",t==null?void 0:t.phone],queryFn:()=>t!=null&&t.phone?jt.findByPhone(t.phone):null,enabled:!!(t&&r)}),{data:pt=[]}=ve({queryKey:["customer-orders",t==null?void 0:t.id],queryFn:()=>Ee.list({customerId:t.id}),enabled:!!(t&&r)}),kt=oe({mutationFn:N=>jt.update(t.id,N),onSuccess:N=>{w.success("Customer updated successfully"),Ye.invalidateQueries({queryKey:["customers"]}),Ye.invalidateQueries({queryKey:["customer-details"]}),l(!1),N&&s(N)},onError:N=>{var he,Ce;return w.error(((Ce=(he=N==null?void 0:N.response)==null?void 0:he.data)==null?void 0:Ce.message)||"Failed to update customer")}}),Ft=oe({mutationFn:N=>jt.updateAddress(t.id,N),onSuccess:()=>{w.success(g?"Address updated successfully":"Address added successfully"),Ye.invalidateQueries({queryKey:["customer-details"]}),u(!1),ae(),ht()},onError:N=>{var he,Ce;return w.error(((Ce=(he=N==null?void 0:N.response)==null?void 0:he.data)==null?void 0:Ce.message)||"Failed to update address")}}),qt=oe({mutationFn:N=>jt.deleteAddress(t.id,N),onSuccess:()=>{w.success("Address deleted successfully"),Ye.invalidateQueries({queryKey:["customer-details"]}),ht()},onError:N=>{var he,Ce;return w.error(((Ce=(he=N==null?void 0:N.response)==null?void 0:he.data)==null?void 0:Ce.message)||"Failed to delete address")}}),Et=oe({mutationFn:N=>jt.create(N),onSuccess:()=>{w.success("Customer created successfully"),Ye.invalidateQueries({queryKey:["customers"]}),p(!1),m()},onError:N=>{var he,Ce;return w.error(((Ce=(he=N==null?void 0:N.response)==null?void 0:he.data)==null?void 0:Ce.message)||"Failed to create customer")}}),m=()=>{k(""),A(""),$(""),pe(""),Z(""),se(""),xe(""),Ne("")},f=()=>{if(!L.trim()){w.error("Name is required");return}if(!C.trim()){w.error("Phone number is required");return}const N={name:L.trim(),phone:C.trim(),email:P.trim()||void 0};V.trim()&&B.trim()&&ce.trim()&&(N.address={line1:V.trim(),line2:S.trim()||void 0,city:B.trim(),state:ce.trim(),postalCode:ye.trim()||void 0}),Et.mutate(N)},y=N=>{s(N),a(!0)},D=()=>{a(!1),setTimeout(()=>s(null),200)},T=()=>{t&&(Q((ge==null?void 0:ge.name)||t.name||""),z((ge==null?void 0:ge.email)||t.email||""),J((ge==null?void 0:ge.phone)||t.phone||""),l(!0))},_=()=>{if(!j.trim()){w.error("Name is required");return}kt.mutate({name:j.trim(),email:Y.trim()||void 0,phone:F.trim()||void 0})},R=N=>{N?(x(N),Se(N.label||""),v(N.line1||""),de(N.line2||""),E(N.city||""),te(N.state||""),nt(N.postalCode||"")):(x(null),ae()),u(!0)},ae=()=>{x(null),Se(""),v(""),de(""),E(""),te(""),nt("")},le=()=>{if(!Fe.trim()||!Me.trim()||!G.trim()){w.error("Address line 1, city, and state are required");return}Ft.mutate({line1:Fe.trim(),line2:re.trim()||void 0,city:Me.trim(),state:G.trim(),postalCode:fe.trim()||void 0,addressId:g==null?void 0:g.id})},De=N=>{window.confirm("Are you sure you want to delete this address?")&&qt.mutate(N)};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Customers"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Customer Directory"})]}),e.jsx(U,{onClick:()=>p(!0),icon:e.jsx(fn,{className:"h-4 w-4"}),children:"Add Customer"})]}),e.jsx(Ke,{title:"Customers",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs uppercase tracking-wide text-slate-500",children:[e.jsx("th",{className:"px-4 py-3",children:"Name"}),e.jsx("th",{className:"px-4 py-3",children:"Contact"}),e.jsx("th",{className:"px-4 py-3",children:"City"}),e.jsx("th",{className:"px-4 py-3",children:"Address"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[it&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-slate-400",children:"Loading customers"})}),!it&&Ct.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-slate-400",children:"No customers found."})}),Ct.map(N=>e.jsxs("tr",{className:"cursor-pointer hover:bg-slate-50 transition-colors",onClick:()=>y(N),children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:N.name}),e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-500",children:[N.phone||"",e.jsx("span",{className:"block text-xs text-slate-400",children:N.email||""})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-500",children:N.city||""}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-500",children:[N.addressLine1,N.addressLine2,N.postalCode].filter(Boolean).join(", ")||""})]},N.id))]})]})})}),e.jsx(Ue,{open:r,onClose:D,title:(t==null?void 0:t.name)||"Customer Details",size:"xl",showCloseButton:!0,children:t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Contact Information"}),e.jsx(U,{variant:"secondary",onClick:T,icon:e.jsx(Rt,{className:"h-4 w-4"}),children:"Edit"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Name"}),e.jsx("p",{className:"font-medium text-slate-900",children:(ge==null?void 0:ge.name)||t.name||""})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Phone"}),e.jsx("p",{className:"font-medium text-slate-900",children:(ge==null?void 0:ge.phone)||t.phone||""})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email"}),e.jsx("p",{className:"font-medium text-slate-900",children:(ge==null?void 0:ge.email)||t.email||""})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Addresses"}),e.jsx(U,{variant:"secondary",onClick:()=>R(),icon:e.jsx(fn,{className:"h-4 w-4"}),children:"Add Address"})]}),ge!=null&&ge.addresses&&ge.addresses.length>0?e.jsx("div",{className:"space-y-3",children:ge.addresses.map((N,he)=>e.jsx("div",{className:"rounded-lg border border-slate-200 p-3 bg-slate-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[N.label&&e.jsx("p",{className:"text-xs font-semibold text-slate-700 mb-1",children:N.label}),e.jsx("p",{className:"text-sm text-slate-900",children:N.line1}),N.line2&&e.jsx("p",{className:"text-sm text-slate-600",children:N.line2}),e.jsx("p",{className:"text-sm text-slate-600",children:[N.city,N.state,N.postalCode].filter(Boolean).join(", ")}),N.phone&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Phone: ",N.phone]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[N.isDefault&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-xs font-medium",children:"Default"}),e.jsx("button",{type:"button",onClick:Ce=>{Ce.stopPropagation(),R(N)},className:"p-1.5 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors",title:"Edit address",children:e.jsx(Rt,{className:"h-4 w-4"})}),!N.isDefault&&e.jsx("button",{type:"button",onClick:Ce=>{Ce.stopPropagation(),De(N.id)},disabled:qt.isPending,className:"p-1.5 rounded-lg text-rose-500 hover:text-rose-700 hover:bg-rose-50 transition-colors disabled:opacity-50",title:"Delete address",children:e.jsx(ts,{className:"h-4 w-4"})})]})]})},N.id||he))}):e.jsx("p",{className:"text-sm text-slate-500",children:"No addresses on file"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:["Order History (",pt.length,")"]}),pt.length>0?e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:pt.map(N=>{var he;return e.jsx("div",{className:"rounded-lg border border-slate-200 p-3 hover:bg-slate-50 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:["#",N._id.slice(-8)]}),e.jsx(Ss,{variant:N.status,children:N.status})]}),e.jsx("p",{className:"text-xs text-slate-600",children:typeof N.serviceItem=="string"?N.serviceItem:((he=N.serviceItem)==null?void 0:he.name)||"Service"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Scheduled: ",qe(N.timeWindowStart)]})]})})},N._id)})}):e.jsx("p",{className:"text-sm text-slate-500",children:"No orders found"})]})]})}),e.jsx(Ue,{open:i,onClose:()=>l(!1),title:"Edit Customer",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(M,{label:"Name *",value:j,onChange:N=>Q(N.target.value),placeholder:"Customer name"}),e.jsx(M,{label:"Email",type:"email",value:Y,onChange:N=>z(N.target.value),placeholder:"customer@email.com"}),e.jsx(M,{label:"Phone",value:F,onChange:N=>J(N.target.value),placeholder:"Phone number"}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(U,{onClick:_,loading:kt.isPending,children:"Save Changes"}),e.jsx(U,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"})]})]})}),e.jsx(Ue,{open:c,onClose:()=>{u(!1),ae()},title:g?"Edit Address":"Add Address",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(M,{label:"Label (optional)",value:Oe,onChange:N=>Se(N.target.value),placeholder:"e.g. Home, Office"}),e.jsx(M,{label:"Address Line 1 *",value:Fe,onChange:N=>v(N.target.value),placeholder:"Street address"}),e.jsx(M,{label:"Address Line 2",value:re,onChange:N=>de(N.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(M,{label:"City *",value:Me,onChange:N=>E(N.target.value),placeholder:"City"}),e.jsx(M,{label:"State *",value:G,onChange:N=>te(N.target.value),placeholder:"State"})]}),e.jsx(M,{label:"Postal Code",value:fe,onChange:N=>nt(N.target.value),placeholder:"PIN Code"}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(U,{onClick:le,loading:Ft.isPending,children:g?"Update Address":"Add Address"}),e.jsx(U,{variant:"secondary",onClick:()=>{u(!1),ae()},children:"Cancel"})]})]})}),e.jsx(Ue,{open:h,onClose:()=>{p(!1),m()},title:"Add New Customer",size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Contact Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(M,{label:"Name *",value:L,onChange:N=>k(N.target.value),placeholder:"Customer name"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(M,{label:"Phone *",value:C,onChange:N=>$(N.target.value),placeholder:"Phone number"}),e.jsx(M,{label:"Email",type:"email",value:P,onChange:N=>A(N.target.value),placeholder:"customer@email.com"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Address (Optional)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(M,{label:"Address Line 1",value:V,onChange:N=>pe(N.target.value),placeholder:"Street address"}),e.jsx(M,{label:"Address Line 2",value:S,onChange:N=>Z(N.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(M,{label:"City",value:B,onChange:N=>se(N.target.value),placeholder:"City"}),e.jsx(M,{label:"State",value:ce,onChange:N=>xe(N.target.value),placeholder:"State"}),e.jsx(M,{label:"Postal Code",value:ye,onChange:N=>Ne(N.target.value),placeholder:"PIN Code"})]})]}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"If you provide an address, line 1, city, and state are required."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(U,{onClick:f,loading:Et.isPending,children:"Create Customer"}),e.jsx(U,{variant:"secondary",onClick:()=>{p(!1),m()},children:"Cancel"})]})]})})]})},$t={async listBanners(t){const s=t!==void 0?{isActive:t}:{},{data:r}=await K.get("/banners",{params:s});return r.data},async getBanner(t){const{data:s}=await K.get(`/banners/${t}`);return s.data},async createBanner(t){const{data:s}=await K.post("/banners",t);return s.data},async updateBanner(t,s){const{data:r}=await K.put(`/banners/${t}`,s);return r.data},async deleteBanner(t){const{data:s}=await K.delete(`/banners/${t}`);return s.data},async toggleBannerStatus(t){const{data:s}=await K.patch(`/banners/${t}/toggle`);return s.data},async reorderBanners(t){const{data:s}=await K.post("/banners/reorder",{banners:t});return s.data},async uploadImage(t){const s=new FormData;s.append("image",t);const{data:r}=await K.post("/banners/upload/image",s,{headers:{"Content-Type":"multipart/form-data"}}),a="https://admin.fixzep.com/api",i=r.data.imageUrl;return i.startsWith("http")?i:`${a.replace("/api","")}${i}`}},Jd=()=>{const[t,s]=o.useState([]),[r,a]=o.useState(!0),[i,l]=o.useState("");o.useEffect(()=>{c()},[]);const c=async()=>{try{a(!0);const x=await $t.listBanners();s(x),l("")}catch(x){l("Failed to load banners"),console.error(x)}finally{a(!1)}},u=async x=>{if(window.confirm("Are you sure you want to delete this banner?"))try{await $t.deleteBanner(x),s(t.filter(h=>h._id!==x))}catch(h){l("Failed to delete banner"),console.error(h)}},g=async x=>{try{const h=await $t.toggleBannerStatus(x);s(t.map(p=>p._id===x?h:p))}catch(h){l("Failed to toggle banner status"),console.error(h)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Banners"}),e.jsx("a",{href:"/banners/new",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700",children:"+ Create Banner"})]}),i&&e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-sm text-red-700",children:i}),r?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"Loading banners..."})}):t.length===0?e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-12 text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"No banners yet"}),e.jsx("a",{href:"/banners/new",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700",children:"Create your first banner"})]}):e.jsx("div",{className:"grid gap-6",children:t.map(x=>e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"grid grid-cols-4 gap-6",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("img",{src:x.imageUrl,alt:x.title,className:"rounded-lg w-full h-32 object-cover"})}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:x.title}),x.subtitle&&e.jsx("p",{className:"text-sm text-gray-600",children:x.subtitle}),x.link&&e.jsx("p",{className:"text-sm text-blue-600 truncate",children:e.jsx("a",{href:x.link,target:"_blank",rel:"noopener noreferrer",children:x.link})}),x.startDate&&x.endDate&&e.jsxs("p",{className:"text-xs text-gray-500",children:[new Date(x.startDate).toLocaleDateString()," -"," ",new Date(x.endDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"col-span-1 flex flex-col gap-2 justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-xs font-semibold ${x.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:x.isActive?"Active":"Inactive"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>g(x._id),className:"flex-1 rounded-lg text-xs font-medium px-3 py-2 border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:x.isActive?"Deactivate":"Activate"}),e.jsx("a",{href:`/banners/${x._id}`,className:"flex-1 rounded-lg text-xs font-medium px-3 py-2 bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors text-center",children:"Edit"}),e.jsx("button",{onClick:()=>u(x._id),className:"flex-1 rounded-lg text-xs font-medium px-3 py-2 border border-red-200 text-red-700 hover:bg-red-50 transition-colors",children:"Delete"})]})]})]})},x._id))})]})},Un=()=>{const t=ar(),{bannerId:s}=Qn(),r=o.useRef(null),[a,i]=o.useState(!!s),[l,c]=o.useState(!1),[u,g]=o.useState(!1),[x,h]=o.useState(""),[p,j]=o.useState({title:"",subtitle:"",imageUrl:"",link:"",isActive:!0,startDate:"",endDate:""});o.useEffect(()=>{s&&Q()},[s]);const Q=async()=>{if(s)try{i(!0);const J=await $t.getBanner(s);j(J),h("")}catch(J){h("Failed to load banner"),console.error(J)}finally{i(!1)}},Y=J=>{const{name:L,value:k,type:P}=J.target;j(A=>({...A,[L]:P==="checkbox"?J.target.checked:k}))},z=async J=>{var k;const L=(k=J.target.files)==null?void 0:k[0];if(L){g(!0),h("");try{const P=await $t.uploadImage(L);j(A=>({...A,imageUrl:P}))}catch(P){h("Failed to upload image"),console.error(P)}finally{g(!1),r.current&&(r.current.value="")}}},F=async J=>{J.preventDefault(),c(!0),h("");try{s?await $t.updateBanner(s,p):await $t.createBanner(p),t("/banners")}catch(L){h(`Failed to ${s?"update":"create"} banner`),console.error(L)}finally{c(!1)}};return a?e.jsx("div",{className:"text-center py-12",children:"Loading..."}):e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s?"Edit Banner":"Create Banner"})}),x&&e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-sm text-red-700",children:x}),e.jsxs("form",{onSubmit:F,className:"space-y-6 bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),e.jsx("input",{type:"text",name:"title",required:!0,value:p.title||"",onChange:Y,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"Banner title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subtitle"}),e.jsx("input",{type:"text",name:"subtitle",value:p.subtitle||"",onChange:Y,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"Banner subtitle"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL *"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"url",name:"imageUrl",required:!0,value:p.imageUrl||"",onChange:Y,className:"flex-1 rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"https://example.com/image.jpg"}),e.jsx("button",{type:"button",onClick:()=>{var J;return(J=r.current)==null?void 0:J.click()},disabled:u,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg border border-gray-300 text-sm font-medium disabled:opacity-60",children:u?"Uploading...":"Upload"})]}),e.jsx("input",{ref:r,type:"file",accept:"image/*",onChange:z,className:"hidden"})]}),p.imageUrl&&e.jsx("img",{src:p.imageUrl,alt:"Preview",className:"mt-3 rounded-lg max-h-48 object-cover"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link"}),e.jsx("input",{type:"url",name:"link",value:p.link||"",onChange:Y,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"https://example.com"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"datetime-local",name:"startDate",value:p.startDate||"",onChange:Y,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"datetime-local",name:"endDate",value:p.endDate||"",onChange:Y,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"isActive",name:"isActive",checked:p.isActive||!1,onChange:Y,className:"h-4 w-4 rounded border-gray-300"}),e.jsx("label",{className:"text-sm font-medium text-gray-700",htmlFor:"isActive",children:"Active"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:l,className:"flex-1 rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 disabled:opacity-60",children:l?"Saving...":"Save Banner"}),e.jsx("button",{type:"button",onClick:()=>t("/banners"),className:"flex-1 rounded-lg border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50",children:"Cancel"})]})]})]})},Xd=()=>e.jsxs(ol,{children:[e.jsx(We,{path:"/login",element:e.jsx(Ad,{})}),e.jsxs(We,{element:e.jsx(lo,{children:e.jsx(nd,{})}),children:[e.jsx(We,{path:"/",element:e.jsx(Pd,{})}),e.jsx(We,{path:"/orders",element:e.jsx(qd,{})}),e.jsx(We,{path:"/customers",element:e.jsx(Yd,{})}),e.jsx(We,{path:"/catalog",element:e.jsx(Ud,{})}),e.jsx(We,{path:"/catalog/:categoryId",element:e.jsx(Vd,{})}),e.jsx(We,{path:"/technicians",element:e.jsx(Zd,{})}),e.jsx(We,{path:"/spare-parts",element:e.jsx(Wd,{})}),e.jsx(We,{path:"/time-slots",element:e.jsx(Kd,{})}),e.jsx(We,{path:"/users/new",element:e.jsx(Hd,{})}),e.jsx(We,{path:"/banners",element:e.jsx(Jd,{})}),e.jsx(We,{path:"/banners/new",element:e.jsx(Un,{})}),e.jsx(We,{path:"/banners/:bannerId",element:e.jsx(Un,{})})]}),e.jsx(We,{path:"*",element:e.jsx(Hn,{to:"/",replace:!0})})]}),Gd=new hl({defaultOptions:{queries:{staleTime:6e4,refetchOnWindowFocus:!1,retry:1}}});zn(document.getElementById("root")).render(e.jsx(o.StrictMode,{children:e.jsx(pl,{client:Gd,children:e.jsx(no,{children:e.jsx(sd,{children:e.jsxs(cl,{children:[e.jsx(Xd,{}),e.jsx(ao,{position:"top-right"})]})})})})}));
