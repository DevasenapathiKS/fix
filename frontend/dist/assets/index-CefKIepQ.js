import{j as e,q as Jt,_ as Xt}from"./ui-BsaTBtI9.js";import{a as Ln,r as o,N as Mn,b as Xi,O as Gi,m as ve,u as Xs,L as Kt,c as Bn,d as $n,R as el,f as Ve,B as tl}from"./vendor-BVDAFvKx.js";import{a as sl,A as rl,c as al,u as jt,b as fe,d as ne,Q as nl,e as il}from"./data-CsO4I2n7.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(i){if(i.ep)return;i.ep=!0;const l=r(i);fetch(i.href,l)}})();var qn,nn=Ln;qn=nn.createRoot,nn.hydrateRoot;const W=sl.create({baseURL:"https://admin.eopsys.xyz/api",timeout:15e3});W.interceptors.request.use(t=>{const s=localStorage.getItem("fixzep_token");if(s){const r=rl.from(t.headers);r.set("Authorization",`Bearer ${s}`),t.headers=r}return t});const J=async t=>(await t).data.data,ll={login:t=>J(W.post("/auth/login",t))},ke={list:(t={})=>J(W.get("/admin/orders",{params:t})),create:t=>J(W.post("/admin/orders",t)),assign:(t,s)=>J(W.post(`/admin/orders/${t}/assign`,{technicianId:s})),candidates:t=>J(W.get(`/admin/orders/${t}/technicians`)),jobCard:t=>J(W.get(`/admin/orders/${t}/jobcard`)),reschedule:(t,s)=>J(W.post(`/orders/${t}/reschedule`,s)),changeStatus:(t,s)=>J(W.post(`/admin/orders/${t}/status`,s)),uploadMedia:(t,s)=>J(W.post(`/admin/orders/${t}/media`,s)),deleteMedia:(t,s)=>J(W.delete(`/admin/orders/${t}/media/${s}`)),updatePaymentStatus:(t,s)=>J(W.post(`/admin/orders/${t}/payment-status`,s)),addHistoryNote:(t,s)=>J(W.post(`/admin/orders/${t}/history`,s)),addSparePart:(t,s)=>J(W.post(`/admin/orders/${t}/spare-parts`,s)),removeSparePart:(t,s)=>J(W.delete(`/admin/orders/${t}/spare-parts/${s}`)),addAdditionalService:(t,s)=>J(W.post(`/admin/orders/${t}/additional-services`,s)),removeAdditionalService:(t,s)=>J(W.delete(`/admin/orders/${t}/additional-services/${s}`))},Te={categories:()=>J(W.get("/admin/categories")),serviceItems:t=>J(W.get("/admin/service-items",{params:t?{categoryId:t}:void 0})),upsertCategory:t=>J(W.post("/admin/categories",t)),updateCategory:(t,s)=>J(W.put(`/admin/categories/${t}`,s)),deleteCategory:t=>J(W.delete(`/admin/categories/${t}`)),upsertServiceItem:t=>J(W.post("/admin/service-items",t)),updateServiceItem:(t,s)=>J(W.put(`/admin/service-items/${t}`,s)),deleteServiceItem:t=>J(W.delete(`/admin/service-items/${t}`))},_r={list:()=>J(W.get("/admin/spare-parts")),upsert:t=>J(W.post("/admin/spare-parts",t))},Ar={list:()=>J(W.get("/admin/technician-skills")),create:t=>J(W.post("/admin/technician-skills",t))},ol={create:t=>J(W.post("/admin/users",t))},Yt={list:()=>J(W.get("/admin/technicians")),get:t=>J(W.get(`/admin/technicians/${t}`)),update:(t,s)=>J(W.put(`/admin/technicians/${t}`,s)),availability:t=>J(W.get(`/admin/technicians/${t}/availability`)),schedule:(t,s)=>J(W.get(`/admin/technicians/${t}/schedule`,{params:s})),attendance:t=>J(W.get(`/admin/technicians/${t}/attendance`)),markAttendance:(t,s)=>J(W.post(`/admin/technicians/${t}/attendance`,s))},fs={list:()=>J(W.get("/admin/time-slots")),create:t=>J(W.post("/admin/time-slots",t)),update:(t,s)=>J(W.put(`/admin/time-slots/${t}`,s)),remove:t=>J(W.delete(`/admin/time-slots/${t}`))},bt={list:()=>J(W.get("/admin/customers")),findByPhone:t=>J(W.get(`/admin/customers/phone/${t}`)),create:t=>J(W.post("/admin/customers",t)),update:(t,s)=>J(W.put(`/admin/customers/${t}`,s)),updateAddress:(t,s)=>J(W.put(`/admin/customers/${t}/address`,s)),deleteAddress:(t,s)=>J(W.delete(`/admin/customers/${t}/address/${s}`))};let cl={data:""},dl=t=>{if(typeof window=="object"){let s=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return s.nonce=window.__nonce__,s.parentNode||(t||document.head).appendChild(s),s.firstChild}return t||cl},ul=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,ml=/\/\*[^]*?\*\/|  +/g,ln=/\n+/g,At=(t,s)=>{let r="",a="",i="";for(let l in t){let c=t[l];l[0]=="@"?l[1]=="i"?r=l+" "+c+";":a+=l[1]=="f"?At(c,l):l+"{"+At(c,l[1]=="k"?"":s)+"}":typeof c=="object"?a+=At(c,s?s.replace(/([^,])+/g,m=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,x=>/&/.test(x)?x.replace(/&/g,m):m?m+" "+x:x)):l):c!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=At.p?At.p(l,c):l+":"+c+";")}return r+(s&&i?s+"{"+i+"}":i)+a},ft={},Vn=t=>{if(typeof t=="object"){let s="";for(let r in t)s+=r+Vn(t[r]);return s}return t},hl=(t,s,r,a,i)=>{let l=Vn(t),c=ft[l]||(ft[l]=(x=>{let g=0,h=11;for(;g<x.length;)h=101*h+x.charCodeAt(g++)>>>0;return"go"+h})(l));if(!ft[c]){let x=l!==t?t:(g=>{let h,p,j=[{}];for(;h=ul.exec(g.replace(ml,""));)h[4]?j.shift():h[3]?(p=h[3].replace(ln," ").trim(),j.unshift(j[0][p]=j[0][p]||{})):j[0][h[1]]=h[2].replace(ln," ").trim();return j[0]})(t);ft[c]=At(i?{["@keyframes "+c]:x}:x,r?"":"."+c)}let m=r&&ft.g?ft.g:null;return r&&(ft.g=ft[c]),((x,g,h,p)=>{p?g.data=g.data.replace(p,x):g.data.indexOf(x)===-1&&(g.data=h?x+g.data:g.data+x)})(ft[c],s,a,m),c},pl=(t,s,r)=>t.reduce((a,i,l)=>{let c=s[l];if(c&&c.call){let m=c(r),x=m&&m.props&&m.props.className||/^go/.test(m)&&m;c=x?"."+x:m&&typeof m=="object"?m.props?"":At(m,""):m===!1?"":m}return a+i+(c??"")},"");function Gs(t){let s=this||{},r=t.call?t(s.p):t;return hl(r.unshift?r.raw?pl(r,[].slice.call(arguments,1),s.p):r.reduce((a,i)=>Object.assign(a,i&&i.call?i(s.p):i),{}):r,dl(s.target),s.g,s.o,s.k)}let Un,Tr,Pr;Gs.bind({g:1});let yt=Gs.bind({k:1});function xl(t,s,r,a){At.p=s,Un=t,Tr=r,Pr=a}function Ot(t,s){let r=this||{};return function(){let a=arguments;function i(l,c){let m=Object.assign({},l),x=m.className||i.className;r.p=Object.assign({theme:Tr&&Tr()},m),r.o=/ *go\d+/.test(x),m.className=Gs.apply(r,a)+(x?" "+x:"");let g=t;return t[0]&&(g=m.as||t,delete m.as),Pr&&g[0]&&Pr(m),Un(g,m)}return i}}var fl=t=>typeof t=="function",zs=(t,s)=>fl(t)?t(s):t,gl=(()=>{let t=0;return()=>(++t).toString()})(),Wn=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let s=matchMedia("(prefers-reduced-motion: reduce)");t=!s||s.matches}return t}})(),bl=20,Wr="default",Hn=(t,s)=>{let{toastLimit:r}=t.settings;switch(s.type){case 0:return{...t,toasts:[s.toast,...t.toasts].slice(0,r)};case 1:return{...t,toasts:t.toasts.map(c=>c.id===s.toast.id?{...c,...s.toast}:c)};case 2:let{toast:a}=s;return Hn(t,{type:t.toasts.find(c=>c.id===a.id)?1:0,toast:a});case 3:let{toastId:i}=s;return{...t,toasts:t.toasts.map(c=>c.id===i||i===void 0?{...c,dismissed:!0,visible:!1}:c)};case 4:return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(c=>c.id!==s.toastId)};case 5:return{...t,pausedAt:s.time};case 6:let l=s.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(c=>({...c,pauseDuration:c.pauseDuration+l}))}}},Vs=[],Kn={toasts:[],pausedAt:void 0,settings:{toastLimit:bl}},nt={},Qn=(t,s=Wr)=>{nt[s]=Hn(nt[s]||Kn,t),Vs.forEach(([r,a])=>{r===s&&a(nt[s])})},zn=t=>Object.keys(nt).forEach(s=>Qn(t,s)),yl=t=>Object.keys(nt).find(s=>nt[s].toasts.some(r=>r.id===t)),er=(t=Wr)=>s=>{Qn(s,t)},vl={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},jl=(t={},s=Wr)=>{let[r,a]=o.useState(nt[s]||Kn),i=o.useRef(nt[s]);o.useEffect(()=>(i.current!==nt[s]&&a(nt[s]),Vs.push([s,a]),()=>{let c=Vs.findIndex(([m])=>m===s);c>-1&&Vs.splice(c,1)}),[s]);let l=r.toasts.map(c=>{var m,x,g;return{...t,...t[c.type],...c,removeDelay:c.removeDelay||((m=t[c.type])==null?void 0:m.removeDelay)||(t==null?void 0:t.removeDelay),duration:c.duration||((x=t[c.type])==null?void 0:x.duration)||(t==null?void 0:t.duration)||vl[c.type],style:{...t.style,...(g=t[c.type])==null?void 0:g.style,...c.style}}});return{...r,toasts:l}},wl=(t,s="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:s,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...r,id:(r==null?void 0:r.id)||gl()}),ws=t=>(s,r)=>{let a=wl(s,t,r);return er(a.toasterId||yl(a.id))({type:2,toast:a}),a.id},Pe=(t,s)=>ws("blank")(t,s);Pe.error=ws("error");Pe.success=ws("success");Pe.loading=ws("loading");Pe.custom=ws("custom");Pe.dismiss=(t,s)=>{let r={type:3,toastId:t};s?er(s)(r):zn(r)};Pe.dismissAll=t=>Pe.dismiss(void 0,t);Pe.remove=(t,s)=>{let r={type:4,toastId:t};s?er(s)(r):zn(r)};Pe.removeAll=t=>Pe.remove(void 0,t);Pe.promise=(t,s,r)=>{let a=Pe.loading(s.loading,{...r,...r==null?void 0:r.loading});return typeof t=="function"&&(t=t()),t.then(i=>{let l=s.success?zs(s.success,i):void 0;return l?Pe.success(l,{id:a,...r,...r==null?void 0:r.success}):Pe.dismiss(a),i}).catch(i=>{let l=s.error?zs(s.error,i):void 0;l?Pe.error(l,{id:a,...r,...r==null?void 0:r.error}):Pe.dismiss(a)}),t};var Nl=1e3,Sl=(t,s="default")=>{let{toasts:r,pausedAt:a}=jl(t,s),i=o.useRef(new Map).current,l=o.useCallback((p,j=Nl)=>{if(i.has(p))return;let K=setTimeout(()=>{i.delete(p),c({type:4,toastId:p})},j);i.set(p,K)},[]);o.useEffect(()=>{if(a)return;let p=Date.now(),j=r.map(K=>{if(K.duration===1/0)return;let z=(K.duration||0)+K.pauseDuration-(p-K.createdAt);if(z<0){K.visible&&Pe.dismiss(K.id);return}return setTimeout(()=>Pe.dismiss(K.id,s),z)});return()=>{j.forEach(K=>K&&clearTimeout(K))}},[r,a,s]);let c=o.useCallback(er(s),[s]),m=o.useCallback(()=>{c({type:5,time:Date.now()})},[c]),x=o.useCallback((p,j)=>{c({type:1,toast:{id:p,height:j}})},[c]),g=o.useCallback(()=>{a&&c({type:6,time:Date.now()})},[a,c]),h=o.useCallback((p,j)=>{let{reverseOrder:K=!1,gutter:z=8,defaultPosition:Z}=j||{},O=r.filter(k=>(k.position||Z)===(p.position||Z)&&k.height),M=O.findIndex(k=>k.id===p.id),C=O.filter((k,R)=>R<M&&k.visible).length;return O.filter(k=>k.visible).slice(...K?[C+1]:[0,C]).reduce((k,R)=>k+(R.height||0)+z,0)},[r]);return o.useEffect(()=>{r.forEach(p=>{if(p.dismissed)l(p.id,p.removeDelay);else{let j=i.get(p.id);j&&(clearTimeout(j),i.delete(p.id))}})},[r,l]),{toasts:r,handlers:{updateHeight:x,startPause:m,endPause:g,calculateOffset:h}}},Cl=yt`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,kl=yt`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,El=yt`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,_l=Ot("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Cl} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${kl} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${El} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Al=yt`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Tl=Ot("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${Al} 1s linear infinite;
`,Pl=yt`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Ol=yt`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Rl=Ot("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Pl} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Ol} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Il=Ot("div")`
  position: absolute;
`,Dl=Ot("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Fl=yt`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Ll=Ot("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Fl} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Ml=({toast:t})=>{let{icon:s,type:r,iconTheme:a}=t;return s!==void 0?typeof s=="string"?o.createElement(Ll,null,s):s:r==="blank"?null:o.createElement(Dl,null,o.createElement(Tl,{...a}),r!=="loading"&&o.createElement(Il,null,r==="error"?o.createElement(_l,{...a}):o.createElement(Rl,{...a})))},Bl=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,$l=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,ql="0%{opacity:0;} 100%{opacity:1;}",Vl="0%{opacity:1;} 100%{opacity:0;}",Ul=Ot("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Wl=Ot("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Hl=(t,s)=>{let r=t.includes("top")?1:-1,[a,i]=Wn()?[ql,Vl]:[Bl(r),$l(r)];return{animation:s?`${yt(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${yt(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Kl=o.memo(({toast:t,position:s,style:r,children:a})=>{let i=t.height?Hl(t.position||s||"top-center",t.visible):{opacity:0},l=o.createElement(Ml,{toast:t}),c=o.createElement(Wl,{...t.ariaProps},zs(t.message,t));return o.createElement(Ul,{className:t.className,style:{...i,...r,...t.style}},typeof a=="function"?a({icon:l,message:c}):o.createElement(o.Fragment,null,l,c))});xl(o.createElement);var Ql=({id:t,className:s,style:r,onHeightUpdate:a,children:i})=>{let l=o.useCallback(c=>{if(c){let m=()=>{let x=c.getBoundingClientRect().height;a(t,x)};m(),new MutationObserver(m).observe(c,{subtree:!0,childList:!0,characterData:!0})}},[t,a]);return o.createElement("div",{ref:l,className:s,style:r},i)},zl=(t,s)=>{let r=t.includes("top"),a=r?{top:0}:{bottom:0},i=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Wn()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${s*(r?1:-1)}px)`,...a,...i}},Zl=Gs`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ms=16,Yl=({reverseOrder:t,position:s="top-center",toastOptions:r,gutter:a,children:i,toasterId:l,containerStyle:c,containerClassName:m})=>{let{toasts:x,handlers:g}=Sl(r,l);return o.createElement("div",{"data-rht-toaster":l||"",style:{position:"fixed",zIndex:9999,top:Ms,left:Ms,right:Ms,bottom:Ms,pointerEvents:"none",...c},className:m,onMouseEnter:g.startPause,onMouseLeave:g.endPause},x.map(h=>{let p=h.position||s,j=g.calculateOffset(h,{reverseOrder:t,gutter:a,defaultPosition:s}),K=zl(p,j);return o.createElement(Ql,{id:h.id,key:h.id,onHeightUpdate:g.updateHeight,className:h.visible?Zl:"",style:K},h.type==="custom"?zs(h.message,h):i?i(h):o.createElement(Kl,{toast:h,position:p}))}))},N=Pe;const Zn=o.createContext(void 0),vr="fixzep_token",jr="fixzep_user",Jl=({children:t})=>{const[s,r]=o.useState(()=>localStorage.getItem(vr)),[a,i]=o.useState(()=>{const x=localStorage.getItem(jr);return x?JSON.parse(x):null});o.useEffect(()=>{s?localStorage.setItem(vr,s):localStorage.removeItem(vr)},[s]),o.useEffect(()=>{a?localStorage.setItem(jr,JSON.stringify(a)):localStorage.removeItem(jr)},[a]);const l=o.useCallback(async x=>{var g,h;try{const p=await ll.login(x);r(p.token),i(p.user),N.success("Welcome back, "+p.user.name.split(" ")[0])}catch(p){throw N.error(((h=(g=p==null?void 0:p.response)==null?void 0:g.data)==null?void 0:h.message)||"Unable to login"),p}},[]),c=o.useCallback(()=>{r(null),i(null),N.success("Logged out")},[]),m=o.useMemo(()=>({user:a,token:s,isAuthenticated:!!(s&&a),login:l,logout:c}),[l,c,s,a]);return e.jsx(Zn.Provider,{value:m,children:t})},Xl=()=>{const t=o.useContext(Zn);if(!t)throw new Error("useAuthContext must be used within AuthProvider");return t},Hr=()=>Xl(),Gl=({children:t})=>{const{isAuthenticated:s}=Hr();return s?e.jsx(e.Fragment,{children:t}):e.jsx(Mn,{to:"/login",replace:!0})};function eo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const to=o.forwardRef(eo);function so({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const ro=o.forwardRef(so);function ao({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))}const no=o.forwardRef(ao);function io({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"}))}const on=o.forwardRef(io);function lo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const oo=o.forwardRef(lo);function co({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const Yn=o.forwardRef(co);function uo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}))}const mo=o.forwardRef(uo);function ho({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const po=o.forwardRef(ho);function xo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"}))}const fo=o.forwardRef(xo);function go({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const bo=o.forwardRef(go);function yo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25"}))}const vo=o.forwardRef(yo);function jo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const Or=o.forwardRef(jo);function wo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const Rr=o.forwardRef(wo);function No({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607ZM13.5 10.5h-6"}))}const So=o.forwardRef(No);function Co({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607ZM10.5 7.5v6m3-3h-6"}))}const ko=o.forwardRef(Co);function Eo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const Mt=o.forwardRef(Eo);function _o({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const Ao=o.forwardRef(_o);function To({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const cn=o.forwardRef(To);function Po({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z"}))}const Oo=o.forwardRef(Po);function Ro({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const Io=o.forwardRef(Ro);function Do({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const Fo=o.forwardRef(Do);function Lo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"}))}const Mo=o.forwardRef(Lo);function Bo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const js=o.forwardRef(Bo);function $o({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"}))}const wr=o.forwardRef($o);function qo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))}const Vo=o.forwardRef(qo);function Uo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75a4.5 4.5 0 0 1-4.884 4.484c-1.076-.091-2.264.071-2.95.904l-7.152 8.684a2.548 2.548 0 1 1-3.586-3.586l8.684-7.152c.833-.686.995-1.874.904-2.95a4.5 4.5 0 0 1 6.336-4.486l-3.276 3.276a3.004 3.004 0 0 0 2.25 2.25l3.276-3.276c.256.565.398 1.192.398 1.852Z"}),o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.867 19.125h.008v.008h-.008v-.008Z"}))}const dn=o.forwardRef(Uo);function Wo({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Ho=o.forwardRef(Wo);function Ko({title:t,titleId:s,...r},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?o.createElement("title",{id:s},t):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const gs=o.forwardRef(Ko);function Jn(t){var s,r,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(s=0;s<i;s++)t[s]&&(r=Jn(t[s]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function vt(){for(var t,s,r=0,a="",i=arguments.length;r<i;r++)(t=arguments[r])&&(s=Jn(t))&&(a&&(a+=" "),a+=s);return a}const Qo=[{to:"/",label:"Overview",icon:Mo},{to:"/orders",label:"Orders",icon:fo},{to:"/customers",label:"Customers",icon:wr},{to:"/catalog",label:"Catalog",icon:dn},{to:"/technicians",label:"Technicians",icon:wr},{to:"/spare-parts",label:"Spare Parts",icon:dn},{to:"/time-slots",label:"Time Slots",icon:bo},{to:"/banners",label:"Banners",icon:Ao},{to:"/users/new",label:"Create User",icon:wr}],un=()=>e.jsxs("aside",{className:"hidden lg:flex w-64 flex-col border-r border-slate-200 bg-white/90 backdrop-blur",children:[e.jsxs("div",{className:"px-6 py-5 border-b border-slate-200",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Fixzep Admin"}),e.jsx("p",{className:"mt-2 text-xl font-semibold text-slate-900",children:"Control Room"})]}),e.jsx("nav",{className:"flex-1 px-4 py-6 space-y-1",children:Qo.map(t=>e.jsxs(Xi,{to:t.to,className:({isActive:s})=>vt("flex items-center gap-3 rounded-xl px-4 py-3 text-sm font-medium transition-all",s?"bg-slate-900 text-white shadow-card":"text-slate-500 hover:bg-slate-100"),children:[e.jsx(t.icon,{className:"h-5 w-5"}),t.label]},t.to))})]}),Xn=al(t=>({isOpen:!1,toggle:()=>t(s=>({isOpen:!s.isOpen})),close:()=>t({isOpen:!1})})),lt=Object.create(null);lt.open="0";lt.close="1";lt.ping="2";lt.pong="3";lt.message="4";lt.upgrade="5";lt.noop="6";const Us=Object.create(null);Object.keys(lt).forEach(t=>{Us[lt[t]]=t});const Ir={type:"error",data:"parser error"},Gn=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",ei=typeof ArrayBuffer=="function",ti=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,Kr=({type:t,data:s},r,a)=>Gn&&s instanceof Blob?r?a(s):mn(s,a):ei&&(s instanceof ArrayBuffer||ti(s))?r?a(s):mn(new Blob([s]),a):a(lt[t]+(s||"")),mn=(t,s)=>{const r=new FileReader;return r.onload=function(){const a=r.result.split(",")[1];s("b"+(a||""))},r.readAsDataURL(t)};function hn(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let Nr;function zo(t,s){if(Gn&&t.data instanceof Blob)return t.data.arrayBuffer().then(hn).then(s);if(ei&&(t.data instanceof ArrayBuffer||ti(t.data)))return s(hn(t.data));Kr(t,!1,r=>{Nr||(Nr=new TextEncoder),s(Nr.encode(r))})}const pn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bs=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<pn.length;t++)bs[pn.charCodeAt(t)]=t;const Zo=t=>{let s=t.length*.75,r=t.length,a,i=0,l,c,m,x;t[t.length-1]==="="&&(s--,t[t.length-2]==="="&&s--);const g=new ArrayBuffer(s),h=new Uint8Array(g);for(a=0;a<r;a+=4)l=bs[t.charCodeAt(a)],c=bs[t.charCodeAt(a+1)],m=bs[t.charCodeAt(a+2)],x=bs[t.charCodeAt(a+3)],h[i++]=l<<2|c>>4,h[i++]=(c&15)<<4|m>>2,h[i++]=(m&3)<<6|x&63;return g},Yo=typeof ArrayBuffer=="function",Qr=(t,s)=>{if(typeof t!="string")return{type:"message",data:si(t,s)};const r=t.charAt(0);return r==="b"?{type:"message",data:Jo(t.substring(1),s)}:Us[r]?t.length>1?{type:Us[r],data:t.substring(1)}:{type:Us[r]}:Ir},Jo=(t,s)=>{if(Yo){const r=Zo(t);return si(r,s)}else return{base64:!0,data:t}},si=(t,s)=>{switch(s){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},ri="",Xo=(t,s)=>{const r=t.length,a=new Array(r);let i=0;t.forEach((l,c)=>{Kr(l,!1,m=>{a[c]=m,++i===r&&s(a.join(ri))})})},Go=(t,s)=>{const r=t.split(ri),a=[];for(let i=0;i<r.length;i++){const l=Qr(r[i],s);if(a.push(l),l.type==="error")break}return a};function ec(){return new TransformStream({transform(t,s){zo(t,r=>{const a=r.length;let i;if(a<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,a);else if(a<65536){i=new Uint8Array(3);const l=new DataView(i.buffer);l.setUint8(0,126),l.setUint16(1,a)}else{i=new Uint8Array(9);const l=new DataView(i.buffer);l.setUint8(0,127),l.setBigUint64(1,BigInt(a))}t.data&&typeof t.data!="string"&&(i[0]|=128),s.enqueue(i),s.enqueue(r)})}})}let Sr;function Bs(t){return t.reduce((s,r)=>s+r.length,0)}function $s(t,s){if(t[0].length===s)return t.shift();const r=new Uint8Array(s);let a=0;for(let i=0;i<s;i++)r[i]=t[0][a++],a===t[0].length&&(t.shift(),a=0);return t.length&&a<t[0].length&&(t[0]=t[0].slice(a)),r}function tc(t,s){Sr||(Sr=new TextDecoder);const r=[];let a=0,i=-1,l=!1;return new TransformStream({transform(c,m){for(r.push(c);;){if(a===0){if(Bs(r)<1)break;const x=$s(r,1);l=(x[0]&128)===128,i=x[0]&127,i<126?a=3:i===126?a=1:a=2}else if(a===1){if(Bs(r)<2)break;const x=$s(r,2);i=new DataView(x.buffer,x.byteOffset,x.length).getUint16(0),a=3}else if(a===2){if(Bs(r)<8)break;const x=$s(r,8),g=new DataView(x.buffer,x.byteOffset,x.length),h=g.getUint32(0);if(h>Math.pow(2,21)-1){m.enqueue(Ir);break}i=h*Math.pow(2,32)+g.getUint32(4),a=3}else{if(Bs(r)<i)break;const x=$s(r,i);m.enqueue(Qr(l?x:Sr.decode(x),s)),a=0}if(i===0||i>t){m.enqueue(Ir);break}}}})}const ai=4;function _e(t){if(t)return sc(t)}function sc(t){for(var s in _e.prototype)t[s]=_e.prototype[s];return t}_e.prototype.on=_e.prototype.addEventListener=function(t,s){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(s),this};_e.prototype.once=function(t,s){function r(){this.off(t,r),s.apply(this,arguments)}return r.fn=s,this.on(t,r),this};_e.prototype.off=_e.prototype.removeListener=_e.prototype.removeAllListeners=_e.prototype.removeEventListener=function(t,s){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var a,i=0;i<r.length;i++)if(a=r[i],a===s||a.fn===s){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};_e.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var s=new Array(arguments.length-1),r=this._callbacks["$"+t],a=1;a<arguments.length;a++)s[a-1]=arguments[a];if(r){r=r.slice(0);for(var a=0,i=r.length;a<i;++a)r[a].apply(this,s)}return this};_e.prototype.emitReserved=_e.prototype.emit;_e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};_e.prototype.hasListeners=function(t){return!!this.listeners(t).length};const tr=typeof Promise=="function"&&typeof Promise.resolve=="function"?s=>Promise.resolve().then(s):(s,r)=>r(s,0),Ye=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),rc="arraybuffer";function ni(t,...s){return s.reduce((r,a)=>(t.hasOwnProperty(a)&&(r[a]=t[a]),r),{})}const ac=Ye.setTimeout,nc=Ye.clearTimeout;function sr(t,s){s.useNativeTimers?(t.setTimeoutFn=ac.bind(Ye),t.clearTimeoutFn=nc.bind(Ye)):(t.setTimeoutFn=Ye.setTimeout.bind(Ye),t.clearTimeoutFn=Ye.clearTimeout.bind(Ye))}const ic=1.33;function lc(t){return typeof t=="string"?oc(t):Math.ceil((t.byteLength||t.size)*ic)}function oc(t){let s=0,r=0;for(let a=0,i=t.length;a<i;a++)s=t.charCodeAt(a),s<128?r+=1:s<2048?r+=2:s<55296||s>=57344?r+=3:(a++,r+=4);return r}function ii(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function cc(t){let s="";for(let r in t)t.hasOwnProperty(r)&&(s.length&&(s+="&"),s+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return s}function dc(t){let s={},r=t.split("&");for(let a=0,i=r.length;a<i;a++){let l=r[a].split("=");s[decodeURIComponent(l[0])]=decodeURIComponent(l[1])}return s}class uc extends Error{constructor(s,r,a){super(s),this.description=r,this.context=a,this.type="TransportError"}}class zr extends _e{constructor(s){super(),this.writable=!1,sr(this,s),this.opts=s,this.query=s.query,this.socket=s.socket,this.supportsBinary=!s.forceBase64}onError(s,r,a){return super.emitReserved("error",new uc(s,r,a)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(s){this.readyState==="open"&&this.write(s)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(s){const r=Qr(s,this.socket.binaryType);this.onPacket(r)}onPacket(s){super.emitReserved("packet",s)}onClose(s){this.readyState="closed",super.emitReserved("close",s)}pause(s){}createUri(s,r={}){return s+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const s=this.opts.hostname;return s.indexOf(":")===-1?s:"["+s+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(s){const r=cc(s);return r.length?"?"+r:""}}class mc extends zr{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(s){this.readyState="pausing";const r=()=>{this.readyState="paused",s()};if(this._polling||!this.writable){let a=0;this._polling&&(a++,this.once("pollComplete",function(){--a||r()})),this.writable||(a++,this.once("drain",function(){--a||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(s){const r=a=>{if(this.readyState==="opening"&&a.type==="open"&&this.onOpen(),a.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(a)};Go(s,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const s=()=>{this.write([{type:"close"}])};this.readyState==="open"?s():this.once("open",s)}write(s){this.writable=!1,Xo(s,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const s=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=ii()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(s,r)}}let li=!1;try{li=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const hc=li;function pc(){}class xc extends mc{constructor(s){if(super(s),typeof location<"u"){const r=location.protocol==="https:";let a=location.port;a||(a=r?"443":"80"),this.xd=typeof location<"u"&&s.hostname!==location.hostname||a!==s.port}}doWrite(s,r){const a=this.request({method:"POST",data:s});a.on("success",r),a.on("error",(i,l)=>{this.onError("xhr post error",i,l)})}doPoll(){const s=this.request();s.on("data",this.onData.bind(this)),s.on("error",(r,a)=>{this.onError("xhr poll error",r,a)}),this.pollXhr=s}}class it extends _e{constructor(s,r,a){super(),this.createRequest=s,sr(this,a),this._opts=a,this._method=a.method||"GET",this._uri=r,this._data=a.data!==void 0?a.data:null,this._create()}_create(){var s;const r=ni(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const a=this._xhr=this.createRequest(r);try{a.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){a.setDisableHeaderCheck&&a.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&a.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{a.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{a.setRequestHeader("Accept","*/*")}catch{}(s=this._opts.cookieJar)===null||s===void 0||s.addCookies(a),"withCredentials"in a&&(a.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(a.timeout=this._opts.requestTimeout),a.onreadystatechange=()=>{var i;a.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(a.getResponseHeader("set-cookie"))),a.readyState===4&&(a.status===200||a.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof a.status=="number"?a.status:0)},0))},a.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=it.requestsCount++,it.requests[this._index]=this)}_onError(s){this.emitReserved("error",s,this._xhr),this._cleanup(!0)}_cleanup(s){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=pc,s)try{this._xhr.abort()}catch{}typeof document<"u"&&delete it.requests[this._index],this._xhr=null}}_onLoad(){const s=this._xhr.responseText;s!==null&&(this.emitReserved("data",s),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}it.requestsCount=0;it.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",xn);else if(typeof addEventListener=="function"){const t="onpagehide"in Ye?"pagehide":"unload";addEventListener(t,xn,!1)}}function xn(){for(let t in it.requests)it.requests.hasOwnProperty(t)&&it.requests[t].abort()}const fc=function(){const t=oi({xdomain:!1});return t&&t.responseType!==null}();class gc extends xc{constructor(s){super(s);const r=s&&s.forceBase64;this.supportsBinary=fc&&!r}request(s={}){return Object.assign(s,{xd:this.xd},this.opts),new it(oi,this.uri(),s)}}function oi(t){const s=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!s||hc))return new XMLHttpRequest}catch{}if(!s)try{return new Ye[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const ci=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class bc extends zr{get name(){return"websocket"}doOpen(){const s=this.uri(),r=this.opts.protocols,a=ci?{}:ni(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(a.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(s,r,a)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=s=>this.onClose({description:"websocket connection closed",context:s}),this.ws.onmessage=s=>this.onData(s.data),this.ws.onerror=s=>this.onError("websocket error",s)}write(s){this.writable=!1;for(let r=0;r<s.length;r++){const a=s[r],i=r===s.length-1;Kr(a,this.supportsBinary,l=>{try{this.doWrite(a,l)}catch{}i&&tr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const s=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=ii()),this.supportsBinary||(r.b64=1),this.createUri(s,r)}}const Cr=Ye.WebSocket||Ye.MozWebSocket;class yc extends bc{createSocket(s,r,a){return ci?new Cr(s,r,a):r?new Cr(s,r):new Cr(s)}doWrite(s,r){this.ws.send(r)}}class vc extends zr{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(s){return this.emitReserved("error",s)}this._transport.closed.then(()=>{this.onClose()}).catch(s=>{this.onError("webtransport error",s)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(s=>{const r=tc(Number.MAX_SAFE_INTEGER,this.socket.binaryType),a=s.readable.pipeThrough(r).getReader(),i=ec();i.readable.pipeTo(s.writable),this._writer=i.writable.getWriter();const l=()=>{a.read().then(({done:m,value:x})=>{m||(this.onPacket(x),l())}).catch(m=>{})};l();const c={type:"open"};this.query.sid&&(c.data=`{"sid":"${this.query.sid}"}`),this._writer.write(c).then(()=>this.onOpen())})})}write(s){this.writable=!1;for(let r=0;r<s.length;r++){const a=s[r],i=r===s.length-1;this._writer.write(a).then(()=>{i&&tr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var s;(s=this._transport)===null||s===void 0||s.close()}}const jc={websocket:yc,webtransport:vc,polling:gc},wc=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Nc=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Dr(t){if(t.length>8e3)throw"URI too long";const s=t,r=t.indexOf("["),a=t.indexOf("]");r!=-1&&a!=-1&&(t=t.substring(0,r)+t.substring(r,a).replace(/:/g,";")+t.substring(a,t.length));let i=wc.exec(t||""),l={},c=14;for(;c--;)l[Nc[c]]=i[c]||"";return r!=-1&&a!=-1&&(l.source=s,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=Sc(l,l.path),l.queryKey=Cc(l,l.query),l}function Sc(t,s){const r=/\/{2,9}/g,a=s.replace(r,"/").split("/");return(s.slice(0,1)=="/"||s.length===0)&&a.splice(0,1),s.slice(-1)=="/"&&a.splice(a.length-1,1),a}function Cc(t,s){const r={};return s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,i,l){i&&(r[i]=l)}),r}const Fr=typeof addEventListener=="function"&&typeof removeEventListener=="function",Ws=[];Fr&&addEventListener("offline",()=>{Ws.forEach(t=>t())},!1);class Tt extends _e{constructor(s,r){if(super(),this.binaryType=rc,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,s&&typeof s=="object"&&(r=s,s=null),s){const a=Dr(s);r.hostname=a.host,r.secure=a.protocol==="https"||a.protocol==="wss",r.port=a.port,a.query&&(r.query=a.query)}else r.host&&(r.hostname=Dr(r.host).host);sr(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(a=>{const i=a.prototype.name;this.transports.push(i),this._transportsByName[i]=a}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=dc(this.opts.query)),Fr&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Ws.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(s){const r=Object.assign({},this.opts.query);r.EIO=ai,r.transport=s,this.id&&(r.sid=this.id);const a=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[s]);return new this._transportsByName[s](a)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const s=this.opts.rememberUpgrade&&Tt.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(s);r.open(),this.setTransport(r)}setTransport(s){this.transport&&this.transport.removeAllListeners(),this.transport=s,s.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",Tt.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",s),this.emitReserved("heartbeat"),s.type){case"open":this.onHandshake(JSON.parse(s.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=s.data,this._onError(r);break;case"message":this.emitReserved("data",s.data),this.emitReserved("message",s.data);break}}onHandshake(s){this.emitReserved("handshake",s),this.id=s.sid,this.transport.query.sid=s.sid,this._pingInterval=s.pingInterval,this._pingTimeout=s.pingTimeout,this._maxPayload=s.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const s=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+s,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},s),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const s=this._getWritablePackets();this.transport.send(s),this._prevBufferLen=s.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let a=0;a<this.writeBuffer.length;a++){const i=this.writeBuffer[a].data;if(i&&(r+=lc(i)),a>0&&r>this._maxPayload)return this.writeBuffer.slice(0,a);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const s=Date.now()>this._pingTimeoutTime;return s&&(this._pingTimeoutTime=0,tr(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),s}write(s,r,a){return this._sendPacket("message",s,r,a),this}send(s,r,a){return this._sendPacket("message",s,r,a),this}_sendPacket(s,r,a,i){if(typeof r=="function"&&(i=r,r=void 0),typeof a=="function"&&(i=a,a=null),this.readyState==="closing"||this.readyState==="closed")return;a=a||{},a.compress=a.compress!==!1;const l={type:s,data:r,options:a};this.emitReserved("packetCreate",l),this.writeBuffer.push(l),i&&this.once("flush",i),this.flush()}close(){const s=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),s()},a=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?a():s()}):this.upgrading?a():s()),this}_onError(s){if(Tt.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",s),this._onClose("transport error",s)}_onClose(s,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Fr&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const a=Ws.indexOf(this._offlineEventListener);a!==-1&&Ws.splice(a,1)}this.readyState="closed",this.id=null,this.emitReserved("close",s,r),this.writeBuffer=[],this._prevBufferLen=0}}}Tt.protocol=ai;class kc extends Tt{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let s=0;s<this._upgrades.length;s++)this._probe(this._upgrades[s])}_probe(s){let r=this.createTransport(s),a=!1;Tt.priorWebsocketSuccess=!1;const i=()=>{a||(r.send([{type:"ping",data:"probe"}]),r.once("packet",p=>{if(!a)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;Tt.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{a||this.readyState!=="closed"&&(h(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const j=new Error("probe error");j.transport=r.name,this.emitReserved("upgradeError",j)}}))};function l(){a||(a=!0,h(),r.close(),r=null)}const c=p=>{const j=new Error("probe error: "+p);j.transport=r.name,l(),this.emitReserved("upgradeError",j)};function m(){c("transport closed")}function x(){c("socket closed")}function g(p){r&&p.name!==r.name&&l()}const h=()=>{r.removeListener("open",i),r.removeListener("error",c),r.removeListener("close",m),this.off("close",x),this.off("upgrading",g)};r.once("open",i),r.once("error",c),r.once("close",m),this.once("close",x),this.once("upgrading",g),this._upgrades.indexOf("webtransport")!==-1&&s!=="webtransport"?this.setTimeoutFn(()=>{a||r.open()},200):r.open()}onHandshake(s){this._upgrades=this._filterUpgrades(s.upgrades),super.onHandshake(s)}_filterUpgrades(s){const r=[];for(let a=0;a<s.length;a++)~this.transports.indexOf(s[a])&&r.push(s[a]);return r}}let Ec=class extends kc{constructor(s,r={}){const a=typeof s=="object"?s:r;(!a.transports||a.transports&&typeof a.transports[0]=="string")&&(a.transports=(a.transports||["polling","websocket","webtransport"]).map(i=>jc[i]).filter(i=>!!i)),super(s,a)}};function _c(t,s="",r){let a=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),a=Dr(t)),a.port||(/^(http|ws)$/.test(a.protocol)?a.port="80":/^(http|ws)s$/.test(a.protocol)&&(a.port="443")),a.path=a.path||"/";const l=a.host.indexOf(":")!==-1?"["+a.host+"]":a.host;return a.id=a.protocol+"://"+l+":"+a.port+s,a.href=a.protocol+"://"+l+(r&&r.port===a.port?"":":"+a.port),a}const Ac=typeof ArrayBuffer=="function",Tc=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,di=Object.prototype.toString,Pc=typeof Blob=="function"||typeof Blob<"u"&&di.call(Blob)==="[object BlobConstructor]",Oc=typeof File=="function"||typeof File<"u"&&di.call(File)==="[object FileConstructor]";function Zr(t){return Ac&&(t instanceof ArrayBuffer||Tc(t))||Pc&&t instanceof Blob||Oc&&t instanceof File}function Hs(t,s){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,a=t.length;r<a;r++)if(Hs(t[r]))return!0;return!1}if(Zr(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Hs(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&Hs(t[r]))return!0;return!1}function Rc(t){const s=[],r=t.data,a=t;return a.data=Lr(r,s),a.attachments=s.length,{packet:a,buffers:s}}function Lr(t,s){if(!t)return t;if(Zr(t)){const r={_placeholder:!0,num:s.length};return s.push(t),r}else if(Array.isArray(t)){const r=new Array(t.length);for(let a=0;a<t.length;a++)r[a]=Lr(t[a],s);return r}else if(typeof t=="object"&&!(t instanceof Date)){const r={};for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=Lr(t[a],s));return r}return t}function Ic(t,s){return t.data=Mr(t.data,s),delete t.attachments,t}function Mr(t,s){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<s.length)return s[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=Mr(t[r],s);else if(typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=Mr(t[r],s));return t}const ui=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Dc=5;var re;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(re||(re={}));class Fc{constructor(s){this.replacer=s}encode(s){return(s.type===re.EVENT||s.type===re.ACK)&&Hs(s)?this.encodeAsBinary({type:s.type===re.EVENT?re.BINARY_EVENT:re.BINARY_ACK,nsp:s.nsp,data:s.data,id:s.id}):[this.encodeAsString(s)]}encodeAsString(s){let r=""+s.type;return(s.type===re.BINARY_EVENT||s.type===re.BINARY_ACK)&&(r+=s.attachments+"-"),s.nsp&&s.nsp!=="/"&&(r+=s.nsp+","),s.id!=null&&(r+=s.id),s.data!=null&&(r+=JSON.stringify(s.data,this.replacer)),r}encodeAsBinary(s){const r=Rc(s),a=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(a),i}}class Yr extends _e{constructor(s){super(),this.reviver=s}add(s){let r;if(typeof s=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(s);const a=r.type===re.BINARY_EVENT;a||r.type===re.BINARY_ACK?(r.type=a?re.EVENT:re.ACK,this.reconstructor=new Lc(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Zr(s)||s.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(s),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+s)}decodeString(s){let r=0;const a={type:Number(s.charAt(0))};if(re[a.type]===void 0)throw new Error("unknown packet type "+a.type);if(a.type===re.BINARY_EVENT||a.type===re.BINARY_ACK){const l=r+1;for(;s.charAt(++r)!=="-"&&r!=s.length;);const c=s.substring(l,r);if(c!=Number(c)||s.charAt(r)!=="-")throw new Error("Illegal attachments");a.attachments=Number(c)}if(s.charAt(r+1)==="/"){const l=r+1;for(;++r&&!(s.charAt(r)===","||r===s.length););a.nsp=s.substring(l,r)}else a.nsp="/";const i=s.charAt(r+1);if(i!==""&&Number(i)==i){const l=r+1;for(;++r;){const c=s.charAt(r);if(c==null||Number(c)!=c){--r;break}if(r===s.length)break}a.id=Number(s.substring(l,r+1))}if(s.charAt(++r)){const l=this.tryParse(s.substr(r));if(Yr.isPayloadValid(a.type,l))a.data=l;else throw new Error("invalid payload")}return a}tryParse(s){try{return JSON.parse(s,this.reviver)}catch{return!1}}static isPayloadValid(s,r){switch(s){case re.CONNECT:return Zs(r);case re.DISCONNECT:return r===void 0;case re.CONNECT_ERROR:return typeof r=="string"||Zs(r);case re.EVENT:case re.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&ui.indexOf(r[0])===-1);case re.ACK:case re.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Lc{constructor(s){this.packet=s,this.buffers=[],this.reconPack=s}takeBinaryData(s){if(this.buffers.push(s),this.buffers.length===this.reconPack.attachments){const r=Ic(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Mc(t){return typeof t=="string"}const Bc=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};function $c(t){return t===void 0||Bc(t)}function Zs(t){return Object.prototype.toString.call(t)==="[object Object]"}function qc(t,s){switch(t){case re.CONNECT:return s===void 0||Zs(s);case re.DISCONNECT:return s===void 0;case re.EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&ui.indexOf(s[0])===-1);case re.ACK:return Array.isArray(s);case re.CONNECT_ERROR:return typeof s=="string"||Zs(s);default:return!1}}function Vc(t){return Mc(t.nsp)&&$c(t.id)&&qc(t.type,t.data)}const Uc=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Yr,Encoder:Fc,get PacketType(){return re},isPacketValid:Vc,protocol:Dc},Symbol.toStringTag,{value:"Module"}));function Xe(t,s,r){return t.on(s,r),function(){t.off(s,r)}}const Wc=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class mi extends _e{constructor(s,r,a){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=s,this.nsp=r,a&&a.auth&&(this.auth=a.auth),this._opts=Object.assign({},a),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const s=this.io;this.subs=[Xe(s,"open",this.onopen.bind(this)),Xe(s,"packet",this.onpacket.bind(this)),Xe(s,"error",this.onerror.bind(this)),Xe(s,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...s){return s.unshift("message"),this.emit.apply(this,s),this}emit(s,...r){var a,i,l;if(Wc.hasOwnProperty(s))throw new Error('"'+s.toString()+'" is a reserved event name');if(r.unshift(s),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const c={type:re.EVENT,data:r};if(c.options={},c.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const h=this.ids++,p=r.pop();this._registerAckCallback(h,p),c.id=h}const m=(i=(a=this.io.engine)===null||a===void 0?void 0:a.transport)===null||i===void 0?void 0:i.writable,x=this.connected&&!(!((l=this.io.engine)===null||l===void 0)&&l._hasPingExpired());return this.flags.volatile&&!m||(x?(this.notifyOutgoingListeners(c),this.packet(c)):this.sendBuffer.push(c)),this.flags={},this}_registerAckCallback(s,r){var a;const i=(a=this.flags.timeout)!==null&&a!==void 0?a:this._opts.ackTimeout;if(i===void 0){this.acks[s]=r;return}const l=this.io.setTimeoutFn(()=>{delete this.acks[s];for(let m=0;m<this.sendBuffer.length;m++)this.sendBuffer[m].id===s&&this.sendBuffer.splice(m,1);r.call(this,new Error("operation has timed out"))},i),c=(...m)=>{this.io.clearTimeoutFn(l),r.apply(this,m)};c.withError=!0,this.acks[s]=c}emitWithAck(s,...r){return new Promise((a,i)=>{const l=(c,m)=>c?i(c):a(m);l.withError=!0,r.push(l),this.emit(s,...r)})}_addToQueue(s){let r;typeof s[s.length-1]=="function"&&(r=s.pop());const a={id:this._queueSeq++,tryCount:0,pending:!1,args:s,flags:Object.assign({fromQueue:!0},this.flags)};s.push((i,...l)=>(this._queue[0],i!==null?a.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...l)),a.pending=!1,this._drainQueue())),this._queue.push(a),this._drainQueue()}_drainQueue(s=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!s||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(s){s.nsp=this.nsp,this.io._packet(s)}onopen(){typeof this.auth=="function"?this.auth(s=>{this._sendConnectPacket(s)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(s){this.packet({type:re.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},s):s})}onerror(s){this.connected||this.emitReserved("connect_error",s)}onclose(s,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",s,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(s=>{if(!this.sendBuffer.some(a=>String(a.id)===s)){const a=this.acks[s];delete this.acks[s],a.withError&&a.call(this,new Error("socket has been disconnected"))}})}onpacket(s){if(s.nsp===this.nsp)switch(s.type){case re.CONNECT:s.data&&s.data.sid?this.onconnect(s.data.sid,s.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case re.EVENT:case re.BINARY_EVENT:this.onevent(s);break;case re.ACK:case re.BINARY_ACK:this.onack(s);break;case re.DISCONNECT:this.ondisconnect();break;case re.CONNECT_ERROR:this.destroy();const a=new Error(s.data.message);a.data=s.data.data,this.emitReserved("connect_error",a);break}}onevent(s){const r=s.data||[];s.id!=null&&r.push(this.ack(s.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(s){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const a of r)a.apply(this,s)}super.emit.apply(this,s),this._pid&&s.length&&typeof s[s.length-1]=="string"&&(this._lastOffset=s[s.length-1])}ack(s){const r=this;let a=!1;return function(...i){a||(a=!0,r.packet({type:re.ACK,id:s,data:i}))}}onack(s){const r=this.acks[s.id];typeof r=="function"&&(delete this.acks[s.id],r.withError&&s.data.unshift(null),r.apply(this,s.data))}onconnect(s,r){this.id=s,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(s=>this.emitEvent(s)),this.receiveBuffer=[],this.sendBuffer.forEach(s=>{this.notifyOutgoingListeners(s),this.packet(s)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(s=>s()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:re.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(s){return this.flags.compress=s,this}get volatile(){return this.flags.volatile=!0,this}timeout(s){return this.flags.timeout=s,this}onAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(s),this}prependAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(s),this}offAny(s){if(!this._anyListeners)return this;if(s){const r=this._anyListeners;for(let a=0;a<r.length;a++)if(s===r[a])return r.splice(a,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(s),this}prependAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(s),this}offAnyOutgoing(s){if(!this._anyOutgoingListeners)return this;if(s){const r=this._anyOutgoingListeners;for(let a=0;a<r.length;a++)if(s===r[a])return r.splice(a,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(s){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const a of r)a.apply(this,s.data)}}}function Gt(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Gt.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var s=Math.random(),r=Math.floor(s*this.jitter*t);t=Math.floor(s*10)&1?t+r:t-r}return Math.min(t,this.max)|0};Gt.prototype.reset=function(){this.attempts=0};Gt.prototype.setMin=function(t){this.ms=t};Gt.prototype.setMax=function(t){this.max=t};Gt.prototype.setJitter=function(t){this.jitter=t};class Br extends _e{constructor(s,r){var a;super(),this.nsps={},this.subs=[],s&&typeof s=="object"&&(r=s,s=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,sr(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((a=r.randomizationFactor)!==null&&a!==void 0?a:.5),this.backoff=new Gt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=s;const i=r.parser||Uc;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(s){return arguments.length?(this._reconnection=!!s,s||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(s){return s===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=s,this)}reconnectionDelay(s){var r;return s===void 0?this._reconnectionDelay:(this._reconnectionDelay=s,(r=this.backoff)===null||r===void 0||r.setMin(s),this)}randomizationFactor(s){var r;return s===void 0?this._randomizationFactor:(this._randomizationFactor=s,(r=this.backoff)===null||r===void 0||r.setJitter(s),this)}reconnectionDelayMax(s){var r;return s===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=s,(r=this.backoff)===null||r===void 0||r.setMax(s),this)}timeout(s){return arguments.length?(this._timeout=s,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(s){if(~this._readyState.indexOf("open"))return this;this.engine=new Ec(this.uri,this.opts);const r=this.engine,a=this;this._readyState="opening",this.skipReconnect=!1;const i=Xe(r,"open",function(){a.onopen(),s&&s()}),l=m=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",m),s?s(m):this.maybeReconnectOnOpen()},c=Xe(r,"error",l);if(this._timeout!==!1){const m=this._timeout,x=this.setTimeoutFn(()=>{i(),l(new Error("timeout")),r.close()},m);this.opts.autoUnref&&x.unref(),this.subs.push(()=>{this.clearTimeoutFn(x)})}return this.subs.push(i),this.subs.push(c),this}connect(s){return this.open(s)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const s=this.engine;this.subs.push(Xe(s,"ping",this.onping.bind(this)),Xe(s,"data",this.ondata.bind(this)),Xe(s,"error",this.onerror.bind(this)),Xe(s,"close",this.onclose.bind(this)),Xe(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(s){try{this.decoder.add(s)}catch(r){this.onclose("parse error",r)}}ondecoded(s){tr(()=>{this.emitReserved("packet",s)},this.setTimeoutFn)}onerror(s){this.emitReserved("error",s)}socket(s,r){let a=this.nsps[s];return a?this._autoConnect&&!a.active&&a.connect():(a=new mi(this,s,r),this.nsps[s]=a),a}_destroy(s){const r=Object.keys(this.nsps);for(const a of r)if(this.nsps[a].active)return;this._close()}_packet(s){const r=this.encoder.encode(s);for(let a=0;a<r.length;a++)this.engine.write(r[a],s.options)}cleanup(){this.subs.forEach(s=>s()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(s,r){var a;this.cleanup(),(a=this.engine)===null||a===void 0||a.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",s,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const s=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const a=this.setTimeoutFn(()=>{s.skipReconnect||(this.emitReserved("reconnect_attempt",s.backoff.attempts),!s.skipReconnect&&s.open(i=>{i?(s._reconnecting=!1,s.reconnect(),this.emitReserved("reconnect_error",i)):s.onreconnect()}))},r);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}}onreconnect(){const s=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",s)}}const hs={};function Ks(t,s){typeof t=="object"&&(s=t,t=void 0),s=s||{};const r=_c(t,s.path||"/socket.io"),a=r.source,i=r.id,l=r.path,c=hs[i]&&l in hs[i].nsps,m=s.forceNew||s["force new connection"]||s.multiplex===!1||c;let x;return m?x=new Br(a,s):(hs[i]||(hs[i]=new Br(a,s)),x=hs[i]),r.query&&!s.query&&(s.query=r.queryKey),x.socket(r.path,s)}Object.assign(Ks,{Manager:Br,Socket:mi,io:Ks,connect:Ks});const Hc="/notification.wav";var Fn;const Kc=typeof window<"u"&&((Fn=window.electronAPI)==null?void 0:Fn.isElectron)===!0,xe={ORDER_CREATED:"ORDER_CREATED",ORDER_RESCHEDULED:"ORDER_RESCHEDULED",TECHNICIAN_ASSIGNED:"TECHNICIAN_ASSIGNED",JOB_UPDATED:"JOB_UPDATED",CUSTOMER_ORDER_PLACED:"CUSTOMER_ORDER_PLACED",PAYMENT_RECEIVED:"PAYMENT_RECEIVED",TECHNICIAN_CHECKED_IN:"TECHNICIAN_CHECKED_IN",CUSTOMER_APPROVAL_REQUIRED:"CUSTOMER_APPROVAL_REQUIRED",CUSTOMER_APPROVAL_UPDATED:"CUSTOMER_APPROVAL_UPDATED",TECHNICIAN_UNASSIGNED:"TECHNICIAN_UNASSIGNED",ORDER_CANCELLATION_REQUESTED:"ORDER_CANCELLATION_REQUESTED",ORDER_CANCELLED:"ORDER_CANCELLED"},hi=o.createContext(null),Qc="https://admin.eopsys.xyz",zc=({children:t})=>{const[s,r]=o.useState(null),[a,i]=o.useState(!1),[l,c]=o.useState([]),[m,x]=o.useState(!0),g=jt(),h=o.useRef(null);o.useEffect(()=>(h.current=new Audio(Hc),h.current.volume=.5,h.current.load(),()=>{h.current&&(h.current.pause(),h.current=null)}),[]),o.useEffect(()=>{const O=()=>{if(h.current&&!m){const C=h.current;C.volume=0,C.play().then(()=>{C.pause(),C.currentTime=0,C.volume=.5,x(!0),console.log("[Sound] Audio unlocked - notifications will play")}).catch(()=>{})}},M=["click","touchstart","keydown"];return M.forEach(C=>{document.addEventListener(C,O,{once:!1,passive:!0})}),()=>{M.forEach(C=>{document.removeEventListener(C,O)})}},[m]);const p=o.useCallback(()=>{h.current&&m?(h.current.currentTime=0,h.current.play().catch(O=>{console.log("[Sound] Could not play notification sound:",O.message)})):m||console.log("[Sound] Audio not yet unlocked - click anywhere to enable notification sounds")},[m]),j=o.useCallback((O,M)=>{const C={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,event:O,payload:M,timestamp:new Date,read:!1};c(k=>[C,...k].slice(0,50))},[]),K=o.useCallback(()=>{c([])},[]),z=o.useCallback((O,M)=>{let C="",k=e.jsx(Yn,{className:"h-5 w-5 text-blue-500"});switch(O){case xe.ORDER_CREATED:case xe.CUSTOMER_ORDER_PLACED:C=`New order received${M.orderCode?`: #${M.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case xe.TECHNICIAN_ASSIGNED:C=`Technician assigned to order${M.orderCode?` #${M.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case xe.ORDER_RESCHEDULED:C=`Order rescheduled${M.orderCode?`: #${M.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case xe.PAYMENT_RECEIVED:C=`Payment received${M.amount?`: ${M.amount}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case xe.TECHNICIAN_CHECKED_IN:C="Technician checked in",k=e.jsx("span",{className:"text-xl",children:""});break;case xe.CUSTOMER_APPROVAL_REQUIRED:C="Customer approval required",k=e.jsx("span",{className:"text-xl",children:""});break;case xe.CUSTOMER_APPROVAL_UPDATED:C="Customer approval updated",k=e.jsx("span",{className:"text-xl",children:""});break;case xe.JOB_UPDATED:C="Job card updated",k=e.jsx("span",{className:"text-xl",children:""});break;case xe.TECHNICIAN_UNASSIGNED:C="Technician unassigned from order",k=e.jsx("span",{className:"text-xl",children:""});break;case xe.ORDER_CANCELLATION_REQUESTED:C=`Cancellation requested${M.orderCode?`: #${M.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;case xe.ORDER_CANCELLED:C=`Order cancelled${M.orderCode?`: #${M.orderCode}`:""}`,k=e.jsx("span",{className:"text-xl",children:""});break;default:C="New notification received"}N(C,{icon:k,duration:5e3,position:"top-right",style:{borderRadius:"12px",background:"#1e293b",color:"#fff",padding:"12px 16px"}}),Kc&&window.electronAPI&&window.electronAPI.showNotification("Fixzep Admin",C)},[]);o.useEffect(()=>{const O=localStorage.getItem("fixzep_token"),M=localStorage.getItem("fixzep_user");if(!O||!M)return;let C={};try{C=JSON.parse(M)}catch{return}const k=Ks(Qc,{transports:["websocket","polling"],autoConnect:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3});return k.on("connect",()=>{console.log("[Socket] Connected:",k.id),i(!0),C.role==="admin"?k.emit("admin:join",{userId:C.id}):C.role==="technician"?k.emit("technician:join",{userId:C.id}):k.emit("customer:join",{userId:C.id})}),k.on("disconnect",()=>{console.log("[Socket] Disconnected"),i(!1)}),k.on("connect_error",R=>{console.error("[Socket] Connection error:",R),i(!1)}),Object.values(xe).forEach(R=>{k.on(R,D=>{console.log(`[Socket] Received ${R}:`,D),j(R,D),z(R,D),(R===xe.ORDER_CREATED||R===xe.CUSTOMER_ORDER_PLACED||R===xe.ORDER_CANCELLATION_REQUESTED||R===xe.ORDER_CANCELLED)&&p(),R===xe.ORDER_CREATED||R===xe.CUSTOMER_ORDER_PLACED?(g.invalidateQueries({queryKey:["orders"]}),g.invalidateQueries({queryKey:["dashboard"]})):R===xe.TECHNICIAN_ASSIGNED||R===xe.TECHNICIAN_UNASSIGNED?(g.invalidateQueries({queryKey:["orders"]}),g.invalidateQueries({queryKey:["technicians"]}),D!=null&&D.orderId&&g.invalidateQueries({queryKey:["order-jobcard",D.orderId]})):R===xe.JOB_UPDATED||R===xe.ORDER_CANCELLATION_REQUESTED||R===xe.ORDER_CANCELLED?(g.invalidateQueries({queryKey:["orders"]}),D!=null&&D.orderId&&g.invalidateQueries({queryKey:["order-jobcard",D.orderId]})):R===xe.ORDER_RESCHEDULED?(g.invalidateQueries({queryKey:["orders"]}),D!=null&&D.orderId&&g.invalidateQueries({queryKey:["order-jobcard",D.orderId]})):R===xe.PAYMENT_RECEIVED&&(g.invalidateQueries({queryKey:["orders"]}),D!=null&&D.orderId&&g.invalidateQueries({queryKey:["order-jobcard",D.orderId]}))})}),r(k),()=>{k.disconnect(),r(null),i(!1)}},[j,z,p,g]);const Z=l.filter(O=>!O.read).length;return e.jsx(hi.Provider,{value:{socket:s,isConnected:a,notifications:l,clearNotifications:K,unreadCount:Z,soundEnabled:m},children:t})},Zc=()=>{const t=o.useContext(hi);if(!t)throw new Error("useSocket must be used within a SocketProvider");return t},Yc=()=>{const t=o.useMemo(()=>{var c;return typeof window<"u"&&((c=window.electronAPI)==null?void 0:c.isElectron)===!0},[]),s=o.useMemo(()=>t&&window.electronAPI?window.electronAPI.platform:"web",[t]),r=o.useCallback((c,m)=>{t&&window.electronAPI?window.electronAPI.showNotification(c,m):"Notification"in window&&Notification.permission==="granted"?new Notification(c,{body:m}):"Notification"in window&&Notification.permission!=="denied"&&Notification.requestPermission().then(x=>{x==="granted"&&new Notification(c,{body:m})})},[t]),a=o.useCallback(()=>{t&&window.electronAPI&&window.electronAPI.minimizeWindow()},[t]),i=o.useCallback(()=>{t&&window.electronAPI&&window.electronAPI.maximizeWindow()},[t]),l=o.useCallback(()=>{t&&window.electronAPI&&window.electronAPI.closeWindow()},[t]);return{isElectron:t,platform:s,showNotification:r,minimizeWindow:a,maximizeWindow:i,closeWindow:l}},Jc=()=>{const{user:t,logout:s}=Hr(),r=Xn(m=>m.toggle),{isConnected:a,unreadCount:i,soundEnabled:l}=Zc(),{isElectron:c}=Yc();return e.jsxs("header",{className:"flex items-center justify-between border-b border-slate-200 bg-white/80 px-6 py-4 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:r,className:"lg:hidden rounded-full border border-slate-200 p-2 text-slate-600",children:e.jsx(oo,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Admin"}),e.jsxs("h2",{className:"text-lg font-semibold text-slate-900",children:["Welcome, ",t==null?void 0:t.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[c&&e.jsxs("div",{className:"flex items-center gap-1.5 rounded-full bg-slate-100 px-2 py-1",title:"Running as Desktop App",children:[e.jsx(vo,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Desktop"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",title:a?"Connected - Real-time updates active":"Disconnected - Reconnecting...",children:[e.jsx(Vo,{className:`h-4 w-4 ${a?"text-emerald-500":"text-slate-300"}`}),e.jsx("span",{className:`h-2 w-2 rounded-full ${a?"bg-emerald-500 animate-pulse":"bg-slate-300"}`})]}),e.jsx("div",{className:"flex items-center",title:l?"Sound notifications enabled":"Click anywhere to enable sound notifications",children:l?e.jsx(Io,{className:"h-4 w-4 text-emerald-500"}):e.jsx(Fo,{className:"h-4 w-4 text-amber-500 animate-pulse"})}),e.jsxs("div",{className:"relative",children:[e.jsx(Yn,{className:"h-5 w-5 text-slate-500"}),i>0&&e.jsx("span",{className:"absolute -right-1 -top-1 flex h-4 w-4 items-center justify-center rounded-full bg-rose-500 text-[10px] font-bold text-white",children:i>9?"9+":i})]}),e.jsx("button",{onClick:s,className:"rounded-full border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-600 hover:border-slate-900 hover:text-slate-900",children:"Logout"})]})]})},Xc=()=>{const{isOpen:t,close:s}=Xn();return e.jsxs("div",{className:"flex min-h-screen bg-slate-50 text-slate-900",children:[e.jsx(un,{}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx(Jc,{}),e.jsx("main",{className:"flex-1 px-4 py-6 sm:px-6 lg:px-10",children:e.jsx("div",{className:"mx-auto max-w-6xl",children:e.jsx(Gi,{})})})]}),e.jsx("div",{className:vt("fixed inset-0 z-40 bg-slate-900/60 backdrop-blur-sm transition-opacity lg:hidden",t?"opacity-100 pointer-events-auto":"pointer-events-none opacity-0"),onClick:s,children:e.jsx("div",{className:vt("absolute inset-y-0 left-0 w-72 transform bg-white shadow-xl transition-transform",t?"translate-x-0":"-translate-x-full"),children:e.jsx(un,{})})})]})};var Ns=t=>t.type==="checkbox",Ft=t=>t instanceof Date,Ke=t=>t==null;const pi=t=>typeof t=="object";var Ae=t=>!Ke(t)&&!Array.isArray(t)&&pi(t)&&!Ft(t),Gc=t=>Ae(t)&&t.target?Ns(t.target)?t.target.checked:t.target.value:t,ed=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,td=(t,s)=>t.has(ed(s)),sd=t=>{const s=t.constructor&&t.constructor.prototype;return Ae(s)&&s.hasOwnProperty("isPrototypeOf")},Jr=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function De(t){let s;const r=Array.isArray(t),a=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)s=new Date(t);else if(!(Jr&&(t instanceof Blob||a))&&(r||Ae(t)))if(s=r?[]:Object.create(Object.getPrototypeOf(t)),!r&&!sd(t))s=t;else for(const i in t)t.hasOwnProperty(i)&&(s[i]=De(t[i]));else return t;return s}var rr=t=>/^\w*$/.test(t),Se=t=>t===void 0,Xr=t=>Array.isArray(t)?t.filter(Boolean):[],Gr=t=>Xr(t.replace(/["|']|\]/g,"").split(/\.|\[/)),B=(t,s,r)=>{if(!s||!Ae(t))return r;const a=(rr(s)?[s]:Gr(s)).reduce((i,l)=>Ke(i)?i:i[l],t);return Se(a)||a===t?Se(t[s])?r:t[s]:a},at=t=>typeof t=="boolean",ye=(t,s,r)=>{let a=-1;const i=rr(s)?[s]:Gr(s),l=i.length,c=l-1;for(;++a<l;){const m=i[a];let x=r;if(a!==c){const g=t[m];x=Ae(g)||Array.isArray(g)?g:isNaN(+i[a+1])?{}:[]}if(m==="__proto__"||m==="constructor"||m==="prototype")return;t[m]=x,t=t[m]}};const fn={BLUR:"blur",FOCUS_OUT:"focusout"},Ge={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},gt={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},xi=ve.createContext(null);xi.displayName="HookFormContext";const rd=()=>ve.useContext(xi);var ad=(t,s,r,a=!0)=>{const i={defaultValues:s._defaultValues};for(const l in t)Object.defineProperty(i,l,{get:()=>{const c=l;return s._proxyFormState[c]!==Ge.all&&(s._proxyFormState[c]=!a||Ge.all),t[c]}});return i};const fi=typeof window<"u"?ve.useLayoutEffect:ve.useEffect;var Ze=t=>typeof t=="string",$r=(t,s,r,a,i)=>Ze(t)?(a&&s.watch.add(t),B(r,t,i)):Array.isArray(t)?t.map(l=>(a&&s.watch.add(l),B(r,l))):(a&&(s.watchAll=!0),r),qr=t=>Ke(t)||!pi(t);function et(t,s,r=new WeakSet){if(qr(t)||qr(s))return Object.is(t,s);if(Ft(t)&&Ft(s))return t.getTime()===s.getTime();const a=Object.keys(t),i=Object.keys(s);if(a.length!==i.length)return!1;if(r.has(t)||r.has(s))return!0;r.add(t),r.add(s);for(const l of a){const c=t[l];if(!i.includes(l))return!1;if(l!=="ref"){const m=s[l];if(Ft(c)&&Ft(m)||Ae(c)&&Ae(m)||Array.isArray(c)&&Array.isArray(m)?!et(c,m,r):!Object.is(c,m))return!1}}return!0}function nd(t){const s=rd(),{control:r=s.control,name:a,defaultValue:i,disabled:l,exact:c,compute:m}=t||{},x=ve.useRef(i),g=ve.useRef(m),h=ve.useRef(void 0),p=ve.useRef(r),j=ve.useRef(a);g.current=m;const[K,z]=ve.useState(()=>{const R=r._getWatch(a,x.current);return g.current?g.current(R):R}),Z=ve.useCallback(R=>{const D=$r(a,r._names,R||r._formValues,!1,x.current);return g.current?g.current(D):D},[r._formValues,r._names,a]),O=ve.useCallback(R=>{if(!l){const D=$r(a,r._names,R||r._formValues,!1,x.current);if(g.current){const oe=g.current(D);et(oe,h.current)||(z(oe),h.current=oe)}else z(D)}},[r._formValues,r._names,l,a]);fi(()=>((p.current!==r||!et(j.current,a))&&(p.current=r,j.current=a,O()),r._subscribe({name:a,formState:{values:!0},exact:c,callback:R=>{O(R.values)}})),[r,c,a,O]),ve.useEffect(()=>r._removeUnmounted());const M=p.current!==r,C=j.current,k=ve.useMemo(()=>{if(l)return null;const R=!M&&!et(C,a);return M||R?Z():null},[l,M,a,C,Z]);return k!==null?k:K}var id=(t,s,r,a,i)=>s?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[a]:i||!0}}:{},ys=t=>Array.isArray(t)?t:[t],gn=()=>{let t=[];return{get observers(){return t},next:i=>{for(const l of t)l.next&&l.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(l=>l!==i)}}),unsubscribe:()=>{t=[]}}};function gi(t,s){const r={};for(const a in t)if(t.hasOwnProperty(a)){const i=t[a],l=s[a];if(i&&Ae(i)&&l){const c=gi(i,l);Ae(c)&&(r[a]=c)}else t[a]&&(r[a]=l)}return r}var We=t=>Ae(t)&&!Object.keys(t).length,ea=t=>t.type==="file",tt=t=>typeof t=="function",Ys=t=>{if(!Jr)return!1;const s=t?t.ownerDocument:0;return t instanceof(s&&s.defaultView?s.defaultView.HTMLElement:HTMLElement)},bi=t=>t.type==="select-multiple",ta=t=>t.type==="radio",ld=t=>ta(t)||Ns(t),kr=t=>Ys(t)&&t.isConnected;function od(t,s){const r=s.slice(0,-1).length;let a=0;for(;a<r;)t=Se(t)?a++:t[s[a++]];return t}function cd(t){for(const s in t)if(t.hasOwnProperty(s)&&!Se(t[s]))return!1;return!0}function Ee(t,s){const r=Array.isArray(s)?s:rr(s)?[s]:Gr(s),a=r.length===1?t:od(t,r),i=r.length-1,l=r[i];return a&&delete a[l],i!==0&&(Ae(a)&&We(a)||Array.isArray(a)&&cd(a))&&Ee(t,r.slice(0,-1)),t}var dd=t=>{for(const s in t)if(tt(t[s]))return!0;return!1};function yi(t){return Array.isArray(t)||Ae(t)&&!dd(t)}function Vr(t,s={}){for(const r in t){const a=t[r];yi(a)?(s[r]=Array.isArray(a)?[]:{},Vr(a,s[r])):Se(a)||(s[r]=!0)}return s}function Zt(t,s,r){r||(r=Vr(s));for(const a in t){const i=t[a];if(yi(i))Se(s)||qr(r[a])?r[a]=Vr(i,Array.isArray(i)?[]:{}):Zt(i,Ke(s)?{}:s[a],r[a]);else{const l=s[a];r[a]=!et(i,l)}}return r}const bn={value:!1,isValid:!1},yn={value:!0,isValid:!0};var vi=t=>{if(Array.isArray(t)){if(t.length>1){const s=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:s,isValid:!!s.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Se(t[0].attributes.value)?Se(t[0].value)||t[0].value===""?yn:{value:t[0].value,isValid:!0}:yn:bn}return bn},ji=(t,{valueAsNumber:s,valueAsDate:r,setValueAs:a})=>Se(t)?t:s?t===""?NaN:t&&+t:r&&Ze(t)?new Date(t):a?a(t):t;const vn={isValid:!1,value:null};var wi=t=>Array.isArray(t)?t.reduce((s,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:s,vn):vn;function jn(t){const s=t.ref;return ea(s)?s.files:ta(s)?wi(t.refs).value:bi(s)?[...s.selectedOptions].map(({value:r})=>r):Ns(s)?vi(t.refs).value:ji(Se(s.value)?t.ref.value:s.value,t)}var ud=(t,s,r,a)=>{const i={};for(const l of t){const c=B(s,l);c&&ye(i,l,c._f)}return{criteriaMode:r,names:[...t],fields:i,shouldUseNativeValidation:a}},Js=t=>t instanceof RegExp,ps=t=>Se(t)?t:Js(t)?t.source:Ae(t)?Js(t.value)?t.value.source:t.value:t,wn=t=>({isOnSubmit:!t||t===Ge.onSubmit,isOnBlur:t===Ge.onBlur,isOnChange:t===Ge.onChange,isOnAll:t===Ge.all,isOnTouch:t===Ge.onTouched});const Nn="AsyncFunction";var md=t=>!!t&&!!t.validate&&!!(tt(t.validate)&&t.validate.constructor.name===Nn||Ae(t.validate)&&Object.values(t.validate).find(s=>s.constructor.name===Nn)),hd=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),Sn=(t,s,r)=>!r&&(s.watchAll||s.watch.has(t)||[...s.watch].some(a=>t.startsWith(a)&&/^\.\w+/.test(t.slice(a.length))));const vs=(t,s,r,a)=>{for(const i of r||Object.keys(t)){const l=B(t,i);if(l){const{_f:c,...m}=l;if(c){if(c.refs&&c.refs[0]&&s(c.refs[0],i)&&!a)return!0;if(c.ref&&s(c.ref,c.name)&&!a)return!0;if(vs(m,s))break}else if(Ae(m)&&vs(m,s))break}}};function Cn(t,s,r){const a=B(t,r);if(a||rr(r))return{error:a,name:r};const i=r.split(".");for(;i.length;){const l=i.join("."),c=B(s,l),m=B(t,l);if(c&&!Array.isArray(c)&&r!==l)return{name:r};if(m&&m.type)return{name:l,error:m};if(m&&m.root&&m.root.type)return{name:`${l}.root`,error:m.root};i.pop()}return{name:r}}var pd=(t,s,r,a)=>{r(t);const{name:i,...l}=t;return We(l)||Object.keys(l).length>=Object.keys(s).length||Object.keys(l).find(c=>s[c]===(!a||Ge.all))},xd=(t,s,r)=>!t||!s||t===s||ys(t).some(a=>a&&(r?a===s:a.startsWith(s)||s.startsWith(a))),fd=(t,s,r,a,i)=>i.isOnAll?!1:!r&&i.isOnTouch?!(s||t):(r?a.isOnBlur:i.isOnBlur)?!t:(r?a.isOnChange:i.isOnChange)?t:!0,gd=(t,s)=>!Xr(B(t,s)).length&&Ee(t,s),bd=(t,s,r)=>{const a=ys(B(t,r));return ye(a,"root",s[r]),ye(t,r,a),t};function kn(t,s,r="validate"){if(Ze(t)||Array.isArray(t)&&t.every(Ze)||at(t)&&!t)return{type:r,message:Ze(t)?t:"",ref:s}}var Qt=t=>Ae(t)&&!Js(t)?t:{value:t,message:""},En=async(t,s,r,a,i,l)=>{const{ref:c,refs:m,required:x,maxLength:g,minLength:h,min:p,max:j,pattern:K,validate:z,name:Z,valueAsNumber:O,mount:M}=t._f,C=B(r,Z);if(!M||s.has(Z))return{};const k=m?m[0]:c,R=L=>{i&&k.reportValidity&&(k.setCustomValidity(at(L)?"":L||""),k.reportValidity())},D={},oe=ta(c),ge=Ns(c),Ce=oe||ge,be=(O||ea(c))&&Se(c.value)&&Se(C)||Ys(c)&&c.value===""||C===""||Array.isArray(C)&&!C.length,S=id.bind(null,Z,a,D),H=(L,G,ie,de=gt.maxLength,pe=gt.minLength)=>{const je=L?G:ie;D[Z]={type:L?de:pe,message:je,ref:c,...S(L?de:pe,je)}};if(l?!Array.isArray(C)||!C.length:x&&(!Ce&&(be||Ke(C))||at(C)&&!C||ge&&!vi(m).isValid||oe&&!wi(m).isValid)){const{value:L,message:G}=Ze(x)?{value:!!x,message:x}:Qt(x);if(L&&(D[Z]={type:gt.required,message:G,ref:k,...S(gt.required,G)},!a))return R(G),D}if(!be&&(!Ke(p)||!Ke(j))){let L,G;const ie=Qt(j),de=Qt(p);if(!Ke(C)&&!isNaN(C)){const pe=c.valueAsNumber||C&&+C;Ke(ie.value)||(L=pe>ie.value),Ke(de.value)||(G=pe<de.value)}else{const pe=c.valueAsDate||new Date(C),je=Fe=>new Date(new Date().toDateString()+" "+Fe),Oe=c.type=="time",we=c.type=="week";Ze(ie.value)&&C&&(L=Oe?je(C)>je(ie.value):we?C>ie.value:pe>new Date(ie.value)),Ze(de.value)&&C&&(G=Oe?je(C)<je(de.value):we?C<de.value:pe<new Date(de.value))}if((L||G)&&(H(!!L,ie.message,de.message,gt.max,gt.min),!a))return R(D[Z].message),D}if((g||h)&&!be&&(Ze(C)||l&&Array.isArray(C))){const L=Qt(g),G=Qt(h),ie=!Ke(L.value)&&C.length>+L.value,de=!Ke(G.value)&&C.length<+G.value;if((ie||de)&&(H(ie,L.message,G.message),!a))return R(D[Z].message),D}if(K&&!be&&Ze(C)){const{value:L,message:G}=Qt(K);if(Js(L)&&!C.match(L)&&(D[Z]={type:gt.pattern,message:G,ref:c,...S(gt.pattern,G)},!a))return R(G),D}if(z){if(tt(z)){const L=await z(C,r),G=kn(L,k);if(G&&(D[Z]={...G,...S(gt.validate,G.message)},!a))return R(G.message),D}else if(Ae(z)){let L={};for(const G in z){if(!We(L)&&!a)break;const ie=kn(await z[G](C,r),k,G);ie&&(L={...ie,...S(G,ie.message)},R(ie.message),a&&(D[Z]=L))}if(!We(L)&&(D[Z]={ref:k,...L},!a))return D}}return R(!0),D};const yd={mode:Ge.onSubmit,reValidateMode:Ge.onChange,shouldFocusError:!0};function vd(t={}){let s={...yd,...t},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:tt(s.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1},a={},i=Ae(s.defaultValues)||Ae(s.values)?De(s.defaultValues||s.values)||{}:{},l=s.shouldUnregister?{}:De(i),c={action:!1,mount:!1,watch:!1},m={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},x,g=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let p={...h};const j={array:gn(),state:gn()},K=s.criteriaMode===Ge.all,z=u=>f=>{clearTimeout(g),g=setTimeout(u,f)},Z=async u=>{if(!s.disabled&&(h.isValid||p.isValid||u)){const f=s.resolver?We((await ge()).errors):await be(a,!0);f!==r.isValid&&j.state.next({isValid:f})}},O=(u,f)=>{!s.disabled&&(h.isValidating||h.validatingFields||p.isValidating||p.validatingFields)&&((u||Array.from(m.mount)).forEach(b=>{b&&(f?ye(r.validatingFields,b,f):Ee(r.validatingFields,b))}),j.state.next({validatingFields:r.validatingFields,isValidating:!We(r.validatingFields)}))},M=(u,f=[],b,I,A=!0,_=!0)=>{if(I&&b&&!s.disabled){if(c.action=!0,_&&Array.isArray(B(a,u))){const P=b(B(a,u),I.argA,I.argB);A&&ye(a,u,P)}if(_&&Array.isArray(B(r.errors,u))){const P=b(B(r.errors,u),I.argA,I.argB);A&&ye(r.errors,u,P),gd(r.errors,u)}if((h.touchedFields||p.touchedFields)&&_&&Array.isArray(B(r.touchedFields,u))){const P=b(B(r.touchedFields,u),I.argA,I.argB);A&&ye(r.touchedFields,u,P)}(h.dirtyFields||p.dirtyFields)&&(r.dirtyFields=Zt(i,l)),j.state.next({name:u,isDirty:H(u,f),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else ye(l,u,f)},C=(u,f)=>{ye(r.errors,u,f),j.state.next({errors:r.errors})},k=u=>{r.errors=u,j.state.next({errors:r.errors,isValid:!1})},R=(u,f,b,I)=>{const A=B(a,u);if(A){const _=B(l,u,Se(b)?B(i,u):b);Se(_)||I&&I.defaultChecked||f?ye(l,u,f?_:jn(A._f)):ie(u,_),c.mount&&!c.action&&Z()}},D=(u,f,b,I,A)=>{let _=!1,P=!1;const te={name:u};if(!s.disabled){if(!b||I){(h.isDirty||p.isDirty)&&(P=r.isDirty,r.isDirty=te.isDirty=H(),_=P!==te.isDirty);const ae=et(B(i,u),f);P=!!B(r.dirtyFields,u),ae?Ee(r.dirtyFields,u):ye(r.dirtyFields,u,!0),te.dirtyFields=r.dirtyFields,_=_||(h.dirtyFields||p.dirtyFields)&&P!==!ae}if(b){const ae=B(r.touchedFields,u);ae||(ye(r.touchedFields,u,b),te.touchedFields=r.touchedFields,_=_||(h.touchedFields||p.touchedFields)&&ae!==b)}_&&A&&j.state.next(te)}return _?te:{}},oe=(u,f,b,I)=>{const A=B(r.errors,u),_=(h.isValid||p.isValid)&&at(f)&&r.isValid!==f;if(s.delayError&&b?(x=z(()=>C(u,b)),x(s.delayError)):(clearTimeout(g),x=null,b?ye(r.errors,u,b):Ee(r.errors,u)),(b?!et(A,b):A)||!We(I)||_){const P={...I,..._&&at(f)?{isValid:f}:{},errors:r.errors,name:u};r={...r,...P},j.state.next(P)}},ge=async u=>{O(u,!0);const f=await s.resolver(l,s.context,ud(u||m.mount,a,s.criteriaMode,s.shouldUseNativeValidation));return O(u),f},Ce=async u=>{const{errors:f}=await ge(u);if(u)for(const b of u){const I=B(f,b);I?ye(r.errors,b,I):Ee(r.errors,b)}else r.errors=f;return f},be=async(u,f,b={valid:!0})=>{for(const I in u){const A=u[I];if(A){const{_f:_,...P}=A;if(_){const te=m.array.has(_.name),ae=A._f&&md(A._f);ae&&h.validatingFields&&O([_.name],!0);const Re=await En(A,m.disabled,l,K,s.shouldUseNativeValidation&&!f,te);if(ae&&h.validatingFields&&O([_.name]),Re[_.name]&&(b.valid=!1,f))break;!f&&(B(Re,_.name)?te?bd(r.errors,Re,_.name):ye(r.errors,_.name,Re[_.name]):Ee(r.errors,_.name))}!We(P)&&await be(P,f,b)}}return b.valid},S=()=>{for(const u of m.unMount){const f=B(a,u);f&&(f._f.refs?f._f.refs.every(b=>!kr(b)):!kr(f._f.ref))&&X(u)}m.unMount=new Set},H=(u,f)=>!s.disabled&&(u&&f&&ye(l,u,f),!et(Fe(),i)),L=(u,f,b)=>$r(u,m,{...c.mount?l:Se(f)?i:Ze(u)?{[u]:f}:f},b,f),G=u=>Xr(B(c.mount?l:i,u,s.shouldUnregister?B(i,u,[]):[])),ie=(u,f,b={})=>{const I=B(a,u);let A=f;if(I){const _=I._f;_&&(!_.disabled&&ye(l,u,ji(f,_)),A=Ys(_.ref)&&Ke(f)?"":f,bi(_.ref)?[..._.ref.options].forEach(P=>P.selected=A.includes(P.value)):_.refs?Ns(_.ref)?_.refs.forEach(P=>{(!P.defaultChecked||!P.disabled)&&(Array.isArray(A)?P.checked=!!A.find(te=>te===P.value):P.checked=A===P.value||!!A)}):_.refs.forEach(P=>P.checked=P.value===A):ea(_.ref)?_.ref.value="":(_.ref.value=A,_.ref.type||j.state.next({name:u,values:De(l)})))}(b.shouldDirty||b.shouldTouch)&&D(u,A,b.shouldTouch,b.shouldDirty,!0),b.shouldValidate&&we(u)},de=(u,f,b)=>{for(const I in f){if(!f.hasOwnProperty(I))return;const A=f[I],_=u+"."+I,P=B(a,_);(m.array.has(u)||Ae(A)||P&&!P._f)&&!Ft(A)?de(_,A,b):ie(_,A,b)}},pe=(u,f,b={})=>{const I=B(a,u),A=m.array.has(u),_=De(f);ye(l,u,_),A?(j.array.next({name:u,values:De(l)}),(h.isDirty||h.dirtyFields||p.isDirty||p.dirtyFields)&&b.shouldDirty&&j.state.next({name:u,dirtyFields:Zt(i,l),isDirty:H(u,_)})):I&&!I._f&&!Ke(_)?de(u,_,b):ie(u,_,b),Sn(u,m)&&j.state.next({...r,name:u}),j.state.next({name:c.mount?u:void 0,values:De(l)})},je=async u=>{c.mount=!0;const f=u.target;let b=f.name,I=!0;const A=B(a,b),_=ae=>{I=Number.isNaN(ae)||Ft(ae)&&isNaN(ae.getTime())||et(ae,B(l,b,ae))},P=wn(s.mode),te=wn(s.reValidateMode);if(A){let ae,Re;const w=f.type?jn(A._f):Gc(u),ce=u.type===fn.BLUR||u.type===fn.FOCUS_OUT,Ne=!hd(A._f)&&!s.resolver&&!B(r.errors,b)&&!A._f.deps||fd(ce,B(r.touchedFields,b),r.isSubmitted,te,P),Ct=Sn(b,m,ce);ye(l,b,w),ce?(!f||!f.readOnly)&&(A._f.onBlur&&A._f.onBlur(u),x&&x(0)):A._f.onChange&&A._f.onChange(u);const ut=D(b,w,ce),It=!We(ut)||Ct;if(!ce&&j.state.next({name:b,type:u.type,values:De(l)}),Ne)return(h.isValid||p.isValid)&&(s.mode==="onBlur"?ce&&Z():ce||Z()),It&&j.state.next({name:b,...Ct?{}:ut});if(!ce&&Ct&&j.state.next({...r}),s.resolver){const{errors:Je}=await ge([b]);if(_(w),I){const $t=Cn(r.errors,a,b),qt=Cn(Je,a,$t.name||b);ae=qt.error,b=qt.name,Re=We(Je)}}else O([b],!0),ae=(await En(A,m.disabled,l,K,s.shouldUseNativeValidation))[b],O([b]),_(w),I&&(ae?Re=!1:(h.isValid||p.isValid)&&(Re=await be(a,!0)));I&&(A._f.deps&&(!Array.isArray(A._f.deps)||A._f.deps.length>0)&&we(A._f.deps),oe(b,Re,ae,ut))}},Oe=(u,f)=>{if(B(r.errors,f)&&u.focus)return u.focus(),1},we=async(u,f={})=>{let b,I;const A=ys(u);if(s.resolver){const _=await Ce(Se(u)?u:A);b=We(_),I=u?!A.some(P=>B(_,P)):b}else u?(I=(await Promise.all(A.map(async _=>{const P=B(a,_);return await be(P&&P._f?{[_]:P}:P)}))).every(Boolean),!(!I&&!r.isValid)&&Z()):I=b=await be(a);return j.state.next({...!Ze(u)||(h.isValid||p.isValid)&&b!==r.isValid?{}:{name:u},...s.resolver||!u?{isValid:b}:{},errors:r.errors}),f.shouldFocus&&!I&&vs(a,Oe,u?A:m.mount),I},Fe=(u,f)=>{let b={...c.mount?l:i};return f&&(b=gi(f.dirtyFields?r.dirtyFields:r.touchedFields,b)),Se(u)?b:Ze(u)?B(b,u):u.map(I=>B(b,I))},y=(u,f)=>({invalid:!!B((f||r).errors,u),isDirty:!!B((f||r).dirtyFields,u),error:B((f||r).errors,u),isValidating:!!B(r.validatingFields,u),isTouched:!!B((f||r).touchedFields,u)}),ee=u=>{u&&ys(u).forEach(f=>Ee(r.errors,f)),j.state.next({errors:u?r.errors:{}})},le=(u,f,b)=>{const I=(B(a,u,{_f:{}})._f||{}).ref,A=B(r.errors,u)||{},{ref:_,message:P,type:te,...ae}=A;ye(r.errors,u,{...ae,...f,ref:I}),j.state.next({name:u,errors:r.errors,isValid:!1}),b&&b.shouldFocus&&I&&I.focus&&I.focus()},Le=(u,f)=>tt(u)?j.state.subscribe({next:b=>"values"in b&&u(L(void 0,f),b)}):L(u,f,!0),E=u=>j.state.subscribe({next:f=>{xd(u.name,f.name,u.exact)&&pd(f,u.formState||h,Rt,u.reRenderRoot)&&u.callback({values:{...l},...r,...f,defaultValues:i})}}).unsubscribe,Y=u=>(c.mount=!0,p={...p,...u.formState},E({...u,formState:p})),X=(u,f={})=>{for(const b of u?ys(u):m.mount)m.mount.delete(b),m.array.delete(b),f.keepValue||(Ee(a,b),Ee(l,b)),!f.keepError&&Ee(r.errors,b),!f.keepDirty&&Ee(r.dirtyFields,b),!f.keepTouched&&Ee(r.touchedFields,b),!f.keepIsValidating&&Ee(r.validatingFields,b),!s.shouldUnregister&&!f.keepDefaultValue&&Ee(i,b);j.state.next({values:De(l)}),j.state.next({...r,...f.keepDirty?{isDirty:H()}:{}}),!f.keepIsValid&&Z()},ue=({disabled:u,name:f})=>{(at(u)&&c.mount||u||m.disabled.has(f))&&(u?m.disabled.add(f):m.disabled.delete(f))},st=(u,f={})=>{let b=B(a,u);const I=at(f.disabled)||at(s.disabled);return ye(a,u,{...b||{},_f:{...b&&b._f?b._f:{ref:{name:u}},name:u,mount:!0,...f}}),m.mount.add(u),b?ue({disabled:at(f.disabled)?f.disabled:s.disabled,name:u}):R(u,!0,f.value),{...I?{disabled:f.disabled||s.disabled}:{},...s.progressive?{required:!!f.required,min:ps(f.min),max:ps(f.max),minLength:ps(f.minLength),maxLength:ps(f.maxLength),pattern:ps(f.pattern)}:{},name:u,onChange:je,onBlur:je,ref:A=>{if(A){st(u,f),b=B(a,u);const _=Se(A.value)&&A.querySelectorAll&&A.querySelectorAll("input,select,textarea")[0]||A,P=ld(_),te=b._f.refs||[];if(P?te.find(ae=>ae===_):_===b._f.ref)return;ye(a,u,{_f:{...b._f,...P?{refs:[...te.filter(kr),_,...Array.isArray(B(i,u))?[{}]:[]],ref:{type:_.type,name:u}}:{ref:_}}}),R(u,!1,void 0,_)}else b=B(a,u,{}),b._f&&(b._f.mount=!1),(s.shouldUnregister||f.shouldUnregister)&&!(td(m.array,u)&&c.action)&&m.unMount.add(u)}}},ze=()=>s.shouldFocusError&&vs(a,Oe,m.mount),wt=u=>{at(u)&&(j.state.next({disabled:u}),vs(a,(f,b)=>{const I=B(a,b);I&&(f.disabled=I._f.disabled||u,Array.isArray(I._f.refs)&&I._f.refs.forEach(A=>{A.disabled=I._f.disabled||u}))},0,!1))},rt=(u,f)=>async b=>{let I;b&&(b.preventDefault&&b.preventDefault(),b.persist&&b.persist());let A=De(l);if(j.state.next({isSubmitting:!0}),s.resolver){const{errors:_,values:P}=await ge();r.errors=_,A=De(P)}else await be(a);if(m.disabled.size)for(const _ of m.disabled)Ee(A,_);if(Ee(r.errors,"root"),We(r.errors)){j.state.next({errors:{}});try{await u(A,b)}catch(_){I=_}}else f&&await f({...r.errors},b),ze(),setTimeout(ze);if(j.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:We(r.errors)&&!I,submitCount:r.submitCount+1,errors:r.errors}),I)throw I},me=(u,f={})=>{B(a,u)&&(Se(f.defaultValue)?pe(u,De(B(i,u))):(pe(u,f.defaultValue),ye(i,u,De(f.defaultValue))),f.keepTouched||Ee(r.touchedFields,u),f.keepDirty||(Ee(r.dirtyFields,u),r.isDirty=f.defaultValue?H(u,De(B(i,u))):H()),f.keepError||(Ee(r.errors,u),h.isValid&&Z()),j.state.next({...r}))},ct=(u,f={})=>{const b=u?De(u):i,I=De(b),A=We(u),_=A?i:I;if(f.keepDefaultValues||(i=b),!f.keepValues){if(f.keepDirtyValues){const P=new Set([...m.mount,...Object.keys(Zt(i,l))]);for(const te of Array.from(P))B(r.dirtyFields,te)?ye(_,te,B(l,te)):pe(te,B(_,te))}else{if(Jr&&Se(u))for(const P of m.mount){const te=B(a,P);if(te&&te._f){const ae=Array.isArray(te._f.refs)?te._f.refs[0]:te._f.ref;if(Ys(ae)){const Re=ae.closest("form");if(Re){Re.reset();break}}}}if(f.keepFieldsRef)for(const P of m.mount)pe(P,B(_,P));else a={}}l=s.shouldUnregister?f.keepDefaultValues?De(i):{}:De(_),j.array.next({values:{..._}}),j.state.next({values:{..._}})}m={mount:f.keepDirtyValues?m.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},c.mount=!h.isValid||!!f.keepIsValid||!!f.keepDirtyValues||!s.shouldUnregister&&!We(_),c.watch=!!s.shouldUnregister,j.state.next({submitCount:f.keepSubmitCount?r.submitCount:0,isDirty:A?!1:f.keepDirty?r.isDirty:!!(f.keepDefaultValues&&!et(u,i)),isSubmitted:f.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:A?{}:f.keepDirtyValues?f.keepDefaultValues&&l?Zt(i,l):r.dirtyFields:f.keepDefaultValues&&u?Zt(i,u):f.keepDirty?r.dirtyFields:{},touchedFields:f.keepTouched?r.touchedFields:{},errors:f.keepErrors?r.errors:{},isSubmitSuccessful:f.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},dt=(u,f)=>ct(tt(u)?u(l):u,f),Nt=(u,f={})=>{const b=B(a,u),I=b&&b._f;if(I){const A=I.refs?I.refs[0]:I.ref;A.focus&&(A.focus(),f.shouldSelect&&tt(A.select)&&A.select())}},Rt=u=>{r={...r,...u}},St={control:{register:st,unregister:X,getFieldState:y,handleSubmit:rt,setError:le,_subscribe:E,_runSchema:ge,_focusError:ze,_getWatch:L,_getDirty:H,_setValid:Z,_setFieldArray:M,_setDisabledField:ue,_setErrors:k,_getFieldArray:G,_reset:ct,_resetDefaultValues:()=>tt(s.defaultValues)&&s.defaultValues().then(u=>{dt(u,s.resetOptions),j.state.next({isLoading:!1})}),_removeUnmounted:S,_disableForm:wt,_subjects:j,_proxyFormState:h,get _fields(){return a},get _formValues(){return l},get _state(){return c},set _state(u){c=u},get _defaultValues(){return i},get _names(){return m},set _names(u){m=u},get _formState(){return r},get _options(){return s},set _options(u){s={...s,...u}}},subscribe:Y,trigger:we,register:st,handleSubmit:rt,watch:Le,setValue:pe,getValues:Fe,reset:dt,resetField:me,clearErrors:ee,unregister:X,setError:le,setFocus:Nt,getFieldState:y};return{...St,formControl:St}}function ot(t={}){const s=ve.useRef(void 0),r=ve.useRef(void 0),[a,i]=ve.useState({isDirty:!1,isValidating:!1,isLoading:tt(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:tt(t.defaultValues)?void 0:t.defaultValues});if(!s.current)if(t.formControl)s.current={...t.formControl,formState:a},t.defaultValues&&!tt(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:c,...m}=vd(t);s.current={...m,formState:a}}const l=s.current.control;return l._options=t,fi(()=>{const c=l._subscribe({formState:l._proxyFormState,callback:()=>i({...l._formState}),reRenderRoot:!0});return i(m=>({...m,isReady:!0})),l._formState.isReady=!0,c},[l]),ve.useEffect(()=>l._disableForm(t.disabled),[l,t.disabled]),ve.useEffect(()=>{t.mode&&(l._options.mode=t.mode),t.reValidateMode&&(l._options.reValidateMode=t.reValidateMode)},[l,t.mode,t.reValidateMode]),ve.useEffect(()=>{t.errors&&(l._setErrors(t.errors),l._focusError())},[l,t.errors]),ve.useEffect(()=>{t.shouldUnregister&&l._subjects.state.next({values:l._getWatch()})},[l,t.shouldUnregister]),ve.useEffect(()=>{if(l._proxyFormState.isDirty){const c=l._getDirty();c!==a.isDirty&&l._subjects.state.next({isDirty:c})}},[l,a.isDirty]),ve.useEffect(()=>{var c;t.values&&!et(t.values,r.current)?(l._reset(t.values,{keepFieldsRef:!0,...l._options.resetOptions}),!((c=l._options.resetOptions)===null||c===void 0)&&c.keepIsValid||l._setValid(),r.current=t.values,i(m=>({...m}))):l._resetDefaultValues()},[l,t.values]),ve.useEffect(()=>{l._state.mount||(l._setValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),s.current.formState=ad(a,l),s.current}const $=({children:t,className:s,variant:r="primary",icon:a,loading:i,disabled:l,...c})=>{const m={primary:"bg-slate-900 text-white hover:bg-slate-800",secondary:"bg-white text-slate-900 border border-slate-200 hover:border-slate-900",ghost:"bg-transparent text-slate-600 hover:text-slate-900"};return e.jsxs("button",{className:vt("inline-flex items-center justify-center gap-2 rounded-xl px-4 py-2 text-sm font-semibold transition-all focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-900 disabled:opacity-60",m[r],s),disabled:l||i,...c,children:[i&&e.jsx("span",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white/30 border-l-white","aria-hidden":!0}),a,t]})},F=o.forwardRef(({label:t,className:s,helpText:r,icon:a,...i},l)=>e.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:[t&&e.jsx("span",{className:"font-medium text-slate-900",children:t}),e.jsxs("div",{className:"relative",children:[a&&e.jsx("span",{className:"pointer-events-none absolute inset-y-0 left-3 flex items-center text-slate-400",children:a}),e.jsx("input",{ref:l,className:vt("w-full rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-slate-900 placeholder:text-slate-400 focus:border-slate-900 focus:outline-none",a&&"pl-10",s),...i})]}),r&&e.jsx("span",{className:"text-xs text-slate-400",children:r})]}));F.displayName="Input";const jd={email:"",password:"",role:"admin"},wd=()=>{const{register:t,handleSubmit:s,formState:{isSubmitting:r}}=ot({defaultValues:jd}),{login:a,isAuthenticated:i}=Hr(),l=Xs(),c=async m=>{await a(m),l("/",{replace:!0})};return o.useEffect(()=>{i&&l("/",{replace:!0})},[i,l]),i?null:e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 px-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-3xl border border-white/5 bg-white/10 p-8 backdrop-blur",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-white/70",children:"Fixzep"}),e.jsx("h1",{className:"mt-4 text-3xl font-bold text-white",children:"Admin Control Login"}),e.jsx("p",{className:"mt-2 text-sm text-white/70",children:"Use your admin credentials to access mission control."}),e.jsxs("form",{onSubmit:s(c),className:"mt-8 space-y-5",children:[e.jsx(F,{type:"email",label:"Email",placeholder:"admin@fixzep.com",...t("email",{required:!0}),className:"bg-white/90"}),e.jsx(F,{type:"password",label:"Password",placeholder:"",...t("password",{required:!0}),className:"bg-white/90"}),e.jsx($,{type:"submit",loading:r,className:"w-full justify-center text-base",children:"Enter Dashboard"})]})]})})},$e=({children:t,className:s,title:r,actions:a})=>e.jsxs("section",{className:vt("rounded-2xl border border-white/60 bg-white/90 p-6 shadow-card backdrop-blur",s),children:[(r||a)&&e.jsxs("header",{className:"mb-4 flex items-center justify-between gap-4",children:[r&&e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:r}),a]}),t]}),Be=t=>new Intl.DateTimeFormat("en-IN",{dateStyle:"medium",timeStyle:"short"}).format(new Date(t)),Ue=(t,s="INR")=>{const r=typeof t=="number"?t:0;return new Intl.NumberFormat("en-IN",{style:"currency",currency:s,maximumFractionDigits:0}).format(r)},Nd=new Set(["completed","cancelled"]),Sd=()=>{var h;const{data:t=[],isLoading:s}=fe({queryKey:["orders","dashboard"],queryFn:()=>ke.list()}),{data:r=[],isLoading:a}=fe({queryKey:["technicians","dashboard"],queryFn:()=>Yt.list()}),i=o.useMemo(()=>{const p=s?null:t.filter(z=>!Nd.has(z.status)),j=p?p.filter(z=>z.status==="pending_assignment"):null,K=a?null:r.filter(z=>{var Z;return((Z=z.todayAttendance)==null?void 0:Z.status)==="present"});return[{label:"Open Orders",value:(p==null?void 0:p.length.toString())??"",delta:j?`${j.length} awaiting assignment`:"fetching",accent:p?"text-slate-900":"text-slate-400",link:"/orders"},{label:"Pending Assignments",value:(j==null?void 0:j.length.toString())??"",delta:p&&j?`${p.length-j.length} already scheduled`:"fetching",accent:j?j.length?"text-amber-600":"text-emerald-600":"text-slate-400",link:"/orders?status=pending_assignment"},{label:"Technicians Active",value:(K==null?void 0:K.length.toString())??"",delta:K?`${r.length} on roster`:"fetching",accent:K?K.length?"text-emerald-600":"text-rose-600":"text-slate-400",link:"/technicians"}]},[t,r,s,a]),l=o.useMemo(()=>t.filter(p=>p.status==="pending_assignment"&&new Date(p.timeWindowStart).getTime()<Date.now()).sort((p,j)=>new Date(p.timeWindowStart).getTime()-new Date(j.timeWindowStart).getTime()),[t]),c=o.useMemo(()=>t.filter(p=>p.status==="rescheduled"||p.status==="awaiting_customer_approval"),[t]),m=o.useMemo(()=>r.filter(p=>!p.todayAttendance||p.todayAttendance.status!=="present"),[r]),x=[...l.slice(0,3).map(p=>({id:p._id,text:`${Ur(p)} missed ${Be(p.timeWindowStart)} without technician assigned.`,link:`/orders?selected=${p._id}`})),...c.slice(0,2).map(p=>({id:`${p._id}-reschedule`,text:`${Ur(p)} awaiting reschedule confirmation.`,link:`/orders?selected=${p._id}`}))],g=[l[0]?{text:Cd(l[0],"Assign technician"),link:`/orders?selected=${l[0]._id}`}:null,m.length?{text:`Mark attendance for ${m[0].name} to include them in assignments.`,link:`/technicians?selected=${m[0].id}`}:null,c.length?{text:`Confirm reschedule for ${c[0].customer.name} (${(h=c[0].serviceItem)==null?void 0:h.name}).`,link:`/orders?selected=${c[0]._id}`}:null].filter(Boolean);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Mission Control"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Realtime Ops Snapshot"})]}),e.jsxs(Kt,{to:"/orders",className:"inline-flex items-center gap-2 rounded-2xl bg-slate-900 px-5 py-3 text-sm font-semibold text-white shadow-card",children:["Review Orders",e.jsx(no,{className:"h-4 w-4"})]})]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-3",children:i.map(p=>e.jsx(Kt,{to:p.link,className:"group",children:e.jsxs($e,{className:"transition-all duration-200 group-hover:shadow-lg group-hover:border-slate-200 group-hover:-translate-y-0.5",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:p.label}),e.jsx(ro,{className:"h-4 w-4 text-slate-300 transition-colors group-hover:text-slate-500"})]}),e.jsx("p",{className:`mt-3 text-3xl font-semibold ${p.accent}`,children:p.value}),e.jsx("p",{className:"mt-1 text-xs uppercase tracking-[0.3em] text-slate-400",children:p.delta})]})},p.label))}),e.jsx($e,{title:"Operations Heatmap",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-600",children:"Critical Alerts"}),x.length>0&&e.jsx(Kt,{to:"/orders",className:"text-xs text-slate-400 hover:text-slate-600 transition-colors",children:"View all "})]}),e.jsxs("ul",{className:"mt-4 space-y-3 text-sm",children:[x.length===0&&e.jsx("li",{className:"text-slate-400",children:"All clear. No SLA breaches detected."}),x.map(p=>e.jsx("li",{children:e.jsxs(Kt,{to:p.link,className:"text-slate-500 hover:text-slate-800 transition-colors cursor-pointer",children:[" ",p.text]})},p.id))]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-600",children:"Next Best Actions"}),g.length>0&&e.jsx(Kt,{to:"/orders",className:"text-xs text-slate-400 hover:text-slate-600 transition-colors",children:"View all "})]}),e.jsxs("ol",{className:"mt-4 space-y-3 text-sm",children:[g.length===0&&e.jsx("li",{className:"text-slate-400",children:"You're fully caught up for now."}),g.map((p,j)=>e.jsx("li",{children:e.jsxs(Kt,{to:p.link,className:"text-slate-500 hover:text-slate-800 transition-colors cursor-pointer",children:[j+1,". ",p.text]})},p.text))]})]})]})})]})},Cd=(t,s="Update order")=>t?`${s} for ${Ur(t)} scheduled ${Be(t.timeWindowStart)}.`:null,Ur=t=>{var a,i;const s=((a=t.customer)==null?void 0:a.name)??"Customer",r=((i=t.serviceItem)==null?void 0:i.name)??"Service";return`${s} (${r})`},_n={new:"bg-slate-100 text-slate-700",pending_assignment:"bg-amber-100 text-amber-800",assigned:"bg-blue-100 text-blue-800",in_progress:"bg-indigo-100 text-indigo-800",completed:"bg-emerald-100 text-emerald-700",cancelled:"bg-rose-100 text-rose-700",follow_up:"bg-orange-100 text-orange-800",unpaid:"bg-rose-100 text-rose-700",partially_paid:"bg-amber-100 text-amber-800",pending:"bg-slate-100 text-slate-700",partial:"bg-amber-100 text-amber-800",paid:"bg-emerald-100 text-emerald-700"},Qs=({variant:t="new",children:s})=>e.jsx("span",{className:vt("rounded-full px-3 py-1 text-xs font-semibold capitalize",_n[t]||_n.new),children:s}),He=o.forwardRef(({label:t,className:s,children:r,...a},i)=>e.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:[t&&e.jsx("span",{className:"font-medium text-slate-900",children:t}),e.jsx("select",{ref:i,className:vt("w-full rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-slate-900 focus:border-slate-900 focus:outline-none",s),...a,children:r})]}));He.displayName="Select";const Pt=o.forwardRef(({label:t,className:s,...r},a)=>e.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:[t&&e.jsx("span",{className:"font-medium text-slate-900",children:t}),e.jsx("textarea",{ref:a,className:vt("w-full rounded-xl border border-slate-200 bg-white px-4 py-2.5 text-slate-900 placeholder:text-slate-400 focus:border-slate-900 focus:outline-none",s),rows:r.rows||3,...r})]}));Pt.displayName="TextArea";const kd={md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",xxl:"max-w-8xl"},Qe=({open:t,onClose:s,title:r,children:a,size:i="md",showCloseButton:l=!1})=>e.jsx(Jt,{appear:!0,show:t,as:o.Fragment,children:e.jsxs(Xt,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(Jt.Child,{as:o.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/50"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsx(Jt.Child,{as:o.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-150",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(Xt.Panel,{className:`w-full ${kd[i]} transform rounded-2xl bg-white p-6 text-left align-middle shadow-xl`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx(Xt.Title,{as:"h3",className:"text-lg font-semibold text-slate-900",children:r}),l&&e.jsx("button",{type:"button",onClick:s,className:"rounded-full p-1 text-slate-500 transition hover:bg-slate-100 hover:text-slate-900","aria-label":"Close modal",children:""})]}),e.jsx("div",{className:"mt-4 space-y-4",children:a})]})})})})]})}),Ni=({open:t,onClose:s,title:r,children:a,widthClassName:i="w-screen max-w-lg"})=>e.jsx(Jt,{show:t,as:o.Fragment,appear:!0,children:e.jsxs(Xt,{as:"div",className:"relative z-[60]",onClose:()=>{},static:!0,children:[e.jsx(Jt.Child,{as:o.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 cursor-pointer",onClick:s,"aria-hidden":"true"})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"fixed inset-y-0 right-0 flex max-w-full pl-8",children:e.jsx(Jt.Child,{as:o.Fragment,enter:"transform transition ease-out duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in duration-200",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsx(Xt.Panel,{className:`pointer-events-auto ${i} bg-white shadow-2xl`,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-slate-100 px-6 py-4",children:[e.jsx("div",{children:e.jsx(Xt.Title,{className:"text-base font-semibold text-slate-900",children:r})}),e.jsxs("button",{type:"button",className:"rounded-full p-1 text-slate-400 transition hover:text-slate-600",onClick:s,children:[e.jsx("span",{className:"sr-only",children:"Close panel"}),e.jsx(gs,{className:"h-5 w-5"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:a})]})})})})})})]})}),xs=t=>t._id??`${t.dayOfWeek}-${t.startTime}-${t.endTime}-${t.label??""}`,Ed=t=>{const[s,r,a]=t.split("-"),i=Number(s),l=Number(r),c=Number(a);if(!Number.isFinite(i)||!Number.isFinite(l)||!Number.isFinite(c))return null;const m=new Date(i,l-1,c);return Number.isNaN(m.getTime())?null:m.getDay()},_d=[{value:"",label:"All statuses"},{value:"pending_assignment",label:"Pending assignment"},{value:"assigned",label:"Assigned"},{value:"in_progress",label:"In progress"},{value:"completed",label:"Completed"},{value:"cancellation_requested",label:"Cancellation requested"},{value:"follow_up",label:"Follow up"},{value:"unpaid",label:"Unpaid"},{value:"partially_paid",label:"Partially paid"}],Si=[{value:"follow_up",label:"Follow up"},{value:"inProgrss",label:"inProgress"},{value:"completed",label:"Complete"}],Ad=Si.map(t=>t.value),Ci=[{value:"pending",label:"Pending"},{value:"partial",label:"Partially paid"},{value:"paid",label:"Paid"}],Td=Ci.map(t=>t.value),Er=t=>{if(!t)return"";const s=t.replace(/_/g," ");return s.charAt(0).toUpperCase()+s.slice(1)},Pd=t=>t?typeof t=="string"?t:t.name||"System":"System",Od=t=>t?[t.addressLine1,t.addressLine2,t.city,t.state,t.postalCode].filter(Boolean).join(", "):"",An=(t,s=7)=>{const r=[];for(let a=0;a<s;a++){const i=new Date(t);i.setDate(t.getDate()+a),r.push(i)}return r},Tn=t=>t.toLocaleDateString("en-IN",{weekday:"short",day:"numeric",month:"short"}),Rd=(t,s,r,a)=>{const[i,l]=s.split(":").map(Number),[c,m]=r.split(":").map(Number),x=new Date(t);x.setHours(i,l,0,0);const g=new Date(t);g.setHours(c,m,0,0);for(const h of a){const p=new Date(h.start),j=new Date(h.end);if(p<g&&j>x)return h}return null},zt=(t,s)=>{const[r,a]=s.split(":").map(Number),i=new Date(t);return i.setHours(r,a,0,0),i},Id=()=>{var wa,Na,Sa,Ca,ka,Ea,_a,Aa,Ta,Pa,Oa,Ra,Ia,Da,Fa,La,Ma,Ba,$a,qa,Va,Ua,Wa,Ha,Ka,Qa,za,Za,Ya,Ja;const[t,s]=Bn(),[r,a]=o.useState(()=>t.get("status")||""),[i,l]=o.useState(!1),[c,m]=o.useState({order:null,open:!1}),[x,g]=o.useState({order:null,open:!1}),[h,p]=o.useState({order:null,open:!1}),[j,K]=o.useState(()=>t.get("selected")),[z,Z]=o.useState({open:!1,url:"",name:""}),[O,M]=o.useState(100),[C,k]=o.useState(null),[R,D]=o.useState(""),[oe,ge]=o.useState(null),[Ce,be]=o.useState(""),[S,H]=o.useState(null),[L,G]=o.useState(""),[ie,de]=o.useState(""),[pe,je]=o.useState(""),[Oe,we]=o.useState(""),[Fe,y]=o.useState(""),[ee,le]=o.useState(""),[Le,E]=o.useState(""),[Y,X]=o.useState(""),[ue,st]=o.useState(""),[ze,wt]=o.useState(""),[rt,me]=o.useState(""),[ct,dt]=o.useState("09:00"),[Nt,Rt]=o.useState("11:00"),[Bt,St]=o.useState(""),[u,f]=o.useState(!1),[b,I]=o.useState({open:!1,technicianId:null,name:""}),[A,_]=o.useState(()=>{const n=new Date;return n.setHours(0,0,0,0),n}),[P,te]=o.useState(null),[ae,Re]=o.useState(""),[w,ce]=o.useState(""),[Ne,Ct]=o.useState(""),[ut,It]=o.useState([]),[Je,$t]=o.useState([]),[qt,ar]=o.useState(""),[sa,ra]=o.useState(null),[nr,aa]=o.useState(!1),[Vt,na]=o.useState(""),[Ss,ia]=o.useState(""),[Cs,la]=o.useState(!1),[Ut,oa]=o.useState(""),[ca,ir]=o.useState(!1),[es,ts]=o.useState(""),[ss,rs]=o.useState(!1),[lr,as]=o.useState(""),[da,ns]=o.useState(""),[or,is]=o.useState(""),[cr,ls]=o.useState(""),[ua,os]=o.useState(""),[ks,ma]=o.useState("1"),Me=jt(),Es=()=>{m({order:null,open:!1}),I({open:!1,technicianId:null,name:""}),te(null)},ki=n=>{te(null),I({open:!0,technicianId:n.id,name:n.name||"Technician"})},ha=n=>{c.order&&Wt.mutate({orderId:c.order._id,technicianId:n})},{data:cs=[],isLoading:_s}=fe({queryKey:["orders",r],queryFn:()=>ke.list({status:r||void 0})});o.useEffect(()=>{if(j&&cs.length>0&&!_s){const n=cs.find(v=>v._id===j);n&&p({order:n,open:!0}),K(null);const d=new URLSearchParams(t);d.delete("selected"),s(d,{replace:!0})}},[cs,j,_s,t,s]);const Ei=n=>{a(n);const d=new URLSearchParams(t);n?d.set("status",n):d.delete("status"),d.delete("selected"),s(d,{replace:!0})},{data:_i=[]}=fe({queryKey:["categories"],queryFn:Te.categories,enabled:i}),{data:Ai=[]}=fe({queryKey:["service-items",ue],queryFn:()=>Te.serviceItems(ue||void 0),enabled:i&&!!ue}),{data:dr=[]}=fe({queryKey:["spare-parts"],queryFn:_r.list,enabled:h.open}),{data:ur=[]}=fe({queryKey:["all-service-items"],queryFn:()=>Te.serviceItems(),enabled:h.open}),{data:pa=[],isFetching:xa}=fe({queryKey:["order-technicians",(wa=c.order)==null?void 0:wa._id],queryFn:()=>ke.candidates(c.order._id),enabled:c.open&&!!((Na=c.order)!=null&&Na._id)}),{data:As=[],isFetching:Ts}=fe({queryKey:["technician-schedule",b.technicianId,A.toISOString()],queryFn:()=>{const n=new Date(A);return n.setDate(n.getDate()+7),Yt.schedule(b.technicianId,{start:A.toISOString(),end:n.toISOString()})},enabled:b.open&&!!b.technicianId}),{data:mt=[],isFetching:kt}=fe({queryKey:["time-slots"],queryFn:()=>fs.list(),enabled:x.open||b.open}),{data:U,isFetching:Ti,error:Pi}=fe({queryKey:["order-jobcard",(Sa=h.order)==null?void 0:Sa._id],queryFn:()=>ke.jobCard(h.order._id),enabled:h.open&&!!((Ca=h.order)!=null&&Ca._id)}),q=(U==null?void 0:U.jobCard)??null,qe=((ka=U==null?void 0:U.order)==null?void 0:ka.followUp)||null,mr=(q==null?void 0:q.sparePartsUsed)??[],Ps=mr.reduce((n,d)=>{var Q;const v=(d==null?void 0:d.quantity)??0,T=(d==null?void 0:d.unitPrice)??(typeof(d==null?void 0:d.part)=="object"?((Q=d.part)==null?void 0:Q.unitPrice)??0:0);return n+v*T},0),Os=(Ea=U==null?void 0:U.order)==null?void 0:Ea.serviceItem,Oi=typeof Os=="string"?0:(Os==null?void 0:Os.basePrice)??0,Rs=(q==null?void 0:q.estimateAmount)??((_a=U==null?void 0:U.order)==null?void 0:_a.estimatedCost)??Oi,Is=((q==null?void 0:q.extraWork)??[]).reduce((n,d)=>n+((d==null?void 0:d.amount)??0),0);o.useEffect(()=>{var d;console.log("Job Card Detail:",U),console.log("Job Card:",q);const n=(d=U==null?void 0:U.order)==null?void 0:d.status;n&&Ad.includes(n)?Re(n):Re("")},[(Aa=U==null?void 0:U.order)==null?void 0:Aa.status]),o.useEffect(()=>{q!=null&&q.paymentStatus&&Td.includes(q.paymentStatus)?ce(q.paymentStatus):ce("")},[q==null?void 0:q.paymentStatus]),o.useEffect(()=>{if(!h.open){Ct(""),It([]),$t([]),ar("");return}qe?(Ct(qe.reason||""),It(qe.attachments||[])):ae!=="follow_up"&&(Ct(""),It([]))},[h.open,qe==null?void 0:qe.reason,(Ta=qe==null?void 0:qe.attachments)==null?void 0:Ta.length,ae]);const Ds=o.useMemo(()=>{if(!U)return[];const n=[],{order:d}=U;((d==null?void 0:d.history)||[]).forEach((T,Q)=>{if(!T)return;let V="bg-blue-100",he=Er(T.action)||"Update";switch(T.action){case"technician_checked_in":V="bg-emerald-500",he="Technician Checked In";break;case"technician_checked_out":V="bg-rose-500",he="Technician Checked Out";break;case"technician_progress_update":V="bg-amber-500",he="Progress Update";break;case"technician_follow_up":V="bg-orange-500",he="Follow Up Required";break;case"technician_assigned":V="bg-indigo-500",he="Technician Assigned";break;case"order_rescheduled":V="bg-purple-500",he="Order Rescheduled";break;case"order_created":V="bg-slate-900",he="Order Created";break;default:V="bg-blue-100"}n.push({id:`history-${Q}`,title:he,description:[T.message,T.performedBy?`By ${Pd(T.performedBy)}`:null].filter(Boolean).join("  "),timestamp:T.performedAt,accent:V})});const v=T=>{if(!T)return Number.MAX_SAFE_INTEGER;const Q=new Date(T).getTime();return Number.isNaN(Q)?Number.MAX_SAFE_INTEGER:Q};return n.sort((T,Q)=>v(T.timestamp)-v(Q.timestamp))},[U]),hr=((Pa=U==null?void 0:U.order)==null?void 0:Pa.media)??[],Ri=hr.length>0||Je.length>0,ht=o.useMemo(()=>{if(!R)return[];const n=Ed(R);return n===null?[]:mt.filter(d=>d.dayOfWeek===n)},[R,mt]),Et=oe&&ht.find(n=>xs(n)===oe)||null,Dt=x.order,Fs=(Oa=Dt==null?void 0:Dt.preferredSlot)==null?void 0:Oa.label,ds=ae==="follow_up",se=((Ra=U==null?void 0:U.order)==null?void 0:Ra.status)==="completed",Ii=n=>{if(se){N.error("Completed job cards are view-only"),n.target.value="";return}const d=Array.from(n.target.files??[]);d.length&&(d.forEach(v=>{const T=new FileReader;T.onload=()=>{const Q=T.result;typeof Q=="string"&&It(V=>[...V,{url:Q,kind:v.type.startsWith("video")?"video":"image",name:v.name}])},T.readAsDataURL(v)}),n.target.value="")},Di=n=>{if(se){N.error("Completed job cards are view-only"),n.target.value="";return}const d=Array.from(n.target.files??[]);d.length&&(d.forEach(v=>{const T=new FileReader;T.onload=()=>{const Q=T.result;typeof Q=="string"&&$t(V=>[...V,{url:Q,kind:v.type.startsWith("video")?"video":v.type.startsWith("image")?"image":"document",name:v.name}])},T.readAsDataURL(v)}),n.target.value="")},Fi=n=>{if(se){N.error("Completed job cards are view-only");return}$t(d=>d.filter((v,T)=>T!==n))},Li=n=>{var d;if(se){N.error("Completed job cards are view-only");return}if(!n){N.error("Unable to delete this file");return}if(!((d=h.order)!=null&&d._id)){N.error("Open an order before deleting documents");return}ra(n),xr.mutate({orderId:h.order._id,mediaId:n})},Mi=()=>{var n;if(se){N.error("Completed job cards are view-only");return}if(!((n=h.order)!=null&&n._id)){N.error("Open an order before uploading documents");return}if(!Je.length){N.error("Select at least one file to upload");return}pr.mutate({orderId:h.order._id,media:Je})},Bi=n=>{if(se){N.error("Completed job cards are view-only");return}It(d=>d.filter((v,T)=>T!==n))},$i=()=>{var n;if(se){N.error("Completed job cards are view-only");return}if(!(!((n=h.order)!=null&&n._id)||!ae)){if(ds){if(!Ne.trim()){N.error("Provide a follow-up reason");return}if(!ut.length){N.error("Attach at least one image or video");return}}ms.mutate({orderId:h.order._id,status:ae,reason:ds?Ne:void 0,attachments:ds?ut:void 0})}},qi=()=>{var n;if(se){N.error("Completed job cards are view-only");return}if(!(!((n=h.order)!=null&&n._id)||!w)){if(!q){N.error("Generate a job card before updating payment status");return}fr.mutate({orderId:h.order._id,status:w})}},Vi=()=>{var v;if(se){N.error("Completed job cards are view-only");return}if(!((v=h.order)!=null&&v._id)){N.error("Open an order before adding spare parts");return}if(!Vt||!Ss){N.error("Please select a spare part and enter quantity");return}const n=parseFloat(Ss);if(isNaN(n)||n<=0){N.error("Quantity must be a positive number");return}const d=dr.find(T=>T._id===Vt);if(!d){N.error("Selected spare part not found");return}ga.mutate({orderId:h.order._id,sparePart:{sparePartId:Vt,quantity:n,unitPrice:d.unitPrice}})},Ui=()=>{var T;if(se){N.error("Completed job cards are view-only");return}if(!((T=h.order)!=null&&T._id)){N.error("Open an order before adding services");return}if(!Ut||!ks){N.error("Please select a service and enter quantity");return}const n=parseFloat(ks);if(isNaN(n)||n<=0){N.error("Quantity must be a positive number");return}const d=ur.find(Q=>Q._id===Ut);if(!d){N.error("Selected service not found");return}const v=(d.basePrice||0)*n;ba.mutate({orderId:h.order._id,service:{description:`${d.name} (x${n})`,amount:v,serviceItemId:Ut}})};o.useEffect(()=>{if(x.open&&x.order){const n=x.order.timeWindowStart?new Date(x.order.timeWindowStart).toISOString().split("T")[0]:"";D(n)}else D(""),ge(null)},[x.open,x.order]),o.useEffect(()=>{var v,T;if(!x.open)return;if(!R){oe!==null&&ge(null);return}if(!ht.length){oe!==null&&ge(null);return}if(oe&&ht.some(Q=>xs(Q)===oe))return;const n=(T=(v=x.order)==null?void 0:v.preferredSlot)==null?void 0:T.label;if(n){const Q=ht.find(V=>V.label===n);if(Q){const V=xs(Q);V!==oe&&ge(V);return}}const d=xs(ht[0]);d!==oe&&ge(d)},[x.open,R,ht,oe,x.order]);const Wt=ne({mutationFn:({orderId:n,technicianId:d})=>ke.assign(n,d),onMutate:({technicianId:n})=>k(n),onSuccess:()=>{N.success("Technician assigned"),Me.invalidateQueries({queryKey:["orders"]}),Es()},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Assignment failed")},onSettled:()=>k(null)}),us=ne({mutationFn:async({orderId:n,technicianId:d,newStart:v,newEnd:T})=>(await ke.reschedule(n,{newStart:v,newEnd:T}),ke.assign(n,d)),onSuccess:()=>{N.success("Order rescheduled and technician assigned!"),Me.invalidateQueries({queryKey:["orders"]}),Me.invalidateQueries({queryKey:["technician-schedule"]}),Es()},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Failed to assign with new slot")}}),fa=ne({mutationFn:({orderId:n,newStart:d,newEnd:v})=>ke.reschedule(n,{newStart:d,newEnd:v}),onSuccess:()=>{N.success("Order rescheduled"),Me.invalidateQueries({queryKey:["orders"]}),g({order:null,open:!1})},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Reschedule failed")}}),ms=ne({mutationFn:({orderId:n,status:d,reason:v,attachments:T})=>ke.changeStatus(n,{status:d,reason:v,attachments:T}),onSuccess:()=>{var n;N.success("Status updated"),(n=h.order)!=null&&n._id&&Me.invalidateQueries({queryKey:["order-jobcard",h.order._id]}),Me.invalidateQueries({queryKey:["orders"]})},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Unable to update status")}}),pr=ne({mutationFn:({orderId:n,media:d})=>ke.uploadMedia(n,{media:d}),onSuccess:()=>{var n;N.success("Documents uploaded"),$t([]),(n=h.order)!=null&&n._id&&Me.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Unable to upload documents")}}),xr=ne({mutationFn:({orderId:n,mediaId:d})=>ke.deleteMedia(n,d),onSuccess:()=>{var n;N.success("Document removed"),(n=h.order)!=null&&n._id&&Me.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Unable to delete document")},onSettled:()=>ra(null)}),fr=ne({mutationFn:({orderId:n,status:d})=>ke.updatePaymentStatus(n,{status:d}),onSuccess:()=>{var n;N.success("Payment status updated"),(n=h.order)!=null&&n._id&&Me.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Unable to update payment status")}}),gr=ne({mutationFn:({orderId:n,message:d})=>ke.addHistoryNote(n,{message:d}),onSuccess:(n,d)=>{N.success("Activity note added"),ar(""),Me.setQueryData(["order-jobcard",d.orderId],n)},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Unable to record note")}}),ga=ne({mutationFn:({orderId:n,sparePart:d})=>ke.addSparePart(n,d),onSuccess:(n,d)=>{N.success("Spare part added"),na(""),ia(""),aa(!1),Me.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Unable to add spare part")}}),ba=ne({mutationFn:({orderId:n,service:d})=>ke.addAdditionalService(n,d),onSuccess:(n,d)=>{N.success("Additional service added"),oa(""),ma("1"),la(!1),Me.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Unable to add service")}}),ya=ne({mutationFn:({orderId:n,index:d})=>ke.removeSparePart(n,d),onSuccess:(n,d)=>{N.success("Spare part removed"),Me.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Unable to remove spare part")}}),va=ne({mutationFn:({orderId:n,index:d})=>ke.removeAdditionalService(n,d),onSuccess:(n,d)=>{N.success("Additional service removed"),Me.invalidateQueries({queryKey:["order-jobcard",d.orderId]})},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Unable to remove service")}}),Ls=ne({mutationFn:({customerId:n,addressId:d,address:v})=>bt.updateAddress(n,{...v,addressId:d}),onSuccess:(n,d)=>{var v;N.success(d.addressId?"Order address updated":"New address added successfully"),ir(!1),rs(!1),ts(""),(v=h.order)!=null&&v._id&&Me.invalidateQueries({queryKey:["order-jobcard",h.order._id]})},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Unable to update address")}}),Wi=ne({mutationFn:n=>bt.findByPhone(n),onSuccess:n=>{var d,v;if(n){H(n),de(n.name||""),je(n.email||"");const T=((d=n.addresses)==null?void 0:d.find(Q=>Q.isDefault))||((v=n.addresses)==null?void 0:v[0]);T?(G(T.id),we(T.line1||""),y(T.line2||""),le(T.city||""),E(T.state||""),X(T.postalCode||"")):(we(n.addressLine1||""),y(n.addressLine2||""),le(n.city||""),E(""),X(n.postalCode||"")),N.success("Customer found!")}else H(null),G(""),de(""),je(""),we(""),y(""),le(""),E(""),X(""),N("Customer not found. Please enter details to create new customer.",{icon:""});f(!1)},onError:()=>{N.error("Failed to check customer"),f(!1)}}),ja=ne({mutationFn:async n=>{if(!S){const d=await bt.create({name:ie,phone:Ce,email:pe,address:{line1:Oe,line2:Fe,city:ee,state:Le,postalCode:Y}});return ke.create({...n,customerId:d.id})}return ke.create(n)},onSuccess:()=>{N.success("Order created successfully!"),l(!1),br(),Me.invalidateQueries({queryKey:["orders"]})},onError:n=>{var d,v;return N.error(((v=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:v.message)||"Failed to create order")}}),br=()=>{be(""),H(null),G(""),de(""),je(""),we(""),y(""),le(""),E(""),X(""),st(""),wt(""),me(""),dt("09:00"),Rt("11:00"),St("")},Hi=n=>{var v;G(n);const d=(v=S==null?void 0:S.addresses)==null?void 0:v.find(T=>T.id===n);d&&(we(d.line1||""),y(d.line2||""),le(d.city||""),E(d.state||""),X(d.postalCode||""))},Ki=()=>{if(!Ce.trim()){N.error("Please enter phone number");return}f(!0),Wi.mutate(Ce)},Qi=()=>{if(!Ce||!ie||!ze||!rt){N.error("Please fill all required fields");return}const n=L,d=Oe&&ee&&Le;if(!n&&!d){N.error("Please select an address or fill in address details");return}const v=new Date(`${rt}T${ct}`),T=new Date(`${rt}T${Nt}`),Q={customerId:S==null?void 0:S.id,serviceItem:ze,scheduledAt:v.toISOString(),timeWindowStart:v.toISOString(),timeWindowEnd:T.toISOString(),issueDescription:Bt,slotLabel:`${ct} - ${Nt}`};L?Q.addressId=L:d&&(Q.address={line1:Oe,line2:Fe,city:ee,state:Le,postalCode:Y}),ja.mutate(Q)},zi=!((Ia=h.order)!=null&&Ia._id)||!ae||ms.isPending||ds&&(!Ne.trim()||ut.length===0)||se,Zi=!((Da=h.order)!=null&&Da._id)||!q||!w||fr.isPending||se,Yi=!((Fa=h.order)!=null&&Fa._id)||!qt.trim()||gr.isPending||se;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Live Orders"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Admin Assignment Console"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx($,{onClick:()=>l(!0),children:"+ Create Order"}),e.jsx(He,{value:r,onChange:n=>Ei(n.target.value),children:_d.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))})]})]}),e.jsx($e,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs uppercase tracking-wide text-slate-500",children:[e.jsx("th",{className:"px-4 py-3",children:"Customer"}),e.jsx("th",{className:"px-4 py-3",children:"Service"}),e.jsx("th",{className:"px-4 py-3",children:"Schedule"}),e.jsx("th",{className:"px-4 py-3",children:"Technician"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[_s&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-slate-400",children:"Loading orders"})}),!_s&&cs.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-10 text-center text-slate-400",children:"No orders found for this filter."})}),cs.map(n=>{var d,v;return e.jsxs("tr",{className:"text-sm cursor-pointer transition-colors hover:bg-slate-50",onClick:()=>p({order:n,open:!0}),children:[e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("p",{className:"font-semibold text-slate-900",children:n.customer.name}),e.jsx("p",{className:"text-xs text-slate-500",children:n.customer.city})]}),e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("p",{className:"font-medium text-slate-900",children:(d=n.serviceItem)==null?void 0:d.name}),e.jsx("p",{className:"text-xs text-slate-500",children:(v=n.serviceCategory)==null?void 0:v.name})]}),e.jsxs("td",{className:"px-4 py-4 text-sm text-slate-600",children:[Be(n.timeWindowStart),e.jsxs("span",{className:"block text-xs text-slate-400",children:[" ",Be(n.timeWindowEnd)]})]}),e.jsx("td",{className:"px-4 py-4",children:n.assignedTechnician?e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-emerald-600",children:n.assignedTechnician.name}),e.jsx("p",{className:"text-xs text-slate-500",children:"Assigned technician"})]}):e.jsx("p",{className:"text-xs text-slate-400",children:"Not assigned"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx(Qs,{variant:n.status,children:n.status.replace(/_/g," ")})}),e.jsx("td",{className:"px-4 py-4 text-right",children:n.status==="completed"?e.jsx("span",{className:"text-xs text-slate-400",children:"Completed"}):n.status==="cancellation_requested"?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx($,{variant:"secondary",onClick:T=>{T.stopPropagation();const Q=window.prompt("Optional: Add a note for approving cancellation")||void 0;ms.mutate({orderId:n._id,status:"cancelled",reason:(Q==null?void 0:Q.trim())||void 0})},className:"text-xs",children:"Approve Cancel"}),e.jsx($,{variant:"secondary",onClick:T=>{T.stopPropagation();const Q=window.prompt("Optional: Add a note for rejecting cancellation")||void 0,V=n.assignedTechnician?"assigned":"pending_assignment";ms.mutate({orderId:n._id,status:V,reason:(Q==null?void 0:Q.trim())||void 0})},className:"text-xs",children:"Reject Cancel"})]}):e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx($,{variant:"secondary",onClick:T=>{T.stopPropagation(),g({order:n,open:!0})},className:"text-xs",children:"Reschedule"}),e.jsx($,{onClick:T=>{T.stopPropagation(),m({order:n,open:!0})},className:"text-xs",children:n.assignedTechnician?"Reassign":"Assign"})]})})]},n._id)})]})]})})}),e.jsxs(Qe,{open:c.open,onClose:()=>{b.open||Es()},title:"Assign Technician",children:[e.jsxs("p",{className:"text-sm text-slate-500",children:["Technicians shown are certified for"," ",e.jsx("span",{className:"font-semibold text-slate-900",children:(Ma=(La=c.order)==null?void 0:La.serviceItem)==null?void 0:Ma.name})," and reflect real-time slot availability."]}),((Ba=c.order)==null?void 0:Ba.assignedTechnician)&&e.jsxs("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-3 text-xs text-amber-800",children:["Currently assigned to ",e.jsx("span",{className:"font-semibold",children:c.order.assignedTechnician.name}),". Select another technician below to reassign."]}),xa&&e.jsx("p",{className:"text-sm text-slate-400",children:"Loading technician roster"}),!xa&&pa.length===0&&e.jsx("p",{className:"text-sm text-slate-400",children:"No technicians match this service yet. Add a profile from the Technicians tab."}),e.jsx("div",{className:"space-y-3",children:pa.map(n=>{var T,Q,V,he,Ie,Ht,_t;const d=(Q=(T=c.order)==null?void 0:T.assignedTechnician)==null?void 0:Q._id,v=d?d===n.id:!1;return e.jsxs("div",{className:`flex flex-col gap-4 rounded-2xl border p-4 shadow-sm sm:flex-row sm:items-start sm:justify-between ${v?"border-amber-200 bg-amber-50/60":"border-slate-100"}`,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("p",{className:"font-semibold text-slate-900",children:n.name||"Unnamed technician"}),e.jsx("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-xs font-semibold ${n.isAvailable?"bg-emerald-50 text-emerald-700":"bg-rose-50 text-rose-600"}`,children:n.isAvailable?e.jsxs(e.Fragment,{children:[e.jsx(po,{className:"h-4 w-4"})," Available"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ho,{className:"h-4 w-4"})," Busy in slot"]})}),v&&e.jsx("span",{className:"rounded-full bg-amber-100 px-2 py-0.5 text-xs font-semibold text-amber-700",children:"Current"})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[(V=n.skills)!=null&&V.length?n.skills.slice(0,3).join(", "):"Generalist",typeof n.experienceYears=="number"&&`  ${n.experienceYears} yrs exp`,n.phone&&`  ${n.phone}`]}),((he=n.workingHours)==null?void 0:he.start)&&((Ie=n.workingHours)==null?void 0:Ie.end)&&e.jsxs("p",{className:"text-xs text-slate-400",children:["Preferred hours ",n.workingHours.start,"  ",n.workingHours.end]}),(Ht=n.serviceItems)!=null&&Ht.length?e.jsxs("p",{className:"text-xs text-slate-400",children:["Services: ",n.serviceItems.map(pt=>pt.name).join(", ")]}):null]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:items-end",children:[e.jsx($,{type:"button",variant:"secondary",icon:e.jsx(mo,{className:"h-4 w-4"}),onClick:()=>ki(n),children:"Calendar"}),e.jsx($,{type:"button",onClick:()=>ha(n.id),disabled:!n.isAvailable||v||Wt.isPending,loading:Wt.isPending&&C===n.id,children:(_t=c.order)!=null&&_t.assignedTechnician?"Reassign":"Assign"})]})]},n.id)})})]}),e.jsx(Qe,{open:x.open,onClose:()=>g({order:null,open:!1}),title:"Reschedule Order",children:Dt&&e.jsxs("form",{className:"space-y-5",onSubmit:n=>{if(n.preventDefault(),!R||!Et){N.error("Select a date and a slot to reschedule");return}const d=(Q,V)=>{const he=V.length===5?`${V}:00`:V;return new Date(`${Q}T${he}`).toISOString()},v=d(R,Et.startTime),T=d(R,Et.endTime);fa.mutate({orderId:Dt._id,newStart:v,newEnd:T})},children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Currently scheduled"}),e.jsxs("p",{className:"mt-2 text-sm font-semibold text-slate-900",children:[Be(Dt.timeWindowStart),e.jsx("span",{className:"mx-1 text-slate-400",children:""}),Be(Dt.timeWindowEnd)]}),Fs&&e.jsxs("p",{className:"text-xs text-slate-500",children:["Slot: ",Fs]}),e.jsx("p",{className:"mt-3 text-xs text-slate-500",children:"Rescheduling keeps the same service and technician assignment rules. Pick a new day & slot below so we can notify the customer and crew."})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(F,{type:"date",label:"Target date",value:R,min:new Date().toISOString().split("T")[0],onChange:n=>D(n.target.value),required:!0}),e.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 p-4 text-sm text-slate-600",children:R&&Et?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-semibold text-slate-900",children:"New slot preview"}),e.jsxs("p",{children:[Et.label||"Custom slot"," on ",new Date(R).toLocaleDateString("en-IN",{dateStyle:"medium"})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[Et.startTime,"  ",Et.endTime]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-semibold text-slate-900",children:"Awaiting selection"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Pick a date and slot to generate a fresh appointment window."})]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Available time slots"}),kt&&e.jsx("p",{className:"mt-2 text-xs text-slate-400",children:"Loading slot templates"}),!kt&&mt.length===0&&e.jsx("p",{className:"mt-2 text-xs text-rose-500",children:"No time slots configured yet. Create slots in the admin settings."}),!kt&&mt.length>0&&!R&&e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Pick a date first to preview relevant slot templates."}),!kt&&mt.length>0&&R&&ht.length===0&&e.jsxs("p",{className:"mt-2 text-xs text-amber-600",children:["No slot templates cover ",new Date(R).toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"short"}),"."]}),!kt&&mt.length>0&&R&&ht.length>0&&e.jsx("div",{className:"mt-3 grid gap-3 sm:grid-cols-2",children:ht.map(n=>{const d=xs(n),v=d===oe,T=Fs&&n.label===Fs;return e.jsxs("button",{type:"button",className:`rounded-2xl border px-4 py-3 text-left transition focus:outline-none ${v?"border-slate-900 bg-slate-900/5 shadow-sm":"border-slate-200 hover:border-slate-400"}`,onClick:()=>ge(d),children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:n.label||`Slot ${n.dayOfWeek}`}),e.jsxs("p",{className:"text-xs text-slate-500",children:[n.startTime,"  ",n.endTime]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-[11px] uppercase tracking-wide",children:[v&&e.jsx("span",{className:"rounded-full bg-slate-900 px-2 py-0.5 text-white",children:"New choice"}),T&&e.jsx("span",{className:"rounded-full bg-emerald-100 px-2 py-0.5 text-emerald-700",children:"Current slot"}),typeof n.capacity=="number"&&e.jsxs("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-slate-600",children:[n.capacity," jobs"]})]})]},d)})})]}),e.jsx($,{type:"submit",className:"w-full",disabled:!R||!Et,loading:fa.isPending,children:"Confirm reschedule"})]})}),e.jsxs(Qe,{open:h.open,onClose:()=>p({order:null,open:!1}),title:`Job card  ${((qa=($a=h.order)==null?void 0:$a.serviceItem)==null?void 0:qa.name)??""}`,size:"xxl",showCloseButton:!0,children:[Ti&&e.jsx("p",{className:"text-sm text-slate-400",children:"Preparing printable job summary"}),Pi&&e.jsx("p",{className:"text-sm text-rose-500",children:"Unable to load job card. Please try again."}),U&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Fixzep Job Sheet"}),e.jsx("h3",{className:"text-2xl font-semibold text-slate-900",children:U.order.code||(q==null?void 0:q.id)||"Job Summary"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Status: ",e.jsx("span",{className:"font-semibold text-slate-900",children:(q==null?void 0:q.status)??"Not generated yet"})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx($,{type:"button",variant:"secondary",icon:e.jsx(Oo,{className:"h-4 w-4"}),onClick:()=>window.print(),disabled:!q,title:q?void 0:"Generate a job card before printing",children:"Print"})})]}),se&&e.jsx("div",{className:"rounded-2xl border border-emerald-200 bg-emerald-50/80 p-4 text-sm text-emerald-800",children:"Job marked as completed. Chat, uploads, and status changes are locked for audit safety."}),!q&&e.jsx("div",{className:"rounded-2xl border border-dashed border-amber-200 bg-amber-50/60 p-4 text-sm text-amber-800",children:"No job card has been created for this order yet. Once the technician starts work, their updates will appear here."}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Customer & Property"}),!se&&!ca&&e.jsx("button",{type:"button",onClick:()=>{ir(!0),rs(!1),ts(""),as(""),ns(""),is(""),ls(""),os("")},className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"Change Address"})]}),e.jsx("h4",{className:"mt-2 text-lg font-semibold text-slate-900",children:U.order.customer.name}),e.jsx("p",{className:"text-sm text-slate-600",children:U.order.customer.phone}),e.jsx("p",{className:"text-sm text-slate-600",children:U.order.customer.email||"Email not provided"}),ca?e.jsxs("div",{className:"mt-3 space-y-3",children:[S!=null&&S.addresses&&((Va=S==null?void 0:S.addresses)==null?void 0:Va.length)>0&&!ss?e.jsxs(e.Fragment,{children:[e.jsxs(He,{label:"Select Address",value:es,onChange:n=>{var T;const d=n.target.value;ts(d);const v=(T=S.addresses)==null?void 0:T.find(Q=>Q.id===d);v&&(as(v.line1||""),ns(v.line2||""),is(v.city||""),ls(v.state||""),os(v.postalCode||""))},children:[e.jsx("option",{value:"",children:"Choose an existing address"}),S.addresses.map(n=>e.jsxs("option",{value:n.id,children:[n.label||"Address"," - ",n.line1,", ",n.city," ",n.isDefault?"(Default)":""]},n.id))]}),e.jsx("button",{type:"button",onClick:()=>{rs(!0),ts(""),as(""),ns(""),is(""),ls(""),os("")},className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"+ Add New Address"})]}):null,(ss||!((Ua=S==null?void 0:S.addresses)!=null&&Ua.length)||es)&&e.jsxs(e.Fragment,{children:[ss&&(S==null?void 0:S.addresses)&&S.addresses.length>0&&e.jsx("button",{type:"button",onClick:()=>{rs(!1),as(""),ns(""),is(""),ls(""),os("")},className:"text-xs text-slate-600 hover:text-slate-700",children:" Back to address list"}),e.jsx(F,{label:"Address Line 1 *",value:lr,onChange:n=>as(n.target.value),placeholder:"Street address"}),e.jsx(F,{label:"Address Line 2",value:da,onChange:n=>ns(n.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(F,{label:"City *",value:or,onChange:n=>is(n.target.value),placeholder:"City"}),e.jsx(F,{label:"State *",value:cr,onChange:n=>ls(n.target.value),placeholder:"State"})]}),e.jsx(F,{label:"Postal Code",value:ua,onChange:n=>os(n.target.value),placeholder:"PIN Code"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{type:"button",onClick:()=>{var d;if(!es&&!ss&&((d=S==null?void 0:S.addresses)!=null&&d.length)){N.error("Please select an address or add a new one");return}if(!lr.trim()||!or.trim()||!cr.trim()){N.error("Please fill required address fields");return}const n=typeof U.order.customer=="string"?U.order.customer:U.order.customer._id||U.order.customer._id;if(!n){N.error("Customer ID not found");return}Ls.mutate({customerId:n,addressId:es||void 0,address:{line1:lr,line2:da,city:or,state:cr,postalCode:ua}})},loading:Ls.isPending,disabled:Ls.isPending,className:"flex-1",children:ss?"Add Address":es?"Update Order Address":"Save"}),e.jsx($,{type:"button",variant:"secondary",onClick:()=>{ir(!1),rs(!1),ts("")},disabled:Ls.isPending,className:"flex-1",children:"Cancel"})]})]}):e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:e.jsx("p",{children:Od(U.order.customer)||"Address not provided"})})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Documents & Photos"}),e.jsxs("label",{className:`mt-3 flex flex-col items-center justify-center rounded-2xl border-2 border-dashed px-4 py-6 text-center text-sm transition ${se?"cursor-not-allowed border-slate-100 bg-slate-50 text-slate-400":"cursor-pointer border-slate-200 bg-slate-50/50 text-slate-500 hover:border-slate-400"}`,children:[e.jsx("input",{type:"file",className:"hidden",multiple:!0,onChange:Di,disabled:se}),e.jsx("span",{className:"font-semibold text-slate-900",children:"Drag & drop files"}),e.jsx("span",{className:"text-xs text-slate-500",children:"or click to browse"})]}),Ri?e.jsxs("div",{className:"mt-4 space-y-5 text-sm",children:[hr.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Stored files"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-3",children:hr.map((n,d)=>e.jsxs("div",{className:"relative rounded-xl border border-slate-100 bg-white/70 overflow-hidden group",children:[n.kind==="image"?e.jsx("div",{className:"aspect-square cursor-pointer",onClick:()=>Z({open:!0,url:n.url,name:n.name||`Image ${d+1}`}),children:e.jsx("img",{src:n.url,alt:n.name||`Image ${d+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity"})}):n.kind==="video"?e.jsx("div",{className:"aspect-square bg-slate-900",children:e.jsx("video",{src:n.url,className:"w-full h-full object-cover",controls:!0})}):e.jsxs("div",{className:"aspect-square flex flex-col items-center justify-center bg-slate-50 p-3",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("p",{className:"mt-2 text-xs text-slate-600 text-center truncate w-full px-2",children:n.name||"Document"})]}),!se&&e.jsx("button",{type:"button",className:"absolute top-2 right-2 p-1 rounded-full bg-rose-600 hover:bg-rose-700 text-white shadow-lg transition-all opacity-0 group-hover:opacity-100",onClick:v=>{v.stopPropagation(),Li(n._id)},disabled:!n._id||xr.isPending&&sa!==n._id,title:"Delete",children:xr.isPending&&sa===n._id?e.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx(gs,{className:"h-4 w-4"})})]},n._id??`${n.url}-${d}`))})]}),Je.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Pending upload"}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-3",children:Je.map((n,d)=>e.jsxs("div",{className:"relative rounded-xl border border-dashed border-slate-200 bg-slate-50 overflow-hidden group",children:[n.kind==="image"?e.jsx("div",{className:"aspect-square cursor-pointer",onClick:()=>Z({open:!0,url:n.url,name:n.name||`Image ${d+1}`}),children:e.jsx("img",{src:n.url,alt:n.name||`Image ${d+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity"})}):n.kind==="video"?e.jsx("div",{className:"aspect-square bg-slate-900",children:e.jsx("video",{src:n.url,className:"w-full h-full object-cover",controls:!0})}):e.jsxs("div",{className:"aspect-square flex flex-col items-center justify-center bg-slate-50 p-3",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("p",{className:"mt-2 text-xs text-slate-600 text-center truncate w-full px-2",children:n.name||"Document"})]}),!se&&e.jsx("button",{type:"button",className:"absolute top-2 right-2 p-1 rounded-full bg-slate-700 hover:bg-slate-800 text-white shadow-lg transition-all opacity-0 group-hover:opacity-100",onClick:v=>{v.stopPropagation(),Fi(d)},disabled:se,title:"Remove",children:e.jsx(gs,{className:"h-4 w-4"})})]},`${n.url}-${d}`))}),e.jsx($,{type:"button",onClick:Mi,className:"mt-4 w-full",disabled:se||!Je.length||pr.isPending,loading:!se&&pr.isPending,children:`Upload ${Je.length} Document${Je.length>1?"s":""}`})]})]}):e.jsx("p",{className:"mt-3 text-xs text-slate-500",children:"No documents uploaded yet."})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-slate-400",children:"Service Details"}),e.jsx("h4",{className:"mt-2 text-lg font-semibold text-slate-900",children:typeof U.order.serviceItem=="string"?U.order.serviceItem:(Wa=U.order.serviceItem)==null?void 0:Wa.name}),e.jsx("p",{className:"text-sm text-slate-600",children:typeof U.order.serviceCategory=="string"?U.order.serviceCategory:((Ha=U.order.serviceCategory)==null?void 0:Ha.name)||"Category not tagged"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:U.order.serviceItem&&typeof U.order.serviceItem!="string"?U.order.serviceItem.description||U.order.issueDescription||"No description provided.":U.order.issueDescription||"No description provided."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Additional Services"}),!se&&e.jsx($,{variant:"secondary",onClick:()=>la(!Cs),className:"text-xs",children:Cs?"Cancel":"+ Add Service"})]}),Cs&&e.jsxs("div",{className:"mt-3 space-y-3 rounded-lg border border-slate-200 bg-slate-50 p-3",children:[e.jsxs(He,{label:"Select Service *",value:Ut,onChange:n=>oa(n.target.value),children:[e.jsx("option",{value:"",children:"Choose a service..."}),ur.map(n=>e.jsxs("option",{value:n._id,children:[n.name," - ",Ue(n.basePrice||0)]},n._id))]}),e.jsx(F,{label:"Quantity",type:"number",placeholder:"1",value:ks,onChange:n=>ma(n.target.value),min:"1",step:"1"}),Ut&&e.jsxs("div",{className:"rounded-lg bg-slate-100 p-2 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:"Total: "}),Ue((((Ka=ur.find(n=>n._id===Ut))==null?void 0:Ka.basePrice)||0)*parseFloat(ks||"1"))]}),e.jsx($,{onClick:Ui,loading:ba.isPending,className:"w-full",children:"Add Service"})]}),q!=null&&q.extraWork&&q.extraWork.length>0?e.jsx("ul",{className:"mt-3 space-y-2 text-sm",children:q.extraWork.map((n,d)=>e.jsxs("li",{className:"flex items-center justify-between rounded-xl bg-slate-50 px-3 py-2",children:[e.jsx("span",{className:"text-slate-600",children:n.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:Ue(n.amount)}),!se&&e.jsx("button",{type:"button",onClick:v=>{var T;v.stopPropagation(),(T=h.order)!=null&&T._id&&va.mutate({orderId:h.order._id,index:d})},className:"text-rose-500 hover:text-rose-700 transition-colors",disabled:va.isPending,title:"Remove service",children:e.jsx(js,{className:"h-4 w-4"})})]})]},`${n.description}-${d}`))}):Cs?null:e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"No additional services captured yet."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Activity Tracking"}),Ds.length>0&&e.jsxs("span",{className:"text-xs text-slate-400",children:[Ds.length," entries"]})]}),Ds.length===0?e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"No activity recorded yet for this job."}):e.jsx("ol",{className:"mt-4 space-y-4 border-l border-slate-100 pl-4 max-h-64 overflow-y-auto pr-2",children:Ds.map(n=>e.jsxs("li",{className:"relative pl-4",children:[e.jsx("span",{className:`absolute -left-2 top-2 block h-3 w-3 rounded-full ${n.accent||"bg-slate-300"}`}),e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:n.title}),n.description&&e.jsx("p",{className:"text-xs text-slate-500",children:n.description}),n.timestamp&&e.jsx("p",{className:"text-[11px] text-slate-400",children:Be(n.timestamp)})]},n.id))}),e.jsxs("form",{className:"mt-4 space-y-3 rounded-2xl bg-slate-50/80 p-3",onSubmit:n=>{var v;if(n.preventDefault(),se){N.error("Completed job cards are view-only");return}if(!((v=h.order)!=null&&v._id)){N.error("Open an order before logging activity");return}const d=qt.trim();d&&gr.mutate({orderId:h.order._id,message:d})},children:[e.jsx(Pt,{label:"Add a quick note",placeholder:"Share updates for finance, dispatch, or technicians",value:qt,onChange:n=>ar(n.target.value),rows:3,disabled:se}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("p",{className:"text-[11px] text-slate-500",children:se?"Job completed  notes locked.":"Notes sync to the order history instantly."}),e.jsx($,{type:"submit",className:"w-full sm:w-auto",disabled:Yi,loading:!se&&gr.isPending,children:"Send update"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Job & Payment Status"}),e.jsxs("div",{className:"mt-3 space-y-5",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-400",children:"Job progress"}),e.jsxs(He,{value:ae,onChange:n=>Re(n.target.value),disabled:se,children:[e.jsx("option",{value:"",children:"Select status"}),Si.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]}),e.jsx($,{type:"button",onClick:$i,disabled:zi,loading:!se&&ms.isPending,children:"Update job status"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[e.jsx(Qs,{variant:U.order.status,children:Er(U.order.status)||"Status"}),e.jsx("span",{children:"Last change synced to technicians and finance."})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-400",children:"Payment status"}),q?e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs(He,{value:w,onChange:n=>ce(n.target.value),disabled:se,children:[e.jsx("option",{value:"",children:"Select payment status"}),Ci.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]}),e.jsx($,{type:"button",onClick:qi,disabled:Zi,loading:!se&&fr.isPending,children:"Update payment status"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[e.jsx(Qs,{variant:q.paymentStatus??"pending",children:Er(q.paymentStatus)||"Pending"}),e.jsx("span",{children:"Tracks what finance should collect."})]})]}):e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Payment tracking unlocks once a job card is created."})]})]}),ds&&e.jsxs("div",{className:"mt-4 space-y-3 rounded-2xl border border-dashed border-rose-200 p-4",children:[e.jsx(Pt,{label:"Follow up reason",placeholder:"Explain why further follow up is required",value:Ne,onChange:n=>Ct(n.target.value),disabled:se}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Attach evidence (images/videos)"}),e.jsx("input",{type:"file",accept:"image/*,video/*",multiple:!0,onChange:Ii,disabled:se,className:"hidden",id:"followup-file-input"}),e.jsxs("label",{htmlFor:"followup-file-input",className:`flex flex-col items-center justify-center rounded-2xl border-2 border-dashed px-4 py-6 text-center text-sm transition cursor-pointer ${se?"border-slate-100 bg-slate-50 text-slate-400 cursor-not-allowed":"border-slate-200 bg-slate-50/50 text-slate-500 hover:border-slate-400"}`,children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"Drag & drop files"}),e.jsx("span",{className:"text-xs text-slate-500",children:"or click to browse"})]})]}),ut.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-3",children:ut.map((n,d)=>e.jsxs("div",{className:"relative rounded-xl border border-slate-100 bg-white/70 overflow-hidden group",children:[n.kind==="video"?e.jsx("div",{className:"aspect-square bg-slate-900",children:e.jsx("video",{src:n.url,className:"w-full h-full object-cover",controls:!0})}):e.jsx("div",{className:"aspect-square cursor-pointer",onClick:()=>Z({open:!0,url:n.url,name:n.name||`Evidence ${d+1}`}),children:e.jsx("img",{src:n.url,alt:n.name||"Attachment",className:"w-full h-full object-cover hover:opacity-90 transition-opacity"})}),!se&&e.jsx("button",{type:"button",className:"absolute top-2 right-2 p-1 rounded-full bg-rose-600 hover:bg-rose-700 text-white shadow-lg transition-all opacity-0 group-hover:opacity-100",onClick:v=>{v.stopPropagation(),Bi(d)},disabled:se,title:"Remove",children:e.jsx(gs,{className:"h-4 w-4"})})]},`${n.name||"attachment"}-${d}`))}),e.jsx("p",{className:"text-[11px] text-rose-600",children:"Technician assignment will be cleared when a job enters follow up."})]}),ae!=="follow_up"&&(qe==null?void 0:qe.reason)&&e.jsxs("div",{className:"mt-4 rounded-xl border border-dashed border-rose-100 bg-rose-50/60 p-3 text-xs text-rose-800",children:[e.jsx("p",{className:"font-semibold text-rose-900",children:"Follow up in progress"}),e.jsx("p",{className:"mt-1 text-rose-800",children:qe.reason}),(Qa=qe.attachments)!=null&&Qa.length?e.jsx("div",{className:"mt-3 grid gap-3 sm:grid-cols-2",children:qe.attachments.map((n,d)=>e.jsxs("div",{className:"rounded-xl border border-rose-100 p-2",children:[n.kind==="video"?e.jsx("video",{controls:!0,className:"h-28 w-full rounded-lg object-cover",src:n.url}):e.jsx("img",{src:n.url,alt:n.name||"Follow up evidence",className:"h-28 w-full rounded-lg object-cover"}),e.jsx("p",{className:"mt-1 text-[11px] text-rose-700 truncate",children:n.name||`Attachment ${d+1}`})]},`existing-${d}`))}):null]}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Syncs both job card and order status for finance follow-ups."})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-900/10 bg-gradient-to-br from-slate-900 to-slate-800 p-5 text-white",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-white/70",children:"Schedule"}),e.jsx("p",{className:"mt-2 text-lg font-semibold",children:((za=U.order.preferredSlot)==null?void 0:za.label)||"Scheduled slot"}),e.jsxs("p",{className:"mt-1 text-sm text-white/80",children:[U.order.timeWindowStart?Be(U.order.timeWindowStart):"",e.jsx("span",{className:"mx-1 text-white/50",children:""}),U.order.timeWindowEnd?Be(U.order.timeWindowEnd):""]}),(q==null?void 0:q.technician)&&e.jsxs("p",{className:"mt-2 text-xs text-white/70",children:["Technician:"," ",typeof q.technician=="string"?q.technician:q.technician.name," ",typeof q.technician!="string"?` ${q.technician.mobile??""}`:""]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Spare Parts / Cost Summary"}),!se&&e.jsx($,{variant:"secondary",onClick:()=>aa(!nr),className:"text-xs",children:nr?"Cancel":"+ Add Spare"})]}),nr&&e.jsxs("div",{className:"mt-3 space-y-3 rounded-lg border border-slate-200 bg-slate-50 p-3",children:[e.jsxs(He,{label:"Select Spare Part *",value:Vt,onChange:n=>na(n.target.value),children:[e.jsx("option",{value:"",children:"Choose a spare part..."}),dr.map(n=>e.jsxs("option",{value:n._id,children:[n.name," (",n.sku,") - ",Ue(n.unitPrice)]},n._id))]}),e.jsx(F,{label:"Quantity",type:"number",placeholder:"1",value:Ss,onChange:n=>ia(n.target.value),min:"1",step:"1"}),Vt&&e.jsxs("div",{className:"rounded-lg bg-slate-100 p-2 text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:"Total: "}),Ue((((Za=dr.find(n=>n._id===Vt))==null?void 0:Za.unitPrice)||0)*parseFloat(Ss||"1"))]}),e.jsx($,{onClick:Vi,loading:ga.isPending,className:"w-full",children:"Add Spare Part"})]}),mr.length>0&&e.jsx("div",{className:"mt-3 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"text-xs uppercase tracking-wide text-slate-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2",children:"Item"}),e.jsx("th",{className:"px-3 py-2",children:"Qty"}),e.jsx("th",{className:"px-3 py-2",children:"Unit price"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Total"}),!se&&e.jsx("th",{className:"px-3 py-2"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:mr.map((n,d)=>{var V,he,Ie;const v=typeof n.part=="string"?n.part:((V=n.part)==null?void 0:V.name)||((he=n.part)==null?void 0:he.sku)||"Part",T=(n==null?void 0:n.unitPrice)??(typeof(n==null?void 0:n.part)=="object"?((Ie=n.part)==null?void 0:Ie.unitPrice)??0:0),Q=(n.quantity??0)*T;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 text-slate-700",children:v}),e.jsx("td",{className:"px-3 py-2 text-slate-500",children:n.quantity??0}),e.jsx("td",{className:"px-3 py-2 text-slate-500",children:Ue(T)}),e.jsx("td",{className:"px-3 py-2 text-right font-semibold text-slate-900",children:Ue(Q)}),!se&&e.jsx("td",{className:"px-3 py-2",children:e.jsx("button",{type:"button",onClick:Ht=>{var _t;Ht.stopPropagation(),(_t=h.order)!=null&&_t._id&&ya.mutate({orderId:h.order._id,index:d})},className:"text-rose-500 hover:text-rose-700 transition-colors",disabled:ya.isPending,title:"Remove spare part",children:e.jsx(js,{className:"h-4 w-4"})})})]},`${v}-${d}`)})})]})}),e.jsxs("div",{className:"mt-4 space-y-2 rounded-2xl bg-slate-50 p-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Service Price"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Ue(Rs)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Spare Parts Subtotal"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Ue(Ps)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Additional Services"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Ue(Is)})]}),q!=null&&q.additionalCharges?e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Additional Charges"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Ue(q.additionalCharges)})]}):null,e.jsxs("div",{className:"flex items-center justify-between border-t border-slate-200 pt-2 text-slate-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Ue(Rs+Ps+Is+((q==null?void 0:q.additionalCharges)??0))})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Tax (18%)"}),e.jsx("span",{className:"font-semibold text-slate-900",children:Ue((Rs+Ps+Is+((q==null?void 0:q.additionalCharges)??0))*.18)})]}),e.jsxs("div",{className:"flex items-center justify-between text-slate-600",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{className:"font-semibold text-emerald-600",children:["-",Ue(0)]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t-2 border-slate-300 pt-2 text-base font-bold text-slate-900",children:[e.jsx("span",{children:"Grand Total"}),e.jsx("span",{className:"text-lg",children:Ue((Rs+Ps+Is+((q==null?void 0:q.additionalCharges)??0))*1.18)})]})]})]})]})]})]})]}),e.jsxs(Ni,{open:b.open,onClose:()=>{Es()},title:`Calendar  ${b.name||""}`,widthClassName:"w-screen max-w-2xl",children:[c.order&&e.jsxs("div",{className:"mb-4 space-y-3",children:[e.jsxs("div",{className:"rounded-xl border border-blue-200 bg-blue-50 p-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-blue-600 font-semibold",children:"Assigning to order"}),e.jsxs("p",{className:"text-sm text-blue-900 mt-1",children:[(Ya=c.order.serviceItem)==null?void 0:Ya.name,"  ",(Ja=c.order.customer)==null?void 0:Ja.name]}),e.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:["Current slot: ",Be(c.order.timeWindowStart),"  ",Be(c.order.timeWindowEnd)]})]}),e.jsx("div",{className:`rounded-xl border-2 p-4 ${P?"border-emerald-400 bg-emerald-50":"border-slate-200 bg-slate-50"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:P?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-emerald-600 font-semibold",children:"Selected time slot"}),e.jsx("p",{className:"text-sm font-semibold text-emerald-900 mt-1",children:P.label||`${P.startTime} - ${P.endTime}`}),e.jsx("p",{className:"text-xs text-emerald-700 mt-0.5",children:P.date.toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"short",year:"numeric"})}),e.jsxs("p",{className:"text-xs text-emerald-600 mt-0.5",children:[P.startTime,"  ",P.endTime]}),(()=>{var V,he;const n=(V=c.order)!=null&&V.timeWindowStart?new Date(c.order.timeWindowStart):null,d=(he=c.order)!=null&&he.timeWindowEnd?new Date(c.order.timeWindowEnd):null,v=zt(P.date,P.startTime),T=zt(P.date,P.endTime);return n&&d&&v.getTime()===n.getTime()&&T.getTime()===d.getTime()?e.jsx("p",{className:"text-xs text-emerald-800 mt-2 font-medium",children:" Same as current order slot"}):e.jsx("p",{className:"text-xs text-amber-600 mt-2 font-medium",children:" Order will be rescheduled to this slot"})})()]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500 font-semibold",children:"No slot selected"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:" Select an available time slot from the calendar below"})]})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx($,{onClick:()=>{if(!b.technicianId||!c.order||!P)return;const n=zt(P.date,P.startTime),d=zt(P.date,P.endTime),v=c.order.timeWindowStart?new Date(c.order.timeWindowStart):null,T=c.order.timeWindowEnd?new Date(c.order.timeWindowEnd):null;v&&T&&n.getTime()===v.getTime()&&d.getTime()===T.getTime()?ha(b.technicianId):us.mutate({orderId:c.order._id,technicianId:b.technicianId,newStart:n.toISOString(),newEnd:d.toISOString()})},loading:us.isPending||Wt.isPending,disabled:!P||us.isPending||Wt.isPending,className:"whitespace-nowrap",children:us.isPending||Wt.isPending?"Assigning...":"Assign Technician"}),P&&e.jsx("button",{type:"button",onClick:()=>te(null),className:"text-xs text-slate-500 hover:text-slate-700 transition-colors",children:"Clear selection"})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),n.preventDefault();const d=new Date(A);d.setDate(d.getDate()-7),_(d)},className:"px-3 py-1.5 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:" Previous"}),e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:[Tn(A)," - ",Tn(An(A,7)[6])]}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),n.preventDefault();const d=new Date(A);d.setDate(d.getDate()+7),_(d)},className:"px-3 py-1.5 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:"Next "})]}),(Ts||kt)&&e.jsx("p",{className:"text-sm text-slate-400 text-center py-8",children:"Loading calendar"}),!Ts&&!kt&&mt.length===0&&e.jsx("p",{className:"text-sm text-amber-600 text-center py-8",children:"No time slots configured. Add slots in admin settings."}),!Ts&&!kt&&mt.length>0&&e.jsx("div",{className:"space-y-1",onClick:n=>n.stopPropagation(),children:An(A,7).map(n=>{const d=n.getDay(),v=mt.filter(V=>V.dayOfWeek===d),T=n.toDateString()===new Date().toDateString(),Q=n<new Date(new Date().setHours(0,0,0,0));return e.jsxs("div",{className:`rounded-xl border p-3 ${T?"border-blue-200 bg-blue-50/50":"border-slate-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("p",{className:`text-sm font-semibold ${T?"text-blue-900":"text-slate-900"}`,children:n.toLocaleDateString("en-IN",{weekday:"short",day:"numeric",month:"short"})}),T&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-blue-500 text-white px-2 py-0.5 rounded-full",children:"Today"}),Q&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-slate-300 text-slate-600 px-2 py-0.5 rounded-full",children:"Past"})]}),v.length===0?e.jsx("p",{className:"text-xs text-slate-400 italic",children:"No slots configured for this day"}):e.jsx("div",{className:"grid grid-cols-2 gap-2",children:v.map(V=>{var en,tn,sn,rn;const he=Rd(n,V.startTime,V.endTime,As),Ie=he!==null,Ht=zt(n,V.startTime),_t=zt(n,V.endTime),pt=_t<new Date,Xa=(en=c.order)!=null&&en.timeWindowStart?new Date(c.order.timeWindowStart):null,Ga=(tn=c.order)!=null&&tn.timeWindowEnd?new Date(c.order.timeWindowEnd):null,yr=Xa&&Ga&&Ht.getTime()===Xa.getTime()&&_t.getTime()===Ga.getTime(),Ji=!Ie&&!pt&&c.order&&b.technicianId,xt=P&&P.date.toDateString()===n.toDateString()&&P.startTime===V.startTime&&P.endTime===V.endTime;return e.jsxs("button",{type:"button",disabled:Ie||pt||!c.order,onClick:an=>{an.stopPropagation(),an.preventDefault(),Ji&&te(xt?null:{date:n,startTime:V.startTime,endTime:V.endTime,label:V.label||`${V.startTime} - ${V.endTime}`})},className:`
                              relative p-2 rounded-lg text-left text-xs transition-all
                              ${Ie?"bg-rose-50 border border-rose-200 cursor-not-allowed":pt?"bg-slate-50 border border-slate-200 cursor-not-allowed opacity-50":xt?"bg-blue-100 border-2 border-blue-500 ring-2 ring-blue-200 cursor-pointer":yr?"bg-emerald-50 border-2 border-emerald-400 hover:bg-emerald-100 cursor-pointer":"bg-emerald-50/50 border border-emerald-200 hover:bg-emerald-100 hover:border-emerald-400 cursor-pointer"}
                            `,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`font-semibold ${Ie?"text-rose-700":pt?"text-slate-400":xt?"text-blue-700":"text-emerald-700"}`,children:V.label||`${V.startTime} - ${V.endTime}`}),Ie&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-rose-100 text-rose-600 px-1.5 py-0.5 rounded",children:"Blocked"}),xt&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-blue-500 text-white px-1.5 py-0.5 rounded",children:"Selected"}),!Ie&&!pt&&!xt&&e.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-emerald-100 text-emerald-600 px-1.5 py-0.5 rounded",children:"Available"})]}),e.jsxs("p",{className:`mt-1 ${Ie?"text-rose-600":pt?"text-slate-400":xt?"text-blue-600":"text-emerald-600"}`,children:[V.startTime,"  ",V.endTime]}),Ie&&he&&e.jsx("div",{className:"mt-2 pt-2 border-t border-rose-200",children:((rn=(sn=he.order)==null?void 0:sn.customer)==null?void 0:rn.name)&&e.jsx("p",{className:"text-rose-600 truncate",children:he.order.customer.name})}),!Ie&&!pt&&c.order&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-emerald-200",children:[e.jsx("p",{className:`font-medium ${xt?"text-blue-700":"text-emerald-700"}`,children:xt?' Click "Assign Technician" above':yr?" Current order slot":"Click to select"}),!yr&&!xt&&e.jsx("p",{className:"text-emerald-600 text-[10px]",children:"Will reschedule order"})]})]},`${n.toISOString()}-${V.startTime}-${V.endTime}`)})})]},n.toISOString())})}),us.isPending&&e.jsx("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl flex items-center gap-3",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"text-slate-700 font-medium",children:"Rescheduling and assigning"})]})}),!Ts&&As.length>0&&e.jsxs("div",{className:"mt-6 pt-4 border-t border-slate-200",children:[e.jsxs("p",{className:"text-xs uppercase tracking-wide text-slate-500 font-semibold mb-3",children:["Blocked entries (",As.length,")"]}),e.jsx("ol",{className:"space-y-2 max-h-48 overflow-y-auto",children:As.map(n=>{var v,T,Q,V,he,Ie;const d=typeof((v=n.order)==null?void 0:v.serviceItem)=="string"?(T=n.order)==null?void 0:T.serviceItem:(V=(Q=n.order)==null?void 0:Q.serviceItem)==null?void 0:V.name;return e.jsxs("li",{className:"rounded-lg border border-slate-100 p-2 text-xs",children:[e.jsxs("p",{className:"font-semibold text-slate-900",children:[Be(n.start)," ",e.jsx("span",{className:"text-slate-400",children:""})," ",Be(n.end)]}),e.jsxs("p",{className:"text-slate-500",children:[d||"Blocked slot",(Ie=(he=n.order)==null?void 0:he.customer)!=null&&Ie.name?`  ${n.order.customer.name}`:""]})]},n.id)})})]})]}),e.jsx(Qe,{open:i,onClose:()=>{l(!1),br()},title:"Create New Order",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Customer Information"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{label:"Customer Phone Number",value:Ce,onChange:n=>be(n.target.value),placeholder:"Enter phone number",disabled:u}),e.jsx($,{onClick:Ki,loading:u,variant:"secondary",className:"mt-6",children:"Check"})]}),S&&e.jsxs("div",{className:"rounded-lg bg-emerald-50 p-3 text-sm text-emerald-800",children:[" Customer found: ",S.name]}),e.jsx(F,{label:"Customer Name *",value:ie,onChange:n=>de(n.target.value),placeholder:"Enter customer name",disabled:!!(S&&ie)}),e.jsx(F,{label:"Email",type:"email",value:pe,onChange:n=>je(n.target.value),placeholder:"customer@email.com",disabled:!!(S&&pe)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Service Address"}),S&&S.addresses&&S.addresses.length>0&&e.jsxs(He,{label:"Select Address *",value:L,onChange:n=>Hi(n.target.value),children:[e.jsx("option",{value:"",children:"Choose an address"}),S.addresses.map(n=>e.jsxs("option",{value:n.id,children:[n.label||"Address"," - ",n.line1,", ",n.city," ",n.isDefault?"(Default)":""]},n.id))]}),e.jsx(F,{label:"Address Line 1 *",value:Oe,onChange:n=>we(n.target.value),placeholder:"Street address",disabled:!!(S&&Oe)}),e.jsx(F,{label:"Address Line 2",value:Fe,onChange:n=>y(n.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(F,{label:"City *",value:ee,onChange:n=>le(n.target.value),placeholder:"City",disabled:!!(S&&ee)}),e.jsx(F,{label:"State *",value:Le,onChange:n=>E(n.target.value),placeholder:"State",disabled:!!(S&&Le)})]}),e.jsx(F,{label:"Postal Code",value:Y,onChange:n=>X(n.target.value),placeholder:"PIN Code",disabled:!!(S&&Y)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Service Details"}),e.jsxs(He,{label:"Service Category *",value:ue,onChange:n=>{st(n.target.value),wt("")},children:[e.jsx("option",{value:"",children:"Select category"}),_i.map(n=>e.jsx("option",{value:n._id,children:n.name},n._id))]}),e.jsxs(He,{label:"Service Item *",value:ze,onChange:n=>wt(n.target.value),disabled:!ue,children:[e.jsx("option",{value:"",children:"Select service"}),Ai.map(n=>e.jsx("option",{value:n._id,children:n.name},n._id))]}),e.jsx(Pt,{label:"Issue Description",value:Bt,onChange:n=>St(n.target.value),placeholder:"Describe the issue...",rows:3})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Schedule"}),e.jsx(F,{label:"Order Date *",type:"date",value:rt,onChange:n=>me(n.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(F,{label:"Start Time *",type:"time",value:ct,onChange:n=>dt(n.target.value)}),e.jsx(F,{label:"End Time *",type:"time",value:Nt,onChange:n=>Rt(n.target.value)})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx($,{onClick:Qi,loading:ja.isPending,children:"Create Order"}),e.jsx($,{variant:"secondary",onClick:()=>{l(!1),br()},children:"Cancel"})]})]})}),z.open&&Ln.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[9999] flex flex-col bg-black/95 backdrop-blur-md animate-in fade-in duration-200",onClick:n=>{n.stopPropagation(),n.target===n.currentTarget&&(Z({open:!1,url:"",name:""}),M(100))},onKeyDown:n=>{n.key==="Escape"&&(n.stopPropagation(),Z({open:!1,url:"",name:""}),M(100))},tabIndex:-1,style:{isolation:"isolate"},children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-gradient-to-b from-black/60 to-transparent",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-semibold text-lg truncate",children:z.name}),e.jsx("p",{className:"text-white/60 text-sm mt-0.5",children:"Click and drag to pan  Scroll to zoom"})]}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),Z({open:!1,url:"",name:""}),M(100)},className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-all ml-4","aria-label":"Close image viewer",children:e.jsx(gs,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center overflow-auto p-8",onClick:n=>n.stopPropagation(),children:e.jsx("div",{className:"relative transition-transform duration-200 ease-out",style:{transform:`scale(${O/100})`,cursor:O>100?"move":"default"},children:e.jsx("img",{src:z.url,alt:z.name,className:"max-w-none shadow-2xl rounded-lg",style:{maxHeight:"80vh",maxWidth:O===100?"90vw":"none"},onClick:n=>n.stopPropagation(),onWheel:n=>{n.preventDefault();const d=n.deltaY>0?-10:10;M(v=>Math.min(Math.max(50,v+d),300))},draggable:!1})})}),e.jsxs("div",{className:"flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-t from-black/60 to-transparent",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm rounded-lg px-4 py-2",children:[e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),M(d=>Math.max(50,d-10))},disabled:O<=50,className:"p-2 rounded-lg hover:bg-white/10 text-white transition-all disabled:opacity-40 disabled:cursor-not-allowed",title:"Zoom out",children:e.jsx(So,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center gap-2 px-3",children:[e.jsx("input",{type:"range",min:"50",max:"300",step:"10",value:O,onChange:n=>M(Number(n.target.value)),className:"w-32 h-1 bg-white/20 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, rgb(59 130 246) 0%, rgb(59 130 246) ${(O-50)/250*100}%, rgba(255,255,255,0.2) ${(O-50)/250*100}%, rgba(255,255,255,0.2) 100%)`},onClick:n=>n.stopPropagation()}),e.jsxs("span",{className:"text-white font-medium text-sm min-w-[3.5rem] text-center",children:[O,"%"]})]}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),M(d=>Math.min(300,d+10))},disabled:O>=300,className:"p-2 rounded-lg hover:bg-white/10 text-white transition-all disabled:opacity-40 disabled:cursor-not-allowed",title:"Zoom in",children:e.jsx(ko,{className:"h-5 w-5"})})]}),e.jsxs("button",{type:"button",onClick:n=>{n.stopPropagation(),M(100)},className:"px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white text-sm font-medium transition-all flex items-center gap-2",title:"Reset zoom",children:[e.jsx(on,{className:"h-4 w-4"}),"Reset"]}),e.jsxs("button",{type:"button",onClick:n=>{n.stopPropagation(),window.open(z.url,"_blank")},className:"px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium transition-all flex items-center gap-2",title:"Open in new tab",children:[e.jsx(on,{className:"h-4 w-4"}),"Full Screen"]})]})]}),document.body)]})},Dd=()=>{const t=Xs(),s=jt(),[r,a]=o.useState(!1),[i,l]=o.useState(null),[c,m]=o.useState(!1),[x,g]=o.useState(null),h=ot({defaultValues:{name:"",description:"",imageUrl:""}}),p=h.watch("imageUrl"),j=S=>{var G;const H=(G=S.target.files)==null?void 0:G[0];if(!H)return;const L=new FileReader;L.onload=()=>{typeof L.result=="string"&&h.setValue("imageUrl",L.result,{shouldDirty:!0,shouldValidate:!0})},L.readAsDataURL(H),S.target.value=""},{data:K=[],isLoading:z}=fe({queryKey:["categories"],queryFn:Te.categories}),Z=ne({mutationFn:S=>Te.upsertCategory(S),onSuccess:()=>{N.success("Category saved"),s.invalidateQueries({queryKey:["categories"]}),h.reset(),a(!1)},onError:S=>{var H,L;return N.error(((L=(H=S==null?void 0:S.response)==null?void 0:H.data)==null?void 0:L.message)||"Failed to save category")}}),O=ne({mutationFn:S=>Te.updateCategory(i._id,S),onSuccess:()=>{N.success("Category updated successfully"),s.invalidateQueries({queryKey:["categories"]}),h.reset(),l(null),a(!1)},onError:S=>{var H,L;return N.error(((L=(H=S==null?void 0:S.response)==null?void 0:H.data)==null?void 0:L.message)||"Failed to update category")}}),M=ne({mutationFn:S=>Te.deleteCategory(S),onSuccess:()=>{N.success("Category deleted successfully"),s.invalidateQueries({queryKey:["categories"]}),m(!1),g(null)},onError:S=>{var H,L;return N.error(((L=(H=S==null?void 0:S.response)==null?void 0:H.data)==null?void 0:L.message)||"Failed to delete category")}}),C=ne({mutationFn:({categoryId:S,isActive:H})=>Te.updateCategory(S,{isActive:H}),onSuccess:(S,H)=>{N.success(H.isActive?"Category activated":"Category deactivated"),s.invalidateQueries({queryKey:["categories"]})},onError:S=>{var H,L;return N.error(((L=(H=S==null?void 0:S.response)==null?void 0:H.data)==null?void 0:L.message)||"Failed to update status")}}),k=(S,H)=>{H.stopPropagation(),S._id&&C.mutate({categoryId:S._id,isActive:!(S.isActive??!0)})},R=()=>{l(null),h.reset({name:"",description:"",imageUrl:""}),a(!0)},D=(S,H)=>{H.stopPropagation(),l(S),h.reset({name:S.name,description:S.description||"",imageUrl:S.imageUrl||""}),a(!0)},oe=(S,H)=>{H.stopPropagation(),g(S),m(!0)},ge=S=>{i?O.mutate(S):Z.mutate(S)},Ce=()=>{x!=null&&x._id&&M.mutate(x._id)},be=()=>{a(!1),l(null),h.reset()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Catalog"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Service Categories & Workflows"})]}),e.jsx($,{onClick:R,children:"Add Category"})]}),e.jsxs($e,{title:"Categories",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Click a category to manage its sub categories."}),z&&e.jsx("p",{className:"mt-4 text-sm text-slate-400",children:"Loading categories"}),!z&&K.length===0&&e.jsx("p",{className:"mt-4 text-sm text-slate-400",children:"No categories yet. Create one using the form above."}),!z&&K.length>0&&e.jsx("div",{className:"mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:K.map(S=>{const H=S.isActive??!0;return e.jsxs("div",{className:`group relative flex flex-col items-center gap-3 rounded-2xl border bg-white p-6 text-center shadow-sm transition hover:-translate-y-1 hover:shadow-lg cursor-pointer ${H?"border-slate-100 hover:border-slate-200":"border-slate-200 bg-slate-50 opacity-60"}`,onClick:()=>t(`/catalog/${S._id}`),children:[!H&&e.jsx("div",{className:"absolute left-2 top-2",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 text-xs font-medium",children:"Inactive"})}),e.jsxs("div",{className:"absolute right-2 top-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{type:"button",onClick:L=>k(S,L),className:`p-1.5 rounded-lg bg-white/90 transition-colors shadow-sm ${H?"text-amber-500 hover:text-amber-700 hover:bg-amber-50":"text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50"}`,title:H?"Deactivate category":"Activate category",disabled:C.isPending,children:H?e.jsx(Or,{className:"h-4 w-4"}):e.jsx(Rr,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:L=>D(S,L),className:"p-1.5 rounded-lg bg-white/90 text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors shadow-sm",title:"Edit category",children:e.jsx(Mt,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:L=>oe(S,L),className:"p-1.5 rounded-lg bg-white/90 text-rose-500 hover:text-rose-700 hover:bg-rose-50 transition-colors shadow-sm",title:"Delete category",children:e.jsx(js,{className:"h-4 w-4"})})]}),S.imageUrl?e.jsx("img",{src:S.imageUrl,alt:S.name,className:`h-24 w-24 rounded-2xl object-cover ${H?"":"grayscale"}`}):e.jsx("div",{className:"flex h-24 w-24 items-center justify-center rounded-2xl bg-slate-50 text-xs text-slate-400",children:"No image"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-900 group-hover:text-slate-700",children:S.name}),S.description&&e.jsx("p",{className:"mt-1 text-xs text-slate-500 line-clamp-2",children:S.description})]})]},S._id)})})]})]}),e.jsx(Qe,{open:r,onClose:be,title:i?"Edit Category":"Add Category",children:e.jsxs("form",{className:"space-y-4",onSubmit:h.handleSubmit(ge),children:[e.jsx(F,{label:"Name *",placeholder:"Electrical",...h.register("name",{required:!0})}),e.jsx(Pt,{label:"Description",placeholder:"Household electrical repairs",...h.register("description")}),e.jsx(F,{type:"file",accept:"image/*",label:"Upload image",onChange:j}),p&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:p,alt:"Category preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx($,{type:"button",variant:"ghost",onClick:be,children:"Cancel"}),e.jsx($,{type:"submit",loading:Z.isPending||O.isPending,children:i?"Update Category":"Save Category"})]})]})}),e.jsx(Qe,{open:c,onClose:()=>{m(!1),g(null)},title:"Delete Category",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-slate-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:x==null?void 0:x.name}),"? This action cannot be undone."]}),e.jsx("p",{className:"text-xs text-amber-600 bg-amber-50 p-3 rounded-lg",children:"Note: Categories with existing service items or orders cannot be deleted."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx($,{variant:"ghost",onClick:()=>{m(!1),g(null)},children:"Cancel"}),e.jsx($,{variant:"primary",className:"!bg-rose-600 hover:!bg-rose-700",onClick:Ce,loading:M.isPending,children:"Delete Category"})]})]})})]})},Fd=()=>{const{categoryId:t}=$n(),s=Xs(),r=jt(),a=t??"",[i,l]=o.useState(!1),[c,m]=o.useState(null),[x,g]=o.useState(!1),[h,p]=o.useState(null),[j,K]=o.useState(!1),{data:z=[],isLoading:Z}=fe({queryKey:["categories"],queryFn:Te.categories}),O=z.find(E=>E._id===t),{data:M=[],isLoading:C}=fe({queryKey:["serviceItems",a],queryFn:()=>Te.serviceItems(a),enabled:!!a}),k=ot({defaultValues:{category:a,name:"",description:"",basePrice:0,imageUrl:""}}),R=k.watch("imageUrl"),D=ot({defaultValues:{name:"",description:"",imageUrl:""}}),oe=D.watch("imageUrl"),ge=E=>{var ue;const Y=(ue=E.target.files)==null?void 0:ue[0];if(!Y)return;const X=new FileReader;X.onload=()=>{typeof X.result=="string"&&k.setValue("imageUrl",X.result,{shouldDirty:!0,shouldValidate:!0})},X.readAsDataURL(Y),E.target.value=""},Ce=E=>{var ue;const Y=(ue=E.target.files)==null?void 0:ue[0];if(!Y)return;const X=new FileReader;X.onload=()=>{typeof X.result=="string"&&D.setValue("imageUrl",X.result,{shouldDirty:!0,shouldValidate:!0})},X.readAsDataURL(Y),E.target.value=""};o.useEffect(()=>{a&&k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""})},[a,k]);const be=ne({mutationFn:E=>Te.upsertServiceItem(E),onSuccess:()=>{N.success("Sub category created"),r.invalidateQueries({queryKey:["serviceItems",a]}),k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""}),l(!1)},onError:E=>{var Y,X;return N.error(((X=(Y=E==null?void 0:E.response)==null?void 0:Y.data)==null?void 0:X.message)||"Failed to create sub category")}}),S=ne({mutationFn:E=>Te.updateServiceItem(c._id,E),onSuccess:()=>{N.success("Sub category updated"),r.invalidateQueries({queryKey:["serviceItems",a]}),k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""}),m(null),l(!1)},onError:E=>{var Y,X;return N.error(((X=(Y=E==null?void 0:E.response)==null?void 0:Y.data)==null?void 0:X.message)||"Failed to update sub category")}}),H=ne({mutationFn:E=>Te.deleteServiceItem(E),onSuccess:()=>{N.success("Sub category deleted"),r.invalidateQueries({queryKey:["serviceItems",a]}),g(!1),p(null)},onError:E=>{var Y,X;return N.error(((X=(Y=E==null?void 0:E.response)==null?void 0:Y.data)==null?void 0:X.message)||"Failed to delete sub category")}}),L=ne({mutationFn:E=>Te.updateCategory(a,E),onSuccess:()=>{N.success("Category updated"),r.invalidateQueries({queryKey:["categories"]}),D.reset(),K(!1)},onError:E=>{var Y,X;return N.error(((X=(Y=E==null?void 0:E.response)==null?void 0:Y.data)==null?void 0:X.message)||"Failed to update category")}}),G=ne({mutationFn:({itemId:E,isActive:Y})=>Te.updateServiceItem(E,{isActive:Y}),onSuccess:(E,Y)=>{N.success(Y.isActive?"Sub category activated":"Sub category deactivated"),r.invalidateQueries({queryKey:["serviceItems",a]})},onError:E=>{var Y,X;return N.error(((X=(Y=E==null?void 0:E.response)==null?void 0:Y.data)==null?void 0:X.message)||"Failed to update status")}}),ie=ne({mutationFn:({isActive:E})=>Te.updateCategory(a,{isActive:E}),onSuccess:(E,Y)=>{N.success(Y.isActive?"Category activated":"Category deactivated"),r.invalidateQueries({queryKey:["categories"]})},onError:E=>{var Y,X;return N.error(((X=(Y=E==null?void 0:E.response)==null?void 0:Y.data)==null?void 0:X.message)||"Failed to update status")}}),de=E=>{E._id&&G.mutate({itemId:E._id,isActive:!(E.isActive??!0)})},pe=()=>{O&&ie.mutate({isActive:!(O.isActive??!0)})},je=()=>{m(null),k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""}),l(!0)},Oe=E=>{m(E),k.reset({category:a,name:E.name,description:E.description||"",basePrice:E.basePrice||0,imageUrl:E.imageUrl||""}),l(!0)},we=E=>{p(E),g(!0)},Fe=()=>{O&&(D.reset({name:O.name,description:O.description||"",imageUrl:O.imageUrl||""}),K(!0))},y=E=>{c?S.mutate(E):be.mutate({...E,category:a})},ee=()=>{h!=null&&h._id&&H.mutate(h._id)},le=()=>{l(!1),m(null),k.reset({category:a,name:"",description:"",basePrice:0,imageUrl:""})},Le=E=>{L.mutate(E)};return a?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx($,{variant:"ghost",icon:e.jsx(to,{className:"h-4 w-4"}),onClick:()=>s("/catalog"),children:"Back to catalog"}),e.jsxs("div",{className:"flex items-center gap-3",children:[(O==null?void 0:O.imageUrl)&&e.jsx("img",{src:O.imageUrl,alt:O.name,className:`h-12 w-12 rounded-xl object-cover ${O.isActive??!0?"":"grayscale opacity-60"}`}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Catalog"}),O&&!(O.isActive??!0)&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 text-xs font-medium",children:"Inactive"})]}),e.jsx("h1",{className:"mt-1 text-2xl font-bold text-slate-900",children:Z?"Loading":(O==null?void 0:O.name)||"Category not found"}),(O==null?void 0:O.description)&&e.jsx("p",{className:"text-sm text-slate-500",children:O.description})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[O&&e.jsxs(e.Fragment,{children:[e.jsx($,{variant:"secondary",onClick:pe,loading:ie.isPending,icon:O.isActive??!0?e.jsx(Or,{className:"h-4 w-4"}):e.jsx(Rr,{className:"h-4 w-4"}),className:O.isActive??!0?"":"!bg-emerald-50 !text-emerald-700 !border-emerald-200",children:O.isActive??!0?"Deactivate":"Activate"}),e.jsx($,{variant:"secondary",onClick:Fe,icon:e.jsx(Mt,{className:"h-4 w-4"}),children:"Edit Category"})]}),e.jsx($,{onClick:je,disabled:!O,children:"Add Sub Category"})]})]}),!Z&&!O&&e.jsx($e,{children:e.jsx("p",{className:"text-sm text-rose-500",children:"We couldn't find that category. It may have been deleted."})}),O&&e.jsxs($e,{title:`Sub Categories (${M.length})`,children:[C&&e.jsx("p",{className:"text-sm text-slate-400",children:"Loading sub categories"}),!C&&M.length===0&&e.jsx("p",{className:"text-sm text-slate-400",children:"No sub categories yet. Create one using the button above."}),!C&&M.length>0&&e.jsx("div",{className:"mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:M.map(E=>{const Y=E.isActive??!0;return e.jsxs("div",{className:`group relative flex flex-col items-center gap-3 rounded-2xl border bg-white p-6 text-center shadow-sm ${Y?"border-slate-100":"border-slate-200 bg-slate-50 opacity-60"}`,children:[!Y&&e.jsx("div",{className:"absolute left-2 top-2",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 text-xs font-medium",children:"Inactive"})}),e.jsxs("div",{className:"absolute right-2 top-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{type:"button",onClick:()=>de(E),className:`p-1.5 rounded-lg bg-white/90 transition-colors shadow-sm ${Y?"text-amber-500 hover:text-amber-700 hover:bg-amber-50":"text-emerald-500 hover:text-emerald-700 hover:bg-emerald-50"}`,title:Y?"Deactivate sub category":"Activate sub category",disabled:G.isPending,children:Y?e.jsx(Or,{className:"h-4 w-4"}):e.jsx(Rr,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>Oe(E),className:"p-1.5 rounded-lg bg-white/90 text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors shadow-sm",title:"Edit sub category",children:e.jsx(Mt,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>we(E),className:"p-1.5 rounded-lg bg-white/90 text-rose-500 hover:text-rose-700 hover:bg-rose-50 transition-colors shadow-sm",title:"Delete sub category",children:e.jsx(js,{className:"h-4 w-4"})})]}),E.imageUrl?e.jsx("img",{src:E.imageUrl,alt:E.name,className:`h-20 w-20 rounded-2xl object-cover ${Y?"":"grayscale"}`}):e.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-2xl bg-slate-50 text-xs text-slate-400",children:"No image"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-900",children:E.name}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2",children:E.description||""}),typeof E.basePrice=="number"&&e.jsxs("p",{className:"mt-1 text-sm font-medium text-slate-700",children:["Base ",E.basePrice.toFixed(2)]})]})]},E._id)})})]}),e.jsx(Qe,{open:i,onClose:le,title:c?"Edit Sub Category":"Add Sub Category",children:e.jsxs("form",{className:"space-y-4",onSubmit:k.handleSubmit(y),children:[e.jsx(F,{label:"Sub category name *",placeholder:"Fan installation",...k.register("name",{required:!0})}),e.jsx(Pt,{label:"Description",...k.register("description")}),e.jsx(F,{type:"file",accept:"image/*",label:"Upload image",onChange:ge}),R&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:R,alt:"Sub category preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsx(F,{label:"Base price ()",type:"number",step:"0.01",...k.register("basePrice",{valueAsNumber:!0})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx($,{type:"button",variant:"ghost",onClick:le,children:"Cancel"}),e.jsx($,{type:"submit",loading:be.isPending||S.isPending,children:c?"Update Sub Category":"Save Sub Category"})]})]})}),e.jsx(Qe,{open:x,onClose:()=>{g(!1),p(null)},title:"Delete Sub Category",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-slate-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:h==null?void 0:h.name}),"? This action cannot be undone."]}),e.jsx("p",{className:"text-xs text-amber-600 bg-amber-50 p-3 rounded-lg",children:"Note: Sub categories with existing orders cannot be deleted."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx($,{variant:"ghost",onClick:()=>{g(!1),p(null)},children:"Cancel"}),e.jsx($,{variant:"primary",className:"!bg-rose-600 hover:!bg-rose-700",onClick:ee,loading:H.isPending,children:"Delete Sub Category"})]})]})}),e.jsx(Qe,{open:j,onClose:()=>{K(!1),D.reset()},title:"Edit Category",children:e.jsxs("form",{className:"space-y-4",onSubmit:D.handleSubmit(Le),children:[e.jsx(F,{label:"Name *",placeholder:"Electrical",...D.register("name",{required:!0})}),e.jsx(Pt,{label:"Description",placeholder:"Household electrical repairs",...D.register("description")}),e.jsx(F,{type:"file",accept:"image/*",label:"Upload image",onChange:Ce}),oe&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:oe,alt:"Category preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx($,{type:"button",variant:"ghost",onClick:()=>{K(!1),D.reset()},children:"Cancel"}),e.jsx($,{type:"submit",loading:L.isPending,children:"Update Category"})]})]})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx($,{variant:"ghost",onClick:()=>s("/catalog"),children:"Back to catalog"}),e.jsx("p",{className:"text-sm text-rose-500",children:"No category selected."})]})},Ld=()=>{const t=jt(),s=ot({defaultValues:{name:"",sku:"",unitPrice:0,imageUrl:""}}),r=s.watch("imageUrl"),{data:a=[]}=fe({queryKey:["spareParts"],queryFn:_r.list}),i=c=>{var g;const m=(g=c.target.files)==null?void 0:g[0];if(!m)return;const x=new FileReader;x.onload=()=>{typeof x.result=="string"&&s.setValue("imageUrl",x.result,{shouldDirty:!0,shouldValidate:!0})},x.readAsDataURL(m),c.target.value=""},l=ne({mutationFn:_r.upsert,onSuccess:()=>{N.success("Spare part saved"),t.invalidateQueries({queryKey:["spareParts"]}),s.reset()}});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Inventory"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Spare Parts Management"})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsx($e,{title:"Add Spare Part",children:e.jsxs("form",{className:"space-y-4",onSubmit:s.handleSubmit(c=>l.mutate(c)),children:[e.jsx(F,{label:"Name",...s.register("name",{required:!0})}),e.jsx(F,{label:"SKU",...s.register("sku",{required:!0})}),e.jsx(F,{type:"number",step:"0.01",label:"Unit price",...s.register("unitPrice",{valueAsNumber:!0})}),e.jsx(F,{type:"file",accept:"image/*",label:"Upload image",onChange:i}),r&&e.jsxs("div",{className:"rounded-2xl border border-slate-100 p-3 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-widest text-slate-400",children:"Preview"}),e.jsx("img",{src:r,alt:"Spare part preview",className:"mx-auto mt-2 h-32 w-32 rounded-xl object-cover"})]}),e.jsx($,{type:"submit",loading:l.isPending,children:"Save"})]})}),e.jsx($e,{title:"Catalog",children:e.jsx("div",{className:"space-y-4",children:a.map(c=>{var m;return e.jsxs("div",{className:"flex items-center gap-4 rounded-2xl border border-slate-100 p-4",children:[c.imageUrl?e.jsx("img",{src:c.imageUrl,alt:c.name,className:"h-16 w-16 rounded-lg object-cover"}):e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-lg bg-slate-50 text-xs text-slate-400",children:"No image"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:c.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:["SKU: ",c.sku]}),e.jsxs("p",{className:"mt-1 text-sm text-slate-600",children:["",(m=c.unitPrice)==null?void 0:m.toFixed(2)]})]})]},c._id)})})})]})]})},Pn={name:"",email:"",phone:"",password:"",role:"technician",serviceItems:[],skills:[]},Md=()=>{const t=jt(),s=ot({defaultValues:Pn}),r=nd({control:s.control,name:"role"}),{data:a=[]}=fe({queryKey:["serviceItems"],queryFn:()=>Te.serviceItems()}),{data:i=[]}=fe({queryKey:["technician-skills"],queryFn:Ar.list}),l=ne({mutationFn:ol.create,onSuccess:()=>{N.success("User created"),s.reset(Pn)},onError:x=>{var g,h;return N.error(((h=(g=x==null?void 0:x.response)==null?void 0:g.data)==null?void 0:h.message)||"Failed to create user")}});o.useEffect(()=>{r==="admin"&&(s.setValue("serviceItems",[]),s.setValue("skills",[]))},[r,s]);const c=ot({defaultValues:{name:"",description:""}}),m=ne({mutationFn:Ar.create,onSuccess:()=>{N.success("Skill saved"),c.reset(),t.invalidateQueries({queryKey:["technician-skills"]})},onError:x=>{var g,h;return N.error(((h=(g=x==null?void 0:x.response)==null?void 0:g.data)==null?void 0:h.message)||"Failed to save skill")}});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Team"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Create Admin / Technician"})]}),e.jsx($e,{children:e.jsxs("form",{className:"grid gap-4 md:grid-cols-2",onSubmit:s.handleSubmit(x=>l.mutate(x)),children:[e.jsx(F,{label:"Full name",...s.register("name",{required:!0})}),e.jsx(F,{label:"Email",type:"email",...s.register("email",{required:!0})}),e.jsx(F,{label:"Phone",...s.register("phone",{required:!0})}),e.jsx(F,{label:"Password",type:"password",...s.register("password",{required:!0})}),e.jsxs(He,{label:"Role",...s.register("role",{required:!0}),children:[e.jsx("option",{value:"technician",children:"Technician"}),e.jsx("option",{value:"admin",children:"Admin"})]}),r==="technician"&&e.jsxs("div",{className:"col-span-2 grid gap-6",children:[e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{className:"font-medium text-slate-900",children:"Service capabilities"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Select the catalog services this technician can perform."}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[a.map(x=>e.jsxs("label",{className:"flex items-center gap-2 rounded-xl border border-slate-200 p-3",children:[e.jsx("input",{type:"checkbox",value:x._id,...s.register("serviceItems"),className:"accent-slate-900"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:x.name})]},x._id)),!a.length&&e.jsx("span",{className:"text-xs text-slate-400",children:"No services available."})]})]}),e.jsxs("label",{className:"flex flex-col gap-2 text-sm text-slate-600",children:[e.jsx("span",{className:"font-medium text-slate-900",children:"Technician skills"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Pick applicable trade skills (electrician, plumber, pest control, etc.)."}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[i.map(x=>e.jsxs("label",{className:"flex items-center gap-2 rounded-xl border border-slate-200 p-3",children:[e.jsx("input",{type:"checkbox",value:x._id,...s.register("skills"),className:"accent-slate-900"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:x.name})]},x._id)),!i.length&&e.jsx("span",{className:"text-xs text-slate-400",children:"Add skill types below to start tagging technicians."})]})]})]}),e.jsx($,{type:"submit",loading:l.isPending,className:"col-span-2",children:"Create User"})]})}),e.jsxs($e,{title:"Manage Technician Skills",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Add or update the skill taxonomy used when creating technicians."}),e.jsxs("form",{className:"mt-4 grid gap-4 md:grid-cols-2",onSubmit:c.handleSubmit(x=>m.mutate(x)),children:[e.jsx(F,{label:"Skill name",placeholder:"Electrician",...c.register("name",{required:!0})}),e.jsx(F,{label:"Description",placeholder:"Optional",...c.register("description")}),e.jsx($,{type:"submit",loading:m.isPending,className:"md:col-span-2",children:"Save Skill"})]})]})]})},qs={label:"",dayOfWeek:0,startTime:"09:00",endTime:"10:00",intervalMinutes:60,capacity:1,isActive:!0},On=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map((t,s)=>({label:t,value:s})),Bd=()=>{const t=jt(),[s,r]=o.useState(null),a=ot({defaultValues:qs}),{data:i=[],isLoading:l}=fe({queryKey:["time-slots"],queryFn:fs.list}),c=ne({mutationFn:({slotId:h,data:p})=>h?fs.update(h,p):fs.create(p),onSuccess:()=>{N.success(`Time slot ${s?"updated":"created"}`),t.invalidateQueries({queryKey:["time-slots"]}),r(null),a.reset(qs)},onError:h=>{var p,j;return N.error(((j=(p=h==null?void 0:h.response)==null?void 0:p.data)==null?void 0:j.message)||"Unable to save time slot")}}),m=ne({mutationFn:h=>fs.remove(h),onSuccess:()=>{N.success("Time slot removed"),t.invalidateQueries({queryKey:["time-slots"]}),s&&s._id&&(r(null),a.reset(qs))},onError:h=>{var p,j;return N.error(((j=(p=h==null?void 0:h.response)==null?void 0:p.data)==null?void 0:j.message)||"Unable to delete slot")}});o.useEffect(()=>{s?a.reset({label:`${s.startTime}-${s.endTime}`,dayOfWeek:s.dayOfWeek,startTime:s.startTime,endTime:s.endTime,intervalMinutes:s.intervalMinutes??60,capacity:s.capacity??1,isActive:s.isActive??!0,_id:s._id}):a.reset(qs)},[s,a]);const x=h=>{const p={...h,intervalMinutes:h.intervalMinutes||60,capacity:h.capacity||1};c.mutate({slotId:s==null?void 0:s._id,data:p})},g=o.useMemo(()=>On.map(h=>({day:h,entries:i.filter(p=>p.dayOfWeek===h.value)})),[i]);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Scheduling"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Time Slot Templates"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Control reusable availability windows used by admin scheduling tooling."})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[360px,1fr]",children:[e.jsx($e,{title:s?"Edit Time Slot":"Create Time Slot",children:e.jsxs("form",{className:"space-y-4",onSubmit:a.handleSubmit(x),children:[e.jsx(F,{label:"Label",placeholder:"Morning Prime",...a.register("label")}),e.jsx(He,{label:"Day of week",...a.register("dayOfWeek",{setValueAs:h=>Number(h)}),children:On.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(F,{type:"time",label:"Start",...a.register("startTime",{required:!0})}),e.jsx(F,{type:"time",label:"End",...a.register("endTime",{required:!0})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(F,{type:"number",label:"Interval (minutes)",min:15,step:15,...a.register("intervalMinutes",{valueAsNumber:!0,min:15})}),e.jsx(F,{type:"number",label:"Capacity",min:1,step:1,...a.register("capacity",{valueAsNumber:!0,min:1})})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 accent-slate-900",...a.register("isActive")}),"Active"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx($,{type:"submit",loading:c.isPending,className:"flex-1",children:s?"Update Slot":"Create Slot"}),s&&e.jsx($,{type:"button",variant:"secondary",onClick:()=>r(null),children:"Cancel"})]})]})}),e.jsx($e,{title:"Configured Slots",children:l?e.jsx("p",{className:"text-sm text-slate-500",children:"Loading time slots"}):e.jsx("div",{className:"space-y-5",children:g.map(({day:h,entries:p})=>e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:h.label}),e.jsxs("div",{className:"mt-2 space-y-3",children:[p.length===0&&e.jsx("p",{className:"text-sm text-slate-300",children:"No slots configured."}),p.map(j=>e.jsxs("div",{className:"flex flex-col gap-2 rounded-2xl border border-slate-100 bg-white p-4 shadow-sm sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:j.label||`${j.startTime}  ${j.endTime}`}),e.jsxs("p",{className:"text-xs text-slate-500",children:[j.startTime,"  ",j.endTime,"  every ",j.intervalMinutes,"m  capacity ",j.capacity]}),!j.isActive&&e.jsx("p",{className:"text-xs text-rose-500",children:"Inactive"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{variant:"secondary",onClick:()=>r(j),children:"Edit"}),e.jsx($,{variant:"secondary",className:"text-rose-600",onClick:()=>j._id&&m.mutate(j._id),loading:m.isPending&&m.variables===j._id,children:"Delete"})]})]},j._id))]})]},h.value))})})]})]})},$d=[{value:"present",label:"Present"},{value:"absent",label:"Absent"},{value:"on_leave",label:"On leave"}],qd=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"suspended",label:"Suspended"}],Rn=()=>new Date().toISOString().split("T")[0],In=(t,s)=>{if(!t||!s)return;const r=s.length===5?`${s}:00`:s;return new Date(`${t}T${r}`).toISOString()},Vd=()=>{var de,pe,je,Oe,we,Fe;const t=jt(),[s,r]=Bn(),[a,i]=o.useState(null),[l,c]=o.useState(()=>s.get("selected")),[m,x]=o.useState(!1),[g,h]=o.useState(null),{data:p=[],isLoading:j}=fe({queryKey:["technicians"],queryFn:Yt.list}),{data:K=[]}=fe({queryKey:["categories"],queryFn:Te.categories,enabled:m}),{data:z=[]}=fe({queryKey:["all-service-items"],queryFn:()=>Te.serviceItems(),enabled:m}),{data:Z=[]}=fe({queryKey:["technician-skills"],queryFn:Ar.list,enabled:m});o.useEffect(()=>{if(l&&p.length>0&&!j){const y=p.find(le=>le.id===l);y&&i(y),c(null);const ee=new URLSearchParams(s);ee.delete("selected"),r(ee,{replace:!0})}},[p,l,j,s,r]);const{data:O=[],isFetching:M}=fe({queryKey:["technician-attendance",a==null?void 0:a.id],queryFn:()=>Yt.attendance(a.id),enabled:!!(a!=null&&a.id)}),C=ot({defaultValues:{date:Rn(),status:"present",checkInTime:"09:00",checkOutTime:"18:00"}}),k=ot({defaultValues:{name:"",email:"",phone:"",status:"active",experienceYears:0,workingHoursStart:"08:00",workingHoursEnd:"20:00",selectedSkills:[],selectedServiceItems:[],selectedServiceCategories:[]}});o.useEffect(()=>{C.reset({date:Rn(),status:"present",checkInTime:"09:00",checkOutTime:"18:00",note:""})},[C,a]);const R=ne({mutationFn:y=>{if(!a)throw new Error("Select a technician");return Yt.markAttendance(a.id,{date:y.date,status:y.status,checkInAt:In(y.date,y.checkInTime),checkOutAt:In(y.date,y.checkOutTime),note:y.note})},onSuccess:()=>{N.success("Attendance updated"),a&&t.invalidateQueries({queryKey:["technician-attendance",a.id]}),t.invalidateQueries({queryKey:["technicians"]})},onError:y=>{var ee,le;return N.error(((le=(ee=y==null?void 0:y.response)==null?void 0:ee.data)==null?void 0:le.message)||"Unable to save attendance")}}),D=ne({mutationFn:y=>{if(!g)throw new Error("No technician selected");return Yt.update(g.id,{name:y.name,email:y.email,phone:y.phone,status:y.status,experienceYears:y.experienceYears,workingHours:{start:y.workingHoursStart,end:y.workingHoursEnd},skills:y.selectedSkills,serviceItems:y.selectedServiceItems,serviceCategories:y.selectedServiceCategories})},onSuccess:y=>{N.success("Technician updated successfully"),t.invalidateQueries({queryKey:["technicians"]}),x(!1),h(null),(a==null?void 0:a.id)===y.id&&i(y)},onError:y=>{var ee,le;return N.error(((le=(ee=y==null?void 0:y.response)==null?void 0:ee.data)==null?void 0:le.message)||"Failed to update technician")}}),oe=o.useMemo(()=>O.slice(0,10),[O]),ge=(y,ee)=>{var le,Le,E,Y,X;ee==null||ee.stopPropagation(),h(y),k.reset({name:y.name||"",email:y.email||"",phone:y.phone||"",status:y.status||"active",experienceYears:y.experienceYears||0,workingHoursStart:((le=y.workingHours)==null?void 0:le.start)||"08:00",workingHoursEnd:((Le=y.workingHours)==null?void 0:Le.end)||"20:00",selectedSkills:((E=y.skills)==null?void 0:E.map(ue=>typeof ue=="string"?ue:ue.id||ue._id||"").filter(Boolean))||[],selectedServiceItems:((Y=y.serviceItems)==null?void 0:Y.map(ue=>ue.id||ue._id||"").filter(Boolean))||[],selectedServiceCategories:((X=y.serviceCategories)==null?void 0:X.map(ue=>ue.id||ue._id||"").filter(Boolean))||[]}),x(!0)},Ce=()=>{x(!1),h(null),k.reset()},be=y=>{const ee=k.getValues("selectedSkills");ee.includes(y)?k.setValue("selectedSkills",ee.filter(le=>le!==y)):k.setValue("selectedSkills",[...ee,y])},S=y=>{const ee=k.getValues("selectedServiceItems");ee.includes(y)?k.setValue("selectedServiceItems",ee.filter(le=>le!==y)):k.setValue("selectedServiceItems",[...ee,y])},H=y=>{const ee=k.getValues("selectedServiceCategories");ee.includes(y)?k.setValue("selectedServiceCategories",ee.filter(le=>le!==y)):k.setValue("selectedServiceCategories",[...ee,y])},L=k.watch("selectedSkills"),G=k.watch("selectedServiceItems"),ie=k.watch("selectedServiceCategories");return e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"flex flex-wrap items-end justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Operations"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Technician Roster"})]})}),e.jsx($e,{title:"Technicians",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs uppercase tracking-wide text-slate-500",children:[e.jsx("th",{className:"px-4 py-3",children:"Name"}),e.jsx("th",{className:"px-4 py-3",children:"Contact"}),e.jsx("th",{className:"px-4 py-3",children:"Skills"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3",children:"Today"}),e.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[j&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-6 text-center text-slate-400",children:"Loading technicians"})}),!j&&p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-6 text-center text-slate-400",children:"No technicians found. Create technician users to populate this list."})}),p.map(y=>{var ee;return e.jsxs("tr",{className:"cursor-pointer transition hover:bg-slate-50",onClick:()=>i(y),children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:y.name}),e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-500",children:[y.phone||"",e.jsx("span",{className:"block text-xs text-slate-400",children:y.email||""})]}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-500",children:(ee=y.skills)!=null&&ee.length?y.skills.slice(0,3).join(", "):"Generalist"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`text-xs uppercase tracking-wide px-2 py-1 rounded-full ${y.status==="active"?"bg-emerald-50 text-emerald-700":y.status==="inactive"?"bg-slate-100 text-slate-600":"bg-rose-50 text-rose-700"}`,children:y.status||"active"})}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-500",children:y.todayAttendance?y.todayAttendance.status:"Not marked"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{type:"button",onClick:le=>ge(y,le),className:"p-1.5 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors",title:"Edit technician",children:e.jsx(Mt,{className:"h-4 w-4"})})})]},y.id)})]})]})})}),e.jsx(Ni,{open:!!a,onClose:()=>i(null),title:(a==null?void 0:a.name)||"Technician",children:a&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-2xl border border-slate-200 p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Contact"}),e.jsx("p",{className:"text-base font-semibold text-slate-900",children:a.phone||""}),e.jsx("p",{className:"text-sm text-slate-500",children:a.email||""}),a.workingHours&&e.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["Hours ",a.workingHours.start||"--","  ",a.workingHours.end||"--"]})]}),e.jsx($,{variant:"secondary",onClick:()=>ge(a),icon:e.jsx(Mt,{className:"h-4 w-4"}),children:"Edit"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Skills"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:[(de=a.skills)==null?void 0:de.map(y=>e.jsx("span",{className:"rounded-full bg-emerald-50 px-3 py-1 text-emerald-700",children:y},y)),!((pe=a.skills)!=null&&pe.length)&&e.jsx("span",{className:"text-slate-400",children:"No skills tagged."})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Service items"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:[(je=a.serviceItems)==null?void 0:je.map(y=>e.jsx("span",{className:"rounded-full bg-slate-100 px-3 py-1",children:y.name},y.id||y.name)),!((Oe=a.serviceItems)!=null&&Oe.length)&&e.jsx("span",{className:"text-slate-400",children:"No service items mapped."})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Service categories"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500",children:[(we=a.serviceCategories)==null?void 0:we.map(y=>e.jsx("span",{className:"rounded-full bg-blue-50 px-3 py-1 text-blue-700",children:y.name},y.id||y.name)),!((Fe=a.serviceCategories)!=null&&Fe.length)&&e.jsx("span",{className:"text-slate-400",children:"No categories mapped."})]})]})]}),e.jsx($e,{title:"Mark attendance",children:e.jsxs("form",{className:"space-y-4",onSubmit:C.handleSubmit(y=>R.mutate(y)),children:[e.jsx(F,{type:"date",label:"Date",...C.register("date",{required:!0})}),e.jsx(He,{label:"Status",...C.register("status",{required:!0}),children:$d.map(y=>e.jsx("option",{value:y.value,children:y.label},y.value))}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(F,{type:"time",label:"Check-in",...C.register("checkInTime")}),e.jsx(F,{type:"time",label:"Check-out",...C.register("checkOutTime")})]}),e.jsx(Pt,{label:"Notes",rows:3,...C.register("note")}),e.jsx($,{type:"submit",loading:R.isPending,children:"Save attendance"})]})}),e.jsxs($e,{title:"Attendance history",children:[M&&e.jsx("p",{className:"text-sm text-slate-400",children:"Loading attendance"}),!M&&oe.length===0&&e.jsx("p",{className:"text-sm text-slate-400",children:"No attendance records found."}),!M&&oe.length>0&&e.jsx("ul",{className:"space-y-3",children:oe.map(y=>e.jsxs("li",{className:"rounded-xl border border-slate-100 p-3",children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:[new Date(y.date).toLocaleDateString("en-IN",{weekday:"short",day:"numeric",month:"short"}),e.jsx("span",{className:"ml-2 text-xs uppercase tracking-wide text-slate-500",children:y.status})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[y.checkInAt?`In: ${Be(y.checkInAt)}`:"No check-in"," "," ",y.checkOutAt?`Out: ${Be(y.checkOutAt)}`:"No check-out"]}),y.note&&e.jsx("p",{className:"text-xs text-slate-500",children:y.note})]},y._id||y.date))})]})]})}),e.jsx(Qe,{open:m,onClose:Ce,title:`Edit ${(g==null?void 0:g.name)||"Technician"}`,size:"xl",children:e.jsxs("form",{className:"space-y-6",onSubmit:k.handleSubmit(y=>D.mutate(y)),children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(F,{label:"Name *",...k.register("name",{required:!0})}),e.jsx(F,{label:"Email",type:"email",...k.register("email")}),e.jsx(F,{label:"Phone",...k.register("phone")}),e.jsx(He,{label:"Status",...k.register("status"),children:qd.map(y=>e.jsx("option",{value:y.value,children:y.label},y.value))})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Work Details"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsx(F,{label:"Experience (years)",type:"number",step:"0.5",min:"0",...k.register("experienceYears",{valueAsNumber:!0})}),e.jsx(F,{label:"Working hours start",type:"time",...k.register("workingHoursStart")}),e.jsx(F,{label:"Working hours end",type:"time",...k.register("workingHoursEnd")})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Skills"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Z.map(y=>e.jsx("button",{type:"button",onClick:()=>be(y._id),className:`rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${L.includes(y._id)?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:y.name},y._id)),Z.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No skills available. Create skills in settings."})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Service Categories"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[K.map(y=>e.jsx("button",{type:"button",onClick:()=>H(y._id),className:`rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${ie.includes(y._id)?"bg-blue-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:y.name},y._id)),K.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No categories available."})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Service Items (Sub-categories)"}),e.jsx("div",{className:"max-h-48 overflow-y-auto border border-slate-200 rounded-xl p-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[z.map(y=>e.jsx("button",{type:"button",onClick:()=>S(y._id),className:`rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${G.includes(y._id)?"bg-slate-900 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:y.name},y._id)),z.length===0&&e.jsx("p",{className:"text-xs text-slate-400",children:"No service items available."})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx($,{type:"button",variant:"ghost",onClick:Ce,children:"Cancel"}),e.jsx($,{type:"submit",loading:D.isPending,children:"Save Changes"})]})]})})]})},Ud=()=>{const[t,s]=o.useState(null),[r,a]=o.useState(!1),[i,l]=o.useState(!1),[c,m]=o.useState(!1),[x,g]=o.useState(null),[h,p]=o.useState(!1),[j,K]=o.useState(""),[z,Z]=o.useState(""),[O,M]=o.useState(""),[C,k]=o.useState(""),[R,D]=o.useState(""),[oe,ge]=o.useState(""),[Ce,be]=o.useState(""),[S,H]=o.useState(""),[L,G]=o.useState(""),[ie,de]=o.useState(""),[pe,je]=o.useState(""),[Oe,we]=o.useState(""),[Fe,y]=o.useState(""),[ee,le]=o.useState(""),[Le,E]=o.useState(""),[Y,X]=o.useState(""),[ue,st]=o.useState(""),ze=jt(),{data:wt=[],isLoading:rt}=fe({queryKey:["customers"],queryFn:bt.list}),{data:me,refetch:ct}=fe({queryKey:["customer-details",t==null?void 0:t.phone],queryFn:()=>t!=null&&t.phone?bt.findByPhone(t.phone):null,enabled:!!(t&&r)}),{data:dt=[]}=fe({queryKey:["customer-orders",t==null?void 0:t.id],queryFn:()=>ke.list({customerId:t.id}),enabled:!!(t&&r)}),Nt=ne({mutationFn:w=>bt.update(t.id,w),onSuccess:w=>{N.success("Customer updated successfully"),ze.invalidateQueries({queryKey:["customers"]}),ze.invalidateQueries({queryKey:["customer-details"]}),l(!1),w&&s(w)},onError:w=>{var ce,Ne;return N.error(((Ne=(ce=w==null?void 0:w.response)==null?void 0:ce.data)==null?void 0:Ne.message)||"Failed to update customer")}}),Rt=ne({mutationFn:w=>bt.updateAddress(t.id,w),onSuccess:()=>{N.success(x?"Address updated successfully":"Address added successfully"),ze.invalidateQueries({queryKey:["customer-details"]}),m(!1),te(),ct()},onError:w=>{var ce,Ne;return N.error(((Ne=(ce=w==null?void 0:w.response)==null?void 0:ce.data)==null?void 0:Ne.message)||"Failed to update address")}}),Bt=ne({mutationFn:w=>bt.deleteAddress(t.id,w),onSuccess:()=>{N.success("Address deleted successfully"),ze.invalidateQueries({queryKey:["customer-details"]}),ct()},onError:w=>{var ce,Ne;return N.error(((Ne=(ce=w==null?void 0:w.response)==null?void 0:ce.data)==null?void 0:Ne.message)||"Failed to delete address")}}),St=ne({mutationFn:w=>bt.create(w),onSuccess:()=>{N.success("Customer created successfully"),ze.invalidateQueries({queryKey:["customers"]}),p(!1),u()},onError:w=>{var ce,Ne;return N.error(((Ne=(ce=w==null?void 0:w.response)==null?void 0:ce.data)==null?void 0:Ne.message)||"Failed to create customer")}}),u=()=>{k(""),D(""),ge(""),be(""),H(""),G(""),de(""),je("")},f=()=>{if(!C.trim()){N.error("Name is required");return}if(!oe.trim()){N.error("Phone number is required");return}const w={name:C.trim(),phone:oe.trim(),email:R.trim()||void 0};Ce.trim()&&L.trim()&&ie.trim()&&(w.address={line1:Ce.trim(),line2:S.trim()||void 0,city:L.trim(),state:ie.trim(),postalCode:pe.trim()||void 0}),St.mutate(w)},b=w=>{s(w),a(!0)},I=()=>{a(!1),setTimeout(()=>s(null),200)},A=()=>{t&&(K((me==null?void 0:me.name)||t.name||""),Z((me==null?void 0:me.email)||t.email||""),M((me==null?void 0:me.phone)||t.phone||""),l(!0))},_=()=>{if(!j.trim()){N.error("Name is required");return}Nt.mutate({name:j.trim(),email:z.trim()||void 0,phone:O.trim()||void 0})},P=w=>{w?(g(w),we(w.label||""),y(w.line1||""),le(w.line2||""),E(w.city||""),X(w.state||""),st(w.postalCode||"")):(g(null),te()),m(!0)},te=()=>{g(null),we(""),y(""),le(""),E(""),X(""),st("")},ae=()=>{if(!Fe.trim()||!Le.trim()||!Y.trim()){N.error("Address line 1, city, and state are required");return}Rt.mutate({line1:Fe.trim(),line2:ee.trim()||void 0,city:Le.trim(),state:Y.trim(),postalCode:ue.trim()||void 0,addressId:x==null?void 0:x.id})},Re=w=>{window.confirm("Are you sure you want to delete this address?")&&Bt.mutate(w)};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-slate-400",children:"Customers"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold text-slate-900",children:"Customer Directory"})]}),e.jsx($,{onClick:()=>p(!0),icon:e.jsx(cn,{className:"h-4 w-4"}),children:"Add Customer"})]}),e.jsx($e,{title:"Customers",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs uppercase tracking-wide text-slate-500",children:[e.jsx("th",{className:"px-4 py-3",children:"Name"}),e.jsx("th",{className:"px-4 py-3",children:"Contact"}),e.jsx("th",{className:"px-4 py-3",children:"City"}),e.jsx("th",{className:"px-4 py-3",children:"Address"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[rt&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-slate-400",children:"Loading customers"})}),!rt&&wt.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-slate-400",children:"No customers found."})}),wt.map(w=>e.jsxs("tr",{className:"cursor-pointer hover:bg-slate-50 transition-colors",onClick:()=>b(w),children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:w.name}),e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-500",children:[w.phone||"",e.jsx("span",{className:"block text-xs text-slate-400",children:w.email||""})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-500",children:w.city||""}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-500",children:[w.addressLine1,w.addressLine2,w.postalCode].filter(Boolean).join(", ")||""})]},w.id))]})]})})}),e.jsx(Qe,{open:r,onClose:I,title:(t==null?void 0:t.name)||"Customer Details",size:"xl",showCloseButton:!0,children:t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Contact Information"}),e.jsx($,{variant:"secondary",onClick:A,icon:e.jsx(Mt,{className:"h-4 w-4"}),children:"Edit"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Name"}),e.jsx("p",{className:"font-medium text-slate-900",children:(me==null?void 0:me.name)||t.name||""})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Phone"}),e.jsx("p",{className:"font-medium text-slate-900",children:(me==null?void 0:me.phone)||t.phone||""})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email"}),e.jsx("p",{className:"font-medium text-slate-900",children:(me==null?void 0:me.email)||t.email||""})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Addresses"}),e.jsx($,{variant:"secondary",onClick:()=>P(),icon:e.jsx(cn,{className:"h-4 w-4"}),children:"Add Address"})]}),me!=null&&me.addresses&&me.addresses.length>0?e.jsx("div",{className:"space-y-3",children:me.addresses.map((w,ce)=>e.jsx("div",{className:"rounded-lg border border-slate-200 p-3 bg-slate-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[w.label&&e.jsx("p",{className:"text-xs font-semibold text-slate-700 mb-1",children:w.label}),e.jsx("p",{className:"text-sm text-slate-900",children:w.line1}),w.line2&&e.jsx("p",{className:"text-sm text-slate-600",children:w.line2}),e.jsx("p",{className:"text-sm text-slate-600",children:[w.city,w.state,w.postalCode].filter(Boolean).join(", ")}),w.phone&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Phone: ",w.phone]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[w.isDefault&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-xs font-medium",children:"Default"}),e.jsx("button",{type:"button",onClick:Ne=>{Ne.stopPropagation(),P(w)},className:"p-1.5 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors",title:"Edit address",children:e.jsx(Mt,{className:"h-4 w-4"})}),!w.isDefault&&e.jsx("button",{type:"button",onClick:Ne=>{Ne.stopPropagation(),Re(w.id)},disabled:Bt.isPending,className:"p-1.5 rounded-lg text-rose-500 hover:text-rose-700 hover:bg-rose-50 transition-colors disabled:opacity-50",title:"Delete address",children:e.jsx(js,{className:"h-4 w-4"})})]})]})},w.id||ce))}):e.jsx("p",{className:"text-sm text-slate-500",children:"No addresses on file"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:["Order History (",dt.length,")"]}),dt.length>0?e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:dt.map(w=>{var ce;return e.jsx("div",{className:"rounded-lg border border-slate-200 p-3 hover:bg-slate-50 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:["#",w._id.slice(-8)]}),e.jsx(Qs,{variant:w.status,children:w.status})]}),e.jsx("p",{className:"text-xs text-slate-600",children:typeof w.serviceItem=="string"?w.serviceItem:((ce=w.serviceItem)==null?void 0:ce.name)||"Service"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Scheduled: ",Be(w.timeWindowStart)]})]})})},w._id)})}):e.jsx("p",{className:"text-sm text-slate-500",children:"No orders found"})]})]})}),e.jsx(Qe,{open:i,onClose:()=>l(!1),title:"Edit Customer",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{label:"Name *",value:j,onChange:w=>K(w.target.value),placeholder:"Customer name"}),e.jsx(F,{label:"Email",type:"email",value:z,onChange:w=>Z(w.target.value),placeholder:"customer@email.com"}),e.jsx(F,{label:"Phone",value:O,onChange:w=>M(w.target.value),placeholder:"Phone number"}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx($,{onClick:_,loading:Nt.isPending,children:"Save Changes"}),e.jsx($,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"})]})]})}),e.jsx(Qe,{open:c,onClose:()=>{m(!1),te()},title:x?"Edit Address":"Add Address",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{label:"Label (optional)",value:Oe,onChange:w=>we(w.target.value),placeholder:"e.g. Home, Office"}),e.jsx(F,{label:"Address Line 1 *",value:Fe,onChange:w=>y(w.target.value),placeholder:"Street address"}),e.jsx(F,{label:"Address Line 2",value:ee,onChange:w=>le(w.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(F,{label:"City *",value:Le,onChange:w=>E(w.target.value),placeholder:"City"}),e.jsx(F,{label:"State *",value:Y,onChange:w=>X(w.target.value),placeholder:"State"})]}),e.jsx(F,{label:"Postal Code",value:ue,onChange:w=>st(w.target.value),placeholder:"PIN Code"}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx($,{onClick:ae,loading:Rt.isPending,children:x?"Update Address":"Add Address"}),e.jsx($,{variant:"secondary",onClick:()=>{m(!1),te()},children:"Cancel"})]})]})}),e.jsx(Qe,{open:h,onClose:()=>{p(!1),u()},title:"Add New Customer",size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Contact Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{label:"Name *",value:C,onChange:w=>k(w.target.value),placeholder:"Customer name"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(F,{label:"Phone *",value:oe,onChange:w=>ge(w.target.value),placeholder:"Phone number"}),e.jsx(F,{label:"Email",type:"email",value:R,onChange:w=>D(w.target.value),placeholder:"customer@email.com"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Address (Optional)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{label:"Address Line 1",value:Ce,onChange:w=>be(w.target.value),placeholder:"Street address"}),e.jsx(F,{label:"Address Line 2",value:S,onChange:w=>H(w.target.value),placeholder:"Apartment, suite, etc."}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(F,{label:"City",value:L,onChange:w=>G(w.target.value),placeholder:"City"}),e.jsx(F,{label:"State",value:ie,onChange:w=>de(w.target.value),placeholder:"State"}),e.jsx(F,{label:"Postal Code",value:pe,onChange:w=>je(w.target.value),placeholder:"PIN Code"})]})]}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"If you provide an address, line 1, city, and state are required."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx($,{onClick:f,loading:St.isPending,children:"Create Customer"}),e.jsx($,{variant:"secondary",onClick:()=>{p(!1),u()},children:"Cancel"})]})]})})]})},Lt={async listBanners(t){const s=t!==void 0?{isActive:t}:{},{data:r}=await W.get("/banners",{params:s});return r.data},async getBanner(t){const{data:s}=await W.get(`/banners/${t}`);return s.data},async createBanner(t){const{data:s}=await W.post("/banners",t);return s.data},async updateBanner(t,s){const{data:r}=await W.put(`/banners/${t}`,s);return r.data},async deleteBanner(t){const{data:s}=await W.delete(`/banners/${t}`);return s.data},async toggleBannerStatus(t){const{data:s}=await W.patch(`/banners/${t}/toggle`);return s.data},async reorderBanners(t){const{data:s}=await W.post("/banners/reorder",{banners:t});return s.data},async uploadImage(t){const s=new FormData;s.append("image",t);const{data:r}=await W.post("/banners/upload/image",s,{headers:{"Content-Type":"multipart/form-data"}}),a="https://admin.eopsys.xyz/api",i=r.data.imageUrl;return i.startsWith("http")?i:`${a.replace("/api","")}${i}`}},Wd=()=>{const[t,s]=o.useState([]),[r,a]=o.useState(!0),[i,l]=o.useState("");o.useEffect(()=>{c()},[]);const c=async()=>{try{a(!0);const g=await Lt.listBanners();s(g),l("")}catch(g){l("Failed to load banners"),console.error(g)}finally{a(!1)}},m=async g=>{if(window.confirm("Are you sure you want to delete this banner?"))try{await Lt.deleteBanner(g),s(t.filter(h=>h._id!==g))}catch(h){l("Failed to delete banner"),console.error(h)}},x=async g=>{try{const h=await Lt.toggleBannerStatus(g);s(t.map(p=>p._id===g?h:p))}catch(h){l("Failed to toggle banner status"),console.error(h)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Banners"}),e.jsx("a",{href:"/banners/new",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700",children:"+ Create Banner"})]}),i&&e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-sm text-red-700",children:i}),r?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"Loading banners..."})}):t.length===0?e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-12 text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"No banners yet"}),e.jsx("a",{href:"/banners/new",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700",children:"Create your first banner"})]}):e.jsx("div",{className:"grid gap-6",children:t.map(g=>e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"grid grid-cols-4 gap-6",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("img",{src:g.imageUrl,alt:g.title,className:"rounded-lg w-full h-32 object-cover"})}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:g.title}),g.subtitle&&e.jsx("p",{className:"text-sm text-gray-600",children:g.subtitle}),g.link&&e.jsx("p",{className:"text-sm text-blue-600 truncate",children:e.jsx("a",{href:g.link,target:"_blank",rel:"noopener noreferrer",children:g.link})}),g.startDate&&g.endDate&&e.jsxs("p",{className:"text-xs text-gray-500",children:[new Date(g.startDate).toLocaleDateString()," -"," ",new Date(g.endDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"col-span-1 flex flex-col gap-2 justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-xs font-semibold ${g.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:g.isActive?"Active":"Inactive"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x(g._id),className:"flex-1 rounded-lg text-xs font-medium px-3 py-2 border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:g.isActive?"Deactivate":"Activate"}),e.jsx("a",{href:`/banners/${g._id}`,className:"flex-1 rounded-lg text-xs font-medium px-3 py-2 bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors text-center",children:"Edit"}),e.jsx("button",{onClick:()=>m(g._id),className:"flex-1 rounded-lg text-xs font-medium px-3 py-2 border border-red-200 text-red-700 hover:bg-red-50 transition-colors",children:"Delete"})]})]})]})},g._id))})]})},Dn=()=>{const t=Xs(),{bannerId:s}=$n(),r=o.useRef(null),[a,i]=o.useState(!!s),[l,c]=o.useState(!1),[m,x]=o.useState(!1),[g,h]=o.useState(""),[p,j]=o.useState({title:"",subtitle:"",imageUrl:"",link:"",isActive:!0,startDate:"",endDate:""});o.useEffect(()=>{s&&K()},[s]);const K=async()=>{if(s)try{i(!0);const M=await Lt.getBanner(s);j(M),h("")}catch(M){h("Failed to load banner"),console.error(M)}finally{i(!1)}},z=M=>{const{name:C,value:k,type:R}=M.target;j(D=>({...D,[C]:R==="checkbox"?M.target.checked:k}))},Z=async M=>{var k;const C=(k=M.target.files)==null?void 0:k[0];if(C){x(!0),h("");try{const R=await Lt.uploadImage(C);j(D=>({...D,imageUrl:R}))}catch(R){h("Failed to upload image"),console.error(R)}finally{x(!1),r.current&&(r.current.value="")}}},O=async M=>{M.preventDefault(),c(!0),h("");try{s?await Lt.updateBanner(s,p):await Lt.createBanner(p),t("/banners")}catch(C){h(`Failed to ${s?"update":"create"} banner`),console.error(C)}finally{c(!1)}};return a?e.jsx("div",{className:"text-center py-12",children:"Loading..."}):e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s?"Edit Banner":"Create Banner"})}),g&&e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-sm text-red-700",children:g}),e.jsxs("form",{onSubmit:O,className:"space-y-6 bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),e.jsx("input",{type:"text",name:"title",required:!0,value:p.title||"",onChange:z,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"Banner title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subtitle"}),e.jsx("input",{type:"text",name:"subtitle",value:p.subtitle||"",onChange:z,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"Banner subtitle"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL *"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"url",name:"imageUrl",required:!0,value:p.imageUrl||"",onChange:z,className:"flex-1 rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"https://example.com/image.jpg"}),e.jsx("button",{type:"button",onClick:()=>{var M;return(M=r.current)==null?void 0:M.click()},disabled:m,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg border border-gray-300 text-sm font-medium disabled:opacity-60",children:m?"Uploading...":"Upload"})]}),e.jsx("input",{ref:r,type:"file",accept:"image/*",onChange:Z,className:"hidden"})]}),p.imageUrl&&e.jsx("img",{src:p.imageUrl,alt:"Preview",className:"mt-3 rounded-lg max-h-48 object-cover"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link"}),e.jsx("input",{type:"url",name:"link",value:p.link||"",onChange:z,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"https://example.com"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"datetime-local",name:"startDate",value:p.startDate||"",onChange:z,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"datetime-local",name:"endDate",value:p.endDate||"",onChange:z,className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"isActive",name:"isActive",checked:p.isActive||!1,onChange:z,className:"h-4 w-4 rounded border-gray-300"}),e.jsx("label",{className:"text-sm font-medium text-gray-700",htmlFor:"isActive",children:"Active"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:l,className:"flex-1 rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 disabled:opacity-60",children:l?"Saving...":"Save Banner"}),e.jsx("button",{type:"button",onClick:()=>t("/banners"),className:"flex-1 rounded-lg border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50",children:"Cancel"})]})]})]})},Hd=()=>e.jsxs(el,{children:[e.jsx(Ve,{path:"/login",element:e.jsx(wd,{})}),e.jsxs(Ve,{element:e.jsx(Gl,{children:e.jsx(Xc,{})}),children:[e.jsx(Ve,{path:"/",element:e.jsx(Sd,{})}),e.jsx(Ve,{path:"/orders",element:e.jsx(Id,{})}),e.jsx(Ve,{path:"/customers",element:e.jsx(Ud,{})}),e.jsx(Ve,{path:"/catalog",element:e.jsx(Dd,{})}),e.jsx(Ve,{path:"/catalog/:categoryId",element:e.jsx(Fd,{})}),e.jsx(Ve,{path:"/technicians",element:e.jsx(Vd,{})}),e.jsx(Ve,{path:"/spare-parts",element:e.jsx(Ld,{})}),e.jsx(Ve,{path:"/time-slots",element:e.jsx(Bd,{})}),e.jsx(Ve,{path:"/users/new",element:e.jsx(Md,{})}),e.jsx(Ve,{path:"/banners",element:e.jsx(Wd,{})}),e.jsx(Ve,{path:"/banners/new",element:e.jsx(Dn,{})}),e.jsx(Ve,{path:"/banners/:bannerId",element:e.jsx(Dn,{})})]}),e.jsx(Ve,{path:"*",element:e.jsx(Mn,{to:"/",replace:!0})})]}),Kd=new nl({defaultOptions:{queries:{staleTime:6e4,refetchOnWindowFocus:!1,retry:1}}});qn(document.getElementById("root")).render(e.jsx(o.StrictMode,{children:e.jsx(il,{client:Kd,children:e.jsx(Jl,{children:e.jsx(zc,{children:e.jsxs(tl,{children:[e.jsx(Hd,{}),e.jsx(Yl,{position:"top-right"})]})})})})}));
